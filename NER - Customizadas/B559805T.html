<!DOCTYPE html><html lang = "en"><head><meta charset = "utf-8"><meta name = "viewport" content = "width=device-width, initial-scale=1"><title>JDE Object Browser HTML Extract</title>
<style type='text/css'>body,th{font-family: Courier New, Courier, mono;font-size: 12px; width:auto}
.section{font-family: Arial, Helvetica, sans-serif;font-size: 12px;font-weight: bold;border: thin groove #CC9966;width: 100%;padding-left: 5px;padding-top: 5px;padding-bottom: 5px; padding-right: 5px; box-sizing: border-box }
.objectheader {font-family: Arial, Helvetica, sans-serif;font-size: 12px;font-weight: bold;border: thin groove #CC9966;width:auto;background-color: #FFFFCC;padding-left: 5px;padding-top: 5px;padding-bottom: 5px;padding-right: 5px; box-sizing: border-box }
.details{font-family: Arial, Helvetica, sans-serif;font-size: 11px;font-weight: normal;border: thin groove #CC9966;width:100%;padding-left: 5px;padding-top: 5px;padding-bottom: 5px;padding-right: 5px;box-sizing: border-box }
.er {background-color: #FFFFFF;font-family: Courier New, Courier, mono;font-size: 12px; font-weight: normal; border: thin solid #CCCCCC; width:auto; padding-left: 5px;padding-top: 5px;padding-bottom: 5px; padding-right: 5px; box-sizing: border-box }
.dstrmembers {background-color: #FFFDDD;font-family: Courier New, Courier, mono;font-size: 12px;border: thin groove #CC9966;padding-left: 5px;padding-top: 5px;padding-bottom: 5px;padding-right: 5px; box-sizing: border-box }
.disabled {font-family: Courier New, Courier, mono;font-size: 12px;	font-style: italic; color:#CC9933}
.parameters {font-family: Courier New, Courier, mono;font-size: 12px; color:#3333FF}
.comment {font-family: Courier New, Courier, mono;font-size: 12px;	color: #339933}
.subtable {font-family: Arial, Helvetica, sans-serif;font-size: 11px;font-weight: normal;width:100%}
.lineno {color:#6E6E6E;font-family: Courier New, Courier, mono;font-size: 12px; font-weight: normal;}
.iokey {color:#FF6905;font-family: Courier New, Courier, mono;font-size: 12px; font-weight: normal;}
.logicline {color:#000000;font-family: Courier New, Courier, mono;font-size: 12px; font-weight: normal;}
.versionoverride {background-color: #FFCC99;}
.overrideflags{font-family: Arial, Helvetica, sans-serif;font-size: 11px;font-weight: normal;border: thin groove #CC9966;width:auto;padding-left: 5px;padding-top: 5px;padding-bottom: 5px;padding-right: 5px; background-color: #FFCC99; box-sizing: border-box }
.bsfnprops {font-family: Courier New, Courier, mono;font-size: 12px; color:#E01B4C}
.searchresult {font-family: Courier New, Courier, mono;font-size: 12px; font-weight: bold; background-color:#8BF3A0}
.expand {font-family: Courier New, Courier, mono;font-size: 11px; font-weight: bold; cursor:pointer; border: 1px solid gray; position: relative; left: -3px; display:inline; line-height:8px;}
.expand2 { display:inline; cursor:pointer; font-size: 9px; border: 1px solid gray; position: relative; left: -3px;}
</style>
<script type='text/javascript'>function load(){location.href = '#result';}</script>
<script language='JavaScript' type='text/javascript'>function ExpandCollapse(ElementId){ var ClickedElement = document.getElementById(ElementId); var SectionName = ElementId + ':hide'; var Section = document.getElementById(SectionName); if (ClickedElement.innerHTML == '-') { 	 ClickedElement.innerHTML = '+';	Section.style.display = 'none'; }  else  { 		ClickedElement.innerHTML = '-'; 	Section.style.display = 'inline';}} </script>
<base target = "_parent"></head><body onload='load()'>
<div class ='objectheader'>Business Function: B559805T - Rotina de Selecao de Aprovadores<BR>Function Type: NER</div><div class='section'>EVENTS<div class='objectheader'>NER: SelecaoDeAprovador <BR>Event GUID: d5028402-9287-11d2-b1e2-00104b6ecaa6</div><div class='er'><div class='dstrmembers'><B>Data Structure: D559805T - Estrutura de dados para BF de selecao de aprovadores        </B><BR>BF mnAddressNumber [AN8]<BR>BF szCostCenter [MCU]<BR>BF szObjectAccount [OBJ]<BR>BF szSubsidiary [SUB]<BR>BF mnAmountField [AA]<BR>BF szCategoryCodeCostCt002 [RP02]<BR>BF szCategoryCodeCostCt001 [RP01]<BR>BF szCategoryCodeCostCt004 [RP04]<BR>BF szCategoryCodeCostCt005 [RP05]<BR>BF szCategoryCodeCostCt006 [RP06]<BR>BF szGlClass [GLC]<BR>BF cActionCodeYn [ACYN]<BR>BF cTippedEmployee [TIPE]<BR>BF mnSAAddressNumber [SAAN8]<BR>BF szCompanyKey [KCO]<BR>BF szControlDigit [CHKD]<BR></div>----------------------------------------</BR>Event Level Variables</BR>----------------------------------------</BR>evt_CodValor [CHKD]<br>evt_CodValorZero [CHKD]<br>evt_TabCC [MCU]<br>evt_TabCompanhia [CO]<br>evt_TabConta [OBJ]<br>evt_TabDiretoria [RP05]<br>evt_TabEmpregado [AN8]<br>evt_TabGerencia [RP06]<br>evt_TabMidia [RP02]<br>evt_TabRegiao [RP04]<br>evt_TabSubConta [SUB]<br>evt_TabValorAtivo [CHKD]<br>evt_TabValorDespesa [ALCL]<br>evt_TabValorImob [ALTY]<br>evt_TabValorPassivo [ADID]<br>evt_User [CRTU]<br>evt_ValorZero [AA]<br>evt_TipoConta1 [ACT1]<br>evt_TipoConta2 [ACT1]<br>evt_TabValorReceita [ADRC]<br>evt_FlagAlcadaUnica [EV01]<br>evt_FlagValorAlcada [EV01]<br>evt_TempFlagValorAlcada [EV01]<br>evt_FlagAprovaRubricas [EV01]<br>evt_TempFlagAlcadaUnica [EV01]<br>evt_AprovaRubrica [EV01]<br>evt_FlagCC [EV01]<br>evt_FlagCONTA [EV01]<br>evt_FlagSUBCONTA [EV01]<br>evt_FlagGERENCIA [EV01]<br>evt_FlagDIRETORIA [EV01]<br>evt_FlagREGIAO [EV01]<br>evt_FlagCOMPANHIA [EV01]<br>evt_FlagMIDIA [EV01]<br>evt_TabCodValor [CHKD]<br>evt_TabMCU [MCU]<br>evt_TabCO [CO]<br>evt_GenMCU1 [MCU]<br>evt_GenCodVal1 [CHKD]<br>evt_GenAlcUn1 [EV02]<br>evt_GenAlcUn2 [EV02]<br>evt_GenAlcUn3 [EV02]<br>evt_GenCodVal2 [CHKD]<br>evt_GenCodVal3 [CHKD]<br>evt_GenMCU2 [MCU]<br>evt_GenMCU3 [MCU]<br>evt_AN8_Ant [AN8]<br>evt_GenVlrAlc1 [EV01]<br>evt_GenVlrAlc2 [EV01]<br>evt_GenVlrAlc3 [EV01]<br>----------------------------------------</BR><span class='comment'>  // ACTION CODE</span><span class='comment'><br>  // F  -  É A PRIMEIRA LINHA DO DOCUMENTO               (1a. conta)</span><span class='comment'><br>  // O  -  SÃO AS OUTRAS LINHAS DO DOCUMENTO      (demais contas)</span><span class='comment'><br>  // </span><span class='comment'><br>  // Acha o User Atual</span><span class='comment'><br>  // </span><br> <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:7' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>GetAuditInfo(B9800100.GetAuditInfo)<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:7:hide' style='display: inline;'><span class='parameters'><br>       VA evt_User [CRTU] &#60;- szUserName [USER]<br>       UNDEFINED &#60;&#62; jdDate [DTE]<br>       UNDEFINED &#60;&#62; mnTime [TME0]<br>       UNDEFINED &#60;&#62; szWorkstation_UserId [JOBN]</span></div><span class='comment'><br>  // </span><span class='comment'><br>  // Se Conta = &#60;Branco&#62; , então com o GLClass buscar Conta e Detalhe </span><span class='comment'><br>  // </span><br> <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:11' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If BF szObjectAccount [OBJ] is equal to &#60;NULL&#62;<br>  Or BF szObjectAccount [OBJ] is equal to &#60;Blank&#62;<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:11:hide' style='display: inline;'><br>      <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:12' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F4095.Select  [Index 1: Table Number, Company, +]<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:12:hide' style='display: inline;'><br>            <span class='iokey'>BF szGlClass [GLC] = TK Category - G/L [GLPT]</span></div><br>      <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:13' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F4095.FetchNext  [Index 1: Table Number, Company, +]<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:13:hide' style='display: inline;'><br>            BF szObjectAccount [OBJ] &#60;- TK Object Account [OBJ]<br>            BF szSubsidiary [SUB] &#60;- TK Subsidiary [SUB]</div></div><br>  End If<span class='comment'><br>  // </span><span class='comment'><br>  // Determina Tipo de Conta:</span><span class='comment'><br>  // 1      -   Ativo</span><span class='comment'><br>  // 13    -   Imobilizado</span><span class='comment'><br>  // 2      -   Passivo</span><span class='comment'><br>  // 3      -    Despesas</span><span class='comment'><br>  // 4      -   Receitas</span><span class='comment'><br>  // </span><br>  VA evt_TipoConta1 [ACT1] = substr([BF szObjectAccount [OBJ]], "0", "1")<br>  VA evt_TipoConta2 [ACT1] = substr([BF szObjectAccount [OBJ]], "1", "1")<span class='comment'><br>  // </span><span class='comment'><br>  // Acha código de valor para aprovação</span><span class='comment'><br>  // </span><br> <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:28' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5598004.Select  [Index 1: Codigo]<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:28:hide' style='display: inline;'><br>       <span class='iokey'>BF mnAmountField [AA] &#60;= TK Amount [AA]</span></div><br> <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:29' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5598004.FetchNext  [Index 1: Codigo]<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:29:hide' style='display: inline;'><br>       VA evt_CodValor [CHKD] &#60;- TK Bank Account - Control Digit [CHKD]</div><span class='comment'><br>  // </span><span class='comment'><br>  // Acha código de valor para aprovação ZERO</span><span class='comment'><br>  // </span><br>  VA evt_ValorZero [AA] = "0"<br> <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:34' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5598004.Select  [Index 1: Codigo]<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:34:hide' style='display: inline;'><br>       <span class='iokey'>VA evt_ValorZero [AA] = TK Amount [AA]</span></div><br> <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:35' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5598004.FetchNext  [Index 1: Codigo]<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:35:hide' style='display: inline;'><br>       VA evt_CodValorZero [CHKD] &#60;- TK Bank Account - Control Digit [CHKD]</div><br> <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:36' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If SV File_IO_Status is not equal to CO SUCCESS<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:36:hide' style='display: inline;'><span class='comment'><br>       // default do CodValorZero</span><br>       VA evt_CodValorZero [CHKD] = "*"</div><br>  End If<span class='comment'><br>  // </span><span class='comment'><br>  // </span><span class='comment'><br>  // </span><span class='comment'><br>  // Se for a 1a. LINHA DO DOCUMENTO</span><span class='comment'><br>  // </span><br> <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:45' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If BF cActionCodeYn [ACYN] is equal to "F"<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:45:hide' style='display: inline;'><span class='comment'><br>       // </span><span class='comment'><br>       // Variável que indica se o aprovador aprova em todas as rubricas. Para 1a. linh</span><span class='comment'><br>       // do documento ela é "S"</span><br>       VA evt_FlagAprovaRubricas [EV01] = "S"<span class='comment'><br>       // </span><span class='comment'><br>       // Exclui registros da tabela temporária para o usuário atual</span><br>      <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:52' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5598012.Delete  [Index 1: User,AN]<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:52:hide' style='display: inline;'><br>            <span class='iokey'>VA evt_User [CRTU] = TK Created by user [CRTU]</span></div><span class='comment'><br>       // </span><span class='comment'><br>       // LOOP NA TABELA DE RUBRICAS ESPECIAIS        ( F5598005 )</span><span class='comment'><br>       // </span><span class='comment'><br>       // Níveis do Aprovado Genérico</span><span class='comment'><br>       // 1=KCO e MCU informados (mais específico)</span><span class='comment'><br>       // 2=KCO informada e MCU=999</span><span class='comment'><br>       // 3=KCO=00000 e MCU=999 (mais genérico)</span><span class='comment'><br>       // </span><br>       VA evt_AN8_Ant [AN8] = "-1"<br>       VA evt_GenMCU1 [MCU] = &#60;Blank&#62;<br>       VA evt_GenMCU2 [MCU] = &#60;Blank&#62;<br>       VA evt_GenMCU3 [MCU] = &#60;Blank&#62;<br>       VA evt_GenCodVal1 [CHKD] = &#60;Blank&#62;<br>       VA evt_GenCodVal2 [CHKD] = &#60;Blank&#62;<br>       VA evt_GenCodVal3 [CHKD] = &#60;Blank&#62;<br>       VA evt_GenVlrAlc1 [EV01] = &#60;Blank&#62;<br>       VA evt_GenVlrAlc2 [EV01] = &#60;Blank&#62;<br>       VA evt_GenVlrAlc3 [EV01] = &#60;Blank&#62;<br>       VA evt_GenAlcUn1 [EV02] = &#60;Blank&#62;<br>       VA evt_GenAlcUn2 [EV02] = &#60;Blank&#62;<br>       VA evt_GenAlcUn3 [EV02] = &#60;Blank&#62;<span class='comment'><br>       // </span><br>      <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:75' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5598005.Select  [Index 2: OBJ,SUB,AN8,KCO-,MCU-]<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:75:hide' style='display: inline;'><br>            <span class='iokey'>BF szObjectAccount [OBJ] = TK Object Account [OBJ]</span><br>            <span class='iokey'>BF szSubsidiary [SUB] = TK Subsidiary [SUB]</span></div><br>      <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:76' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5598005.FetchNext  [Index 2: OBJ,SUB,AN8,KCO-,MCU-]<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:76:hide' style='display: inline;'><br>            VA evt_TabEmpregado [AN8] &#60;- TK Address Number [AN8]<br>            VA evt_TabCompanhia [CO] &#60;- TK Document Company [KCO]<br>            VA evt_TabCC [MCU] &#60;- TK Business Unit [MCU]<br>            VA evt_TabConta [OBJ] &#60;- TK Object Account [OBJ]<br>            VA evt_TabSubConta [SUB] &#60;- TK Subsidiary [SUB]<br>            VA evt_TabValorAtivo [CHKD] &#60;- TK Bank Account - Control Digit [CHKD]<br>            VA evt_FlagAlcadaUnica [EV01] &#60;- TK J.D. EnterpriseOne Event Point 01 [EV01]</div><br>      <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:77' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>While SV File_IO_Status is equal to CO SUCCESS<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:77:hide' style='display: inline;'><span class='comment'><br>            // </span><br>           <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:79' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_TabEmpregado [AN8] is equal to "0"<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:79:hide' style='display: inline;'><span class='comment'><br>                 // </span><span class='comment'><br>                 // Verifica se aprovador GENÉRICO aprova no CC ...</span><br>                 VA evt_AprovaRubrica [EV01] = "N"<br>                <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:83' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_TabCC [MCU] is equal to BF szCostCenter [MCU]<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:83:hide' style='display: inline;'><br>                      VA evt_AprovaRubrica [EV01] = "S"</div><br>                <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:85' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:85:hide' style='display: inline;'><br>                     <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:86' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_TabCC [MCU] is equal to "         999"<br>                      And VA evt_TabCompanhia [CO] is equal to BF szCompanyKey [KCO]<br>                      Or VA evt_TabCC [MCU] is equal to "         999"<br>                      And VA evt_TabCompanhia [CO] is equal to "00000"<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:86:hide' style='display: inline;'><br>                           VA evt_TabCC [MCU] = "           T"<br>                           VA evt_AprovaRubrica [EV01] = "S"</div><br>                      End If</div><br>                 End If<span class='comment'><br>                 // </span><span class='comment'><br>                 // Verifica nível do aprovador GENÉRICO e guarda dados</span><span class='comment'><br>                 // </span><br>                <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:94' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_AprovaRubrica [EV01] is equal to "S"<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:94:hide' style='display: inline;'><span class='comment'><br>                      // Variável que indica se o aprovador possui alçada de valor para rubricas</span><br>                     <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:96' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_TabValorAtivo [CHKD] is greater than or equal to VA evt_CodValor [CHKD]<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:96:hide' style='display: inline;'><br>                           VA evt_FlagValorAlcada [EV01] = "S"</div><br>                     <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:98' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:98:hide' style='display: inline;'><br>                           VA evt_FlagValorAlcada [EV01] = "N"</div><br>                      End If<br>                     <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:101' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_TabCompanhia [CO] is equal to "00000"<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:101:hide' style='display: inline;'><br>                           VA evt_GenMCU3 [MCU] = VA evt_TabCC [MCU]<br>                           VA evt_GenCodVal3 [CHKD] = VA evt_TabValorAtivo [CHKD]<br>                           VA evt_GenVlrAlc3 [EV01] = VA evt_FlagValorAlcada [EV01]<br>                           VA evt_GenAlcUn3 [EV02] = VA evt_FlagAlcadaUnica [EV01]</div><br>                     <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:106' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:106:hide' style='display: inline;'><br>                          <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:107' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_TabCC [MCU] is equal to "           T"<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:107:hide' style='display: inline;'><br>                                VA evt_GenMCU2 [MCU] = VA evt_TabCC [MCU]<br>                                VA evt_GenCodVal2 [CHKD] = VA evt_TabValorAtivo [CHKD]<br>                                VA evt_GenVlrAlc2 [EV01] = VA evt_FlagValorAlcada [EV01]<br>                                VA evt_GenAlcUn2 [EV02] = VA evt_FlagAlcadaUnica [EV01]</div><br>                          <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:112' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:112:hide' style='display: inline;'><br>                                VA evt_GenMCU1 [MCU] = VA evt_TabCC [MCU]<br>                                VA evt_GenCodVal1 [CHKD] = VA evt_TabValorAtivo [CHKD]<br>                                VA evt_GenVlrAlc1 [EV01] = VA evt_FlagValorAlcada [EV01]<br>                                VA evt_GenAlcUn1 [EV02] = VA evt_FlagAlcadaUnica [EV01]</div><br>                           End If</div><br>                      End If</div><br>                 End If</div><br>           <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:120' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:120:hide' style='display: inline;'><br>                <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:121' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_TabEmpregado [AN8] is not equal to VA evt_AN8_Ant [AN8]<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:121:hide' style='display: inline;'><span class='comment'><br>                      // Verifica se aprovador aprova no CC ...</span><br>                      VA evt_AprovaRubrica [EV01] = "N"<br>                     <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:124' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_TabCC [MCU] is equal to BF szCostCenter [MCU]<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:124:hide' style='display: inline;'><br>                           VA evt_AprovaRubrica [EV01] = "S"</div><br>                     <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:126' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:126:hide' style='display: inline;'><br>                          <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:127' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_TabCC [MCU] is equal to "         999"<br>                           And VA evt_TabCompanhia [CO] is equal to BF szCompanyKey [KCO]<br>                           Or VA evt_TabCC [MCU] is equal to "         999"<br>                           And VA evt_TabCompanhia [CO] is equal to "00000"<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:127:hide' style='display: inline;'><br>                                VA evt_TabCC [MCU] = "           T"<br>                                VA evt_AprovaRubrica [EV01] = "S"</div><br>                           End If</div><br>                      End If<span class='comment'><br>                      // </span><span class='comment'><br>                      // Alimenta dados na tabela temporária</span><span class='comment'><br>                      // </span><br>                     <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:135' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_AprovaRubrica [EV01] is equal to "S"<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:135:hide' style='display: inline;'><br>                           VA evt_AN8_Ant [AN8] = VA evt_TabEmpregado [AN8]<span class='comment'><br>                           // Variável que indica se o aprovador possui alçada de valor para rubricas</span><br>                          <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:138' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_TabValorAtivo [CHKD] is greater than or equal to VA evt_CodValor [CHKD]<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:138:hide' style='display: inline;'><br>                                VA evt_FlagValorAlcada [EV01] = "S"<br>                               <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:140' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5598012.Insert  [Index 1: User,AN]<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:140:hide' style='display: inline;'><br>                                     VA evt_TabEmpregado [AN8] -&#62; TK Address Number [AN8]<br>                                     VA evt_TabCC [MCU] -&#62; TK Business Unit [MCU]<br>                                     VA evt_TabValorAtivo [CHKD] -&#62; TK Bank Account - Control Digit [CHKD]<br>                                     VA evt_FlagValorAlcada [EV01] -&#62; TK J.D. EnterpriseOne Event Point 01 [EV01]<br>                                     VA evt_FlagAlcadaUnica [EV01] -&#62; TK J.D. EnterpriseOne Event Point 02 [EV02]<br>                                     VA evt_FlagAprovaRubricas [EV01] -&#62; TK J.D. EnterpriseOne Point 03 [EV03]<br>                                     VA evt_User [CRTU] -&#62; TK Created by user [CRTU]</div></div><br>                           End If</div><br>                      End If</div><br>                 End If</div><br>            End If<br>           <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:153' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5598005.FetchNext  [Index 2: OBJ,SUB,AN8,KCO-,MCU-]<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:153:hide' style='display: inline;'><br>                 VA evt_TabEmpregado [AN8] &#60;- TK Address Number [AN8]<br>                 VA evt_TabCompanhia [CO] &#60;- TK Document Company [KCO]<br>                 VA evt_TabCC [MCU] &#60;- TK Business Unit [MCU]<br>                 VA evt_TabConta [OBJ] &#60;- TK Object Account [OBJ]<br>                 VA evt_TabSubConta [SUB] &#60;- TK Subsidiary [SUB]<br>                 VA evt_TabValorAtivo [CHKD] &#60;- TK Bank Account - Control Digit [CHKD]<br>                 VA evt_FlagAlcadaUnica [EV01] &#60;- TK J.D. EnterpriseOne Event Point 01 [EV01]</div><span class='comment'><br>            // </span></div><br>       End While<span class='comment'><br>       // </span><span class='comment'><br>       // LOOP NA TABELA DE APROVADORES FIXOS PARA LOCALIZAR APROVADORES COM VALOR ZERO</span><span class='comment'><br>       // Solicitação feita para retirar uma conta específica de algum aprovador da</span><span class='comment'><br>       // tabela de condição de aprovadores</span><br>      <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:160' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5598005.Select  [Index 2: OBJ,SUB,AN8,KCO-,MCU-]<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:160:hide' style='display: inline;'><br>            <span class='iokey'>BF szObjectAccount [OBJ] = TK Object Account [OBJ]</span><br>            <span class='iokey'>BF szSubsidiary [SUB] = TK Subsidiary [SUB]</span><br>            <span class='iokey'>VA evt_CodValorZero [CHKD] = TK Bank Account - Control Digit [CHKD]</span></div><br>      <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:161' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5598005.FetchNext  [Index 2: OBJ,SUB,AN8,KCO-,MCU-]<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:161:hide' style='display: inline;'><br>            VA evt_TabEmpregado [AN8] &#60;- TK Address Number [AN8]<br>            VA evt_TabCompanhia [CO] &#60;- TK Document Company [KCO]<br>            VA evt_TabCC [MCU] &#60;- TK Business Unit [MCU]<br>            VA evt_TabValorAtivo [CHKD] &#60;- TK Bank Account - Control Digit [CHKD]</div><br>      <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:162' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>While SV File_IO_Status is equal to CO SUCCESS<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:162:hide' style='display: inline;'><span class='comment'><br>            // </span><span class='comment'><br>            // Verifica se aprovador aprova no CC ...</span><br>            VA evt_AprovaRubrica [EV01] = "N"<br>           <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:166' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_TabCC [MCU] is equal to BF szCostCenter [MCU]<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:166:hide' style='display: inline;'><br>                 VA evt_AprovaRubrica [EV01] = "S"</div><br>           <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:168' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:168:hide' style='display: inline;'><br>                <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:169' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_TabCC [MCU] is equal to "         999"<br>                 And VA evt_TabCompanhia [CO] is equal to BF szCompanyKey [KCO]<br>                 Or VA evt_TabCC [MCU] is equal to "         999"<br>                 And VA evt_TabCompanhia [CO] is equal to "00000"<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:169:hide' style='display: inline;'><br>                      VA evt_AprovaRubrica [EV01] = "S"</div><br>                 End If</div><br>            End If<span class='comment'><br>            // </span><span class='comment'><br>            // Alimenta dados na tabela temporária</span><span class='comment'><br>            // </span><br>           <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:176' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_AprovaRubrica [EV01] is equal to "S"<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:176:hide' style='display: inline;'><br>                <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:184' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5598012.Insert  [Index 1: User,AN]<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:184:hide' style='display: inline;'><br>                      VA evt_TabEmpregado [AN8] -&#62; TK Address Number [AN8]<br>                      VA evt_TabValorAtivo [CHKD] -&#62; TK Bank Account - Control Digit [CHKD]<br>                      VA evt_User [CRTU] -&#62; TK Created by user [CRTU]</div></div><br>            End If<br>           <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:186' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5598005.FetchNext  [Index 2: OBJ,SUB,AN8,KCO-,MCU-]<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:186:hide' style='display: inline;'><br>                 VA evt_TabEmpregado [AN8] &#60;- TK Address Number [AN8]<br>                 VA evt_TabCompanhia [CO] &#60;- TK Document Company [KCO]<br>                 VA evt_TabCC [MCU] &#60;- TK Business Unit [MCU]<br>                 VA evt_TabValorAtivo [CHKD] &#60;- TK Bank Account - Control Digit [CHKD]</div><span class='comment'><br>            // </span></div><br>       End While<span class='comment'><br>       // </span><span class='comment'><br>       // LOOP NA TABELA DE CONDIÇÕES DE APROVADORES    ( F5598013 )</span><span class='comment'><br>       // </span><br>      <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:192' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5598013.SelectAll<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:192:hide' style='display: inline;'><br>            </div><br>      <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:193' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5598013.FetchNext  [Index 1: Employee, Media, Company ...]<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:193:hide' style='display: inline;'><br>            VA evt_TabEmpregado [AN8] &#60;- TK Address Number [AN8]<br>            VA evt_TabMidia [RP02] &#60;- TK Region [RP02]<br>            VA evt_TabCompanhia [CO] &#60;- TK Company [CO]<br>            VA evt_TabRegiao [RP04] &#60;- TK Branch Office [RP04]<br>            VA evt_TabDiretoria [RP05] &#60;- TK Department Type [RP05]<br>            VA evt_TabGerencia [RP06] &#60;- TK Person Responsible [RP06]<br>            VA evt_TabCC [MCU] &#60;- TK Business Unit [MCU]<br>            VA evt_TabConta [OBJ] &#60;- TK Object Account [OBJ]<br>            VA evt_TabSubConta [SUB] &#60;- TK Subsidiary [SUB]<br>            VA evt_TabValorAtivo [CHKD] &#60;- TK Bank Account - Control Digit [CHKD]<br>            VA evt_TabValorPassivo [ADID] &#60;- TK Address Format ID [ADID]<br>            VA evt_TabValorDespesa [ALCL] &#60;- TK Allocation Level [ALCL]<br>            VA evt_TabValorImob [ALTY] &#60;- TK ID Type [ALTY]<br>            VA evt_TabValorReceita [ADRC] &#60;- TK Adjustment Reason Code [ADRC]<br>            VA evt_FlagAlcadaUnica [EV01] &#60;- TK J.D. EnterpriseOne Event Point 01 [EV01]</div><br>      <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:194' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>While SV File_IO_Status is equal to CO SUCCESS<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:194:hide' style='display: inline;'><span class='comment'><br>            // </span><span class='comment'><br>            // Alimenta dados na tabela temporária</span><span class='comment'><br>            // </span><span class='comment'><br>            // Verifica se o registro da Tabela de Condições de Aprovadores satisfaz as</span><span class='comment'><br>            // condições de CC, Conta, Detalhe, etc</span><span class='comment'><br>            // </span><br>            VA evt_FlagCC [EV01] = "F"<br>            VA evt_FlagCONTA [EV01] = "F"<br>            VA evt_FlagSUBCONTA [EV01] = "F"<br>            VA evt_FlagGERENCIA [EV01] = "F"<br>            VA evt_FlagDIRETORIA [EV01] = "F"<br>            VA evt_FlagREGIAO [EV01] = "F"<br>            VA evt_FlagCOMPANHIA [EV01] = "F"<br>            VA evt_FlagMIDIA [EV01] = "F"<span class='comment'><br>            // </span><br>           <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:210' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_TabCC [MCU] is equal to BF szCostCenter [MCU]<br>            Or VA evt_TabCC [MCU] is equal to "           T"<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:210:hide' style='display: inline;'><br>                 VA evt_FlagCC [EV01] = "T"</div><br>            End If<br>           <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:213' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_TabConta [OBJ] is equal to BF szObjectAccount [OBJ]<br>            Or VA evt_TabConta [OBJ] is equal to "T"<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:213:hide' style='display: inline;'><br>                 VA evt_FlagCONTA [EV01] = "T"</div><br>            End If<br>           <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:216' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_TabSubConta [SUB] is equal to BF szSubsidiary [SUB]<br>            Or VA evt_TabSubConta [SUB] is equal to "T"<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:216:hide' style='display: inline;'><br>                 VA evt_FlagSUBCONTA [EV01] = "T"</div><br>            End If<br>           <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:219' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_TabGerencia [RP06] is equal to BF szCategoryCodeCostCt006 [RP06]<br>            Or VA evt_TabGerencia [RP06] is equal to "T"<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:219:hide' style='display: inline;'><br>                 VA evt_FlagGERENCIA [EV01] = "T"</div><br>            End If<br>           <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:222' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_TabDiretoria [RP05] is equal to BF szCategoryCodeCostCt005 [RP05]<br>            Or VA evt_TabDiretoria [RP05] is equal to "T"<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:222:hide' style='display: inline;'><br>                 VA evt_FlagDIRETORIA [EV01] = "T"</div><br>            End If<br>           <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:225' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_TabRegiao [RP04] is equal to BF szCategoryCodeCostCt004 [RP04]<br>            Or VA evt_TabRegiao [RP04] is equal to "T"<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:225:hide' style='display: inline;'><br>                 VA evt_FlagREGIAO [EV01] = "T"</div><br>            End If<br>           <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:228' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_TabCompanhia [CO] is equal to BF szCompanyKey [KCO]<br>            Or VA evt_TabCompanhia [CO] is equal to "00000"<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:228:hide' style='display: inline;'><br>                 VA evt_FlagCOMPANHIA [EV01] = "T"</div><br>            End If<br>           <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:231' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_TabMidia [RP02] is equal to BF szCategoryCodeCostCt002 [RP02]<br>            Or VA evt_TabMidia [RP02] is equal to "T"<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:231:hide' style='display: inline;'><br>                 VA evt_FlagMIDIA [EV01] = "T"</div><br>            End If<span class='comment'><br>            // </span><br>           <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:235' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_FlagCC [EV01] is equal to "T"<br>            And VA evt_FlagCONTA [EV01] is equal to "T"<br>            And VA evt_FlagSUBCONTA [EV01] is equal to "T"<br>            And VA evt_FlagGERENCIA [EV01] is equal to "T"<br>            And VA evt_FlagDIRETORIA [EV01] is equal to "T"<br>            And VA evt_FlagREGIAO [EV01] is equal to "T"<br>            And VA evt_FlagCOMPANHIA [EV01] is equal to "T"<br>            And VA evt_FlagMIDIA [EV01] is equal to "T"<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:235:hide' style='display: inline;'><span class='comment'><br>                 // </span><span class='comment'><br>                 // Verifica se este aprovador possui Rubrica Especial para esta conta/centro de</span><span class='comment'><br>                 // responsabilidade (específico/default). Se existir, independente do Valor,</span><span class='comment'><br>                 // desconsiderar este Aprovador, logo, só continuar se não existir</span><span class='comment'><br>                 // Obs.: Independe o Valor, porque, por definição, se existir rubrica especial</span><span class='comment'><br>                 // com valor menor, deve restringir, e se a rubrica for maior, é válida e já foi</span><span class='comment'><br>                 // gravada.</span><span class='comment'><br>                 // </span><br>                <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:244' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5598005.Select  [Index 2: OBJ,SUB,AN8,KCO-,MCU-]<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:244:hide' style='display: inline;'><br>                      <span class='iokey'>VA evt_TabEmpregado [AN8] = TK Address Number [AN8]</span><br>                      <span class='iokey'>BF szObjectAccount [OBJ] = TK Object Account [OBJ]</span><br>                      <span class='iokey'>BF szSubsidiary [SUB] = TK Subsidiary [SUB]</span></div><br>                <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:245' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5598005.FetchNext  [Index 2: OBJ,SUB,AN8,KCO-,MCU-]<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:245:hide' style='display: inline;'><br>                      VA evt_TabCO [CO] &#60;- TK Document Company [KCO]<br>                      VA evt_TabMCU [MCU] &#60;- TK Business Unit [MCU]</div><br>                 VA evt_FlagValorAlcada [EV01] = "N"<br>                <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:247' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>While SV File_IO_Status is equal to CO SUCCESS<br>                 And VA evt_FlagValorAlcada [EV01] is not equal to "S"<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:247:hide' style='display: inline;'><br>                     <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:248' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_TabMCU [MCU] is equal to "         999"<br>                      And VA evt_TabCO [CO] is equal to BF szCompanyKey [KCO]<br>                      Or VA evt_TabMCU [MCU] is equal to "         999"<br>                      And VA evt_TabCO [CO] is equal to "00000"<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:248:hide' style='display: inline;'><br>                           VA evt_FlagValorAlcada [EV01] = "S"</div><br>                     <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:250' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:250:hide' style='display: inline;'><br>                          <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:251' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5598005.FetchNext  [Index 2: OBJ,SUB,AN8,KCO-,MCU-]<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:251:hide' style='display: inline;'><br>                                VA evt_TabCO [CO] &#60;- TK Document Company [KCO]<br>                                VA evt_TabMCU [MCU] &#60;- TK Business Unit [MCU]</div></div><br>                      End If</div><br>                 End While<span class='comment'><br>                 // </span><br>                <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:255' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_FlagValorAlcada [EV01] is not equal to "S"<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:255:hide' style='display: inline;'><span class='comment'><br>                      // Este aprovador não tem Rubrica Especial específica para ele</span><span class='comment'><br>                      // </span><span class='comment'><br>                      // Verifica as condições da Rubrica Especial do Aprovador Genérico</span><span class='comment'><br>                      // </span><br>                     <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:260' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_GenVlrAlc1 [EV01] is not equal to &#60;Blank&#62;<br>                      Or VA evt_GenVlrAlc2 [EV01] is not equal to &#60;Blank&#62;<br>                      Or VA evt_GenVlrAlc3 [EV01] is not equal to &#60;Blank&#62;<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:260:hide' style='display: inline;'><span class='comment'><br>                           // Existe rubrica especial pro aprovador genérico, logo, deve gravar ou despreza</span><br>                          <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:262' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_GenVlrAlc1 [EV01] is not equal to &#60;Blank&#62;<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:262:hide' style='display: inline;'><span class='comment'><br>                                // Existe rubrica especial pro aprovador genérico com KCO e MCU específicos</span><br>                               <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:264' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5598012.Insert  [Index 1: User,AN]<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:264:hide' style='display: inline;'><br>                                     VA evt_TabEmpregado [AN8] -&#62; TK Address Number [AN8]<br>                                     VA evt_GenMCU1 [MCU] -&#62; TK Business Unit [MCU]<br>                                     VA evt_GenCodVal1 [CHKD] -&#62; TK Bank Account - Control Digit [CHKD]<br>                                     VA evt_GenVlrAlc1 [EV01] -&#62; TK J.D. EnterpriseOne Event Point 01 [EV01]<br>                                     VA evt_GenAlcUn1 [EV02] -&#62; TK J.D. EnterpriseOne Event Point 02 [EV02]<br>                                     VA evt_FlagAprovaRubricas [EV01] -&#62; TK J.D. EnterpriseOne Point 03 [EV03]<br>                                     VA evt_User [CRTU] -&#62; TK Created by user [CRTU]</div></div><br>                          <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:265' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:265:hide' style='display: inline;'><br>                               <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:266' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_GenVlrAlc2 [EV01] is not equal to &#60;Blank&#62;<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:266:hide' style='display: inline;'><span class='comment'><br>                                     // Existe rubrica especial pro aprovador genérico com KCO especifico e MCU=999</span><br>                                    <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:268' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5598012.Insert  [Index 1: User,AN]<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:268:hide' style='display: inline;'><br>                                          VA evt_TabEmpregado [AN8] -&#62; TK Address Number [AN8]<br>                                          VA evt_GenMCU2 [MCU] -&#62; TK Business Unit [MCU]<br>                                          VA evt_GenCodVal2 [CHKD] -&#62; TK Bank Account - Control Digit [CHKD]<br>                                          VA evt_GenVlrAlc2 [EV01] -&#62; TK J.D. EnterpriseOne Event Point 01 [EV01]<br>                                          VA evt_GenAlcUn2 [EV02] -&#62; TK J.D. EnterpriseOne Event Point 02 [EV02]<br>                                          VA evt_FlagAprovaRubricas [EV01] -&#62; TK J.D. EnterpriseOne Point 03 [EV03]<br>                                          VA evt_User [CRTU] -&#62; TK Created by user [CRTU]</div></div><br>                               <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:269' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:269:hide' style='display: inline;'><br>                                    <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:270' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_GenVlrAlc3 [EV01] is not equal to &#60;Blank&#62;<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:270:hide' style='display: inline;'><span class='comment'><br>                                          // Existe rubrica especial pro aprovador genérico com KCO=00000 e MCU=999</span><br>                                         <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:272' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5598012.Insert  [Index 1: User,AN]<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:272:hide' style='display: inline;'><br>                                               VA evt_TabEmpregado [AN8] -&#62; TK Address Number [AN8]<br>                                               VA evt_GenMCU3 [MCU] -&#62; TK Business Unit [MCU]<br>                                               VA evt_GenCodVal3 [CHKD] -&#62; TK Bank Account - Control Digit [CHKD]<br>                                               VA evt_GenVlrAlc3 [EV01] -&#62; TK J.D. EnterpriseOne Event Point 01 [EV01]<br>                                               VA evt_GenAlcUn3 [EV02] -&#62; TK J.D. EnterpriseOne Event Point 02 [EV02]<br>                                               VA evt_FlagAprovaRubricas [EV01] -&#62; TK J.D. EnterpriseOne Point 03 [EV03]<br>                                               VA evt_User [CRTU] -&#62; TK Created by user [CRTU]</div></div><br>                                     End If</div><br>                                End If</div><br>                           End If</div><br>                     <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:276' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:276:hide' style='display: inline;'><span class='comment'><br>                           // </span><span class='comment'><br>                           // Se já houver registro na Tabela Temporaria para este aprovador, é porque ou é</span><span class='comment'><br>                           // rubrica especial ou rubrica de VALOR ZERO(não aprova na rubrica). Logo, não</span><span class='comment'><br>                           // inclui o registro.</span><span class='comment'><br>                           // </span><span class='comment'><br>                           // Variável que indica se o aprovador possui alcada de valor para rubricas</span><br>                           VA evt_FlagValorAlcada [EV01] = "N"<span class='comment'><br>                           // </span><br>                          <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:285' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5598012.FetchSingle  [Index 1: User,AN]<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:285:hide' style='display: inline;'><br>                                <span class='iokey'>VA evt_TabEmpregado [AN8] = TK Address Number [AN8]</span><br>                                VA evt_TabCodValor [CHKD] &#60;- TK Bank Account - Control Digit [CHKD]<br>                                <span class='iokey'>VA evt_User [CRTU] = TK Created by user [CRTU]</span></div><br>                          <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:286' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If SV File_IO_Status is not equal to CO SUCCESS<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:286:hide' style='display: inline;'><span class='comment'><br>                                // </span><br>                               <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:288' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_TipoConta1 [ACT1] is equal to "1"<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:288:hide' style='display: inline;'><br>                                    <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:289' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_TipoConta2 [ACT1] is equal to "3"<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:289:hide' style='display: inline;'><br>                                         <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:290' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_TabValorImob [ALTY] is not equal to &#60;Blank&#62;<br>                                          And VA evt_TabValorImob [ALTY] is not equal to &#60;NULL&#62;<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:290:hide' style='display: inline;'><br>                                              <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:291' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_TabValorImob [ALTY] is greater than or equal to VA evt_CodValor [CHKD]<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:291:hide' style='display: inline;'><br>                                                    VA evt_FlagValorAlcada [EV01] = "S"</div><br>                                               End If<br>                                              <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:301' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5598012.Insert  [Index 1: User,AN]<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:301:hide' style='display: inline;'><br>                                                    VA evt_TabEmpregado [AN8] -&#62; TK Address Number [AN8]<br>                                                    VA evt_TabCC [MCU] -&#62; TK Business Unit [MCU]<br>                                                    VA evt_TabValorImob [ALTY] -&#62; TK Bank Account - Control Digit [CHKD]<br>                                                    VA evt_FlagValorAlcada [EV01] -&#62; TK J.D. EnterpriseOne Event Point 01 [EV01]<br>                                                    VA evt_FlagAlcadaUnica [EV01] -&#62; TK J.D. EnterpriseOne Event Point 02 [EV02]<br>                                                    VA evt_FlagAprovaRubricas [EV01] -&#62; TK J.D. EnterpriseOne Point 03 [EV03]<br>                                                    VA evt_User [CRTU] -&#62; TK Created by user [CRTU]</div></div><br>                                          End If</div><br>                                    <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:303' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:303:hide' style='display: inline;'><br>                                         <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:304' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_TabValorAtivo [CHKD] is not equal to &#60;Blank&#62;<br>                                          And VA evt_TabValorAtivo [CHKD] is not equal to &#60;NULL&#62;<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:304:hide' style='display: inline;'><br>                                              <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:305' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_TabValorAtivo [CHKD] is greater than or equal to VA evt_CodValor [CHKD]<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:305:hide' style='display: inline;'><br>                                                    VA evt_FlagValorAlcada [EV01] = "S"</div><br>                                               End If<br>                                              <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:315' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5598012.Insert  [Index 1: User,AN]<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:315:hide' style='display: inline;'><br>                                                    VA evt_TabEmpregado [AN8] -&#62; TK Address Number [AN8]<br>                                                    VA evt_TabCC [MCU] -&#62; TK Business Unit [MCU]<br>                                                    VA evt_TabValorAtivo [CHKD] -&#62; TK Bank Account - Control Digit [CHKD]<br>                                                    VA evt_FlagValorAlcada [EV01] -&#62; TK J.D. EnterpriseOne Event Point 01 [EV01]<br>                                                    VA evt_FlagAlcadaUnica [EV01] -&#62; TK J.D. EnterpriseOne Event Point 02 [EV02]<br>                                                    VA evt_FlagAprovaRubricas [EV01] -&#62; TK J.D. EnterpriseOne Point 03 [EV03]<br>                                                    VA evt_User [CRTU] -&#62; TK Created by user [CRTU]</div></div><br>                                          End If</div><br>                                     End If</div><br>                                End If<span class='comment'><br>                                // </span><br>                               <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:320' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_TipoConta1 [ACT1] is equal to "2"<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:320:hide' style='display: inline;'><br>                                    <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:321' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_TabValorPassivo [ADID] is not equal to &#60;Blank&#62;<br>                                     And VA evt_TabValorPassivo [ADID] is not equal to &#60;NULL&#62;<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:321:hide' style='display: inline;'><br>                                         <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:322' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_TabValorPassivo [ADID] is greater than or equal to VA evt_CodValor [CHKD]<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:322:hide' style='display: inline;'><br>                                               VA evt_FlagValorAlcada [EV01] = "S"</div><br>                                          End If<br>                                         <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:332' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5598012.Insert  [Index 1: User,AN]<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:332:hide' style='display: inline;'><br>                                               VA evt_TabEmpregado [AN8] -&#62; TK Address Number [AN8]<br>                                               VA evt_TabCC [MCU] -&#62; TK Business Unit [MCU]<br>                                               VA evt_TabValorPassivo [ADID] -&#62; TK Bank Account - Control Digit [CHKD]<br>                                               VA evt_FlagValorAlcada [EV01] -&#62; TK J.D. EnterpriseOne Event Point 01 [EV01]<br>                                               VA evt_FlagAlcadaUnica [EV01] -&#62; TK J.D. EnterpriseOne Event Point 02 [EV02]<br>                                               VA evt_FlagAprovaRubricas [EV01] -&#62; TK J.D. EnterpriseOne Point 03 [EV03]<br>                                               VA evt_User [CRTU] -&#62; TK Created by user [CRTU]</div></div><br>                                     End If</div><br>                                End If<span class='comment'><br>                                // </span><br>                               <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:336' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_TipoConta1 [ACT1] is equal to ("3","5","6")<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:336:hide' style='display: inline;'><br>                                    <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:337' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_TabValorDespesa [ALCL] is not equal to &#60;Blank&#62;<br>                                     And VA evt_TabValorDespesa [ALCL] is not equal to &#60;NULL&#62;<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:337:hide' style='display: inline;'><br>                                         <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:338' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_TabValorDespesa [ALCL] is greater than or equal to VA evt_CodValor [CHKD]<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:338:hide' style='display: inline;'><br>                                               VA evt_FlagValorAlcada [EV01] = "S"</div><br>                                          End If<br>                                         <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:348' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5598012.Insert  [Index 1: User,AN]<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:348:hide' style='display: inline;'><br>                                               VA evt_TabEmpregado [AN8] -&#62; TK Address Number [AN8]<br>                                               VA evt_TabCC [MCU] -&#62; TK Business Unit [MCU]<br>                                               VA evt_TabValorDespesa [ALCL] -&#62; TK Bank Account - Control Digit [CHKD]<br>                                               VA evt_FlagValorAlcada [EV01] -&#62; TK J.D. EnterpriseOne Event Point 01 [EV01]<br>                                               VA evt_FlagAlcadaUnica [EV01] -&#62; TK J.D. EnterpriseOne Event Point 02 [EV02]<br>                                               VA evt_FlagAprovaRubricas [EV01] -&#62; TK J.D. EnterpriseOne Point 03 [EV03]<br>                                               VA evt_User [CRTU] -&#62; TK Created by user [CRTU]</div></div><br>                                     End If</div><br>                                End If<span class='comment'><br>                                // </span><br>                               <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:352' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_TipoConta1 [ACT1] is equal to "4"<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:352:hide' style='display: inline;'><br>                                    <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:353' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_TabValorReceita [ADRC] is not equal to &#60;Blank&#62;<br>                                     And VA evt_TabValorReceita [ADRC] is not equal to &#60;NULL&#62;<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:353:hide' style='display: inline;'><br>                                         <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:354' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_TabValorReceita [ADRC] is greater than or equal to VA evt_CodValor [CHKD]<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:354:hide' style='display: inline;'><br>                                               VA evt_FlagValorAlcada [EV01] = "S"</div><br>                                          End If<br>                                         <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:364' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5598012.Insert  [Index 1: User,AN]<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:364:hide' style='display: inline;'><br>                                               VA evt_TabEmpregado [AN8] -&#62; TK Address Number [AN8]<br>                                               VA evt_TabCC [MCU] -&#62; TK Business Unit [MCU]<br>                                               VA evt_TabValorReceita [ADRC] -&#62; TK Bank Account - Control Digit [CHKD]<br>                                               VA evt_FlagValorAlcada [EV01] -&#62; TK J.D. EnterpriseOne Event Point 01 [EV01]<br>                                               VA evt_FlagAlcadaUnica [EV01] -&#62; TK J.D. EnterpriseOne Event Point 02 [EV02]<br>                                               VA evt_FlagAprovaRubricas [EV01] -&#62; TK J.D. EnterpriseOne Point 03 [EV03]<br>                                               VA evt_User [CRTU] -&#62; TK Created by user [CRTU]</div></div><br>                                     End If</div><br>                                End If</div><br>                          <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:367' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:367:hide' style='display: inline;'><span class='comment'><br>                                // </span><span class='comment'><br>                                // Se já existe registro para este aprovador, então atualizar campo de código de</span><span class='comment'><br>                                // valor com o maior valor. CUIDADO com VALOR ZERO !!!</span><span class='comment'><br>                                // </span><br>                               <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:372' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_TipoConta1 [ACT1] is equal to "1"<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:372:hide' style='display: inline;'><br>                                    <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:373' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_TipoConta2 [ACT1] is equal to "3"<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:373:hide' style='display: inline;'><br>                                         <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:374' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_TabValorImob [ALTY] is greater than VA evt_TabCodValor [CHKD]<br>                                          And VA evt_TabCodValor [CHKD] is not equal to VA evt_CodValorZero [CHKD]<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:374:hide' style='display: inline;'><br>                                              <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:375' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_TabValorImob [ALTY] is greater than or equal to VA evt_CodValor [CHKD]<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:375:hide' style='display: inline;'><br>                                                    VA evt_FlagValorAlcada [EV01] = "S"</div><br>                                               End If<br>                                              <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:385' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5598012.Update  [Index 1: User,AN]<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:385:hide' style='display: inline;'><br>                                                    <span class='iokey'>VA evt_TabEmpregado [AN8] = TK Address Number [AN8]</span><br>                                                    VA evt_TabValorImob [ALTY] -&#62; TK Bank Account - Control Digit [CHKD]<br>                                                    VA evt_FlagValorAlcada [EV01] -&#62; TK J.D. EnterpriseOne Event Point 01 [EV01]<br>                                                    <span class='iokey'>VA evt_User [CRTU] = TK Created by user [CRTU]</span></div></div><br>                                          End If</div><br>                                    <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:387' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:387:hide' style='display: inline;'><br>                                         <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:388' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_TabValorAtivo [CHKD] is greater than VA evt_TabCodValor [CHKD]<br>                                          And VA evt_TabCodValor [CHKD] is not equal to VA evt_CodValorZero [CHKD]<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:388:hide' style='display: inline;'><br>                                              <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:389' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_TabValorAtivo [CHKD] is greater than or equal to VA evt_CodValor [CHKD]<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:389:hide' style='display: inline;'><br>                                                    VA evt_FlagValorAlcada [EV01] = "S"</div><br>                                               End If<br>                                              <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:399' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5598012.Update  [Index 1: User,AN]<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:399:hide' style='display: inline;'><br>                                                    <span class='iokey'>VA evt_TabEmpregado [AN8] = TK Address Number [AN8]</span><br>                                                    VA evt_TabValorAtivo [CHKD] -&#62; TK Bank Account - Control Digit [CHKD]<br>                                                    VA evt_FlagValorAlcada [EV01] -&#62; TK J.D. EnterpriseOne Event Point 01 [EV01]<br>                                                    <span class='iokey'>VA evt_User [CRTU] = TK Created by user [CRTU]</span></div></div><br>                                          End If</div><br>                                     End If</div><br>                                End If<span class='comment'><br>                                // </span><br>                               <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:404' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_TipoConta1 [ACT1] is equal to "2"<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:404:hide' style='display: inline;'><br>                                    <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:405' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_TabValorPassivo [ADID] is greater than VA evt_TabCodValor [CHKD]<br>                                     And VA evt_TabCodValor [CHKD] is not equal to VA evt_CodValorZero [CHKD]<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:405:hide' style='display: inline;'><br>                                         <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:406' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_TabValorPassivo [ADID] is greater than or equal to VA evt_CodValor [CHKD]<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:406:hide' style='display: inline;'><br>                                               VA evt_FlagValorAlcada [EV01] = "S"</div><br>                                          End If<br>                                         <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:417' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5598012.Update  [Index 1: User,AN]<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:417:hide' style='display: inline;'><br>                                               <span class='iokey'>VA evt_TabEmpregado [AN8] = TK Address Number [AN8]</span><br>                                               VA evt_TabValorPassivo [ADID] -&#62; TK Bank Account - Control Digit [CHKD]<br>                                               VA evt_FlagValorAlcada [EV01] -&#62; TK J.D. EnterpriseOne Event Point 01 [EV01]<br>                                               <span class='iokey'>VA evt_User [CRTU] = TK Created by user [CRTU]</span></div></div><br>                                     End If</div><br>                                End If<span class='comment'><br>                                // </span><br>                               <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:421' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_TipoConta1 [ACT1] is equal to ("3","5","6")<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:421:hide' style='display: inline;'><br>                                    <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:422' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_TabValorDespesa [ALCL] is greater than VA evt_TabCodValor [CHKD]<br>                                     And VA evt_TabCodValor [CHKD] is not equal to VA evt_CodValorZero [CHKD]<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:422:hide' style='display: inline;'><br>                                         <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:423' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_TabValorDespesa [ALCL] is greater than or equal to VA evt_CodValor [CHKD]<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:423:hide' style='display: inline;'><br>                                               VA evt_FlagValorAlcada [EV01] = "S"</div><br>                                          End If<br>                                         <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:433' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5598012.Update  [Index 1: User,AN]<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:433:hide' style='display: inline;'><br>                                               <span class='iokey'>VA evt_TabEmpregado [AN8] = TK Address Number [AN8]</span><br>                                               VA evt_TabValorDespesa [ALCL] -&#62; TK Bank Account - Control Digit [CHKD]<br>                                               VA evt_FlagValorAlcada [EV01] -&#62; TK J.D. EnterpriseOne Event Point 01 [EV01]<br>                                               <span class='iokey'>VA evt_User [CRTU] = TK Created by user [CRTU]</span></div></div><br>                                     End If</div><br>                                End If<span class='comment'><br>                                // </span><br>                               <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:437' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_TipoConta1 [ACT1] is equal to "4"<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:437:hide' style='display: inline;'><br>                                    <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:438' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_TabValorReceita [ADRC] is greater than VA evt_TabCodValor [CHKD]<br>                                     And VA evt_TabCodValor [CHKD] is not equal to VA evt_CodValorZero [CHKD]<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:438:hide' style='display: inline;'><br>                                         <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:439' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_TabValorReceita [ADRC] is greater than or equal to VA evt_CodValor [CHKD]<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:439:hide' style='display: inline;'><br>                                               VA evt_FlagValorAlcada [EV01] = "S"</div><br>                                          End If<br>                                         <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:449' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5598012.Update  [Index 1: User,AN]<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:449:hide' style='display: inline;'><br>                                               <span class='iokey'>VA evt_TabEmpregado [AN8] = TK Address Number [AN8]</span><br>                                               VA evt_TabValorReceita [ADRC] -&#62; TK Bank Account - Control Digit [CHKD]<br>                                               VA evt_FlagValorAlcada [EV01] -&#62; TK J.D. EnterpriseOne Event Point 01 [EV01]<br>                                               <span class='iokey'>VA evt_User [CRTU] = TK Created by user [CRTU]</span></div></div><br>                                     End If</div><br>                                End If</div><br>                           End If</div><br>                      End If</div><br>                 End If</div><br>            End If<br>           <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:456' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5598013.FetchNext  [Index 1: Employee, Media, Company ...]<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:456:hide' style='display: inline;'><br>                 VA evt_TabEmpregado [AN8] &#60;- TK Address Number [AN8]<br>                 VA evt_TabMidia [RP02] &#60;- TK Region [RP02]<br>                 VA evt_TabCompanhia [CO] &#60;- TK Company [CO]<br>                 VA evt_TabRegiao [RP04] &#60;- TK Branch Office [RP04]<br>                 VA evt_TabDiretoria [RP05] &#60;- TK Department Type [RP05]<br>                 VA evt_TabGerencia [RP06] &#60;- TK Person Responsible [RP06]<br>                 VA evt_TabCC [MCU] &#60;- TK Business Unit [MCU]<br>                 VA evt_TabConta [OBJ] &#60;- TK Object Account [OBJ]<br>                 VA evt_TabSubConta [SUB] &#60;- TK Subsidiary [SUB]<br>                 VA evt_TabValorAtivo [CHKD] &#60;- TK Bank Account - Control Digit [CHKD]<br>                 VA evt_TabValorPassivo [ADID] &#60;- TK Address Format ID [ADID]<br>                 VA evt_TabValorDespesa [ALCL] &#60;- TK Allocation Level [ALCL]<br>                 VA evt_TabValorImob [ALTY] &#60;- TK ID Type [ALTY]<br>                 VA evt_TabValorReceita [ADRC] &#60;- TK Adjustment Reason Code [ADRC]<br>                 VA evt_FlagAlcadaUnica [EV01] &#60;- TK J.D. EnterpriseOne Event Point 01 [EV01]</div></div><br>       End While<span class='comment'><br>       // </span><span class='comment'><br>       // RETIRA APROVADOR COM VALOR ZERO</span><br>      <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:460' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5598012.Delete  [Index 1: User,AN]<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:460:hide' style='display: inline;'><br>            <span class='iokey'>VA evt_CodValorZero [CHKD] = TK Bank Account - Control Digit [CHKD]</span><br>            <span class='iokey'>VA evt_User [CRTU] = TK Created by user [CRTU]</span></div><span class='comment'><br>       // </span></div><br>  End If<span class='comment'><br>  // </span><span class='comment'><br>  // </span><span class='comment'><br>  // </span><span class='comment'><br>  // Se for as DEMAIS LINHAS DO DOCUMENTO</span><span class='comment'><br>  // </span><br> <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:468' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If BF cActionCodeYn [ACYN] is equal to "O"<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:468:hide' style='display: inline;'><span class='comment'><br>       // </span><span class='comment'><br>       // Níveis do Aprovado Genérico</span><span class='comment'><br>       // 1=KCO e MCU informados (mais específico)</span><span class='comment'><br>       // 2=KCO informada e MCU=999</span><span class='comment'><br>       // 3=KCO=00000 e MCU=999 (mais genérico)</span><span class='comment'><br>       // </span><br>       VA evt_AN8_Ant [AN8] = "-1"<br>       VA evt_GenMCU1 [MCU] = &#60;Blank&#62;<br>       VA evt_GenMCU2 [MCU] = &#60;Blank&#62;<br>       VA evt_GenMCU3 [MCU] = &#60;Blank&#62;<br>       VA evt_GenCodVal1 [CHKD] = &#60;Blank&#62;<br>       VA evt_GenCodVal2 [CHKD] = &#60;Blank&#62;<br>       VA evt_GenCodVal3 [CHKD] = &#60;Blank&#62;<br>       VA evt_GenVlrAlc1 [EV01] = &#60;Blank&#62;<br>       VA evt_GenVlrAlc2 [EV01] = &#60;Blank&#62;<br>       VA evt_GenVlrAlc3 [EV01] = &#60;Blank&#62;<br>       VA evt_GenAlcUn1 [EV02] = &#60;Blank&#62;<br>       VA evt_GenAlcUn2 [EV02] = &#60;Blank&#62;<br>       VA evt_GenAlcUn3 [EV02] = &#60;Blank&#62;<span class='comment'><br>       // </span><br>      <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:489' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5598005.Select  [Index 2: OBJ,SUB,AN8,KCO-,MCU-]<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:489:hide' style='display: inline;'><br>            <span class='iokey'>VA evt_ValorZero [AA] = TK Address Number [AN8]</span><br>            <span class='iokey'>BF szObjectAccount [OBJ] = TK Object Account [OBJ]</span><br>            <span class='iokey'>BF szSubsidiary [SUB] = TK Subsidiary [SUB]</span></div><br>      <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:490' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5598005.FetchNext  [Index 2: OBJ,SUB,AN8,KCO-,MCU-]<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:490:hide' style='display: inline;'><br>            VA evt_TabCompanhia [CO] &#60;- TK Document Company [KCO]<br>            VA evt_TabCC [MCU] &#60;- TK Business Unit [MCU]<br>            VA evt_TabValorAtivo [CHKD] &#60;- TK Bank Account - Control Digit [CHKD]<br>            VA evt_FlagAlcadaUnica [EV01] &#60;- TK J.D. EnterpriseOne Event Point 01 [EV01]</div><span class='comment'><br>       // </span><br>      <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:492' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>While SV File_IO_Status is equal to CO SUCCESS<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:492:hide' style='display: inline;'><span class='comment'><br>            // </span><span class='comment'><br>            // Verifica se aprovador GENÉRICO aprova no CC ...</span><br>            VA evt_AprovaRubrica [EV01] = "N"<br>           <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:496' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_TabCC [MCU] is equal to BF szCostCenter [MCU]<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:496:hide' style='display: inline;'><br>                 VA evt_AprovaRubrica [EV01] = "S"</div><br>           <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:498' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:498:hide' style='display: inline;'><br>                <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:499' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_TabCC [MCU] is equal to "         999"<br>                 And VA evt_TabCompanhia [CO] is equal to BF szCompanyKey [KCO]<br>                 Or VA evt_TabCC [MCU] is equal to "         999"<br>                 And VA evt_TabCompanhia [CO] is equal to "00000"<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:499:hide' style='display: inline;'><br>                      VA evt_TabCC [MCU] = "           T"<br>                      VA evt_AprovaRubrica [EV01] = "S"</div><br>                 End If</div><br>            End If<span class='comment'><br>            // </span><span class='comment'><br>            // Verifica nível do aprovador GENÉRICO e guarda dados</span><span class='comment'><br>            // </span><br>           <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:507' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_AprovaRubrica [EV01] is equal to "S"<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:507:hide' style='display: inline;'><span class='comment'><br>                 // Variável que indica se o aprovador possui alçada de valor para rubricas</span><br>                <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:509' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_TabValorAtivo [CHKD] is greater than or equal to VA evt_CodValor [CHKD]<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:509:hide' style='display: inline;'><br>                      VA evt_FlagValorAlcada [EV01] = "S"</div><br>                <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:511' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:511:hide' style='display: inline;'><br>                      VA evt_FlagValorAlcada [EV01] = "N"</div><br>                 End If<br>                <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:514' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_TabCompanhia [CO] is equal to "00000"<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:514:hide' style='display: inline;'><br>                      VA evt_GenMCU3 [MCU] = VA evt_TabCC [MCU]<br>                      VA evt_GenCodVal3 [CHKD] = VA evt_TabValorAtivo [CHKD]<br>                      VA evt_GenVlrAlc3 [EV01] = VA evt_FlagValorAlcada [EV01]<br>                      VA evt_GenAlcUn3 [EV02] = VA evt_FlagAlcadaUnica [EV01]</div><br>                <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:519' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:519:hide' style='display: inline;'><br>                     <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:520' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_TabCC [MCU] is equal to "           T"<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:520:hide' style='display: inline;'><br>                           VA evt_GenMCU2 [MCU] = VA evt_TabCC [MCU]<br>                           VA evt_GenCodVal2 [CHKD] = VA evt_TabValorAtivo [CHKD]<br>                           VA evt_GenVlrAlc2 [EV01] = VA evt_FlagValorAlcada [EV01]<br>                           VA evt_GenAlcUn2 [EV02] = VA evt_FlagAlcadaUnica [EV01]</div><br>                     <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:525' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:525:hide' style='display: inline;'><br>                           VA evt_GenMCU1 [MCU] = VA evt_TabCC [MCU]<br>                           VA evt_GenCodVal1 [CHKD] = VA evt_TabValorAtivo [CHKD]<br>                           VA evt_GenVlrAlc1 [EV01] = VA evt_FlagValorAlcada [EV01]<br>                           VA evt_GenAlcUn1 [EV02] = VA evt_FlagAlcadaUnica [EV01]</div><br>                      End If</div><br>                 End If</div><br>            End If<br>           <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:533' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5598005.FetchNext  [Index 2: OBJ,SUB,AN8,KCO-,MCU-]<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:533:hide' style='display: inline;'><br>                 VA evt_TabCompanhia [CO] &#60;- TK Document Company [KCO]<br>                 VA evt_TabCC [MCU] &#60;- TK Business Unit [MCU]<br>                 VA evt_TabValorAtivo [CHKD] &#60;- TK Bank Account - Control Digit [CHKD]<br>                 VA evt_FlagAlcadaUnica [EV01] &#60;- TK J.D. EnterpriseOne Event Point 01 [EV01]</div></div><br>       End While<span class='comment'><br>       // </span><span class='comment'><br>       // LOOP NA TABELA TEMPORÁRIA PARA VERIFICAR SE CADA UM DOS APROVADORES  VÁLIDOS</span><span class='comment'><br>       // PARA A 1a. CONTA CONTINUA APROVANDO</span><span class='comment'><br>       // </span><br>      <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:539' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5598012.Select  [Index 1: User,AN]<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:539:hide' style='display: inline;'><br>            <span class='iokey'>VA evt_User [CRTU] = TK Created by user [CRTU]</span></div><br>      <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:540' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5598012.FetchNext  [Index 1: User,AN]<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:540:hide' style='display: inline;'><br>            VA evt_TabEmpregado [AN8] &#60;- TK Address Number [AN8]<br>            VA evt_TempFlagValorAlcada [EV01] &#60;- TK J.D. EnterpriseOne Event Point 01 [EV01]<br>            VA evt_TempFlagAlcadaUnica [EV01] &#60;- TK J.D. EnterpriseOne Event Point 02 [EV02]</div><br>      <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:541' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>While SV File_IO_Status is equal to CO SUCCESS<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:541:hide' style='display: inline;'><span class='comment'><br>            // </span><span class='comment'><br>            // Variável que indica se o aprovador aprova na rubrica</span><br>            VA evt_AprovaRubrica [EV01] = "N"<span class='comment'><br>            // </span><span class='comment'><br>            // Se Aprovador possui rubrica especial com VALOR ZERO, ele não pode aprovar</span><span class='comment'><br>            // </span><br>           <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:548' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5598005.Select  [Index 2: OBJ,SUB,AN8,KCO-,MCU-]<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:548:hide' style='display: inline;'><br>                 <span class='iokey'>VA evt_TabEmpregado [AN8] = TK Address Number [AN8]</span><br>                 <span class='iokey'>BF szObjectAccount [OBJ] = TK Object Account [OBJ]</span><br>                 <span class='iokey'>BF szSubsidiary [SUB] = TK Subsidiary [SUB]</span><br>                 <span class='iokey'>VA evt_CodValorZero [CHKD] = TK Bank Account - Control Digit [CHKD]</span></div><br>           <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:549' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5598005.FetchNext  [Index 2: OBJ,SUB,AN8,KCO-,MCU-]<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:549:hide' style='display: inline;'><br>                 VA evt_TabCompanhia [CO] &#60;- TK Document Company [KCO]<br>                 VA evt_TabCC [MCU] &#60;- TK Business Unit [MCU]<br>                 VA evt_FlagAlcadaUnica [EV01] &#60;- TK J.D. EnterpriseOne Event Point 01 [EV01]</div><br>           <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:550' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>While SV File_IO_Status is equal to CO SUCCESS<br>            And VA evt_AprovaRubrica [EV01] is not equal to "Z"<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:550:hide' style='display: inline;'><span class='comment'><br>                 // Verifica se aprovador aprova no CC ...</span><br>                <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:552' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_TabCC [MCU] is equal to BF szCostCenter [MCU]<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:552:hide' style='display: inline;'><br>                      VA evt_AprovaRubrica [EV01] = "Z"</div><br>                <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:554' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:554:hide' style='display: inline;'><br>                     <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:555' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_TabCC [MCU] is equal to "         999"<br>                      And VA evt_TabCompanhia [CO] is equal to BF szCompanyKey [KCO]<br>                      Or VA evt_TabCC [MCU] is equal to "         999"<br>                      And VA evt_TabCompanhia [CO] is equal to "00000"<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:555:hide' style='display: inline;'><br>                           VA evt_AprovaRubrica [EV01] = "Z"</div><br>                     <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:557' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:557:hide' style='display: inline;'><br>                          <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:558' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5598005.FetchNext  [Index 2: OBJ,SUB,AN8,KCO-,MCU-]<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:558:hide' style='display: inline;'><br>                                VA evt_TabCompanhia [CO] &#60;- TK Document Company [KCO]<br>                                VA evt_TabCC [MCU] &#60;- TK Business Unit [MCU]<br>                                VA evt_FlagAlcadaUnica [EV01] &#60;- TK J.D. EnterpriseOne Event Point 01 [EV01]</div></div><br>                      End If</div><br>                 End If</div><br>            End While<span class='comment'><br>            // </span><br>           <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:563' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_AprovaRubrica [EV01] is equal to "N"<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:563:hide' style='display: inline;'><span class='comment'><br>                 // </span><span class='comment'><br>                 // Se Aprovador possui rubrica especial para esta conta, então continua aprovand</span><span class='comment'><br>                 // </span><br>                <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:567' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5598005.Select  [Index 2: OBJ,SUB,AN8,KCO-,MCU-]<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:567:hide' style='display: inline;'><br>                      <span class='iokey'>VA evt_TabEmpregado [AN8] = TK Address Number [AN8]</span><br>                      <span class='iokey'>BF szObjectAccount [OBJ] = TK Object Account [OBJ]</span><br>                      <span class='iokey'>BF szSubsidiary [SUB] = TK Subsidiary [SUB]</span></div><br>                <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:568' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5598005.FetchNext  [Index 2: OBJ,SUB,AN8,KCO-,MCU-]<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:568:hide' style='display: inline;'><br>                      VA evt_TabEmpregado [AN8] &#60;- TK Address Number [AN8]<br>                      VA evt_TabCompanhia [CO] &#60;- TK Document Company [KCO]<br>                      VA evt_TabCC [MCU] &#60;- TK Business Unit [MCU]<br>                      VA evt_TabConta [OBJ] &#60;- TK Object Account [OBJ]<br>                      VA evt_TabSubConta [SUB] &#60;- TK Subsidiary [SUB]<br>                      VA evt_TabValorAtivo [CHKD] &#60;- TK Bank Account - Control Digit [CHKD]<br>                      VA evt_FlagAlcadaUnica [EV01] &#60;- TK J.D. EnterpriseOne Event Point 01 [EV01]</div><br>                <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:569' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>While SV File_IO_Status is equal to CO SUCCESS<br>                 And VA evt_AprovaRubrica [EV01] is not equal to("S","Z")<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:569:hide' style='display: inline;'><span class='comment'><br>                      // Verifica se aprovador aprova no CC ...</span><br>                     <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:571' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_TabCC [MCU] is equal to BF szCostCenter [MCU]<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:571:hide' style='display: inline;'><br>                           VA evt_AprovaRubrica [EV01] = "S"</div><br>                     <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:573' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:573:hide' style='display: inline;'><br>                          <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:574' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_TabCC [MCU] is equal to "         999"<br>                           And VA evt_TabCompanhia [CO] is equal to BF szCompanyKey [KCO]<br>                           Or VA evt_TabCC [MCU] is equal to "         999"<br>                           And VA evt_TabCompanhia [CO] is equal to "00000"<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:574:hide' style='display: inline;'><br>                                VA evt_AprovaRubrica [EV01] = "S"</div><br>                           End If</div><br>                      End If<br>                     <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:578' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_AprovaRubrica [EV01] is equal to "S"<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:578:hide' style='display: inline;'><span class='comment'><br>                           // Se não possui alçada de valor para esta rubrica, trocar flag de valor de</span><span class='comment'><br>                           // alçada na tabela para N</span><br>                          <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:581' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_TabValorAtivo [CHKD] is less than VA evt_CodValor [CHKD]<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:581:hide' style='display: inline;'><br>                                VA evt_TempFlagValorAlcada [EV01] = "N"<br>                                VA evt_AprovaRubrica [EV01] = "Z"</div><br>                           End If<span class='comment'><br>                           // Se não aprova sozinho, troca flag de alçada única para N</span><br>                          <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:586' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_FlagAlcadaUnica [EV01] is equal to "N"<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:586:hide' style='display: inline;'><br>                                VA evt_TempFlagAlcadaUnica [EV01] = "N"</div><br>                           End If<br>                          <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:596' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5598012.Update  [Index 1: User,AN]<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:596:hide' style='display: inline;'><br>                                <span class='iokey'>VA evt_TabEmpregado [AN8] = TK Address Number [AN8]</span><br>                                VA evt_TempFlagValorAlcada [EV01] -&#62; TK J.D. EnterpriseOne Event Point 01 [EV01]<br>                                VA evt_TempFlagAlcadaUnica [EV01] -&#62; TK J.D. EnterpriseOne Event Point 02 [EV02]<br>                                <span class='iokey'>VA evt_User [CRTU] = TK Created by user [CRTU]</span></div></div><br>                     <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:597' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:597:hide' style='display: inline;'><br>                          <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:598' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5598005.FetchNext  [Index 2: OBJ,SUB,AN8,KCO-,MCU-]<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:598:hide' style='display: inline;'><br>                                VA evt_TabEmpregado [AN8] &#60;- TK Address Number [AN8]<br>                                VA evt_TabCompanhia [CO] &#60;- TK Document Company [KCO]<br>                                VA evt_TabCC [MCU] &#60;- TK Business Unit [MCU]<br>                                VA evt_TabConta [OBJ] &#60;- TK Object Account [OBJ]<br>                                VA evt_TabSubConta [SUB] &#60;- TK Subsidiary [SUB]<br>                                VA evt_TabValorAtivo [CHKD] &#60;- TK Bank Account - Control Digit [CHKD]<br>                                VA evt_FlagAlcadaUnica [EV01] &#60;- TK J.D. EnterpriseOne Event Point 01 [EV01]</div></div><br>                      End If</div><br>                 End While<span class='comment'><br>                 // </span><br>                <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:602' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_AprovaRubrica [EV01] is equal to "N"<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:602:hide' style='display: inline;'><span class='comment'><br>                      // </span><span class='comment'><br>                      // Verifica Rubrica Especial para Aprovador Genérico</span><span class='comment'><br>                      // </span><span class='comment'><br>                      // Se Aprovador Genérico possui rubrica especial para esta conta, então ele</span><span class='comment'><br>                      // continua aprovando</span><br>                     <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:608' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_GenVlrAlc1 [EV01] is not equal to &#60;Blank&#62;<br>                      Or VA evt_GenVlrAlc2 [EV01] is not equal to &#60;Blank&#62;<br>                      Or VA evt_GenVlrAlc3 [EV01] is not equal to &#60;Blank&#62;<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:608:hide' style='display: inline;'><span class='comment'><br>                           // Existe rubrica especial pro aprovador genérico, logo, deve gravar ou despreza</span><br>                          <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:610' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_GenVlrAlc1 [EV01] is equal to "N"<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:610:hide' style='display: inline;'><span class='comment'><br>                                // Existe rubrica especial pro aprovador genérico com restrição de valor</span><br>                                VA evt_AprovaRubrica [EV01] = "Z"</div><br>                          <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:613' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:613:hide' style='display: inline;'><br>                               <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:614' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_GenVlrAlc1 [EV01] is equal to "S"<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:614:hide' style='display: inline;'><span class='comment'><br>                                     // Existe rubrica especial pro aprovador genérico com alçada de valor</span><br>                                     VA evt_AprovaRubrica [EV01] = "S"</div><br>                               <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:617' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:617:hide' style='display: inline;'><br>                                    <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:618' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_GenVlrAlc2 [EV01] is equal to "N"<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:618:hide' style='display: inline;'><span class='comment'><br>                                          // Existe rubrica especial pro aprovador genérico com restrição de valor</span><br>                                          VA evt_AprovaRubrica [EV01] = "Z"</div><br>                                    <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:621' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:621:hide' style='display: inline;'><br>                                         <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:622' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_GenVlrAlc2 [EV01] is equal to "S"<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:622:hide' style='display: inline;'><span class='comment'><br>                                               // Existe rubrica especial pro aprovador genérico com alçada de valor</span><br>                                               VA evt_AprovaRubrica [EV01] = "S"</div><br>                                         <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:625' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:625:hide' style='display: inline;'><br>                                              <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:626' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_GenVlrAlc3 [EV01] is equal to "N"<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:626:hide' style='display: inline;'><span class='comment'><br>                                                    // Existe rubrica especial pro aprovador genérico com restrição de valor</span><br>                                                    VA evt_AprovaRubrica [EV01] = "Z"</div><br>                                              <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:629' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:629:hide' style='display: inline;'><br>                                                   <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:630' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_GenVlrAlc3 [EV01] is equal to "S"<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:630:hide' style='display: inline;'><span class='comment'><br>                                                         // Existe rubrica especial pro aprovador genérico com alçada de valor</span><br>                                                         VA evt_AprovaRubrica [EV01] = "S"</div><br>                                                   <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:633' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:633:hide' style='display: inline;'><span class='comment'><br>                                                         // Existe rubrica especial pro aprovador genérico com restrição de valor</span><br>                                                         VA evt_AprovaRubrica [EV01] = "Z"</div><br>                                                    End If</div><br>                                               End If</div><br>                                          End If</div><br>                                     End If</div><br>                                End If</div><br>                           End If<br>                          <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:642' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_TempFlagAlcadaUnica [EV01] is not equal to VA evt_GenAlcUn1 [EV02]<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:642:hide' style='display: inline;'><br>                               <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:643' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5598012.Update  [Index 1: User,AN]<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:643:hide' style='display: inline;'><br>                                     <span class='iokey'>VA evt_TabEmpregado [AN8] = TK Address Number [AN8]</span><br>                                     VA evt_GenAlcUn1 [EV02] -&#62; TK J.D. EnterpriseOne Event Point 02 [EV02]<br>                                     <span class='iokey'>VA evt_User [CRTU] = TK Created by user [CRTU]</span></div></div><br>                           End If</div><br>                      End If</div><br>                 End If</div><br>            End If<span class='comment'><br>            // </span><span class='comment'><br>            // Se não possui rubrica especial, nem rubrica de VALOR ZERO, então verificar a</span><span class='comment'><br>            // Tabela de Condições de Aprovadores para o aprovador em questão</span><span class='comment'><br>            // </span><br>           <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:652' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_AprovaRubrica [EV01] is equal to "N"<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:652:hide' style='display: inline;'><span class='comment'><br>                 // </span><br>                <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:654' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5598013.Select  [Index 1: Employee, Media, Company ...]<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:654:hide' style='display: inline;'><br>                      <span class='iokey'>VA evt_TabEmpregado [AN8] = TK Address Number [AN8]</span></div><br>                <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:655' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5598013.FetchNext  [Index 1: Employee, Media, Company ...]<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:655:hide' style='display: inline;'><br>                      VA evt_TabMidia [RP02] &#60;- TK Region [RP02]<br>                      VA evt_TabCompanhia [CO] &#60;- TK Company [CO]<br>                      VA evt_TabRegiao [RP04] &#60;- TK Branch Office [RP04]<br>                      VA evt_TabDiretoria [RP05] &#60;- TK Department Type [RP05]<br>                      VA evt_TabGerencia [RP06] &#60;- TK Person Responsible [RP06]<br>                      VA evt_TabCC [MCU] &#60;- TK Business Unit [MCU]<br>                      VA evt_TabConta [OBJ] &#60;- TK Object Account [OBJ]<br>                      VA evt_TabSubConta [SUB] &#60;- TK Subsidiary [SUB]<br>                      VA evt_TabValorAtivo [CHKD] &#60;- TK Bank Account - Control Digit [CHKD]<br>                      VA evt_TabValorPassivo [ADID] &#60;- TK Address Format ID [ADID]<br>                      VA evt_TabValorDespesa [ALCL] &#60;- TK Allocation Level [ALCL]<br>                      VA evt_TabValorImob [ALTY] &#60;- TK ID Type [ALTY]<br>                      VA evt_TabValorReceita [ADRC] &#60;- TK Adjustment Reason Code [ADRC]<br>                      VA evt_FlagAlcadaUnica [EV01] &#60;- TK J.D. EnterpriseOne Event Point 01 [EV01]</div><br>                <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:656' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>While SV File_IO_Status is equal to CO SUCCESS<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:656:hide' style='display: inline;'><span class='comment'><br>                      // </span><br>                      VA evt_FlagCC [EV01] = "F"<br>                      VA evt_FlagCONTA [EV01] = "F"<br>                      VA evt_FlagSUBCONTA [EV01] = "F"<br>                      VA evt_FlagGERENCIA [EV01] = "F"<br>                      VA evt_FlagDIRETORIA [EV01] = "F"<br>                      VA evt_FlagREGIAO [EV01] = "F"<br>                      VA evt_FlagCOMPANHIA [EV01] = "F"<br>                      VA evt_FlagMIDIA [EV01] = "F"<span class='comment'><br>                      // </span><br>                     <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:667' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_TabCC [MCU] is equal to BF szCostCenter [MCU]<br>                      Or VA evt_TabCC [MCU] is equal to "           T"<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:667:hide' style='display: inline;'><br>                           VA evt_FlagCC [EV01] = "T"</div><br>                      End If<br>                     <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:670' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_TabConta [OBJ] is equal to BF szObjectAccount [OBJ]<br>                      Or VA evt_TabConta [OBJ] is equal to "T"<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:670:hide' style='display: inline;'><br>                           VA evt_FlagCONTA [EV01] = "T"</div><br>                      End If<br>                     <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:673' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_TabSubConta [SUB] is equal to BF szSubsidiary [SUB]<br>                      Or VA evt_TabSubConta [SUB] is equal to "T"<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:673:hide' style='display: inline;'><br>                           VA evt_FlagSUBCONTA [EV01] = "T"</div><br>                      End If<br>                     <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:676' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_TabGerencia [RP06] is equal to BF szCategoryCodeCostCt006 [RP06]<br>                      Or VA evt_TabGerencia [RP06] is equal to "T"<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:676:hide' style='display: inline;'><br>                           VA evt_FlagGERENCIA [EV01] = "T"</div><br>                      End If<br>                     <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:679' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_TabDiretoria [RP05] is equal to BF szCategoryCodeCostCt005 [RP05]<br>                      Or VA evt_TabDiretoria [RP05] is equal to "T"<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:679:hide' style='display: inline;'><br>                           VA evt_FlagDIRETORIA [EV01] = "T"</div><br>                      End If<br>                     <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:682' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_TabRegiao [RP04] is equal to BF szCategoryCodeCostCt004 [RP04]<br>                      Or VA evt_TabRegiao [RP04] is equal to "T"<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:682:hide' style='display: inline;'><br>                           VA evt_FlagREGIAO [EV01] = "T"</div><br>                      End If<br>                     <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:685' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_TabCompanhia [CO] is equal to BF szCompanyKey [KCO]<br>                      Or VA evt_TabCompanhia [CO] is equal to "00000"<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:685:hide' style='display: inline;'><br>                           VA evt_FlagCOMPANHIA [EV01] = "T"</div><br>                      End If<br>                     <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:688' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_TabMidia [RP02] is equal to BF szCategoryCodeCostCt002 [RP02]<br>                      Or VA evt_TabMidia [RP02] is equal to "T"<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:688:hide' style='display: inline;'><br>                           VA evt_FlagMIDIA [EV01] = "T"</div><br>                      End If<span class='comment'><br>                      // </span><br>                     <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:692' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_FlagCC [EV01] is equal to "T"<br>                      And VA evt_FlagCONTA [EV01] is equal to "T"<br>                      And VA evt_FlagSUBCONTA [EV01] is equal to "T"<br>                      And VA evt_FlagGERENCIA [EV01] is equal to "T"<br>                      And VA evt_FlagDIRETORIA [EV01] is equal to "T"<br>                      And VA evt_FlagREGIAO [EV01] is equal to "T"<br>                      And VA evt_FlagCOMPANHIA [EV01] is equal to "T"<br>                      And VA evt_FlagMIDIA [EV01] is equal to "T"<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:692:hide' style='display: inline;'><br>                           VA evt_AprovaRubrica [EV01] = "S"<span class='comment'><br>                           // Atualiza flag de Alcada Unica</span><br>                          <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:695' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_FlagAlcadaUnica [EV01] is equal to "N"<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:695:hide' style='display: inline;'><br>                                VA evt_TempFlagAlcadaUnica [EV01] = "N"</div><br>                           End If<span class='comment'><br>                           // </span><br>                          <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:699' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_TipoConta1 [ACT1] is equal to "1"<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:699:hide' style='display: inline;'><br>                               <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:700' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_TipoConta2 [ACT1] is equal to "3"<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:700:hide' style='display: inline;'><br>                                    <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:701' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_TabValorImob [ALTY] is less than VA evt_CodValor [CHKD]<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:701:hide' style='display: inline;'><br>                                          VA evt_TempFlagValorAlcada [EV01] = "N"</div><br>                                     End If</div><br>                               <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:704' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:704:hide' style='display: inline;'><br>                                    <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:705' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_TabValorAtivo [CHKD] is less than VA evt_CodValor [CHKD]<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:705:hide' style='display: inline;'><br>                                          VA evt_TempFlagValorAlcada [EV01] = "N"</div><br>                                     End If</div><br>                                End If</div><br>                           End If<span class='comment'><br>                           // </span><br>                          <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:711' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_TipoConta1 [ACT1] is equal to "2"<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:711:hide' style='display: inline;'><br>                               <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:712' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_TabValorPassivo [ADID] is less than VA evt_CodValor [CHKD]<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:712:hide' style='display: inline;'><br>                                     VA evt_TempFlagValorAlcada [EV01] = "N"</div><br>                                End If</div><br>                           End If<span class='comment'><br>                           // </span><br>                          <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:717' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_TipoConta1 [ACT1] is equal to ("3","5","6")<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:717:hide' style='display: inline;'><br>                               <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:718' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_TabValorDespesa [ALCL] is less than VA evt_CodValor [CHKD]<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:718:hide' style='display: inline;'><br>                                     VA evt_TempFlagValorAlcada [EV01] = "N"</div><br>                                End If</div><br>                           End If<span class='comment'><br>                           // </span><br>                          <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:723' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_TipoConta1 [ACT1] is equal to "4"<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:723:hide' style='display: inline;'><br>                               <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:724' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_TabValorReceita [ADRC] is less than VA evt_CodValor [CHKD]<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:724:hide' style='display: inline;'><br>                                     VA evt_TempFlagValorAlcada [EV01] = "N"</div><br>                                End If</div><br>                           End If<br>                          <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:735' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5598012.Update  [Index 1: User,AN]<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:735:hide' style='display: inline;'><br>                                <span class='iokey'>VA evt_TabEmpregado [AN8] = TK Address Number [AN8]</span><br>                                VA evt_TempFlagValorAlcada [EV01] -&#62; TK J.D. EnterpriseOne Event Point 01 [EV01]<br>                                VA evt_TempFlagAlcadaUnica [EV01] -&#62; TK J.D. EnterpriseOne Event Point 02 [EV02]<br>                                <span class='iokey'>VA evt_User [CRTU] = TK Created by user [CRTU]</span></div></div><br>                      End If<br>                     <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:737' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5598013.FetchNext  [Index 1: Employee, Media, Company ...]<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:737:hide' style='display: inline;'><br>                           VA evt_TabMidia [RP02] &#60;- TK Region [RP02]<br>                           VA evt_TabCompanhia [CO] &#60;- TK Company [CO]<br>                           VA evt_TabRegiao [RP04] &#60;- TK Branch Office [RP04]<br>                           VA evt_TabDiretoria [RP05] &#60;- TK Department Type [RP05]<br>                           VA evt_TabGerencia [RP06] &#60;- TK Person Responsible [RP06]<br>                           VA evt_TabCC [MCU] &#60;- TK Business Unit [MCU]<br>                           VA evt_TabConta [OBJ] &#60;- TK Object Account [OBJ]<br>                           VA evt_TabSubConta [SUB] &#60;- TK Subsidiary [SUB]<br>                           VA evt_TabValorAtivo [CHKD] &#60;- TK Bank Account - Control Digit [CHKD]<br>                           VA evt_TabValorPassivo [ADID] &#60;- TK Address Format ID [ADID]<br>                           VA evt_TabValorDespesa [ALCL] &#60;- TK Allocation Level [ALCL]<br>                           VA evt_TabValorImob [ALTY] &#60;- TK ID Type [ALTY]<br>                           VA evt_TabValorReceita [ADRC] &#60;- TK Adjustment Reason Code [ADRC]<br>                           VA evt_FlagAlcadaUnica [EV01] &#60;- TK J.D. EnterpriseOne Event Point 01 [EV01]</div></div><br>                 End While</div><br>            End If<br>           <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:740' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_AprovaRubrica [EV01] is not equal to "S"<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:740:hide' style='display: inline;'><br>                 VA evt_AprovaRubrica [EV01] = "N"<br>                <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:749' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5598012.Update  [Index 1: User,AN]<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:749:hide' style='display: inline;'><br>                      <span class='iokey'>VA evt_TabEmpregado [AN8] = TK Address Number [AN8]</span><br>                      VA evt_AprovaRubrica [EV01] -&#62; TK J.D. EnterpriseOne Point 03 [EV03]<br>                      <span class='iokey'>VA evt_User [CRTU] = TK Created by user [CRTU]</span></div></div><br>            End If<br>           <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:751' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5598012.FetchNext  [Index 1: User,AN]<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:751:hide' style='display: inline;'><br>                 VA evt_TabEmpregado [AN8] &#60;- TK Address Number [AN8]<br>                 VA evt_TempFlagValorAlcada [EV01] &#60;- TK J.D. EnterpriseOne Event Point 01 [EV01]<br>                 VA evt_TempFlagAlcadaUnica [EV01] &#60;- TK J.D. EnterpriseOne Event Point 02 [EV02]</div></div><br>       End While<span class='comment'><br>       // </span><span class='comment'><br>       // Excluir da Tabela Temporária aqueles aprovadores que não aprovam na rubrica</span><br>       VA evt_AprovaRubrica [EV01] = "N"<br>      <div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:756' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5598012.Delete  [Index 1: User,AN]<div id='d5028402-9287-11d2-b1e2-00104b6ecaa6:756:hide' style='display: inline;'><br>            <span class='iokey'>VA evt_AprovaRubrica [EV01] = TK J.D. EnterpriseOne Point 03 [EV03]</span><br>            <span class='iokey'>VA evt_User [CRTU] = TK Created by user [CRTU]</span></div></div><br>  End If</div></div></body></html>