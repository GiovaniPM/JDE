<!DOCTYPE html><html lang = "en"><head><meta charset = "utf-8"><meta name = "viewport" content = "width=device-width, initial-scale=1"><title>JDE Object Browser HTML Extract</title>
<style type='text/css'>body,th{font-family: Courier New, Courier, mono;font-size: 12px; width:auto}
.section{font-family: Arial, Helvetica, sans-serif;font-size: 12px;font-weight: bold;border: thin groove #CC9966;width: 100%;padding-left: 5px;padding-top: 5px;padding-bottom: 5px; padding-right: 5px; box-sizing: border-box }
.objectheader {font-family: Arial, Helvetica, sans-serif;font-size: 12px;font-weight: bold;border: thin groove #CC9966;width:auto;background-color: #FFFFCC;padding-left: 5px;padding-top: 5px;padding-bottom: 5px;padding-right: 5px; box-sizing: border-box }
.details{font-family: Arial, Helvetica, sans-serif;font-size: 11px;font-weight: normal;border: thin groove #CC9966;width:100%;padding-left: 5px;padding-top: 5px;padding-bottom: 5px;padding-right: 5px;box-sizing: border-box }
.er {background-color: #FFFFFF;font-family: Courier New, Courier, mono;font-size: 12px; font-weight: normal; border: thin solid #CCCCCC; width:auto; padding-left: 5px;padding-top: 5px;padding-bottom: 5px; padding-right: 5px; box-sizing: border-box }
.dstrmembers {background-color: #FFFDDD;font-family: Courier New, Courier, mono;font-size: 12px;border: thin groove #CC9966;padding-left: 5px;padding-top: 5px;padding-bottom: 5px;padding-right: 5px; box-sizing: border-box }
.disabled {font-family: Courier New, Courier, mono;font-size: 12px;	font-style: italic; color:#CC9933}
.parameters {font-family: Courier New, Courier, mono;font-size: 12px; color:#3333FF}
.comment {font-family: Courier New, Courier, mono;font-size: 12px;	color: #339933}
.subtable {font-family: Arial, Helvetica, sans-serif;font-size: 11px;font-weight: normal;width:100%}
.lineno {color:#6E6E6E;font-family: Courier New, Courier, mono;font-size: 12px; font-weight: normal;}
.iokey {color:#FF6905;font-family: Courier New, Courier, mono;font-size: 12px; font-weight: normal;}
.logicline {color:#000000;font-family: Courier New, Courier, mono;font-size: 12px; font-weight: normal;}
.versionoverride {background-color: #FFCC99;}
.overrideflags{font-family: Arial, Helvetica, sans-serif;font-size: 11px;font-weight: normal;border: thin groove #CC9966;width:auto;padding-left: 5px;padding-top: 5px;padding-bottom: 5px;padding-right: 5px; background-color: #FFCC99; box-sizing: border-box }
.bsfnprops {font-family: Courier New, Courier, mono;font-size: 12px; color:#E01B4C}
.searchresult {font-family: Courier New, Courier, mono;font-size: 12px; font-weight: bold; background-color:#8BF3A0}
.expand {font-family: Courier New, Courier, mono;font-size: 11px; font-weight: bold; cursor:pointer; border: 1px solid gray; position: relative; left: -3px; display:inline; line-height:8px;}
.expand2 { display:inline; cursor:pointer; font-size: 9px; border: 1px solid gray; position: relative; left: -3px;}
</style>
<script type='text/javascript'>function load(){location.href = '#result';}</script>
<script language='JavaScript' type='text/javascript'>function ExpandCollapse(ElementId){ var ClickedElement = document.getElementById(ElementId); var SectionName = ElementId + ':hide'; var Section = document.getElementById(SectionName); if (ClickedElement.innerHTML == '-') { 	 ClickedElement.innerHTML = '+';	Section.style.display = 'none'; }  else  { 		ClickedElement.innerHTML = '-'; 	Section.style.display = 'inline';}} </script>
<base target = "_parent"></head><body onload='load()'>
<div class ='objectheader'>Business Function: B55MAIL - Manda Mail<BR>Function Type: C</div><div class='section'>EVENTS<div class='objectheader'>C Function: Manda Mail - [MandaMail]</div><div class='er'><div class='dstrmembers'><B>Data Structure: D55MAIL - Manda Mail                                                  </B><BR>BF szDe [HLNK]<BR>BF szAssunto [CMDS]<BR>BF cTemAnexo [EV01]<BR>BF szNomeAnexo [HLNK]<BR>BF szDisplayAnexo [CMDS]<BR>BF cEnviaCopiaParaRemetente [EV01]<BR>BF cSetaErroJDE [EV01]<BR>BF cGravaLog [EV01]<BR>BF cEscreveSobrescreveLog [EV01]<BR>BF szArquivoLog [HLNK]<BR>BF szErros [A322]<BR>BF szPara [TXPP]<BR>BF szCC [TXPP]<BR>BF cFormato [EV01]<BR>BF szMensagem [TXPP]<BR>BF szNomeAnexo2 [HLNK]<BR>BF szDisplayAnexo2 [CMDS]<BR></div><pre><div class='dstrmembers'><B>Header File: b55mail.h</B><BR></div> <br/>/***************************************************************************** <br/> *    Header File:  B55MAIL.h <br/> * <br/> *    Description:  Manda Mail Header File <br/> * <br/> *        History: <br/> *          Date        Programmer  SAR# - Description <br/> *          ----------  ----------  ------------------------------------------- <br/> *   Author 25/06/14    Unkno       Unknown  - Created  <br/> * <br/> * <br/> * Copyright (c) J.D. Edwards World Source Company, 1996 <br/> * <br/> * This unpublished material is proprietary to J.D. Edwards World Source  <br/> * Company.  All rights reserved.  The methods and techniques described  <br/> * herein are considered trade secrets and/or confidential.  Reproduction <br/> * or distribution, in whole or in part, is forbidden except by express <br/> * written permission of J.D. Edwards World Source Company. <br/> ****************************************************************************/ <br/> <br/>#ifndef __B55MAIL_H<br/>#define __B55MAIL_H <br/> <br/>/***************************************************************************** <br/> * Table Header Inclusions <br/> ****************************************************************************/ <br/> <br/>/***************************************************************************** <br/> * External Business Function Header Inclusions <br/> ****************************************************************************/ <br/> <br/>/***************************************************************************** <br/> * Global Definitions <br/> ****************************************************************************/ <br/> <br/>/***************************************************************************** <br/> * Structure Definitions <br/> ****************************************************************************/ <br/> <br/>/***************************************************************************** <br/> * DS Template Type Definitions <br/> ****************************************************************************/ <br/><br/><br/>/**<br/> * TYPEDEF for Data Structure<br/> * D55MAIL : Manda Mail<br/> *<br/> * Copyright Oracle USA<br/> *<br/> * This is a JDEdwards EnterpriseOne generated file.<br/> * Do not modify this file.<br/> * Only re-generate with the appropriate tool.<br/> * Generation Date : 12/08/15<br/> */<br/><br/>#ifndef DATASTRUCTURE_D55MAIL<br/>#define DATASTRUCTURE_D55MAIL<br/><br/>typedef struct tagDSD55MAIL<br/>{<br/>  JCHAR          szDe[257];<br/>  JCHAR          szAssunto[257];<br/>  JCHAR          cTemAnexo;<br/>  JCHAR          szNomeAnexo[257];<br/>  JCHAR          szDisplayAnexo[257];<br/>  JCHAR          cEnviaCopiaParaRemetente;<br/>  JCHAR          cSetaErroJDE;<br/>  JCHAR          cGravaLog;<br/>  JCHAR          cEscreveSobrescreveLog;<br/>  JCHAR          szArquivoLog[257];<br/>  JCHAR          szErros[601];<br/>  JCHAR          szPara[961];<br/>  JCHAR          szCC[961];<br/>  JCHAR          cFormato;<br/>  JCHAR          szMensagem[961];<br/>  JCHAR          szNomeAnexo2[257];<br/>  JCHAR          szDisplayAnexo2[257];<br/>} DSD55MAIL , *LPDSD55MAIL;<br/><br/>#define IDERRszDe_1                               1L<br/>#define IDERRszAssunto_4                          4L<br/>#define IDERRcTemAnexo_6                          6L<br/>#define IDERRszNomeAnexo_7                        7L<br/>#define IDERRszDisplayAnexo_8                     8L<br/>#define IDERRcEnviaCopiaParaRemetente_9           9L<br/>#define IDERRcSetaErroJDE_10                      10L<br/>#define IDERRcGravaLog_11                         11L<br/>#define IDERRcEscreveSobrescreveLog_14            14L<br/>#define IDERRszArquivoLog_15                      15L<br/>#define IDERRszErros_17                           17L<br/>#define IDERRszPara_20                            20L<br/>#define IDERRszCC_21                              21L<br/>#define IDERRcFormato_22                          22L<br/>#define IDERRszMensagem_23                        23L<br/>#define IDERRszNomeAnexo2_24                      24L<br/>#define IDERRszDisplayAnexo2_25                   25L<br/><br/>#endif /* DATASTRUCTURE_D55MAIL */<br/><br/><br/><br/>/***************************************************************************** <br/> * Source Preprocessor Definitions <br/> ****************************************************************************/ <br/>#if defined (JDEBFRTN) <br/>	#undef JDEBFRTN <br/>#endif <br/> <br/>#if defined (WIN32) <br/>	#if defined (WIN32) <br/>		#define JDEBFRTN(r) __declspec(dllexport) r <br/>	#else <br/>		#define JDEBFRTN(r) __declspec(dllimport) r <br/>	#endif <br/>#else <br/>	#define JDEBFRTN(r) r <br/>#endif <br/> <br/>/***************************************************************************** <br/> * Business Function Prototypes <br/> ****************************************************************************/ <br/> JDEBFRTN (ID) JDEBFWINAPI MandaMail                        (LPBHVRCOM lpBhvrCom, LPVOID lpVoid, LPDSD55MAIL lpDS); <br/>  <br/>/***************************************************************************** <br/> * Internal Function Prototypes <br/> ****************************************************************************/ <br/> void I5509019_WriteErrorsToLogFile(JDEMailError MailError, int ErrorCode, JCHAR * LogFileName, JCHAR cAppendOrOverwriteLogFile01, JCHAR * szMessageIDString);<br/> void I5509019_WriteErrorsToString(JDEMailError MailError, JCHAR * szErros);<br/> void I5509019_RemoveSurroundingBlanks(JCHAR * szString);<br/> <br/>#endif    /* __B55MAIL_H */ <br/> <br/></pre><BR/><pre><div class='dstrmembers'><B>Source File: b55mail.c</B><BR></div>#include &ltjde.h&gt <br/> <br/>#define b55mail_c <br/> <br/> <br/>/***************************************************************************** <br/> *    Source File:  b55mail <br/> * <br/> *    Description:  Manda Mail Source File <br/> * <br/> *        History: <br/> *          Date        Programmer  SAR# - Description <br/> *          ----------  ----------  ------------------------------------------- <br/> *   Author 25/06/14    Unkno       Unknown  - Created   <br/> * <br/> * Copyright (c) J.D. Edwards World Source Company, 1996 <br/> * <br/> * This unpublished material is proprietary to J.D. Edwards World Source Company. <br/> * All rights reserved.  The methods and techniques described herein are <br/> * considered trade secrets and/or confidential.  Reproduction or <br/> * distribution, in whole or in part, is forbidden except by express <br/> * written permission of J.D. Edwards World Source Company. <br/> ****************************************************************************/ <br/>/************************************************************************** <br/> * Notes: <br/> * <br/> **************************************************************************/ <br/> <br/>#include &ltb55mail.h&gt <br/> <br/> <br/>/************************************************************************** <br/> *  Business Function:  MandaMail <br/> * <br/> *        Description:  Envia Email <br/> * <br/> *         Parameters: <br/> *           LPBHVRCOM           lpBhvrCom    Business Function Communications <br/> *           LPVOID              lpVoid       Void Parameter - DO NOT USE! <br/> *           LPDSD55M            lpDS         Parameter Data Structure Pointer   <br/> * <br/> *************************************************************************/ <br/>JDEBFRTN (ID) JDEBFWINAPI MandaMail (LPBHVRCOM lpBhvrCom, LPVOID lpVoid, LPDSD55MAIL lpDS) <br/>{ <br/>   /************************************************************************<br/>    *  Variable declarations<br/>    ************************************************************************/<br/>	JCHAR	szDe[257],<br/>			szPara[257],<br/>			szCC[257],<br/>			szAssunto[257],<br/>			szMensagem[961],<br/>			szNomeAnexo[257],<br/>			szNomeAnexo2[257],<br/>			szDisplayAnexo[257],<br/>			szDisplayAnexo2[257],<br/>			szArquivoLog[257],<br/>			cTemAnexo,<br/>			cEnviaCopiaParaRemetente,<br/>			cSetaErroJDE,<br/>			cGravaLog,<br/>			cEscreveSobrescreveLog,<br/>			szFormato[11],<br/>			szErros[601];<br/>            <br/>	int		ErrorCode;<br/><br/>	JCHAR	StringBuffer[32] = {_J('\0')};<br/>	JCHAR	*s;<br/><br/>	int NumAttachments={0};<br/>	JDEMailError	err=eOK;<br/>	JDEMailMessageAtt *smtpAtt = NULL;<br/>   /************************************************************************<br/>    * Declare structures<br/>    ************************************************************************/<br/><br/>   /************************************************************************<br/>    * Declare pointers<br/>    ************************************************************************/<br/><br/>   /************************************************************************<br/>    * Check for NULL pointers<br/>    ************************************************************************/<br/>   if ((lpBhvrCom == (LPBHVRCOM) NULL) ||<br/>       (lpVoid    == (LPVOID)    NULL) ||<br/>       (lpDS      == (LPDSD55MAIL)	NULL))<br/>   {<br/>     jdeErrorSet (lpBhvrCom, lpVoid, (ID) 0, _J("4363"), (LPVOID) NULL);<br/>     return ER_ERROR;<br/>   }<br/><br/>   /************************************************************************<br/>    * Set pointers<br/>    ************************************************************************/<br/><br/>   /************************************************************************<br/>    * Main Processing<br/>    ************************************************************************/<br/>	/* Copy data structure into local variables */<br/>	jdeStrncpy(szDe, lpDS-&gtszDe, DIM(lpDS-&gtszDe));<br/>	jdeStrncpy(szPara, lpDS-&gtszPara, DIM(lpDS-&gtszPara));<br/>	jdeStrncpy(szCC, lpDS-&gtszCC, DIM(lpDS-&gtszCC));<br/>	jdeStrncpy(szAssunto, lpDS-&gtszAssunto, DIM(lpDS-&gtszAssunto));<br/>	jdeStrncpy(szMensagem, lpDS-&gtszMensagem, DIM(lpDS-&gtszMensagem));<br/>	jdeStrncpy(szNomeAnexo, lpDS-&gtszNomeAnexo, DIM(lpDS-&gtszNomeAnexo));<br/>	jdeStrncpy(szNomeAnexo2, lpDS-&gtszNomeAnexo2, DIM(lpDS-&gtszNomeAnexo2));<br/>	jdeStrncpy(szDisplayAnexo, lpDS-&gtszDisplayAnexo, DIM(lpDS-&gtszDisplayAnexo));<br/>	jdeStrncpy(szDisplayAnexo2, lpDS-&gtszDisplayAnexo2, DIM(lpDS-&gtszDisplayAnexo2));<br/>	jdeStrncpy(szArquivoLog, lpDS-&gtszArquivoLog, DIM(lpDS-&gtszArquivoLog));<br/>	jdeStrncpy(szErros, lpDS-&gtszErros, DIM(lpDS-&gtszErros));<br/><br/>	cTemAnexo = lpDS-&gtcTemAnexo;<br/>	cEnviaCopiaParaRemetente = lpDS-&gtcEnviaCopiaParaRemetente;<br/>	cSetaErroJDE = lpDS-&gtcSetaErroJDE;<br/>	cGravaLog = lpDS-&gtcGravaLog;<br/>	cEscreveSobrescreveLog = lpDS-&gtcEscreveSobrescreveLog;<br/><br/>    if ( lpDS-&gtcFormato == 'T' )<br/>    {<br/>        jdeStrncpy(szFormato, _J("TEXT/PLAIN"), DIM(szFormato));<br/>    } else {<br/>        jdeStrncpy(szFormato, _J("TEXT/HTML"), DIM(szFormato));<br/>    } <br/>    <br/><br/>	I5509019_RemoveSurroundingBlanks(szDe);<br/>	I5509019_RemoveSurroundingBlanks(szPara);<br/>	I5509019_RemoveSurroundingBlanks(szCC);<br/>	I5509019_RemoveSurroundingBlanks(szAssunto);<br/><br/>	ErrorCode = 0;<br/><br/>	if (jdeIsBlankOrNull(szDe)) <br/>	{<br/>		jdeStrcat(szErros, _J("001,"));<br/>	    ErrorCode = 1;<br/>	}<br/>			<br/>	if (jdeIsBlankOrNull(szPara)) <br/>	{<br/>		jdeStrcat(szErros, _J("002,"));<br/>        ErrorCode = 2;<br/>	}<br/>	<br/>	if (jdeIsBlankOrNull(szAssunto)) <br/>	{<br/>		jdeStrcat(szErros, _J("004,"));<br/>        ErrorCode = 4;<br/>	}<br/>	<br/>	if (cTemAnexo == _J('1'))<br/>	{<br/>		if (jdeAccess(szNomeAnexo, 0) == 0)		/* "access" returns 0 if file exists */<br/>		{<br/>			NumAttachments++;<br/>		}<br/>		<br/>		if (jdeAccess(szNomeAnexo2, 0) == 0)		/* "access" returns 0 if file exists */<br/>		{<br/>			NumAttachments++;<br/><br/>		}<br/><br/>		if (NumAttachments == 0) {<br/><br/>			jdeStrcat(szErros, _J("016,"));<br/>            ErrorCode = 16;<br/><br/>		} else {<br/><br/>			/* Populate attachment structure */	<br/>			smtpAtt=malloc(sizeof(JDEMailMessageAtt)*NumAttachments);<br/>			<br/>			smtpAtt[0].pVoid=NULL; /* This is always NULL */<br/>			jdeStrcpy(smtpAtt[0].filename, lpDS-&gtszNomeAnexo);<br/>			smtpAtt[0].filetype=ATT_FILE;	<br/>			jdeStrcpy(smtpAtt[0].displayname, lpDS-&gtszDisplayAnexo);<br/><br/>			if (NumAttachments &gt 1)	 {<br/><br/>				smtpAtt[1].pVoid=NULL; <br/>				jdeStrcpy(smtpAtt[1].filename, lpDS-&gtszNomeAnexo2);<br/>				smtpAtt[1].filetype=ATT_FILE;	<br/>				jdeStrcpy(smtpAtt[1].displayname, lpDS-&gtszDisplayAnexo2);<br/><br/>			}<br/><br/>		}<br/><br/>	}<br/><br/>	if (cEnviaCopiaParaRemetente == _J('1') && ErrorCode == 0)<br/>	{<br/>		if (jdeStrlen(szCC) &gt 0)<br/>		{<br/>			s = StringBuffer;<br/>			*s = _J(';');<br/>			jdeStrcat(szCC, s);<br/>		}<br/>		jdeStrcat(szCC, szDe);<br/>	}<br/>	<br/>	if (jdeIsBlankOrNull(szErros))<br/>	{<br/>		/* Send the E-mail*/<br/>      err = JDE_SendEMailSMTPExt(<br/>	         szDe,         /* From */<br/>		     szMensagem,                     /* Body */<br/>			 szAssunto,           /* Subject */<br/>	         szFormato,           /* Content Type */<br/>		     smtpAtt         ,          /* Attachments */<br/>			 NumAttachments,                /* Number of attachments */<br/>	         szPara,           /* To */<br/>		     szCC,            /* Cc */<br/>			 NULL) ;                    /* Bcc */<br/><br/>		if (err != eOK)<br/>		{<br/>			jdeStrcat(szErros, _J("032,"));<br/>            ErrorCode = 32;<br/>		}<br/><br/>	}<br/><br/>	if(err != eOK)<br/>	{<br/>	<br/>		if (cSetaErroJDE == _J('1'))<br/>		{<br/>			if(err == eSendError)<br/>			{<br/>				jdeSetGBRError (lpBhvrCom, lpVoid, (ID) 0, _J("033X"));  /* Error 033X = One or more addresses are invalid */<br/>				jdeStrcat(szErros, _J("033,"));<br/>                ErrorCode = 33;<br/>			}<br/>			else<br/>			{<br/>				jdeSetGBRError (lpBhvrCom, lpVoid, (ID) 0, _J("053X"));  /* Error 053X = Email Error - Check your jde.log file */<br/>				jdeStrcat(szErros, _J("053,"));<br/>                ErrorCode = 53;<br/>			}<br/>		}<br/>	}<br/><br/>	if (!jdeIsBlankOrNull(szErros))<br/>		if (cGravaLog == _J('1'))<br/>			I5509019_WriteErrorsToLogFile(err, ErrorCode, szArquivoLog, cEscreveSobrescreveLog, szMensagem);<br/><br/>	if (!jdeIsBlankOrNull(szErros)) <br/>	{<br/>		I5509019_WriteErrorsToString(ErrorCode, (JCHAR *)&szErros);<br/>		jdeStrncpy(lpDS-&gtszErros, szErros, DIM(lpDS-&gtszErros));<br/>	} else {<br/>		jdeStrncpy(lpDS-&gtszErros, (const JCHAR *)_J("000"), DIM(lpDS-&gtszErros));<br/>	}<br/><br/>	if (cTemAnexo == _J('1'))<br/>		free(smtpAtt);						/* free memory */<br/><br/>   /************************************************************************<br/>    * Function Clean Up<br/>    ************************************************************************/<br/><br/>   return (err == eOK)?ER_SUCCESS:ER_ERROR;<br/>} <br/> <br/>/* Internal function*/<br/>void I5509019_WriteErrorsToLogFile(JDEMailError MailError, int ErrorCode, JCHAR * LogFileName, JCHAR cAppendOrOverwriteLogFile01, JCHAR * szMessageIDString)<br/> {<br/><br/>	JCHAR	szMessageBuffer[257];<br/>	FILE	*ArquivoLog;<br/><br/>	ArquivoLog = jdeFopen(LogFileName, _J("w"));<br/>	jdeStrcpy(szMessageBuffer, szMessageIDString);<br/>	jdeWriteLog(_J("EMAIL ERROR"), 0, szMessageBuffer);<br/><br/>	if (ErrorCode &gt 0)<br/>	{<br/>		if (ErrorCode & 1)<br/>		{<br/>			jdeSprintf(szMessageBuffer, _J("Missing ")_J("FROM")_J(" e-mail address"));<br/>			jdeFprintf(ArquivoLog, _J("Missing ")_J("FROM")_J(" e-mail address"));<br/>			jdeWriteLog (_J("EMAIL ERROR"), 0, szMessageBuffer);<br/>		}<br/><br/>		if (ErrorCode & 2)<br/>		{<br/>			jdeSprintf(szMessageBuffer, _J("Missing ")_J("TO")_J(" e-mail address"));<br/>			jdeFprintf(ArquivoLog, _J("Missing ")_J("TO")_J(" e-mail address"));<br/>			jdeWriteLog (_J("EMAIL ERROR"), 0, szMessageBuffer);<br/>		}<br/><br/>		if (ErrorCode & 4)<br/>		{<br/>			jdeSprintf(szMessageBuffer, _J("Missing e-mail ")_J("SUBJECT")_J(""));<br/>			jdeFprintf(ArquivoLog, _J("Missing e-mail ")_J("SUBJECT")_J(""));<br/>			jdeWriteLog (_J("EMAIL ERROR"), 0, szMessageBuffer);<br/>		}<br/><br/>		if (ErrorCode & 16)<br/>		{<br/>			jdeSprintf(szMessageBuffer, _J("Attachment file not found"));<br/>			jdeFprintf(ArquivoLog, _J("Attachment file not found"));<br/>			jdeWriteLog (_J("EMAIL ERROR"), 0, szMessageBuffer);<br/>		}<br/>	}<br/><br/><br/>    if (MailError != eOK)<br/>	{<br/>	switch(MailError)<br/>	{<br/>      case eNullHandle:<br/>          jdeSprintf(szMessageBuffer, _J("eNullHandle: The mail handle is NULL - SendMail"));<br/>		  jdeFprintf(ArquivoLog, _J("eNullHandle: The mail handle is NULL - SendMail"));<br/>	      jdeWriteLog (_J("EMAIL ERROR"), 0, szMessageBuffer);<br/>        break;<br/>      case eOpenMessageStoreFailed:<br/>          jdeSprintf(szMessageBuffer, _J("eOpenMessageStoreFailed: Unable to open the message store - SendMail"));<br/>		  jdeFprintf(ArquivoLog, _J("eOpenMessageStoreFailed: Unable to open the message store - SendMail"));<br/>	      jdeWriteLog (_J("EMAIL ERROR"), 0, szMessageBuffer);<br/>        break;<br/>      case eOpenMailFolderFailed:<br/>          jdeSprintf(szMessageBuffer, _J("eOpenMailFolderFailed: Unable to open the mail folder - SendMail"));<br/>		  jdeFprintf(ArquivoLog, _J("eOpenMailFolderFailed: Unable to open the mail folder - SendMail"));<br/>	      jdeWriteLog (_J("EMAIL ERROR"), 0, szMessageBuffer);<br/>        break;<br/>      case eReadMessageFailed:<br/>          jdeSprintf(szMessageBuffer, _J("eReadMessageFailed: Unable to read the mail message - SendMail"));<br/>		  jdeFprintf(ArquivoLog, _J("eReadMessageFailed: Unable to read the mail message - SendMail"));<br/>	      jdeWriteLog (_J("EMAIL ERROR"), 0, szMessageBuffer);<br/>        break;<br/>      case eReadAttachmentsFailed:<br/>          jdeSprintf(szMessageBuffer, _J("eReadAttachmentsFailed: Unable to read the attachments - SendMail"));<br/>		  jdeFprintf(ArquivoLog, _J("eReadAttachmentsFailed: Unable to read the attachments - SendMail"));<br/>	      jdeWriteLog (_J("EMAIL ERROR"), 0, szMessageBuffer);<br/>        break;<br/>      case eOpenMailboxTOCFailed:<br/>          jdeSprintf(szMessageBuffer, _J("eOpenMailboxTOCFailed: Unable to open the mailbox - SendMail"));<br/>		  jdeFprintf(ArquivoLog, _J("eOpenMailboxTOCFailed: Unable to open the mailbox - SendMail"));<br/>	      jdeWriteLog (_J("EMAIL ERROR"), 0, szMessageBuffer);<br/>        break;<br/>      case eOpenMessageFailed:<br/>          jdeSprintf(szMessageBuffer, _J("eOpenMessageFailed: Unable to open the message - SendMail"));<br/>		  jdeFprintf(ArquivoLog, _J("eOpenMessageFailed: Unable to open the message - SendMail"));<br/>	      jdeWriteLog (_J("EMAIL ERROR"), 0, szMessageBuffer);<br/>        break;<br/>      case eCreateMessageFailed:<br/>          jdeSprintf(szMessageBuffer, _J("eCreateMessageFailed: Could not create the message - SendMail"));<br/>		  jdeFprintf(ArquivoLog, _J("eCreateMessageFailed: Could not create the message - SendMail"));<br/>	      jdeWriteLog (_J("EMAIL ERROR"), 0, szMessageBuffer);<br/>        break;<br/>      case eMailRecipientError:<br/>          jdeSprintf(szMessageBuffer, _J("eMailRecipientError: The mail recipient is in error - SendMail"));<br/>		  jdeFprintf(ArquivoLog, _J("eMailRecipientError: The mail recipient is in error - SendMail"));<br/>	      jdeWriteLog (_J("EMAIL ERROR"), 0, szMessageBuffer);<br/>        break;<br/>      case eSendMessageFailed:<br/>          jdeSprintf(szMessageBuffer, _J("eSendMessageFailed: Unable to send the message - SendMail"));<br/>		  jdeFprintf(ArquivoLog, _J("eSendMessageFailed: Unable to send the message - SendMail"));<br/>	      jdeWriteLog (_J("EMAIL ERROR"), 0, szMessageBuffer);<br/>        break;<br/>      case eCopyToSentMailFailed:<br/>          jdeSprintf(szMessageBuffer, _J("eCopyToSentMailFailed: Unable to copy message to sent mailbox - SendMail"));<br/>          jdeFprintf(ArquivoLog, _J("eCopyToSentMailFailed: Unable to copy message to sent mailbox - SendMail"));<br/>	      jdeWriteLog (_J("EMAIL ERROR"), 0, szMessageBuffer);<br/>        break;<br/>      case eDeleteFromOutBoxFailed:<br/>          jdeSprintf(szMessageBuffer, _J("eDeleteFromOutBoxFailed: Unable to delete message from the outbox - SendMail"));<br/>		  jdeFprintf(ArquivoLog, _J("eDeleteFromOutBoxFailed: Unable to delete message from the outbox - SendMail"));<br/>	      jdeWriteLog (_J("EMAIL ERROR"), 0, szMessageBuffer);<br/>        break;<br/>      case eOpenWasteBasketFailed:<br/>          jdeSprintf(szMessageBuffer, _J("eOpenWasteBasketFailed: Unable to open the deleted mailbox - SendMail"));<br/>		  jdeFprintf(ArquivoLog, _J("eOpenWasteBasketFailed: Unable to open the deleted mailbox - SendMail"));<br/>	      jdeWriteLog (_J("EMAIL ERROR"), 0, szMessageBuffer);<br/>        break;<br/>      case eCopyToWasteBasketFailed:<br/>          jdeSprintf(szMessageBuffer, _J("eCopyToWasteBasketFailed: Unable to copy message to deleted mailbox - SendMail"));<br/>		  jdeFprintf(ArquivoLog, _J("eCopyToWasteBasketFailed: Unable to copy message to deleted mailbox - SendMail"));<br/>	      jdeWriteLog (_J("EMAIL ERROR"), 0, szMessageBuffer);<br/>        break;<br/>      case eFormDisplayFailed:<br/>          jdeSprintf(szMessageBuffer, _J("eFormDisplayFailed: The MAPI form could not be displayed - SendMail"));<br/>		  jdeFprintf(ArquivoLog, _J("eFormDisplayFailed: The MAPI form could not be displayed - SendMail"));<br/>	      jdeWriteLog (_J("EMAIL ERROR"), 0, szMessageBuffer);<br/>        break;<br/>      case eNoMoreMessages:<br/>          jdeSprintf(szMessageBuffer, _J("eNoMoreMessages: No more messages were found - SendMail"));<br/>		  jdeFprintf(ArquivoLog, _J("eNoMoreMessages: No more messages were found - SendMail"));<br/>	      jdeWriteLog (_J("EMAIL ERROR"), 0, szMessageBuffer);<br/>        break;<br/>      case eMapiFindError:<br/>          jdeSprintf(szMessageBuffer, _J("eMapiFindError: The MAPI find failed - SendMail"));<br/>		  jdeFprintf(ArquivoLog, _J("eMapiFindError: The MAPI find failed - SendMail"));<br/>	      jdeWriteLog (_J("EMAIL ERROR"), 0, szMessageBuffer);<br/>        break;<br/>      case eDeleteFailed:<br/>          jdeSprintf(szMessageBuffer, _J("eDeleteFailed: The message delete failed - SendMail"));<br/>		  jdeFprintf(ArquivoLog, _J("eDeleteFailed: The message delete failed - SendMail"));<br/>	      jdeWriteLog (_J("EMAIL ERROR"), 0, szMessageBuffer);<br/>        break;<br/>      case eCallFailed:<br/>          jdeSprintf(szMessageBuffer, _J("eCallFailed: A MAPI call failed - SendMail"));<br/>		  jdeFprintf(ArquivoLog, _J("eCallFailed: A MAPI call failed - SendMail"));<br/>	      jdeWriteLog (_J("EMAIL ERROR"), 0, szMessageBuffer);<br/>        break;<br/><br/>   /* SMTP errors: */<br/>      case eSocketCreateFailed:<br/>          jdeSprintf(szMessageBuffer, _J("eSocketCreateFailed: Creation of socket failed - SendMail"));<br/>		  jdeFprintf(ArquivoLog, _J("eSocketCreateFailed: Creation of socket failed - SendMail"));<br/>	      jdeWriteLog (_J("EMAIL ERROR"), 0, szMessageBuffer);<br/>        break;<br/>      case eCouldNotGetIPAddress:<br/>          jdeSprintf(szMessageBuffer, _J("eCouldNotGetIPAddress: Could not resolve IP address - SendMail"));<br/>		  jdeFprintf(ArquivoLog, _J("eCouldNotGetIPAddress: Could not resolve IP address - SendMail"));<br/>	      jdeWriteLog (_J("EMAIL ERROR"), 0, szMessageBuffer);<br/>        break;<br/>      case eConnectError:<br/>          jdeSprintf(szMessageBuffer, _J("eConnectError: The connection to the service provider failed - SendMail"));<br/>		  jdeFprintf(ArquivoLog, _J("eConnectError: The connection to the service provider failed - SendMail"));<br/>	      jdeWriteLog (_J("EMAIL ERROR"), 0, szMessageBuffer);<br/>        break;<br/>      case eSendError:<br/>		  jdeSprintf(szMessageBuffer, _J("eSendError: There was an error in the send of the message - SendMail"));<br/>		  jdeFprintf(ArquivoLog, _J("eSendError: There was an error in the send of the message - SendMail"));<br/>		  jdeWriteLog (_J("EMAIL ERROR"), 0, szMessageBuffer);<br/>        break;<br/>      case eReceiveError:<br/>          jdeSprintf(szMessageBuffer, _J("eReceiveError: There was an error in receiving the message - SendMail"));<br/>		  jdeFprintf(ArquivoLog, _J("eReceiveError: There was an error in receiving the message - SendMail"));<br/>	      jdeWriteLog (_J("EMAIL ERROR"), 0, szMessageBuffer);<br/>        break;<br/>      case eCouldNotGetHost:<br/>          jdeSprintf(szMessageBuffer, _J("eCouldNotGetHost: The host could not be resolved - SendMail"));<br/>		  jdeFprintf(ArquivoLog, _J("eCouldNotGetHost: The host could not be resolved - SendMail"));<br/>	      jdeWriteLog (_J("EMAIL ERROR"), 0, szMessageBuffer);<br/>        break;<br/>      case eServiceNotAvailable:<br/>          jdeSprintf(szMessageBuffer, _J("eServiceNotAvailable: The MAPI service is not available - SendMail"));<br/>		  jdeFprintf(ArquivoLog, _J("eServiceNotAvailable: The MAPI service is not available - SendMail"));<br/>	      jdeWriteLog (_J("EMAIL ERROR"), 0, szMessageBuffer);<br/>        break;<br/>      case eMailActionNotTaken:<br/>          jdeSprintf(szMessageBuffer, _J("eMailActionNotTaken: The specified action was not taken - SendMail"));<br/>		  jdeFprintf(ArquivoLog, _J("eMailActionNotTaken: The specified action was not taken - SendMail"));<br/>	      jdeWriteLog (_J("EMAIL ERROR"), 0, szMessageBuffer);<br/>        break;<br/>      case eMailSyntaxError:<br/>          jdeSprintf(szMessageBuffer, _J("eMailSyntaxError: There was a syntax error - SendMail"));<br/>		  jdeFprintf(ArquivoLog, _J("eMailSyntaxError: There was a syntax error - SendMail"));<br/>	      jdeWriteLog (_J("EMAIL ERROR"), 0, szMessageBuffer);<br/>        break;<br/>      case eMailboxUnavailable:<br/>          jdeSprintf(szMessageBuffer, _J("eMailboxUnavailable: Unable to get handle for mailbox - SendMail"));<br/>		  jdeFprintf(ArquivoLog, _J("eMailboxUnavailable: Unable to get handle for mailbox - SendMail"));<br/>	      jdeWriteLog (_J("EMAIL ERROR"), 0, szMessageBuffer);<br/>        break;<br/>      case eUserNotLocal:<br/>          jdeSprintf(szMessageBuffer, _J("eUserNotLocal: The user is not local to the service provider - SendMail"));<br/>		  jdeFprintf(ArquivoLog, _J("eUserNotLocal: The user is not local to the service provider - SendMail"));<br/>	      jdeWriteLog (_J("EMAIL ERROR"), 0, szMessageBuffer);<br/>        break;<br/>      case eStorageAllocExceeded:<br/>          jdeSprintf(szMessageBuffer, _J("eStorageAllocExceeded: You have exceeded your mail storage allocation - SendMail"));<br/>		  jdeFprintf(ArquivoLog, _J("eStorageAllocExceeded: You have exceeded your mail storage allocation - SendMail"));<br/>	      jdeWriteLog (_J("EMAIL ERROR"), 0, szMessageBuffer);<br/>        break;<br/>      case eTransactionFailed:<br/>          jdeSprintf(szMessageBuffer, _J("eTransactionFailed: The transaction failed - SendMail"));<br/>		  jdeFprintf(ArquivoLog, _J("eTransactionFailed: The transaction failed - SendMail"));<br/>	      jdeWriteLog (_J("EMAIL ERROR"), 0, szMessageBuffer);<br/>        break;<br/><br/>   /* Init & Cleanup errors: */<br/>      case eInitFailed:<br/>          jdeSprintf(szMessageBuffer, _J("eInitFailed: Unable to initialize mail handle - SendMail"));<br/>		  jdeFprintf(ArquivoLog, _J("eInitFailed: Unable to initialize mail handle - SendMail"));<br/>	      jdeWriteLog (_J("EMAIL ERROR"), 0, szMessageBuffer);<br/>        break;<br/>      case eInitNoProfile:<br/>          jdeSprintf(szMessageBuffer, _J("eInitNoProfile: Initialization failed, no profile was found - SendMail"));<br/>		  jdeFprintf(ArquivoLog, _J("eInitNoProfile: Initialization failed, no profile was found - SendMail"));<br/>	      jdeWriteLog (_J("EMAIL ERROR"), 0, szMessageBuffer);<br/>        break;<br/>      case eWinsockInitFailed:<br/>          jdeSprintf(szMessageBuffer, _J("eWinsockInitFailed: Unable to initialize the Winsock - SendMail"));<br/>		  jdeFprintf(ArquivoLog, _J("eWinsockInitFailed: Unable to initialize the Winsock - SendMail"));<br/>	      jdeWriteLog (_J("EMAIL ERROR"), 0, szMessageBuffer);<br/>        break;<br/>      case eInitMapiFailed:<br/>          jdeSprintf(szMessageBuffer, _J("eInitMapiFailed: Unable to initialize MAPI mail handle - SendMail"));<br/>		  jdeFprintf(ArquivoLog, _J("eInitMapiFailed: Unable to initialize MAPI mail handle - SendMail"));<br/>	      jdeWriteLog (_J("EMAIL ERROR"), 0, szMessageBuffer);<br/>        break;<br/>      case eMapiLoadLibError:<br/>          jdeSprintf(szMessageBuffer, _J("eMapiLoadLibError: Unable to load MAPI32.DLL - SendMail"));<br/>		  jdeFprintf(ArquivoLog, _J("eMapiLoadLibError: Unable to load MAPI32.DLL - SendMail"));<br/>	      jdeWriteLog (_J("EMAIL ERROR"), 0, szMessageBuffer);<br/>        break;<br/>      case eMapiLoadFuncError:<br/>          jdeSprintf(szMessageBuffer, _J("eMapiLoadFuncError: Unable to call a MAPI function - SendMail"));<br/>		  jdeFprintf(ArquivoLog, _J("eMapiLoadFuncError: Unable to call a MAPI function - SendMail"));<br/>	      jdeWriteLog (_J("EMAIL ERROR"), 0, szMessageBuffer);<br/>        break;<br/>      case eMapiLogoffFailed:<br/>          jdeSprintf(szMessageBuffer, _J("eMapiLogoffFailed: The call to MAPI logoff failed - SendMail"));<br/>		  jdeFprintf(ArquivoLog, _J("eMapiLogoffFailed: The call to MAPI logoff failed - SendMail"));<br/>	      jdeWriteLog (_J("EMAIL ERROR"), 0, szMessageBuffer);<br/>        break;<br/>  <br/>   /* Other Errors: */<br/>      case eSmallBuffer:<br/>          jdeSprintf(szMessageBuffer, _J("eSmallBuffer: The buffer is to small - SendMail"));<br/>		  jdeFprintf(ArquivoLog, _J("eSmallBuffer: The buffer is to small - SendMail"));<br/>	      jdeWriteLog (_J("EMAIL ERROR"), 0, szMessageBuffer);<br/>        break;<br/>      case eBadFileName:<br/>          jdeSprintf(szMessageBuffer, _J("eBadFileName: The file name was not a valid name - SendMail"));<br/>		  jdeFprintf(ArquivoLog, _J("eBadFileName: The file name was not a valid name - SendMail"));<br/>	      jdeWriteLog (_J("EMAIL ERROR"), 0, szMessageBuffer);<br/>        break;<br/>      case eMemoryError:<br/>          jdeSprintf(szMessageBuffer, _J("eMemoryError: A memory error occured - SendMail"));<br/>		  jdeFprintf(ArquivoLog, _J("eMemoryError: A memory error occured - SendMail"));<br/>	      jdeWriteLog (_J("EMAIL ERROR"), 0, szMessageBuffer);<br/>        break;<br/>      case eNoMsgFrom:<br/>          jdeSprintf(szMessageBuffer, _J("eNoMsgFrom: The From could not be resolved - SendMail"));<br/>		  jdeFprintf(ArquivoLog, _J("eNoMsgFrom: The From could not be resolved - SendMail"));<br/>	      jdeWriteLog (_J("EMAIL ERROR"), 0, szMessageBuffer);<br/>        break;<br/>      case eNoMsgRecips:<br/>          jdeSprintf(szMessageBuffer, _J("eNoMsgRecips: No message recipient was speceified - SendMail"));<br/>		  jdeFprintf(ArquivoLog, _J("eNoMsgRecips: No message recipient was speceified - SendMail"));<br/>	      jdeWriteLog (_J("EMAIL ERROR"), 0, szMessageBuffer);<br/>        break;<br/>      case eBadArg:<br/>          jdeSprintf(szMessageBuffer, _J("eBadArg: Abad argument was passed to mail - SendMail"));<br/>		  jdeFprintf(ArquivoLog, _J("eBadArg: Abad argument was passed to mail - SendMail"));<br/>	      jdeWriteLog (_J("EMAIL ERROR"), 0, szMessageBuffer);<br/>        break;<br/>      case eUnrecognizedProtocol:<br/>          jdeSprintf(szMessageBuffer, _J("eUnrecognizedProtocol: The protocol did not conform to SMTP - SendMail"));<br/>		  jdeFprintf(ArquivoLog, _J("eUnrecognizedProtocol: The protocol did not conform to SMTP - SendMail"));<br/>	      jdeWriteLog (_J("EMAIL ERROR"), 0, szMessageBuffer);<br/>        break;<br/>      case eEncodeError:<br/>          jdeSprintf(szMessageBuffer, _J("eEncodeError: Could not encode message - SendMail"));<br/>		  jdeFprintf(ArquivoLog, _J("eEncodeError: Could not encode message - SendMail"));<br/>	      jdeWriteLog (_J("EMAIL ERROR"), 0, szMessageBuffer);<br/>        break;<br/>      default :<br/>          jdeSprintf(szMessageBuffer, _J("eUnknownMailError: Unknown error occured in SendMail"));<br/>		  jdeFprintf(ArquivoLog, _J("eUnknownMailError: Unknown error occured in SendMail"));<br/>	      jdeWriteLog (_J("EMAIL ERROR"), 0, szMessageBuffer);<br/>        break;<br/>    }<br/>	jdeWriteLog (_J("EMAIL ERROR"), 0, szMessageBuffer);<br/>	}<br/>		jdeWriteLog (_J("EMAIL ERROR END "), 0, _J("---------------------------"));<br/><br/>	jdeFclose(ArquivoLog);<br/>    return;<br/>}<br/><br/>void I5509019_WriteErrorsToString(JDEMailError MailError, JCHAR * szErros)<br/>{<br/>    if (MailError != eOK)<br/>	{<br/>		switch(MailError)<br/>		{<br/>		  case eNullHandle:<br/>			  jdeStrcat(szErros, _J("100,"));        break;<br/>		  case eOpenMessageStoreFailed:<br/>			  jdeStrcat(szErros, _J("101,"));        break;<br/>		  case eOpenMailFolderFailed:<br/>			  jdeStrcat(szErros, _J("102,"));        break;<br/>		  case eReadMessageFailed:<br/>			  jdeStrcat(szErros, _J("103,"));        break;<br/>		  case eReadAttachmentsFailed:<br/>			  jdeStrcat(szErros, _J("104,"));        break;<br/>		  case eOpenMailboxTOCFailed:<br/>			  jdeStrcat(szErros, _J("105,"));        break;<br/>		  case eOpenMessageFailed:<br/>			  jdeStrcat(szErros, _J("106,"));        break;<br/>		  case eCreateMessageFailed:<br/>			  jdeStrcat(szErros, _J("107,"));        break;<br/>		  case eMailRecipientError:<br/>			  jdeStrcat(szErros, _J("108,"));        break;<br/>		  case eSendMessageFailed:<br/>			  jdeStrcat(szErros, _J("109,"));        break;<br/>		  case eCopyToSentMailFailed:<br/>			  jdeStrcat(szErros, _J("110,"));        break;<br/>		  case eDeleteFromOutBoxFailed:<br/>			  jdeStrcat(szErros, _J("111,"));        break;<br/>		  case eOpenWasteBasketFailed:<br/>			  jdeStrcat(szErros, _J("112,"));        break;<br/>		  case eCopyToWasteBasketFailed:<br/>			  jdeStrcat(szErros, _J("113,"));        break;<br/>		  case eFormDisplayFailed:<br/>			  jdeStrcat(szErros, _J("114,"));        break;<br/>		  case eNoMoreMessages:<br/>			  jdeStrcat(szErros, _J("115,"));        break;<br/>		  case eMapiFindError:<br/>			  jdeStrcat(szErros, _J("116,"));        break;<br/>		  case eDeleteFailed:<br/>			  jdeStrcat(szErros, _J("117,"));        break;<br/>		  case eCallFailed:<br/>			  jdeStrcat(szErros, _J("118,"));        break;<br/><br/>	   /* SMTP errors: */<br/>		  case eSocketCreateFailed:<br/>			  jdeStrcat(szErros, _J("119,"));        break;<br/>		  case eCouldNotGetIPAddress:<br/>			  jdeStrcat(szErros, _J("120,"));        break;<br/>		  case eConnectError:<br/>			  jdeStrcat(szErros, _J("121,"));        break;<br/>		  case eSendError:<br/>			  jdeStrcat(szErros, _J("122,"));        break;<br/>		  case eReceiveError:<br/>			  jdeStrcat(szErros, _J("123,"));        break;<br/>		  case eCouldNotGetHost:<br/>			  jdeStrcat(szErros, _J("124,"));        break;<br/>		  case eServiceNotAvailable:<br/>			  jdeStrcat(szErros, _J("125,"));        break;<br/>		  case eMailActionNotTaken:<br/>			  jdeStrcat(szErros, _J("126,"));        break;<br/>		  case eMailSyntaxError:<br/>			  jdeStrcat(szErros, _J("127,"));        break;<br/>		  case eMailboxUnavailable:<br/>			  jdeStrcat(szErros, _J("128,"));        break;<br/>		  case eUserNotLocal:<br/>			  jdeStrcat(szErros, _J("129,"));        break;<br/>		  case eStorageAllocExceeded:<br/>			  jdeStrcat(szErros, _J("130,"));        break;<br/>		  case eTransactionFailed:<br/>			  jdeStrcat(szErros, _J("131,"));        break;<br/><br/>	   /* Init & Cleanup errors: */<br/>		  case eInitFailed:<br/>			  jdeStrcat(szErros, _J("132,"));        break;<br/>		  case eInitNoProfile:<br/>			  jdeStrcat(szErros, _J("133,"));        break;<br/>		  case eWinsockInitFailed:<br/>			  jdeStrcat(szErros, _J("134,"));        break;<br/>		  case eInitMapiFailed:<br/>			  jdeStrcat(szErros, _J("135,"));        break;<br/>		  case eMapiLoadLibError:<br/>			  jdeStrcat(szErros, _J("136,"));        break;<br/>		  case eMapiLoadFuncError:<br/>			  jdeStrcat(szErros, _J("137,"));        break;<br/>		  case eMapiLogoffFailed:<br/>			  jdeStrcat(szErros, _J("138,"));        break;<br/>	  <br/>	   /* Other Errors: */<br/>		  case eSmallBuffer:<br/>			  jdeStrcat(szErros, _J("139,"));        break;<br/>		  case eBadFileName:<br/>			  jdeStrcat(szErros, _J("140,"));        break;<br/>		  case eMemoryError:<br/>			  jdeStrcat(szErros, _J("141,"));        break;<br/>		  case eNoMsgFrom:<br/>			  jdeStrcat(szErros, _J("142,"));        break;<br/>		  case eNoMsgRecips:<br/>			  jdeStrcat(szErros, _J("143,"));<br/>			break;<br/>		  case eBadArg:<br/>			  jdeStrcat(szErros, _J("144,"));        break;<br/>		  case eUnrecognizedProtocol:<br/>			  jdeStrcat(szErros, _J("145,"));        break;<br/>		  case eEncodeError:<br/>			  jdeStrcat(szErros, _J("146,"));        break;<br/>		  default :<br/>			  jdeStrcat(szErros, _J("147,"));        break;<br/>		};<br/>	};<br/>	  return;<br/>};<br/><br/>/* Internal function comment block */<br/>/**************************************************************************<br/> *   Function:  Ixxxxxxx_a   // Replace "xxxxxxx" with source file number<br/> *                           // and "a" with the function name<br/> *      Notes:<br/> *<br/> *    Returns:<br/> *<br/> * Parameters:<br/> **************************************************************************/<br/> void I5509019_RemoveSurroundingBlanks(JCHAR * szString)<br/>  {<br/>	//<br/>	unsigned int	ni;<br/>	JCHAR	*p;<br/>	JCHAR	*s;<br/>	JCHAR	*pi;<br/>    //<br/>	ni = jdeStrlen(szString);		/* Get initial length of string */<br/>	s = (JCHAR *) calloc(ni+1, sizeof(*s));  /* allow for the null char at end of string */<br/>	jdeStrncpy(s, (const JCHAR *) szString, ni);<br/>	pi = s;<br/><br/>	if (*s != _J('\0'))<br/>	{	while (jdeIsspace(*s) && *s != _J('\0'))	/* Skip leading spaces */<br/>			++s;<br/>		p = s;<br/>		<br/>		if (*s)								/* Proceed if remaining string is not null */<br/>		{<br/>			for (;*s != _J('\0'); ++s);			/* go to end of string */<br/>			--s;							/* back up one char to point to last char in string */<br/>			while (jdeIsspace(*s))				/* remove spaces from end of string */<br/>			{<br/>				*s = _J('\0');<br/>				--s;<br/>			}<br/>		}<br/>		jdeStrncpy(szString, (const JCHAR *) p, ni);<br/>	}<br/>	free(pi);<br/>  }<br/></pre></div></div></body></html>