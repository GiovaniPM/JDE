<!DOCTYPE html><html lang = "en"><head><meta charset = "utf-8"><meta name = "viewport" content = "width=device-width, initial-scale=1"><title>JDE Object Browser HTML Extract</title>
<style type='text/css'>body,th{font-family: Courier New, Courier, mono;font-size: 12px; width:auto}
.section{font-family: Arial, Helvetica, sans-serif;font-size: 12px;font-weight: bold;border: thin groove #CC9966;width: 100%;padding-left: 5px;padding-top: 5px;padding-bottom: 5px; padding-right: 5px; box-sizing: border-box }
.objectheader {font-family: Arial, Helvetica, sans-serif;font-size: 12px;font-weight: bold;border: thin groove #CC9966;width:auto;background-color: #FFFFCC;padding-left: 5px;padding-top: 5px;padding-bottom: 5px;padding-right: 5px; box-sizing: border-box }
.details{font-family: Arial, Helvetica, sans-serif;font-size: 11px;font-weight: normal;border: thin groove #CC9966;width:100%;padding-left: 5px;padding-top: 5px;padding-bottom: 5px;padding-right: 5px;box-sizing: border-box }
.er {background-color: #FFFFFF;font-family: Courier New, Courier, mono;font-size: 12px; font-weight: normal; border: thin solid #CCCCCC; width:auto; padding-left: 5px;padding-top: 5px;padding-bottom: 5px; padding-right: 5px; box-sizing: border-box }
.dstrmembers {background-color: #FFFDDD;font-family: Courier New, Courier, mono;font-size: 12px;border: thin groove #CC9966;padding-left: 5px;padding-top: 5px;padding-bottom: 5px;padding-right: 5px; box-sizing: border-box }
.disabled {font-family: Courier New, Courier, mono;font-size: 12px;	font-style: italic; color:#CC9933}
.parameters {font-family: Courier New, Courier, mono;font-size: 12px; color:#3333FF}
.comment {font-family: Courier New, Courier, mono;font-size: 12px;	color: #339933}
.subtable {font-family: Arial, Helvetica, sans-serif;font-size: 11px;font-weight: normal;width:100%}
.lineno {color:#6E6E6E;font-family: Courier New, Courier, mono;font-size: 12px; font-weight: normal;}
.iokey {color:#FF6905;font-family: Courier New, Courier, mono;font-size: 12px; font-weight: normal;}
.logicline {color:#000000;font-family: Courier New, Courier, mono;font-size: 12px; font-weight: normal;}
.versionoverride {background-color: #FFCC99;}
.overrideflags{font-family: Arial, Helvetica, sans-serif;font-size: 11px;font-weight: normal;border: thin groove #CC9966;width:auto;padding-left: 5px;padding-top: 5px;padding-bottom: 5px;padding-right: 5px; background-color: #FFCC99; box-sizing: border-box }
.bsfnprops {font-family: Courier New, Courier, mono;font-size: 12px; color:#E01B4C}
.searchresult {font-family: Courier New, Courier, mono;font-size: 12px; font-weight: bold; background-color:#8BF3A0}
.expand {font-family: Courier New, Courier, mono;font-size: 11px; font-weight: bold; cursor:pointer; border: 1px solid gray; position: relative; left: -3px; display:inline; line-height:8px;}
.expand2 { display:inline; cursor:pointer; font-size: 9px; border: 1px solid gray; position: relative; left: -3px;}
</style>
<script type='text/javascript'>function load(){location.href = '#result';}</script>
<script language='JavaScript' type='text/javascript'>function ExpandCollapse(ElementId){ var ClickedElement = document.getElementById(ElementId); var SectionName = ElementId + ':hide'; var Section = document.getElementById(SectionName); if (ClickedElement.innerHTML == '-') { 	 ClickedElement.innerHTML = '+';	Section.style.display = 'none'; }  else  { 		ClickedElement.innerHTML = '-'; 	Section.style.display = 'inline';}} </script>
<base target = "_parent"></head><body onload='load()'>
<div class ='objectheader'>Business Function: B55XML02 - XML common functions for Localization<BR>Function Type: C</div><div class='section'>EVENTS<div class='objectheader'>C Function: XML common functions for Localization - [XMLAddElement_55]</div><div class='er'><div class='dstrmembers'><B>Data Structure: D55XML01B - XML Add Element                                             </B><BR>BF idDoc [GENLNG]<BR>BF idParentElement [GENLNG]<BR>BF szElementName [PARMSTRG]<BR>BF szElementAttributeName [PARMSTRG]<BR>BF szElementAttributeValue [PARMSTRG]<BR>BF szElementText [PARMSTRG]<BR>BF cReturnElement [EV01]<BR>BF idNewElement [GENLNG]<BR>BF cErrorCode [EV01]<BR>BF idAPIs [GENLNG]<BR>BF cSuppressErrorMessage [SUPPS]<BR>BF szErrorMessageID [DTAI]<BR>BF szXMLAttributeDataType [OWTP]<BR>BF cXMLAttributeCharacter [55XCG1]<BR>BF jdXMLAttributeDate [55XDG1]<BR>BF idXMLAttributeInteger [55XIG1]<BR>BF mnXMLAttributeNumeric [55XNG1]<BR>BF szXMLElementDataType [OWTP]<BR>BF cXMLElementCharacter [55XCG1]<BR>BF jdXMLElementDate [55XDG1]<BR>BF idXMLElementInteger [55XIG1]<BR>BF mnXMLElementNumeric [55XNG1]<BR>BF idXMLElementLongID [GENLNG]<BR></div><pre><div class='dstrmembers'><B>Header File: b55xml02.h</B><BR></div><br/>/*****************************************************************************<br/> *    Header File:  B55XML02.h<br/> *<br/> *    Description:  XML common functions for Localization Header File<br/> *<br/> *        History:<br/> *          Date        Programmer  SAR# - Description<br/> *          ----------  ----------  -------------------------------------------<br/> *   Author 13/02/07    FG8307947   Unknown  - Created  <br/> *          12/11/07    IC9018661   8666675  - XML modification for CNAO Project<br/> *          21/09/10    Juliano Rach<br/> *<br/> * Copyright (c) J.D. Edwards World Source Company, 1996<br/> *<br/> * This unpublished material is proprietary to J.D. Edwards World Source <br/> * Company.  All rights reserved.  The methods and techniques described <br/> * herein are considered trade secrets and/or confidential.  Reproduction<br/> * or distribution, in whole or in part, is forbidden except by express<br/> * written permission of J.D. Edwards World Source Company.<br/> ****************************************************************************/<br/><br/>#ifndef __B55XML02_H<br/>#define __B55XML02_H<br/><br/>/*****************************************************************************<br/> * Table Header Inclusions<br/> ****************************************************************************/<br/><br/>#include &ltf55xmlz1.h&gt<br/><br/>/*****************************************************************************<br/> * External Business Function Header Inclusions<br/> ****************************************************************************/<br/>#include &ltjdeapp.h&gt<br/><br/>/*****************************************************************************<br/> * Global Definitions<br/> ****************************************************************************/<br/><br/><br/>#define I55XML02_EVDT_CHAR			1<br/>#define I55XML02_EVDT_JDEDATE		11<br/>#define I55XML02_EVDT_TIME			12<br/>#define I55XML02_EVDT_SZCHAR		2<br/>#define I55XML02_EVDT_MATH_NUMERIC	9<br/>#define I55XML02_EVDT_INTEGER		15<br/>#define I55XML02_EVDT_AMOUNT		10<br/><br/><br/><br/><br/><br/>/* File Structure */<br/><br/>typedef struct<br/>{<br/>  JCHAR              szEdiUserId[11];                     <br/>  JCHAR              szEdiBatchNumber[16];                <br/>  JCHAR              szEdiTransactNumber[23];             <br/>  MATH_NUMERIC      mnEdiLineNumber; <br/>  JCHAR              szXMLInternalReference[61];<br/>  JCHAR              szXMLFileContainerPath[256];<br/>  JCHAR*				szXMLString;<br/>  JCHAR				cXMLStringAlloc;<br/>  JCHAR              cSuppressErrorMessage;               <br/>  long				lBlobSize;<br/>  JCHAR              szErrorMessageID[11]; <br/>  JCHAR              szXMLErrorCode[4];<br/>  JCHAR              szErrorReason[3];                    <br/>} DSI55XML01ZFILE, *LPDSI55XML01ZFILE;<br/><br/><br/><br/><br/><br/><br/>/* File Structure */<br/><br/>typedef struct<br/>{<br/>  JCHAR              szEdiUserId[11];                     <br/>  JCHAR              szEdiBatchNumber[16];                <br/>  JCHAR              szEdiTransactNumber[23];             <br/>  MATH_NUMERIC      mnEdiLineNumber; <br/>  JCHAR              szXMLInternalReference[61];<br/>  JCHAR              szXMLFileContainerPath[256]; <br/>  JCHAR				cTemporalFile_YN;<br/>  JCHAR              szXMLFullFileName[256]; <br/>  JCHAR              szXMLFileName[256];  <br/>} DSI55XML01FILE, *LPDSI55XML01FILE;<br/><br/><br/><br/><br/>/*****************************************<br/> * TYPEDEF for Data Structure<br/> *    Template Name: Bus. Function DS DE70X01<br/> *    Template ID:   DE70X01<br/> *    Generated:     Wed Feb 14 12:59:15 2007<br/> *<br/> * DO NOT EDIT THE FOLLOWING TYPEDEF<br/> *    To make modifications, use the OneWorld Data Structure<br/> *    Tool to Generate a revised version, and paste from<br/> *    the clipboard.<br/> *<br/> **************************************/<br/><br/>#ifndef DATASTRUCTURE_DE55X01<br/>#define DATASTRUCTURE_DE55X01<br/><br/>typedef struct tagDSDE55X01<br/>{<br/>  JCHAR              szErrorReason[3];                    <br/>} DSDE55X01, *LPDSDE55X01;<br/><br/>#define IDERRszErrorReason_1                      1L<br/><br/>#endif<br/><br/><br/>/*****************************************************************************<br/> * Structure Definitions<br/> ****************************************************************************/<br/><br/><br/>/*****************************************<br/> * TYPEDEF for Data Structure<br/> *    Template Name: XML Create Document<br/> *    Template ID:   D70XML01A<br/> *    Generated:     Tue Feb 13 13:41:06 2007<br/> *<br/> * DO NOT EDIT THE FOLLOWING TYPEDEF<br/> *    To make modifications, use the OneWorld Data Structure<br/> *    Tool to Generate a revised version, and paste from<br/> *    the clipboard.<br/> *<br/> **************************************/<br/><br/>#ifndef DATASTRUCTURE_D55XML01A<br/>#define DATASTRUCTURE_D55XML01A<br/><br/>typedef struct tagDSD55XML01A<br/>{<br/>  JCHAR              szDocumentName[257];                 <br/>  ID                idDoc;                               <br/>  ID                idDocElement;                        <br/>  JCHAR              cErrorCode;                          <br/>  ID                idAPIs;                              <br/>  JCHAR              cSuppressErrorMessage;               <br/>  JCHAR              szErrorMessageID[11];                <br/>} DSD55XML01A, *LPDSD55XML01A;<br/><br/>#define IDERRszDocumentName_1                     1L<br/>#define IDERRidDoc_3                              3L<br/>#define IDERRidDocElement_4                       4L<br/>#define IDERRcErrorCode_6                         6L<br/>#define IDERRidAPIs_8                             8L<br/>#define IDERRcSuppressErrorMessage_9              9L<br/>#define IDERRszErrorMessageID_10                  10L<br/><br/>#endif<br/><br/>/*****************************************<br/> * TYPEDEF for Data Structure<br/> *    Template Name: XML Add Element<br/> *    Template ID:   D70XML01B<br/> *    Generated:     Wed Feb 14 10:45:20 2007<br/> *<br/> * DO NOT EDIT THE FOLLOWING TYPEDEF<br/> *    To make modifications, use the OneWorld Data Structure<br/> *    Tool to Generate a revised version, and paste from<br/> *    the clipboard.<br/> *<br/> **************************************/<br/><br/>#ifndef DATASTRUCTURE_D55XML01B<br/>#define DATASTRUCTURE_D55XML01B<br/><br/>typedef struct tagDSD55XML01B<br/>{<br/>  ID                idDoc;                               <br/>  ID                idParentElement;                     <br/>  JCHAR              szElementName[257];                  <br/>  JCHAR              szElementAttributeName[257];         <br/>  JCHAR              szElementAttributeValue[257];        <br/>  JCHAR              szElementText[257];                  <br/>  JCHAR              cReturnElement;                      <br/>  ID                idNewElement;                        <br/>  JCHAR              cErrorCode;                          <br/>  ID                idAPIs;                              <br/>  JCHAR              cSuppressErrorMessage;               <br/>  JCHAR              szErrorMessageID[11];                <br/>  JCHAR              szXMLAttributeDataType[3];           <br/>  JCHAR              cXMLAttributeCharacter;              <br/>  JDEDATE           jdXMLAttributeDate;                  <br/>  ID                idXMLAttributeInteger;               <br/>  MATH_NUMERIC      mnXMLAttributeNumeric;               <br/>  JCHAR              szXMLElementDataType[3];             <br/>  JCHAR              cXMLElementCharacter;                <br/>  JDEDATE           jdXMLElementDate;                    <br/>  ID                idXMLElementInteger;                 <br/>  MATH_NUMERIC      mnXMLElementNumeric;                 <br/>  ID                idXMLElementLongID;                  <br/>} DSD55XML01B, *LPDSD55XML01B;<br/><br/>#define IDERRidDoc_1                              1L<br/>#define IDERRidParentElement_2                    2L<br/>#define IDERRszElementName_3                      3L<br/>#define IDERRszElementAttributeName_4             4L<br/>#define IDERRszElementAttributeValue_5            5L<br/>#define IDERRszElementText_6                      6L<br/>#define IDERRcReturnElement_7                     7L<br/>#define IDERRidNewElement_9                       9L<br/>#define IDERRcErrorCode_11                        11L<br/>#define IDERRidAPIs_13                            13L<br/>#define IDERRcSuppressErrorMessage_14             14L<br/>#define IDERRszErrorMessageID_15                  15L<br/>#define IDERRszXMLAttributeDataType_16            16L<br/>#define IDERRcXMLAttributeCharacter_17            17L<br/>#define IDERRjdXMLAttributeDate_18                18L<br/>#define IDERRidXMLAttributeInteger_19             19L<br/>#define IDERRmnXMLAttributeNumeric_20             20L<br/>#define IDERRszXMLElementDataType_21              21L<br/>#define IDERRcXMLElementCharacter_22              22L<br/>#define IDERRjdXMLElementDate_23                  23L<br/>#define IDERRidXMLElementInteger_24               24L<br/>#define IDERRmnXMLElementNumeric_25               25L<br/>#define IDERRidXMLElementLongID_26                26L<br/><br/>#endif<br/><br/><br/>/*****************************************<br/> * TYPEDEF for Data Structure<br/> *    Template Name: XML Free Element<br/> *    Template ID:   D70XML01C<br/> *    Generated:     Tue Feb 13 13:41:16 2007<br/> *<br/> * DO NOT EDIT THE FOLLOWING TYPEDEF<br/> *    To make modifications, use the OneWorld Data Structure<br/> *    Tool to Generate a revised version, and paste from<br/> *    the clipboard.<br/> *<br/> **************************************/<br/><br/>#ifndef DATASTRUCTURE_D55XML01C<br/>#define DATASTRUCTURE_D55XML01C<br/><br/>typedef struct tagDSD55XML01C<br/>{<br/>  ID                idElementToFree;                     <br/>  JCHAR              cErrorCode;                          <br/>  ID                idAPIs;                              <br/>  JCHAR              cSuppressErrorMessage;               <br/>  JCHAR              szErrorMessageID[11];                <br/>} DSD55XML01C, *LPDSD55XML01C;<br/><br/>#define IDERRidElementToFree_1                    1L<br/>#define IDERRcErrorCode_4                         4L<br/>#define IDERRidAPIs_6                             6L<br/>#define IDERRcSuppressErrorMessage_7              7L<br/>#define IDERRszErrorMessageID_8                   8L<br/><br/>#endif<br/><br/>/*****************************************<br/> * TYPEDEF for Data Structure<br/> *    Template Name: XML Load APIs<br/> *    Template ID:   D70XML01E<br/> *    Generated:     Tue Feb 13 13:41:30 2007<br/> *<br/> * DO NOT EDIT THE FOLLOWING TYPEDEF<br/> *    To make modifications, use the OneWorld Data Structure<br/> *    Tool to Generate a revised version, and paste from<br/> *    the clipboard.<br/> *<br/> **************************************/<br/><br/>#ifndef DATASTRUCTURE_D55XML01E<br/>#define DATASTRUCTURE_D55XML01E<br/><br/>typedef struct tagDSD55XML01E<br/>{<br/>  JCHAR              cErrorCode;                          <br/>  ID                idAPIs;                              <br/>  JCHAR              cSuppressErrorMessage;               <br/>  JCHAR              szErrorMessageID[11];                <br/>} DSD55XML01E, *LPDSD55XML01E;<br/><br/>#define IDERRcErrorCode_1                         1L<br/>#define IDERRidAPIs_2                             2L<br/>#define IDERRcSuppressErrorMessage_3              3L<br/>#define IDERRszErrorMessageID_4                   4L<br/><br/>#endif<br/><br/>/*****************************************<br/> * TYPEDEF for Data Structure<br/> *    Template Name: XML Does the XML File exist<br/> *    Template ID:   D70XML01D<br/> *    Generated:     Thu Feb 22 12:01:34 2007<br/> *<br/> * DO NOT EDIT THE FOLLOWING TYPEDEF<br/> *    To make modifications, use the OneWorld Data Structure<br/> *    Tool to Generate a revised version, and paste from<br/> *    the clipboard.<br/> *<br/> **************************************/<br/><br/>#ifndef DATASTRUCTURE_D55XML01D<br/>#define DATASTRUCTURE_D55XML01D<br/><br/>typedef struct tagDSD55XML01D<br/>{<br/>  JCHAR              szXMLFileNameWithPath[256];          <br/>  JCHAR              szXMLTemporalPath[256];              <br/>  JCHAR              cGenerateTemporalXMLFileYN;          <br/>  JCHAR              szEdiUserId[11];                     <br/>  JCHAR              szEdiBatchNumber[16];                <br/>  JCHAR              szEdiTransactNumber[23];             <br/>  MATH_NUMERIC      mnEdiLineNumber;                     <br/>  JCHAR              cDoesFinalXMLFileExist;              <br/>  JCHAR              cDoesTemporalXMLFileExist;           <br/>  JCHAR              szTemporalXMLFileWithPath[256];      <br/>  JCHAR              cSuppressErrorMessage;               <br/>  JCHAR              szErrorDataItemCode[11];             <br/>  JCHAR              cErrorCode;                          <br/>  ID                idAPIs;                              <br/>  JCHAR              szXMLInternalReference[61];          <br/>} DSD55XML01D, *LPDSD55XML01D;<br/><br/>#define IDERRszXMLFileNameWithPath_10             10L<br/>#define IDERRszXMLTemporalPath_11                 11L<br/>#define IDERRcGenerateTemporalXMLFileYN_12        12L<br/>#define IDERRszEdiUserId_13                       13L<br/>#define IDERRszEdiBatchNumber_14                  14L<br/>#define IDERRszEdiTransactNumber_15               15L<br/>#define IDERRmnEdiLineNumber_16                   16L<br/>#define IDERRcDoesFinalXMLFileExist_17            17L<br/>#define IDERRcDoesTemporalXMLFileExist_18         18L<br/>#define IDERRszTemporalXMLFileWithPath_19         19L<br/>#define IDERRcSuppressErrorMessage_20             20L<br/>#define IDERRszErrorDataItemCode_21               21L<br/>#define IDERRcErrorCode_22                        22L<br/>#define IDERRidAPIs_23                            23L<br/>#define IDERRszXMLInternalReference_24            24L<br/><br/>#endif<br/><br/><br/><br/>/*****************************************<br/> * TYPEDEF for Data Structure<br/> *    Template Name: XML Write To Z File<br/> *    Template ID:   D70XML01F<br/> *    Generated:     Wed Feb 14 11:02:09 2007<br/> *<br/> * DO NOT EDIT THE FOLLOWING TYPEDEF<br/> *    To make modifications, use the OneWorld Data Structure<br/> *    Tool to Generate a revised version, and paste from<br/> *    the clipboard.<br/> *<br/> **************************************/<br/><br/>#ifndef DATASTRUCTURE_D55XML01F<br/>#define DATASTRUCTURE_D55XML01F<br/><br/>typedef struct tagDSD55XML01F<br/>{<br/>  ID                idDoc;                               <br/>  JCHAR              szFileName[257];                     <br/>  JCHAR              cErrorCode;                          <br/>  ID                idAPIs;                              <br/>  JCHAR              cSuppressErrorMessage;               <br/>  JCHAR              szErrorMessageID[11];                <br/>  JCHAR              cWriteToFileYN;                      <br/>  JCHAR              szXMLFileContainerPath[256];         <br/>  JCHAR              szEdiUserId[11];                     <br/>  JCHAR              szEdiBatchNumber[16];                <br/>  JCHAR              szEdiTransactNumber[23];             <br/>  MATH_NUMERIC      mnEdiLineNumber;                     <br/>  JCHAR              szEdiDocumentType[3];                <br/>  JCHAR              szTypeTransaction[9];                <br/>  JCHAR              szEdiTranslationFormat[11];          <br/>  JDEDATE           jdEdiTransmissionDate;               <br/>  JCHAR              cDirectionIndicator;                 <br/>  MATH_NUMERIC      mnEdiDetailLinesProcess;             <br/>  JCHAR              cEdiSuccessfullyProcess;             <br/>  JCHAR              szTradingPartnerId[16];              <br/>  JCHAR              szTransactionAction[3];              <br/>  JDEDATE           jdXMLDateProcessed;                  <br/>  JCHAR              szXMLTransactionGroup[11];           <br/>  JCHAR              szXMLInternalReference[61];          <br/>  JCHAR              szXMLAditionalCode[11];              <br/>  JCHAR              cXMLDocumentStatus;                  <br/>  JCHAR              szXMLVersion[5];                     <br/>  JCHAR              szXMLAttributeStrGeneric1[61];       <br/>  JCHAR              szXMLAttributeStrGeneric2[61];       <br/>  JCHAR              szXMLAttributeStrGeneric3[101];      <br/>  MATH_NUMERIC      mnXMLAttributeNumGeneric1;           <br/>  MATH_NUMERIC      mnXMLAttributeNumGeneric2;           <br/>  MATH_NUMERIC      mnXMLAttributeNumGeneric3;           <br/>  JDEDATE           jdXMLAttributeDatGeneric1;           <br/>  JDEDATE           jdXMLAttributeDatGeneric2;           <br/>  JDEDATE           jdXMLAttributeDatGeneric3;           <br/>  ID                idXMLAttributeIntGeneric1;           <br/>  JCHAR              cXMLAttributeChrGeneric1;            <br/>  JCHAR              cXMLAttributeChrGeneric2;            <br/>  JCHAR              cXMLAttributeChrGeneric3;            <br/>  MATH_NUMERIC      mnXMLAddressNumber;                  <br/>  JCHAR              szXMLCostCenter[13];                 <br/>  JCHAR              szXMLCompany[6];                     <br/>  JCHAR              szXMLDocumentType[3];                <br/>  JCHAR              szUserReservedCode[3];               <br/>  JDEDATE           jdUserReservedDate;                  <br/>  MATH_NUMERIC      mnUserReservedAmount;                <br/>  MATH_NUMERIC      mnUserReservedNumber;                <br/>  JCHAR              szUserReservedReference[16];         <br/>  JCHAR              szTransactionOriginator[11];         <br/>  JCHAR              szUserId[11];                        <br/>  JCHAR              szProgramId[11];                     <br/>  JCHAR              szWorkStationId[11];                 <br/>  JDEDATE           jdDateUpdated;                       <br/>  MATH_NUMERIC      mnTimeLastUpdated;                   <br/>} DSD55XML01F, *LPDSD55XML01F;<br/><br/>#define IDERRidDoc_1                              1L<br/>#define IDERRszFileName_2                         2L<br/>#define IDERRcErrorCode_5                         5L<br/>#define IDERRidAPIs_7                             7L<br/>#define IDERRcSuppressErrorMessage_8              8L<br/>#define IDERRszErrorMessageID_9                   9L<br/>#define IDERRcWriteToFileYN_10                    10L<br/>#define IDERRszXMLFileContainerPath_11            11L<br/>#define IDERRszEdiUserId_12                       12L<br/>#define IDERRszEdiBatchNumber_13                  13L<br/>#define IDERRszEdiTransactNumber_14               14L<br/>#define IDERRmnEdiLineNumber_15                   15L<br/>#define IDERRszEdiDocumentType_16                 16L<br/>#define IDERRszTypeTransaction_17                 17L<br/>#define IDERRszEdiTranslationFormat_18            18L<br/>#define IDERRjdEdiTransmissionDate_19             19L<br/>#define IDERRcDirectionIndicator_20               20L<br/>#define IDERRmnEdiDetailLinesProcess_21           21L<br/>#define IDERRcEdiSuccessfullyProcess_22           22L<br/>#define IDERRszTradingPartnerId_23                23L<br/>#define IDERRszTransactionAction_24               24L<br/>#define IDERRjdXMLDateProcessed_25                25L<br/>#define IDERRszXMLTransactionGroup_26             26L<br/>#define IDERRszXMLInternalReference_27            27L<br/>#define IDERRszXMLAditionalCode_28                28L<br/>#define IDERRcXMLDocumentStatus_29                29L<br/>#define IDERRszXMLVersion_30                      30L<br/>#define IDERRszXMLAttributeStrGeneric1_32         32L<br/>#define IDERRszXMLAttributeStrGeneric2_33         33L<br/>#define IDERRszXMLAttributeStrGeneric3_34         34L<br/>#define IDERRmnXMLAttributeNumGeneric1_35         35L<br/>#define IDERRmnXMLAttributeNumGeneric2_36         36L<br/>#define IDERRmnXMLAttributeNumGeneric3_37         37L<br/>#define IDERRjdXMLAttributeDatGeneric1_38         38L<br/>#define IDERRjdXMLAttributeDatGeneric2_39         39L<br/>#define IDERRjdXMLAttributeDatGeneric3_40         40L<br/>#define IDERRidXMLAttributeIntGeneric1_41         41L<br/>#define IDERRcXMLAttributeChrGeneric1_42          42L<br/>#define IDERRcXMLAttributeChrGeneric2_43          43L<br/>#define IDERRcXMLAttributeChrGeneric3_45          45L<br/>#define IDERRmnXMLAddressNumber_46                46L<br/>#define IDERRszXMLCostCenter_47                   47L<br/>#define IDERRszXMLCompany_48                      48L<br/>#define IDERRszXMLDocumentType_49                 49L<br/>#define IDERRszUserReservedCode_50                50L<br/>#define IDERRjdUserReservedDate_51                51L<br/>#define IDERRmnUserReservedAmount_52              52L<br/>#define IDERRmnUserReservedNumber_53              53L<br/>#define IDERRszUserReservedReference_54           54L<br/>#define IDERRszTransactionOriginator_55           55L<br/>#define IDERRszUserId_56                          56L<br/>#define IDERRszProgramId_57                       57L<br/>#define IDERRszWorkStationId_58                   58L<br/>#define IDERRjdDateUpdated_59                     59L<br/>#define IDERRmnTimeLastUpdated_60                 60L<br/><br/>#endif<br/><br/><br/>/*****************************************<br/> * TYPEDEF for Data Structure<br/> *    Template Name: XML Free Document<br/> *    Template ID:   D70XML01G<br/> *    Generated:     Wed Feb 14 15:04:51 2007<br/> *<br/> * DO NOT EDIT THE FOLLOWING TYPEDEF<br/> *    To make modifications, use the OneWorld Data Structure<br/> *    Tool to Generate a revised version, and paste from<br/> *    the clipboard.<br/> *<br/> **************************************/<br/><br/>#ifndef DATASTRUCTURE_D55XML01G<br/>#define DATASTRUCTURE_D55XML01G<br/><br/>typedef struct tagDSD55XML01G<br/>{<br/>  JCHAR              szDocumentName[257];                 <br/>  ID                idDoc;                               <br/>  ID                idDocElement;                        <br/>  JCHAR              cErrorCode;                          <br/>  ID                idAPIs;                              <br/>  JCHAR              cSuppressErrorMessage;               <br/>  JCHAR              szErrorMessageID[11];                <br/>} DSD55XML01G, *LPDSD55XML01G;<br/><br/>#define IDERRszDocumentName_1                     1L<br/>#define IDERRidDoc_3                              3L<br/>#define IDERRidDocElement_4                       4L<br/>#define IDERRcErrorCode_6                         6L<br/>#define IDERRidAPIs_8                             8L<br/>#define IDERRcSuppressErrorMessage_9              9L<br/>#define IDERRszErrorMessageID_10                  10L<br/><br/>#endif<br/>/*****************************************<br/> * TYPEDEF for Data Structure<br/> *    Template Name: XML Get Element Value by Name<br/> *    Template ID:   D70XML01H<br/> *    Generated:     Thu Feb 22 11:31:10 2007<br/> *<br/> * DO NOT EDIT THE FOLLOWING TYPEDEF<br/> *    To make modifications, use the OneWorld Data Structure<br/> *    Tool to Generate a revised version, and paste from<br/> *    the clipboard.<br/> *<br/> **************************************/<br/><br/>#ifndef DATASTRUCTURE_D55XML01H<br/>#define DATASTRUCTURE_D55XML01H<br/><br/>typedef struct tagDSD55XML01H<br/>{<br/>  ID                idAPIs;                              <br/>  JCHAR              szElementName[257];                  <br/>  JCHAR              szElementValueToCompare[257];        <br/>  JCHAR              szElementValueFound[257];            <br/>  JCHAR              cMatchValue_YN;                      <br/>  JCHAR              cSuppressErrorMessage;               <br/>  JCHAR              szErrorDataItemCode[11];             <br/>  JCHAR              cErrorCode;                          <br/>  ID                idDoc;                               <br/>  ID                idDocElement;                        <br/>} DSD55XML01H, *LPDSD55XML01H;<br/><br/>#define IDERRidAPIs_27                            27L<br/>#define IDERRszElementName_30                     30L<br/>#define IDERRszElementValueToCompare_31           31L<br/>#define IDERRszElementValueFound_32               32L<br/>#define IDERRcMatchValue_YN_33                    33L<br/>#define IDERRcSuppressErrorMessage_34             34L<br/>#define IDERRszErrorDataItemCode_35               35L<br/>#define IDERRcErrorCode_36                        36L<br/>#define IDERRidDoc_41                             41L<br/>#define IDERRidDocElement_42                      42L<br/><br/>#endif<br/>/*****************************************<br/> * TYPEDEF for Data Structure<br/> *    Template Name: Bus. Function DS D70XML01I<br/> *    Template ID:   D70XML01I<br/> *    Generated:     Fri Feb 23 13:40:17 2007<br/> *<br/> * DO NOT EDIT THE FOLLOWING TYPEDEF<br/> *    To make modifications, use the OneWorld Data Structure<br/> *    Tool to Generate a revised version, and paste from<br/> *    the clipboard.<br/> *<br/> **************************************/<br/><br/>#ifndef DATASTRUCTURE_D55XML01I<br/>#define DATASTRUCTURE_D55XML01I<br/><br/>typedef struct tagDSD55XML01I<br/>{<br/>  JCHAR              szEdiUserId[11];                     <br/>  JCHAR              szEdiBatchNumber[16];                <br/>  JCHAR              szEdiTransactNumber[23];             <br/>  MATH_NUMERIC      mnEdiLineNumber;                     <br/>  ID                idAPIs;                              <br/>  ID                idDoc;                               <br/>  ID                idDocElement;                        <br/>  JCHAR              cSuppressErrorMessage;               <br/>  JCHAR              szErrorMessageID[11];                <br/>  JCHAR              cErrorCode;                          <br/>  JCHAR              cTakeXMLfromFileYN;                  <br/>  JCHAR              szXMLErrorCode[4];                   <br/>} DSD55XML01I, *LPDSD55XML01I;<br/><br/>#define IDERRszEdiUserId_1                        1L<br/>#define IDERRszEdiBatchNumber_2                   2L<br/>#define IDERRszEdiTransactNumber_3                3L<br/>#define IDERRmnEdiLineNumber_4                    4L<br/>#define IDERRidAPIs_5                             5L<br/>#define IDERRidDoc_6                              6L<br/>#define IDERRidDocElement_7                       7L<br/>#define IDERRcSuppressErrorMessage_8              8L<br/>#define IDERRszErrorMessageID_9                   9L<br/>#define IDERRcErrorCode_10                        10L<br/>#define IDERRcTakeXMLfromFileYN_11                11L<br/>#define IDERRszXMLErrorCode_12                    12L<br/><br/>#endif<br/><br/>/*****************************************<br/> * TYPEDEF for Data Structure<br/> *    Template Name: XML Update Z File<br/> *    Template ID:   D70XML01J<br/> *    Generated:     Thu Mar 08 12:33:13 2007<br/> *<br/> * DO NOT EDIT THE FOLLOWING TYPEDEF<br/> *    To make modifications, use the OneWorld Data Structure<br/> *    Tool to Generate a revised version, and paste from<br/> *    the clipboard.<br/> *<br/> **************************************/<br/><br/>#ifndef DATASTRUCTURE_D55XML01J<br/>#define DATASTRUCTURE_D55XML01J<br/><br/>typedef struct tagDSD55XML01J<br/>{<br/>  ID                idDoc;                               <br/>  JCHAR              cErrorCode;                          <br/>  ID                idAPIs;                              <br/>  JCHAR              cSuppressErrorMessage;               <br/>  JCHAR              szErrorMessageID[11];                <br/>  JCHAR              cWriteToFileYN;                      <br/>  JCHAR              szXMLFileContainerPath[256];         <br/>  JCHAR              szEdiUserId[11];                     <br/>  JCHAR              szEdiBatchNumber[16];                <br/>  JCHAR              szEdiTransactNumber[23];             <br/>  MATH_NUMERIC      mnEdiLineNumber;                     <br/>  JCHAR              szEdiDocumentType[3];                <br/>  JCHAR              szTypeTransaction[9];                <br/>  JCHAR              szEdiTranslationFormat[11];          <br/>  JDEDATE           jdEdiTransmissionDate;               <br/>  JCHAR              cDirectionIndicator;                 <br/>  MATH_NUMERIC      mnEdiDetailLinesProcess;             <br/>  JCHAR              cEdiSuccessfullyProcess;             <br/>  JCHAR              szTradingPartnerId[16];              <br/>  JCHAR              szTransactionAction[3];              <br/>  JDEDATE           jdXMLDateProcessed;                  <br/>  JCHAR              szXMLTransactionGroup[11];           <br/>  JCHAR              szXMLInternalReference[61];          <br/>  JCHAR              szXMLAditionalCode[11];              <br/>  JCHAR              cXMLDocumentStatus;                  <br/>  JCHAR              szXMLVersion[5];                     <br/>  JCHAR              szXMLAttributeStrGeneric1[61];       <br/>  JCHAR              szXMLAttributeStrGeneric2[61];       <br/>  JCHAR              szXMLAttributeStrGeneric3[61];      <br/>  MATH_NUMERIC      mnXMLAttributeNumGeneric1;           <br/>  MATH_NUMERIC      mnXMLAttributeNumGeneric2;           <br/>  MATH_NUMERIC      mnXMLAttributeNumGeneric3;           <br/>  JDEDATE           jdXMLAttributeDatGeneric1;           <br/>  JDEDATE           jdXMLAttributeDatGeneric2;           <br/>  JDEDATE           jdXMLAttributeDatGeneric3;           <br/>  ID                idXMLAttributeIntGeneric1;           <br/>  JCHAR              cXMLAttributeChrGeneric1;            <br/>  JCHAR              cXMLAttributeChrGeneric2;            <br/>  JCHAR              cXMLAttributeChrGeneric3;            <br/>  MATH_NUMERIC      mnXMLAddressNumber;                  <br/>  JCHAR              szXMLCostCenter[13];                 <br/>  JCHAR              szXMLCompany[6];                     <br/>  JCHAR              szXMLDocumentType[3];                <br/>  JCHAR              szUserReservedCode[3];               <br/>  JDEDATE           jdUserReservedDate;                  <br/>  MATH_NUMERIC      mnUserReservedAmount;                <br/>  MATH_NUMERIC      mnUserReservedNumber;                <br/>  JCHAR              szUserReservedReference[16];         <br/>  JCHAR              szTransactionOriginator[11];         <br/>  JCHAR              szUserId[11];                        <br/>  JCHAR              szProgramId[11];                     <br/>  JCHAR              szWorkStationId[11];                 <br/>  JDEDATE           jdDateUpdated;                       <br/>  MATH_NUMERIC      mnTimeLastUpdated;                   <br/>  JCHAR              szXMLErrorCode[4];                   <br/>  JCHAR              cUpdateBlobYN;                       <br/>  JCHAR              szXMLNewErrorCode[4];                <br/>} DSD55XML01J, *LPDSD55XML01J;<br/><br/>#define IDERRidDoc_1                              1L<br/>#define IDERRcErrorCode_5                         5L<br/>#define IDERRidAPIs_7                             7L<br/>#define IDERRcSuppressErrorMessage_8              8L<br/>#define IDERRszErrorMessageID_9                   9L<br/>#define IDERRcWriteToFileYN_10                    10L<br/>#define IDERRszXMLFileContainerPath_11            11L<br/>#define IDERRszEdiUserId_12                       12L<br/>#define IDERRszEdiBatchNumber_13                  13L<br/>#define IDERRszEdiTransactNumber_14               14L<br/>#define IDERRmnEdiLineNumber_15                   15L<br/>#define IDERRszEdiDocumentType_16                 16L<br/>#define IDERRszTypeTransaction_17                 17L<br/>#define IDERRszEdiTranslationFormat_18            18L<br/>#define IDERRjdEdiTransmissionDate_19             19L<br/>#define IDERRcDirectionIndicator_20               20L<br/>#define IDERRmnEdiDetailLinesProcess_21           21L<br/>#define IDERRcEdiSuccessfullyProcess_22           22L<br/>#define IDERRszTradingPartnerId_23                23L<br/>#define IDERRszTransactionAction_24               24L<br/>#define IDERRjdXMLDateProcessed_25                25L<br/>#define IDERRszXMLTransactionGroup_26             26L<br/>#define IDERRszXMLInternalReference_27            27L<br/>#define IDERRszXMLAditionalCode_28                28L<br/>#define IDERRcXMLDocumentStatus_29                29L<br/>#define IDERRszXMLVersion_30                      30L<br/>#define IDERRszXMLAttributeStrGeneric1_32         32L<br/>#define IDERRszXMLAttributeStrGeneric2_33         33L<br/>#define IDERRszXMLAttributeStrGeneric3_34         34L<br/>#define IDERRmnXMLAttributeNumGeneric1_35         35L<br/>#define IDERRmnXMLAttributeNumGeneric2_36         36L<br/>#define IDERRmnXMLAttributeNumGeneric3_37         37L<br/>#define IDERRjdXMLAttributeDatGeneric1_38         38L<br/>#define IDERRjdXMLAttributeDatGeneric2_39         39L<br/>#define IDERRjdXMLAttributeDatGeneric3_40         40L<br/>#define IDERRidXMLAttributeIntGeneric1_41         41L<br/>#define IDERRcXMLAttributeChrGeneric1_42          42L<br/>#define IDERRcXMLAttributeChrGeneric2_43          43L<br/>#define IDERRcXMLAttributeChrGeneric3_45          45L<br/>#define IDERRmnXMLAddressNumber_46                46L<br/>#define IDERRszXMLCostCenter_47                   47L<br/>#define IDERRszXMLCompany_48                      48L<br/>#define IDERRszXMLDocumentType_49                 49L<br/>#define IDERRszUserReservedCode_50                50L<br/>#define IDERRjdUserReservedDate_51                51L<br/>#define IDERRmnUserReservedAmount_52              52L<br/>#define IDERRmnUserReservedNumber_53              53L<br/>#define IDERRszUserReservedReference_54           54L<br/>#define IDERRszTransactionOriginator_55           55L<br/>#define IDERRszUserId_56                          56L<br/>#define IDERRszProgramId_57                       57L<br/>#define IDERRszWorkStationId_58                   58L<br/>#define IDERRjdDateUpdated_59                     59L<br/>#define IDERRmnTimeLastUpdated_60                 60L<br/>#define IDERRszXMLErrorCode_61                    61L<br/>#define IDERRcUpdateBlobYN_62                     62L<br/>#define IDERRszXMLNewErrorCode_63                 63L<br/><br/>#endif<br/><br/>/*****************************************<br/> * TYPEDEF for Data Structure<br/> *    Template Name: XML Get Element By Tag Name - G70<br/> *    Template ID:   D70XML01K<br/> *    Generated:     Wed Feb 28 13:06:07 2007<br/> *<br/> * DO NOT EDIT THE FOLLOWING TYPEDEF<br/> *    To make modifications, use the OneWorld Data Structure<br/> *    Tool to Generate a revised version, and paste from<br/> *    the clipboard.<br/> *<br/> **************************************/<br/><br/>#ifndef DATASTRUCTURE_D55XML01K<br/>#define DATASTRUCTURE_D55XML01K<br/><br/>typedef struct tagDSD55XML01K<br/>{<br/>  ID                idAPIs;                              <br/>  ID                idDoc;                               <br/>  ID                idFromElement;                       <br/>  JCHAR              szElementName[257];                  <br/>  JCHAR              cReturnValueYN;                      <br/>  JCHAR              cIsIDFromElementAnArrayYN;           <br/>  MATH_NUMERIC      mnFromElementNumber;                 <br/>  ID                idArrayElements;                     <br/>  MATH_NUMERIC      mnNumberOfElements;                  <br/>  JCHAR              szElementValue[257];                 <br/>  JCHAR              cSuppressErrorMessage;               <br/>  JCHAR              szErrorMessageID[11];                <br/>  JCHAR              cErrorCode;                          <br/>} DSD55XML01K, *LPDSD55XML01K;<br/><br/>#define IDERRidAPIs_1                             1L<br/>#define IDERRidDoc_2                              2L<br/>#define IDERRidFromElement_3                      3L<br/>#define IDERRszElementName_4                      4L<br/>#define IDERRcReturnValueYN_5                     5L<br/>#define IDERRcIsIDFromElementAnArrayYN_6          6L<br/>#define IDERRmnFromElementNumber_7                7L<br/>#define IDERRidArrayElements_8                    8L<br/>#define IDERRmnNumberOfElements_9                 9L<br/>#define IDERRszElementValue_10                    10L<br/>#define IDERRcSuppressErrorMessage_11             11L<br/>#define IDERRszErrorMessageID_12                  12L<br/>#define IDERRcErrorCode_13                        13L<br/><br/>#endif<br/><br/><br/>/*****************************************<br/> * TYPEDEF for Data Structure<br/> *    Template Name: XML Free Array of Elements - G70<br/> *    Template ID:   D70XML01L<br/> *    Generated:     Wed Feb 28 13:06:25 2007<br/> *<br/> * DO NOT EDIT THE FOLLOWING TYPEDEF<br/> *    To make modifications, use the OneWorld Data Structure<br/> *    Tool to Generate a revised version, and paste from<br/> *    the clipboard.<br/> *<br/> **************************************/<br/><br/>#ifndef DATASTRUCTURE_D55XML01L<br/>#define DATASTRUCTURE_D55XML01L<br/><br/>typedef struct tagDSD55XML01L<br/>{<br/>  ID                idAPIs;                              <br/>  ID                idDoc;                               <br/>  ID                idArrayElements;                     <br/>  MATH_NUMERIC      mnNumberOfElements;                  <br/>  JCHAR              cSuppressErrorMessage;               <br/>  JCHAR              szErrorMessageID[11];                <br/>  JCHAR              cErrorCode;                          <br/>} DSD55XML01L, *LPDSD55XML01L;<br/><br/>#define IDERRidAPIs_1                             1L<br/>#define IDERRidDoc_2                              2L<br/>#define IDERRidArrayElements_8                    8L<br/>#define IDERRmnNumberOfElements_9                 9L<br/>#define IDERRcSuppressErrorMessage_11             11L<br/>#define IDERRszErrorMessageID_12                  12L<br/>#define IDERRcErrorCode_13                        13L<br/><br/>#endif<br/><br/>/* BEGIN SAR 8542525*/<br/><br/>/*****************************************<br/> * TYPEDEF for Data Structure<br/> *    Template Name: XML Create Document From String - G70<br/> *    Template ID:   D70XML01M<br/> *    Generated:     Sat Jul 28 13:44:13 2007<br/> *<br/> * DO NOT EDIT THE FOLLOWING TYPEDEF<br/> *    To make modifications, use the OneWorld Data Structure<br/> *    Tool to Generate a revised version, and paste from<br/> *    the clipboard.<br/> *<br/> **************************************/<br/><br/>#ifndef DATASTRUCTURE_D55XML01M<br/>#define DATASTRUCTURE_D55XML01M<br/><br/>typedef struct tagDSD55XML01M<br/>{<br/>  ID                idAPIs;                              <br/>  ID                idDoc;                               <br/>  ID                idDocElement;                        <br/>  JCHAR             cSuppressErrorMessage;               <br/>  JCHAR             szErrorMessageID[11];                <br/>  JCHAR             cErrorCode;                          <br/>  JCHAR             szXMLErrorCode[4];                   <br/>  ID                idXMLString;                         <br/>} DSD55XML01M, *LPDSD55XML01M;<br/> <br/>#define IDERRidAPIs_5                             5L<br/>#define IDERRidDoc_6                              6L<br/>#define IDERRidDocElement_7                       7L<br/>#define IDERRcSuppressErrorMessage_8              8L<br/>#define IDERRszErrorMessageID_9                   9L<br/>#define IDERRcErrorCode_10                        10L<br/>#define IDERRszXMLErrorCode_12                    12L<br/>#define IDERRidXMLString_13                       13L<br/><br/>#endif<br/><br/><br/>/*****************************************<br/> * TYPEDEF for Data Structure<br/> *    Template Name: XML Serialize Document To XMLString - G70<br/> *    Template ID:   D70XML01N<br/> *    Generated:     Mon Jul 30 08:15:11 2007<br/> *<br/> * DO NOT EDIT THE FOLLOWING TYPEDEF<br/> *    To make modifications, use the OneWorld Data Structure<br/> *    Tool to Generate a revised version, and paste from<br/> *    the clipboard.<br/> *<br/> **************************************/<br/><br/>#ifndef DATASTRUCTURE_D55XML01N<br/>#define DATASTRUCTURE_D55XML01N<br/><br/>typedef struct tagDSD55XML01N<br/>{<br/>  ID                idDoc;                               <br/>  JCHAR             cSuppressErrorMessage;               <br/>  JCHAR             szErrorMessageID[11];                <br/>  JCHAR             cErrorCode;                          <br/>  JCHAR             szXMLErrorCode[4];                   <br/>  ID                idXMLString;                         <br/>  ID                idApis;                              <br/>  JCHAR             cActionCode;                         <br/>} DSD55XML01N, *LPDSD55XML01N;<br/> <br/>#define IDERRidDoc_6                              6L<br/>#define IDERRcSuppressErrorMessage_8              8L<br/>#define IDERRszErrorMessageID_9                   9L<br/>#define IDERRcErrorCode_10                        10L<br/>#define IDERRszXMLErrorCode_12                    12L<br/>#define IDERRidXMLString_13                       13L<br/>#define IDERRidApis_14                            14L<br/>#define IDERRcActionCode_15                       15L<br/><br/>#endif<br/>/* EN SAR 8542525*/<br/><br/>/* BEGIN SAR 8666675 */<br/>/*****************************************<br/> * TYPEDEF for Data Structure<br/> *    Template Name: XML Write To Z File -UTF8-No Hyphen<br/> *    Template ID:   D70XML01P<br/> *    Generated:     Tue Dec 11 02:05:21 2007<br/> *<br/> * DO NOT EDIT THE FOLLOWING TYPEDEF<br/> *    To make modifications, use the OneWorld Data Structure<br/> *    Tool to Generate a revised version, and paste from<br/> *    the clipboard.<br/> *<br/> **************************************/<br/><br/>#ifndef DATASTRUCTURE_D55XML01P<br/>#define DATASTRUCTURE_D55XML01P<br/><br/>typedef struct tagDSD55XML01P<br/>{<br/>  ID                idDoc;                               <br/>  JCHAR             szFileName[257];                     <br/>  JCHAR             cErrorCode;                          <br/>  ID                idAPIs;                              <br/>  JCHAR             cSuppressErrorMessage;               <br/>  JCHAR             szErrorMessageID[11];                <br/>  JCHAR             cWriteToFileYN;                      <br/>  JCHAR             szXMLFileContainerPath[256];         <br/>  JCHAR             szEdiUserId[11];                     <br/>  JCHAR             szEdiBatchNumber[16];                <br/>  JCHAR             szEdiTransactNumber[23];             <br/>  MATH_NUMERIC      mnEdiLineNumber;                     <br/>  JCHAR             szEdiDocumentType[3];                <br/>  JCHAR             szTypeTransaction[9];                <br/>  JCHAR             szEdiTranslationFormat[11];          <br/>  JDEDATE           jdEdiTransmissionDate;               <br/>  JCHAR             cDirectionIndicator;                 <br/>  MATH_NUMERIC      mnEdiDetailLinesProcess;             <br/>  JCHAR             cEdiSuccessfullyProcess;             <br/>  JCHAR             szTradingPartnerId[16];              <br/>  JCHAR             szTransactionAction[3];              <br/>  JDEDATE           jdXMLDateProcessed;                  <br/>  JCHAR             szXMLTransactionGroup[11];           <br/>  JCHAR             szXMLInternalReference[61];          <br/>  JCHAR             szXMLAditionalCode[11];              <br/>  JCHAR             cXMLDocumentStatus;                  <br/>  JCHAR             szXMLVersion[5];                     <br/>  JCHAR             szXMLAttributeStrGeneric1[61];       <br/>  JCHAR             szXMLAttributeStrGeneric2[61];       <br/>  JCHAR             szXMLAttributeStrGeneric3[101];      <br/>  MATH_NUMERIC      mnXMLAttributeNumGeneric1;           <br/>  MATH_NUMERIC      mnXMLAttributeNumGeneric2;           <br/>  MATH_NUMERIC      mnXMLAttributeNumGeneric3;           <br/>  JDEDATE           jdXMLAttributeDatGeneric1;           <br/>  JDEDATE           jdXMLAttributeDatGeneric2;           <br/>  JDEDATE           jdXMLAttributeDatGeneric3;           <br/>  ID                idXMLAttributeIntGeneric1;           <br/>  JCHAR             cXMLAttributeChrGeneric1;            <br/>  JCHAR             cXMLAttributeChrGeneric2;            <br/>  JCHAR             cXMLAttributeChrGeneric3;            <br/>  MATH_NUMERIC      mnXMLAddressNumber;                  <br/>  JCHAR             szXMLCostCenter[13];                 <br/>  JCHAR             szXMLCompany[6];                     <br/>  JCHAR             szXMLDocumentType[3];                <br/>  JCHAR             szUserReservedCode[3];               <br/>  JDEDATE           jdUserReservedDate;                  <br/>  MATH_NUMERIC      mnUserReservedAmount;                <br/>  MATH_NUMERIC      mnUserReservedNumber;                <br/>  JCHAR             szUserReservedReference[16];         <br/>  JCHAR             szTransactionOriginator[11];         <br/>  JCHAR             szUserId[11];                        <br/>  JCHAR             szProgramId[11];                     <br/>  JCHAR             szWorkStationId[11];                 <br/>  JDEDATE           jdDateUpdated;                       <br/>  MATH_NUMERIC      mnTimeLastUpdated;                   <br/>} DSD55XML01P, *LPDSD55XML01P;<br/> <br/>#define IDERRidDoc_1                              1L<br/>#define IDERRszFileName_2                         2L<br/>#define IDERRcErrorCode_5                         5L<br/>#define IDERRidAPIs_7                             7L<br/>#define IDERRcSuppressErrorMessage_8              8L<br/>#define IDERRszErrorMessageID_9                   9L<br/>#define IDERRcWriteToFileYN_10                    10L<br/>#define IDERRszXMLFileContainerPath_11            11L<br/>#define IDERRszEdiUserId_12                       12L<br/>#define IDERRszEdiBatchNumber_13                  13L<br/>#define IDERRszEdiTransactNumber_14               14L<br/>#define IDERRmnEdiLineNumber_15                   15L<br/>#define IDERRszEdiDocumentType_16                 16L<br/>#define IDERRszTypeTransaction_17                 17L<br/>#define IDERRszEdiTranslationFormat_18            18L<br/>#define IDERRjdEdiTransmissionDate_19             19L<br/>#define IDERRcDirectionIndicator_20               20L<br/>#define IDERRmnEdiDetailLinesProcess_21           21L<br/>#define IDERRcEdiSuccessfullyProcess_22           22L<br/>#define IDERRszTradingPartnerId_23                23L<br/>#define IDERRszTransactionAction_24               24L<br/>#define IDERRjdXMLDateProcessed_25                25L<br/>#define IDERRszXMLTransactionGroup_26             26L<br/>#define IDERRszXMLInternalReference_27            27L<br/>#define IDERRszXMLAditionalCode_28                28L<br/>#define IDERRcXMLDocumentStatus_29                29L<br/>#define IDERRszXMLVersion_30                      30L<br/>#define IDERRszXMLAttributeStrGeneric1_32         32L<br/>#define IDERRszXMLAttributeStrGeneric2_33         33L<br/>#define IDERRszXMLAttributeStrGeneric3_34         34L<br/>#define IDERRmnXMLAttributeNumGeneric1_35         35L<br/>#define IDERRmnXMLAttributeNumGeneric2_36         36L<br/>#define IDERRmnXMLAttributeNumGeneric3_37         37L<br/>#define IDERRjdXMLAttributeDatGeneric1_38         38L<br/>#define IDERRjdXMLAttributeDatGeneric2_39         39L<br/>#define IDERRjdXMLAttributeDatGeneric3_40         40L<br/>#define IDERRidXMLAttributeIntGeneric1_41         41L<br/>#define IDERRcXMLAttributeChrGeneric1_42          42L<br/>#define IDERRcXMLAttributeChrGeneric2_43          43L<br/>#define IDERRcXMLAttributeChrGeneric3_45          45L<br/>#define IDERRmnXMLAddressNumber_46                46L<br/>#define IDERRszXMLCostCenter_47                   47L<br/>#define IDERRszXMLCompany_48                      48L<br/>#define IDERRszXMLDocumentType_49                 49L<br/>#define IDERRszUserReservedCode_50                50L<br/>#define IDERRjdUserReservedDate_51                51L<br/>#define IDERRmnUserReservedAmount_52              52L<br/>#define IDERRmnUserReservedNumber_53              53L<br/>#define IDERRszUserReservedReference_54           54L<br/>#define IDERRszTransactionOriginator_55           55L<br/>#define IDERRszUserId_56                          56L<br/>#define IDERRszProgramId_57                       57L<br/>#define IDERRszWorkStationId_58                   58L<br/>#define IDERRjdDateUpdated_59                     59L<br/>#define IDERRmnTimeLastUpdated_60                 60L<br/><br/>#endif<br/><br/><br/>/*****************************************<br/> * TYPEDEF for Data Structure<br/> *    Template Name: XML Create Document -With Attributes<br/> *    Template ID:   D70XML01O<br/> *    Generated:     Tue Dec 11 02:12:49 2007<br/> *<br/> * DO NOT EDIT THE FOLLOWING TYPEDEF<br/> *    To make modifications, use the OneWorld Data Structure<br/> *    Tool to Generate a revised version, and paste from<br/> *    the clipboard.<br/> *<br/> **************************************/<br/><br/>#ifndef DATASTRUCTURE_D55XML01O<br/>#define DATASTRUCTURE_D55XML01O<br/><br/>typedef struct tagDSD55XML01O<br/>{<br/>  JCHAR             szDocumentName[257];                 <br/>  ID                idDoc;                               <br/>  ID                idDocElement;                        <br/>  JCHAR             cErrorCode;                          <br/>  ID                idAPIs;                              <br/>  JCHAR             cSuppressErrorMessage;               <br/>  JCHAR             szErrorMessageID[11];                <br/>  JCHAR             szAttribute1Name[257];               <br/>  JCHAR             szAttribute2Name[257];               <br/>  JCHAR             szAttribute1Value[257];              <br/>  JCHAR             szAttribute2Value[257];              <br/>  JCHAR             szAttribute3Name[257];               <br/>  JCHAR             szAttribute3Value[257];              <br/>  JCHAR             szAttribute4Name[257];               <br/>  JCHAR             szAttribute4Value[257];              <br/>  JCHAR             szAttribute5Name[257];               <br/>  JCHAR             szAttribute5Value[257];              <br/>  JCHAR             szAttribute6Name[257];               <br/>  JCHAR             szAttribute6Value[257];              <br/>} DSD55XML01O, *LPDSD55XML01O;<br/> <br/>#define IDERRszDocumentName_1                     1L<br/>#define IDERRidDoc_3                              3L<br/>#define IDERRidDocElement_4                       4L<br/>#define IDERRcErrorCode_6                         6L<br/>#define IDERRidAPIs_8                             8L<br/>#define IDERRcSuppressErrorMessage_9              9L<br/>#define IDERRszErrorMessageID_10                  10L<br/>#define IDERRszAttribute1Name_11                  11L<br/>#define IDERRszAttribute2Name_12                  12L<br/>#define IDERRszAttribute1Value_13                 13L<br/>#define IDERRszAttribute2Value_14                 14L<br/>#define IDERRszAttribute3Name_15                  15L<br/>#define IDERRszAttribute3Value_16                 16L<br/>#define IDERRszAttribute4Name_17                  17L<br/>#define IDERRszAttribute4Value_18                 18L<br/>#define IDERRszAttribute5Name_19                  19L<br/>#define IDERRszAttribute5Value_20                 20L<br/>#define IDERRszAttribute6Name_21                  21L<br/>#define IDERRszAttribute6Value_22                 22L<br/><br/>#endif<br/><br/>/* END SAR 8666675 */<br/><br/><br/>/*****************************************************************************<br/> * Source Preprocessor Definitions<br/> ****************************************************************************/<br/>#if defined (JDEBFRTN)<br/>	#undef JDEBFRTN<br/>#endif<br/><br/>#if defined (WIN32)<br/>	#if defined (WIN32)<br/>		#define JDEBFRTN(r) __declspec(dllexport) r<br/>	#else<br/>		#define JDEBFRTN(r) __declspec(dllimport) r<br/>	#endif <br/> #else<br/>	#define JDEBFRTN(r) r<br/>#endif <br/> <br/><br/>/*****************************************************************************<br/> * Business Function Prototypes<br/> ****************************************************************************/<br/>JDEBFRTN (ID) JDEBFWINAPI XMLAddElement_55                (LPBHVRCOM lpBhvrCom, LPVOID lpVoid, LPDSD55XML01B lpDS);<br/>JDEBFRTN (ID) JDEBFWINAPI XMLCreateDocument_55            (LPBHVRCOM lpBhvrCom, LPVOID lpVoid, LPDSD55XML01A lpDS);<br/>JDEBFRTN (ID) JDEBFWINAPI XMLFreeElement_55               (LPBHVRCOM lpBhvrCom, LPVOID lpVoid, LPDSD55XML01C lpDS);<br/>JDEBFRTN (ID) JDEBFWINAPI XMLLoadAPIs_55                  (LPBHVRCOM lpBhvrCom, LPVOID lpVoid, LPDSD55XML01E lpDS);<br/>JDEBFRTN (ID) JDEBFWINAPI XMLUnloadAPIs_55                (LPBHVRCOM lpBhvrCom, LPVOID lpVoid, LPDSD55XML01E lpDS);<br/>JDEBFRTN (ID) JDEBFWINAPI XMLDoesFileExist_55             (LPBHVRCOM lpBhvrCom, LPVOID lpVoid, LPDSD55XML01D lpDS);<br/>JDEBFRTN (ID) JDEBFWINAPI XMLWriteToZFile_55              (LPBHVRCOM lpBhvrCom, LPVOID lpVoid, LPDSD55XML01F lpDS);<br/>JDEBFRTN (ID) JDEBFWINAPI XMLFreeDocument_55              (LPBHVRCOM lpBhvrCom, LPVOID lpVoid, LPDSD55XML01G lpDS);<br/>JDEBFRTN (ID) JDEBFWINAPI XMLGetXMLValueByTagName_55      (LPBHVRCOM lpBhvrCom, LPVOID lpVoid, LPDSD55XML01H lpDS);<br/>JDEBFRTN (ID) JDEBFWINAPI XMLCreateDocumentFromZFile_55   (LPBHVRCOM lpBhvrCom, LPVOID lpVoid, LPDSD55XML01I lpDS);<br/>JDEBFRTN (ID) JDEBFWINAPI XMLUpdateZFile_55               (LPBHVRCOM lpBhvrCom, LPVOID lpVoid, LPDSD55XML01J lpDS);<br/>JDEBFRTN (ID) JDEBFWINAPI XMLGetElementsByTagName_55      (LPBHVRCOM lpBhvrCom, LPVOID lpVoid, LPDSD55XML01K lpDS);<br/>JDEBFRTN (ID) JDEBFWINAPI XMLFreeArrayOfElements_55       (LPBHVRCOM lpBhvrCom, LPVOID lpVoid, LPDSD55XML01L lpDS);<br/>/* BEGIN SAR 8542525*/<br/>JDEBFRTN (ID) JDEBFWINAPI XMLCreateDocumentFromString_55  (LPBHVRCOM lpBhvrCom, LPVOID lpVoid, LPDSD55XML01M lpDS);<br/>JDEBFRTN (ID) JDEBFWINAPI XMLSerializeDocToXMLString_55  (LPBHVRCOM lpBhvrCom, LPVOID lpVoid, LPDSD55XML01N lpDS);<br/>/* END SAR 8542525*/<br/>/* BEGIN SAR 8666675 */<br/>JDEBFRTN (ID) JDEBFWINAPI XMLCreateDocWithAttrib_55 (LPBHVRCOM lpBhvrCom, LPVOID lpVoid, LPDSD55XML01O lpDS);<br/>JDEBFRTN (ID) JDEBFWINAPI XMLWriteToZFile_UTF8_55 (LPBHVRCOM lpBhvrCom, LPVOID lpVoid, LPDSD55XML01P lpDS);<br/>/* END  SAR 8666675 */<br/><br/>/*****************************************************************************<br/> * Internal Function Prototypes<br/> ****************************************************************************/<br/><br/>BOOL I55XML01_GetXMLString(LPBHVRCOM lpBhvrCom,LPVOID lpVoid, HUSER hUser,LPDSI55XML01ZFILE lpF55XMLZ1);<br/>void I55XML01_GenerateXMLFileName (LPBHVRCOM lpBhvrCom,LPVOID lpVoid, HUSER hUser,LPDSI55XML01FILE lpF55XML);<br/>void I55XML01_AppendDirectorySeparator(JCHAR *szPath);<br/>void I55XML01_ConvertMathNumericToAString(LPMATH_NUMERIC lpmnNumber, JCHAR *szReturnString);<br/>void I55XML01_ConvertAmountToAString(LPMATH_NUMERIC lpmnNumber, JCHAR *szReturnString);<br/>void I55XML01_ConvertCharacterToString(JCHAR cCharacterToConvert, JCHAR *szReturnString);<br/>void I55XML01_ConvertDateToString(LPJDEDATE lpjdDateToConvert, JCHAR *szReturnString);<br/>void I55XML01_ConvertTimeToString(int iTimeToConvert, JCHAR *szReturnString);<br/>BOOL I55XML01_DoesXMLFileExists(JCHAR *szXMLFile);<br/>void I55XML01_RemoveIllegalCharacterForAString(PJSTR lpName);<br/>//void I55XML01_RemoveIllegalCharacterForAString(JCHAR *lpName);<br/>void I55XML01_RemoveSurroundingBlanks(JCHAR * szString);<br/>/* BEGIN SAR 8666675 */<br/>void I55XML01_GenerateXMLFileNameWithoutHyphens(LPBHVRCOM lpBhvrCom,LPVOID lpVoid, HUSER hUser,LPDSI55XML01FILE lpF55XML);<br/>/*<br/>static void I55XML02_RightTrimSpaces(JCHAR *szString);<br/>*/<br/>/* END  SAR 8666675 */<br/>#endif    /* __B70XML01_H */<br/><br/></pre><BR/><pre><div class='dstrmembers'><B>Source File: b55xml02.c</B><BR></div>#include &ltjde.h&gt<br/><br/>#define b55xml02_c<br/><br/> <br/>#ifndef IAMASERVER<br/>//#pragma comment(lib,_Z("XMLCWrapper"))<br/>#pragma comment(lib,_Z("XercesWrapper"))<br/>#endif<br/> <br/><br/>/*****************************************************************************<br/> *    Source File:  b70xml01<br/> *<br/> *    Description:  XML common functions for Localization Source File<br/> *<br/> *        History:<br/> *          Date        Programmer  SAR# - Description<br/> *          ----------  ----------  -------------------------------------------<br/> *   Author 13/02/07    FG8307947   8384029  - Created  <br/> *          06/04/07    FG8307947   8498691  - LOC:XML Wrong Element Char <br/> *			28/07/07    CB9051200   8535237  - Create XML Doc from Str / Serialize String<br/> *          12/11/07    IC9018661   8666675  - XML modification for CNAO Project<br/> *<br/> * Copyright (c) J.D. Edwards World Source Company, 1996<br/> *<br/> * This unpublished material is proprietary to J.D. Edwards World Source Company.<br/> * All rights reserved.  The methods and techniques described herein are<br/> * considered trade secrets and/or confidential.  Reproduction or<br/> * distribution, in whole or in part, is forbidden except by express<br/> * written permission of J.D. Edwards World Source Company.<br/> ****************************************************************************/<br/>/**************************************************************************<br/> * Notes:<br/> *<br/> **************************************************************************/<br/><br/>#include &ltxerceswrapper.h&gt<br/>//#include &ltb70xml01.h&gt<br/>//#include &ltxmlcwrapper.h&gt<br/>#include &ltb55xml02.h&gt<br/><br/><br/>/**************************************************************************<br/> *  Business Function:  XMLCreateDocument_55<br/> *<br/> *        Description:  XML Create Document 76B<br/> *<br/> *         Parameters:<br/> *           LPBHVRCOM           lpBhvrCom    Business Function Communications<br/> *           LPVOID              lpVoid       Void Parameter - DO NOT USE!<br/> *           LPDSD70XML01A       lpDS         Parameter Data Structure Pointer  <br/> *<br/> *************************************************************************/<br/><br/>JDEBFRTN (ID) JDEBFWINAPI XMLCreateDocument_55 (LPBHVRCOM lpBhvrCom, LPVOID lpVoid, LPDSD55XML01A lpDS)  <br/>{<br/>   /************************************************************************<br/>    *  Variable declarations<br/>    ************************************************************************/<br/>    ID                idReturn       = ER_SUCCESS;<br/>    ID                idJDBResult    = JDEDB_PASSED;<br/>    HUSER             hUser          = (HUSER)NULL;<br/>    XRCS_Status       xmlcStatus     = XRCS_SUCCESS;<br/>	XRCS_hDocument    hDoc           = (XRCS_hDocument)NULL;<br/>	XRCS_hElement     hDocElement    = (XRCS_hElement)NULL;<br/><br/>//  XMLC_Status       xmlcStatus     = XMLC_SUCCESS;<br/>//	XMLC_hDocument    hDoc           = NULL;<br/>//	XMLC_hElement     hDocElement    = NULL;<br/><br/><br/>   /************************************************************************<br/>    * Declare structures<br/>    ************************************************************************/<br/><br/>	<br/>	DSDE55X01			dsDSDE55X01			= {0};		/* error text substitution structure */<br/><br/>   /************************************************************************<br/>    * Declare pointers<br/>    ************************************************************************/<br/><br/>   /************************************************************************<br/>    * Check for NULL pointers<br/>    ************************************************************************/<br/>   if ((lpBhvrCom == (LPBHVRCOM) NULL) ||<br/>       (lpVoid    == (LPVOID)    NULL) ||<br/>       (lpDS      == (LPDSD55XML01A)	NULL))<br/>   {<br/>     jdeErrorSet (lpBhvrCom, lpVoid, (ID) 0, _J("4363"), (LPVOID) NULL);<br/>     return ER_ERROR;<br/>   }<br/><br/>   idJDBResult = JDB_InitBhvr((void *)lpBhvrCom, &hUser,<br/>                           (JCHAR *)NULL, JDEDB_COMMIT_AUTO);<br/><br/>   if (idJDBResult == JDEDB_FAILED)<br/>   {<br/>      jdeErrorSet(lpBhvrCom, lpVoid, (ID)0, _J("078S"), (LPVOID)NULL);<br/>      return ER_ERROR;<br/>   }<br/><br/>   /************************************************************************<br/>    * Set pointers<br/>    ************************************************************************/<br/><br/>   /************************************************************************<br/>    * Main Processing<br/>    ************************************************************************/<br/>   <br/>   <br/>   <br/>   <br/>   <br/>   /* Initialize output parameters */<br/>   /* ============================ */<br/><br/>   lpDS-&gtcErrorCode = _J('0');<br/>   lpDS-&gtidDoc = 0;<br/>   lpDS-&gtidDocElement = 0;<br/>   jdeStrcpy(lpDS-&gtszErrorMessageID, (const JCHAR *)(_J("")));<br/><br/>   /* Check required parameters */<br/>   /* ========================= */<br/><br/><br/>   if (!IsStringBlank(lpDS-&gtszDocumentName))<br/>   {<br/>         /*Create the XML Document in memory*/<br/>		   <br/>   		 xmlcStatus = XRCS_createEmptyDocument(&hDoc);<br/><br/>    // 	 xmlcStatus = XMLC_createEmptyDocument(&hDoc);<br/><br/>         if(xmlcStatus == XRCS_SUCCESS)<br/>   //    if(xmlcStatus == XMLC_SUCCESS)<br/>		 {<br/>            /*create document element*/<br/>			 jdeTraceSz(NULL, _J("B55XML02 - Document Created:"));<br/>			 jdeTraceSz(NULL, lpDS-&gtszDocumentName);<br/><br/>            xmlcStatus = XRCS_createElement(hDoc, lpDS-&gtszDocumentName, &hDocElement);<br/>     <br/>	//		xmlcStatus = XMLC_createElement(hDoc, lpDS-&gtszDocumentName, &hDocElement); <br/><br/>            if(xmlcStatus == XRCS_SUCCESS)<br/>   //   	if(xmlcStatus == XMLC_SUCCESS)<br/>            {<br/>               /*Add document element*/<br/>				<br/>			   jdeTraceSz(NULL, _J("B55XML02 - root element created"));<br/><br/>               xmlcStatus = XRCS_setDocumentElement(hDoc, hDocElement);<br/><br/>	//		   xmlcStatus = XMLC_setDocumentElement(hDoc, hDocElement);<br/><br/>               if(xmlcStatus == XRCS_SUCCESS)<br/>	//		   if(xmlcStatus == XMLC_SUCCESS)<br/>               {<br/>                  /*Store the handles and return IDs*/<br/>                  lpDS-&gtidDoc = jdeStoreDataPtr(hUser, hDoc);<br/>                  lpDS-&gtidDocElement = jdeStoreDataPtr(hUser, hDocElement);<br/>				  jdeTraceSz(NULL, _J("B55XML02 - root element assigned to document"));<br/>               }<br/>			   else<br/>			   {<br/><br/>				   memset((void *)(&dsDSDE55X01), (int)(_J('\0')), sizeof(dsDSDE55X01));<br/>				   jdeStrcpy(dsDSDE55X01.szErrorReason, (const JCHAR *)(_J("03")));<br/>				   jdeStrcpy(lpDS-&gtszErrorMessageID, (const JCHAR *)(_J("G55E003")));	   <br/>				   jdeTraceSz(NULL, _J("B55XML02 - Failed to create element into XML document"));<br/><br/><br/>			   }<br/>            }<br/>         }<br/>		 else<br/>		 {<br/><br/>			 memset((void *)(&dsDSDE55X01), (int)(_J('\0')), sizeof(dsDSDE55X01));<br/>			 jdeStrcpy(dsDSDE55X01.szErrorReason, (const JCHAR *)(_J("03")));<br/>			 jdeStrcpy(lpDS-&gtszErrorMessageID, (const JCHAR *)(_J("G55E003")));	   <br/>			 jdeTraceSz(NULL, _J("B55XML02 - Failed to create XML document"));<br/><br/>		 }<br/>      <br/><br/>   }<br/>   else<br/>   {<br/>	   xmlcStatus = XRCS_ERROR;	<br/>//	   xmlcStatus = XMLC_ERROR;	<br/>	   memset((void *)(&dsDSDE55X01), (int)(_J('\0')), sizeof(dsDSDE55X01));<br/>	   jdeStrcpy(dsDSDE55X01.szErrorReason, (const JCHAR *)(_J("01")));<br/>	   jdeStrcpy(lpDS-&gtszErrorMessageID, (const JCHAR *)(_J("G55E003")));	   <br/>	   jdeTraceSz(NULL, _J("B55XML02 - Invalid parameters passed to XMLCreateDocument"));<br/><br/><br/>   }<br/><br/>   /************************************************************************ <br/>    * Function Clean Up <br/>    ************************************************************************/ <br/>   if(xmlcStatus != XRCS_SUCCESS)<br/>// if(xmlcStatus != XMLC_SUCCESS)<br/>   {<br/>      idReturn = ER_ERROR;<br/>      lpDS-&gtcErrorCode = _J('1');<br/>	  if(lpDS-&gtcSuppressErrorMessage != _J('1'))<br/>	  {<br/>		  jdeSetGBRErrorSubText(lpBhvrCom, lpVoid, (ID) 0, lpDS-&gtszErrorMessageID, &dsDSDE55X01);<br/>		<br/>	  }<br/>      <br/>   }<br/><br/>	if (hUser)<br/>	{<br/>		JDB_FreeBhvr(hUser);<br/>	}<br/>   <br/>   return (idReturn);<br/>}<br/><br/><br/>/**************************************************************************<br/> *  Business Function:  XMLAddElement_76B<br/> *<br/> *        Description:  XML Add Element 76B<br/> *<br/> *         Parameters:<br/> *           LPBHVRCOM           lpBhvrCom    Business Function Communications<br/> *           LPVOID              lpVoid       Void Parameter - DO NOT USE!<br/> *           LPDSD70XML01B       lpDS         Parameter Data Structure Pointer  <br/> *<br/> *************************************************************************/<br/><br/>JDEBFRTN (ID) JDEBFWINAPI XMLAddElement_55 (LPBHVRCOM lpBhvrCom, LPVOID lpVoid, LPDSD55XML01B lpDS)  <br/>{<br/>   /************************************************************************<br/>    *  Variable declarations<br/>    ************************************************************************/<br/>   ID                idReturn       = ER_SUCCESS;<br/>   ID                idJDBResult    = JDEDB_PASSED;<br/>   HUSER             hUser          = (HUSER)NULL;<br/>   XRCS_Status       xmlcStatus     = XRCS_SUCCESS;<br/>   XRCS_hDocument    hDoc           = (XRCS_hDocument)NULL;<br/>   XRCS_hElement     hParentElement = (XRCS_hElement)NULL;<br/>   XRCS_hElement     hNewElement    = (XRCS_hElement)NULL;<br/>   XRCS_hAttribute   hAttribute     = (XRCS_hAttribute)NULL; <br/>/*<br/>   XMLC_Status       xmlcStatus     = XMLC_SUCCESS;<br/>   XMLC_hDocument    hDoc           = NULL;<br/>   XMLC_hElement     hParentElement = NULL;<br/>   XMLC_hElement     hNewElement    = NULL;<br/>   XMLC_hAttribute   hAttribute     = NULL; */<br/><br/>   int				iTime=	0;<br/><br/>   BOOL				bErrorFound	= FALSE;<br/><br/>   /************************************************************************<br/>    * Declare structures<br/>    ************************************************************************/<br/>   <br/>   <br/>   DSDE55X01			dsDSDE55X01			= {0};		/* error text substitution structure */<br/>   /************************************************************************<br/>    * Declare pointers<br/>    ************************************************************************/<br/><br/>   /************************************************************************<br/>    * Check for NULL pointers<br/>    ************************************************************************/<br/>   if ((lpBhvrCom == (LPBHVRCOM) NULL) ||<br/>       (lpVoid    == (LPVOID)    NULL) ||<br/>       (lpDS      == (LPDSD55XML01B)	NULL))<br/>   {<br/>     jdeErrorSet (lpBhvrCom, lpVoid, (ID) 0, _J("4363"), (LPVOID) NULL);<br/>     return ER_ERROR;<br/>   }<br/><br/>   idJDBResult = JDB_InitBhvr((void *)lpBhvrCom, &hUser,<br/>                           (JCHAR *)NULL, JDEDB_COMMIT_AUTO);<br/><br/>   if (idJDBResult == JDEDB_FAILED)<br/>   {<br/>      jdeErrorSet(lpBhvrCom, lpVoid, (ID)0, _J("078S"), (LPVOID)NULL);<br/>      return ER_ERROR;<br/>   }<br/>   /************************************************************************<br/>    * Set pointers<br/>    ************************************************************************/<br/><br/>   /************************************************************************<br/>    * Main Processing<br/>    ************************************************************************/<br/>   <br/>   /* Initialize output parameters */<br/>   /* ============================ */<br/><br/>   lpDS-&gtcErrorCode = _J('0');<br/>   lpDS-&gtidNewElement = 0;<br/>   jdeStrcpy(lpDS-&gtszErrorMessageID, (const JCHAR *)(_J("")));<br/><br/><br/>   /* Check required parameters */<br/>   /* ========================= */<br/><br/>   if ((lpDS-&gtidDoc != 0) &&<br/>      (lpDS-&gtidParentElement != 0) &&<br/>      (!IsStringBlank(lpDS-&gtszElementName)) )<br/>   {<br/>	        <br/>	   /* Retrieve document pointers */<br/>	   /* ========================== */<br/>	   <br/>	   <br/>	   hDoc = jdeRetrieveDataPtr(hUser, lpDS-&gtidDoc);<br/>	   <br/>	   if(hDoc == (XRCS_hDocument)NULL)<br/>//     if(hDoc == NULL)<br/>	   {<br/>		   bErrorFound = TRUE;<br/>		   jdeTraceSz(NULL, _J("B55XML02 - jdeRetrieveDataPtr for idDoc failed"));<br/>		   jdeStrcpy(dsDSDE55X01.szErrorReason, (const JCHAR *)(_J("08")));<br/>	   <br/>	   <br/>	   }<br/><br/>   	   /* Retrieve Parent Element pointers */<br/>	   /* ================================ */    <br/>	   <br/>	   hParentElement = jdeRetrieveDataPtr(hUser, lpDS-&gtidParentElement);<br/><br/>	   if(hParentElement == (XRCS_hElement)NULL)<br/>//	   if(hParentElement == NULL)<br/>	   {<br/>		   bErrorFound = TRUE;<br/>		   jdeTraceSz(NULL, _J("B55XML02 - jdeRetrieveDataPtr for idParentElement failed"));<br/>		   jdeStrcpy(dsDSDE55X01.szErrorReason, (const JCHAR *)(_J("08")));<br/><br/>	   }<br/><br/>   }<br/>   else<br/>   {<br/><br/>	   bErrorFound = TRUE;	<br/>	   jdeStrcpy(dsDSDE55X01.szErrorReason, (const JCHAR *)(_J("08")));<br/>	   jdeTraceSz(NULL, _J("B55XML02 - Invalid parameters passed to XMLAddElement"));<br/><br/>   }<br/><br/><br/><br/>  <br/>   /* Check required parameters */<br/>   /* ========================= */<br/><br/>   if (!bErrorFound )<br/>   {<br/>	   <br/>	   /* Format Element Value and Attribute Value */<br/>	   /* ======================================== */<br/><br/><br/>		if(!IsStringBlank(lpDS-&gtszXMLElementDataType))<br/>		{<br/>			  switch (jdeAtoi (lpDS-&gtszXMLElementDataType))<br/>//			  switch ( atoi(lpDS-&gtszXMLElementDataType))<br/>			  {<br/>					case I55XML02_EVDT_CHAR:<br/>		<br/>		<br/>						I55XML01_ConvertCharacterToString(lpDS-&gtcXMLElementCharacter,lpDS-&gtszElementText);<br/>				<br/>						break;<br/>					<br/>					case I55XML02_EVDT_SZCHAR:<br/>						<br/>						break;<br/>		<br/>					case I55XML02_EVDT_JDEDATE:<br/>					<br/>						I55XML01_ConvertDateToString(&lpDS-&gtjdXMLElementDate,lpDS-&gtszElementText);<br/>		<br/>						break;<br/>					<br/>					case I55XML02_EVDT_MATH_NUMERIC:<br/>		<br/>		<br/>						I55XML01_ConvertMathNumericToAString(&lpDS-&gtmnXMLElementNumeric,lpDS-&gtszElementText);<br/>						<br/>						break;<br/><br/>					case I55XML02_EVDT_AMOUNT:<br/>		<br/>		<br/>						I55XML01_ConvertAmountToAString(&lpDS-&gtmnXMLElementNumeric,lpDS-&gtszElementText);<br/>						<br/>						break;<br/>		<br/>					case I55XML02_EVDT_INTEGER:<br/>		<br/>						jdeItoa(lpDS-&gtidXMLElementInteger,lpDS-&gtszElementText,10);<br/>		<br/>						break;<br/>		<br/>					case I55XML02_EVDT_TIME:<br/><br/>						MathNumericToInt(&lpDS-&gtmnXMLElementNumeric,&iTime);<br/>						I55XML01_ConvertTimeToString(iTime,lpDS-&gtszElementText);<br/>		<br/>						break;<br/>		<br/>					default:<br/>		<br/>		<br/>						break;<br/>		<br/>		<br/>			  }<br/>		<br/>		<br/>		}<br/><br/>		I55XML01_RemoveSurroundingBlanks(lpDS-&gtszElementText);<br/><br/><br/>          /* Format Attribute Value */<br/>		  /* ====================== */<br/><br/><br/>		  if(!IsStringBlank(lpDS-&gtszXMLAttributeDataType))<br/>		  {<br/>			  switch (jdeAtoi (lpDS-&gtszXMLAttributeDataType))<br/>			  {<br/>					case I55XML02_EVDT_CHAR:<br/><br/><br/>						I55XML01_ConvertCharacterToString(lpDS-&gtcXMLAttributeCharacter,lpDS-&gtszElementAttributeValue);<br/>				<br/>						break;<br/>					<br/>					case I55XML02_EVDT_SZCHAR:<br/>						<br/>						break;<br/><br/>					case I55XML02_EVDT_JDEDATE:<br/>					<br/>						I55XML01_ConvertDateToString(&lpDS-&gtjdXMLAttributeDate,lpDS-&gtszElementAttributeValue);<br/><br/>						break;<br/>					<br/>					case I55XML02_EVDT_MATH_NUMERIC:<br/><br/><br/>						I55XML01_ConvertMathNumericToAString(&lpDS-&gtmnXMLAttributeNumeric,lpDS-&gtszElementAttributeValue);<br/>						<br/>						break;<br/><br/>					case I55XML02_EVDT_AMOUNT:<br/>		<br/>		<br/>						I55XML01_ConvertAmountToAString(&lpDS-&gtmnXMLAttributeNumeric,lpDS-&gtszElementAttributeValue);<br/>						<br/>						break;<br/><br/>					case I55XML02_EVDT_INTEGER:<br/><br/>						jdeItoa(lpDS-&gtidXMLAttributeInteger,lpDS-&gtszElementAttributeValue,10);<br/><br/>						break;<br/><br/>					case I55XML02_EVDT_TIME:<br/><br/><br/><br/>						MathNumericToInt(&lpDS-&gtmnXMLAttributeNumeric,&iTime);<br/>						I55XML01_ConvertTimeToString(iTime,lpDS-&gtszElementAttributeValue);<br/><br/>						break;<br/><br/>					default:<br/><br/><br/>						break;<br/><br/><br/>			  }<br/><br/>			  I55XML01_RemoveSurroundingBlanks(lpDS-&gtszElementAttributeValue);<br/><br/><br/>		  }<br/><br/>          /* create new node */<br/>		  /* =============== */<br/><br/>    	  xmlcStatus = XRCS_createElement(hDoc, lpDS-&gtszElementName, &hNewElement);<br/><br/>//		  xmlcStatus = XMLC_createElement(hDoc, lpDS-&gtszElementName, &hNewElement);<br/>      <br/>         if(xmlcStatus == XRCS_SUCCESS)<br/>//		 if(xmlcStatus == XMLC_SUCCESS)<br/>         {<br/>            <br/>			 /* if requested, add attribute */<br/>			 /* =========================== */<br/><br/>            if (  !IsStringBlank(lpDS-&gtszElementAttributeName) && <br/>				  !IsStringBlank(lpDS-&gtszElementAttributeValue) )<br/>            {<br/>               xmlcStatus = XRCS_createAttribute(hDoc, lpDS-&gtszElementAttributeName,<br/>                                                lpDS-&gtszElementAttributeValue,<br/>                                                &hAttribute);<br/><br/>/*			   xmlcStatus = XMLC_createAttribute(hDoc, lpDS-&gtszElementAttributeName,<br/>                                                lpDS-&gtszElementAttributeValue,<br/>                                                &hAttribute); */<br/><br/>               if(xmlcStatus == XRCS_SUCCESS)<br/>//			   if(xmlcStatus == XMLC_SUCCESS)<br/>               {<br/>                  xmlcStatus = XRCS_appendAttribute(hNewElement, hAttribute);<br/><br/>  //     		  xmlcStatus = XMLC_appendAttribute(hNewElement, hAttribute);<br/>               }<br/>			   else<br/>			   {<br/><br/>				   jdeTraceSz(NULL, _J("B55XML02 - Failed execute API: XMLC_appendAttribute"));<br/><br/>			   }<br/>         <br/>               XRCS_freeAttribute(hAttribute);    <br/>			   <br/>//			   XMLC_freeAttribute(hAttribute);<br/><br/>            }<br/>         <br/>		 }<br/>		 else<br/>		 {<br/>			 jdeTraceSz(NULL, _J("B55XML02 - Failed execute API: XMLC_createElement"));<br/>		 }<br/><br/><br/><br/>          /* Set Element Text */<br/>		  /* ================ */<br/>            <br/>         if (xmlcStatus == XRCS_SUCCESS)<br/>//		 if (xmlcStatus == XMLC_SUCCESS)<br/>         {            <br/>            /*if requested, add text*/<br/>            if (!IsStringBlank(lpDS-&gtszElementText))<br/>            {         <br/>               xmlcStatus = XRCS_setElementText(hNewElement, lpDS-&gtszElementText);<br/>				<br/>//			   xmlcStatus = XMLC_setElementText(hNewElement, lpDS-&gtszElementText);<br/><br/>			   if(xmlcStatus != XRCS_SUCCESS)<br/>//			   if(xmlcStatus != XMLC_SUCCESS)<br/>			   {<br/><br/>				   jdeTraceSz(NULL, _J("B55XML02 - Failed execute API: XMLC_setElementText"));<br/><br/>			   }<br/>            }<br/>         }<br/><br/><br/>          /* Append Child Element */<br/>		  /* ==================== */<br/>         <br/>         if (xmlcStatus == XRCS_SUCCESS)<br/>//		 if (xmlcStatus == XMLC_SUCCESS)<br/>         {<br/>            /*add child to parent*/<br/>            xmlcStatus = XRCS_appendChildElement(hParentElement, hNewElement);<br/><br/>//			xmlcStatus = XMLC_appendChildElement(hParentElement, hNewElement);<br/>         <br/>            if (xmlcStatus == XRCS_SUCCESS)<br/>//			if (xmlcStatus == XMLC_SUCCESS)<br/>            {<br/>               /*if requested, store the new element otherwise free it*/<br/>               if (lpDS-&gtcReturnElement == _J('1'))<br/>               {<br/>                  lpDS-&gtidNewElement = jdeStoreDataPtr(hUser, hNewElement);<br/>               }<br/>               else<br/>               {<br/>                  XRCS_freeElement(hNewElement);<br/>//				  XMLC_freeElement(hNewElement);<br/>               }<br/>            }<br/>			else<br/>			{<br/>				<br/>				jdeTraceSz(NULL, _J("B55XML02 - Failed execute API: XMLC_appendChildElement"));<br/><br/>			}<br/>         }<br/><br/>		 if (xmlcStatus != XRCS_SUCCESS)<br/>//		 if (xmlcStatus != XMLC_SUCCESS)<br/>		 {<br/>			<br/>			 bErrorFound = TRUE;<br/>			 jdeStrcpy(dsDSDE55X01.szErrorReason, (const JCHAR *)(_J("09")));<br/>			 jdeTraceSz(NULL, _J("B55XML02 - Failed to add XML element"));<br/><br/>		 }<br/><br/>   }<br/><br/>   /************************************************************************<br/>    * Function Clean Up<br/>    ************************************************************************/<br/>   if(bErrorFound)<br/>   {<br/>      idReturn = ER_ERROR;<br/>      lpDS-&gtcErrorCode = _J('1');<br/>	  jdeStrcpy(lpDS-&gtszErrorMessageID, (const JCHAR *)(_J("G55E003")));      <br/>	  <br/>	  if(lpDS-&gtcSuppressErrorMessage != _J('1'))<br/>	  {<br/>		  jdeSetGBRErrorSubText(lpBhvrCom, lpVoid, (ID) 0, lpDS-&gtszErrorMessageID, &dsDSDE55X01);<br/>		<br/>	  }<br/>   }<br/>   <br/>	if (hUser)<br/>	{<br/>		JDB_FreeBhvr(hUser);<br/>	}<br/>   <br/>   return (idReturn);<br/>}<br/><br/><br/>/**************************************************************************<br/> *  Business Function:  XMLFreeElement_76B<br/> *<br/> *        Description:  XML Free Element 76B<br/> *<br/> *         Parameters:<br/> *           LPBHVRCOM           lpBhvrCom    Business Function Communications<br/> *           LPVOID              lpVoid       Void Parameter - DO NOT USE!<br/> *           LPDSD70XML01C       lpDS         Parameter Data Structure Pointer  <br/> *<br/> *************************************************************************/<br/><br/>JDEBFRTN (ID) JDEBFWINAPI XMLFreeElement_55 (LPBHVRCOM lpBhvrCom, LPVOID lpVoid, LPDSD55XML01C lpDS)  <br/>{<br/>   /************************************************************************<br/>    *  Variable declarations<br/>    ************************************************************************/<br/>   ID                idReturn       = ER_SUCCESS;<br/>   ID                idJDBResult    = JDEDB_PASSED;<br/>   HUSER             hUser          = (HUSER)NULL;<br/>   XRCS_Status       xmlcStatus     = XRCS_SUCCESS;<br/>   XRCS_hElement     hElement       = (XRCS_hElement)NULL; <br/>/* XMLC_Status       xmlcStatus     = XMLC_SUCCESS;<br/>   XMLC_hElement     hElement       = NULL; */<br/>   /************************************************************************<br/>    * Declare structures<br/>    ************************************************************************/<br/> <br/>   <br/>   DSDE55X01			dsDSDE55X01			= {0};		/* error text substitution structure */<br/><br/>   /************************************************************************<br/>    * Declare pointers<br/>    ************************************************************************/<br/><br/>   /************************************************************************<br/>    * Check for NULL pointers<br/>    ************************************************************************/<br/>   if ((lpBhvrCom == (LPBHVRCOM) NULL) ||<br/>       (lpVoid    == (LPVOID)    NULL) ||<br/>       (lpDS      == (LPDSD55XML01C)	NULL))<br/>   {<br/>     jdeErrorSet (lpBhvrCom, lpVoid, (ID) 0, _J("4363"), (LPVOID) NULL);<br/>     return ER_ERROR;<br/>   }<br/><br/>   idJDBResult = JDB_InitBhvr((void *)lpBhvrCom, &hUser,<br/>                           (JCHAR *)NULL, JDEDB_COMMIT_AUTO);<br/><br/>   if (idJDBResult == JDEDB_FAILED)<br/>   {<br/>      jdeErrorSet(lpBhvrCom, lpVoid, (ID)0, _J("078S"), (LPVOID)NULL);<br/>      return ER_ERROR;<br/>   }<br/><br/>   /************************************************************************<br/>    * Set pointers<br/>    ************************************************************************/<br/><br/>   /************************************************************************<br/>    * Main Processing<br/>    ************************************************************************/<br/>   <br/>   /* Initialize output parameters */<br/>   /* ============================ */<br/>   lpDS-&gtcErrorCode = _J('0');<br/>   jdeStrcpy(lpDS-&gtszErrorMessageID, (const JCHAR *)(_J("")));<br/><br/>   /* Check required parameters */<br/>   /* ========================= */<br/><br/>   if (lpDS-&gtidElementToFree != 0)<br/>   {<br/>      <br/>	   <br/>		   /* Remove element handle */<br/>		   /* ===================== */<br/>		   <br/>		   hElement = jdeRemoveDataPtr(hUser, lpDS-&gtidElementToFree);<br/>		   <br/>		   if (hElement != (XRCS_hElement)NULL)<br/>//		   if (hElement != NULL)<br/>		   {<br/>			   /* Free the element */<br/>			   /* ---------------- */<br/>			   <br/>			   xmlcStatus = XRCS_freeElement(hElement);<br/>//			   xmlcStatus = XMLC_freeElement(hElement);<br/>			   <br/>			   if(xmlcStatus != XRCS_SUCCESS)<br/>//			   if(xmlcStatus != XMLC_SUCCESS)<br/>			   {<br/>				   jdeStrcpy(dsDSDE55X01.szErrorReason, (const JCHAR *)(_J("07")));<br/>				   jdeTraceSz(NULL, _J("B55XML02 - Failed to get XML parser functions"));<br/>			   }<br/>			   <br/>			   /* Reset the ID to zero */<br/>			   /* ==================== */<br/>			   <br/>			   lpDS-&gtidElementToFree = 0;<br/>		   <br/>		   }<br/>		   else<br/>		   {<br/>			   xmlcStatus = XRCS_ERROR;<br/>//			   xmlcStatus = XMLC_ERROR;<br/>			   jdeStrcpy(dsDSDE55X01.szErrorReason, (const JCHAR *)(_J("07")));			   <br/>			   jdeTraceSz(NULL, _J("B55XML02 - jdeRemoveDataPtr for idElemnt failed"));<br/>		   }<br/>     <br/>   <br/>   }<br/>   else<br/>   {<br/>      xmlcStatus = XRCS_ERROR;<br/>//	  xmlcStatus = XMLC_ERROR;<br/>	  jdeStrcpy(dsDSDE55X01.szErrorReason, (const JCHAR *)(_J("06")));<br/>	  jdeTraceSz(NULL, _J("B55XML02 - Invalid parameters passed to XMLFreeDocument"));<br/><br/><br/>   }<br/><br/>   /************************************************************************<br/>    * Function Clean Up<br/>    ************************************************************************/<br/>   if(xmlcStatus != XRCS_SUCCESS)<br/>// if(xmlcStatus != XMLC_SUCCESS)<br/>   {<br/>      idReturn = ER_ERROR;<br/>      lpDS-&gtcErrorCode = _J('1');<br/>	  jdeStrcpy(lpDS-&gtszErrorMessageID, (const JCHAR *)(_J("G55E003")));<br/><br/>	  if(lpDS-&gtcSuppressErrorMessage != _J('1'))<br/>	  {<br/>		  jdeSetGBRErrorSubText(lpBhvrCom, lpVoid, (ID) 0, lpDS-&gtszErrorMessageID, &dsDSDE55X01);<br/>		<br/>	  }<br/><br/>      jdeTraceSz(NULL, _J("B55XML02 - Failed to free XML element"));<br/>   }<br/><br/>	if (hUser)<br/>	{<br/>		JDB_FreeBhvr(hUser);<br/>	}<br/>   <br/>   return (idReturn);<br/>}<br/><br/><br/>/**************************************************************************<br/> *  Business Function:  XMLLoadAPIs_76B<br/> *<br/> *        Description:  XML Load APIs 76B<br/> *<br/> *         Parameters:<br/> *           LPBHVRCOM           lpBhvrCom    Business Function Communications<br/> *           LPVOID              lpVoid       Void Parameter - DO NOT USE!<br/> *           LPDSD70XML01E       lpDS         Parameter Data Structure Pointer  <br/> *<br/> *************************************************************************/<br/><br/>JDEBFRTN (ID) JDEBFWINAPI XMLLoadAPIs_55 (LPBHVRCOM lpBhvrCom, LPVOID lpVoid, LPDSD55XML01E lpDS)  <br/>{<br/>   /************************************************************************<br/>    *  Variable declarations<br/>    ************************************************************************/<br/>   ID                idReturn          = ER_SUCCESS;<br/>   XRCS_Status       xmlcStatus        = XRCS_SUCCESS;<br/>// XMLC_Status       xmlcStatus	       = XMLC_SUCCESS; <br/>  <br/>   /************************************************************************<br/>    * Declare structures<br/>    ************************************************************************/<br/><br/>   <br/>   DSDE55X01			dsDSDE55X01			= {0};		/* error text substitution structure */<br/><br/>   /************************************************************************<br/>    * Declare pointers<br/>    ************************************************************************/<br/>    <br/>   /************************************************************************<br/>    * Check for NULL pointers<br/>    ************************************************************************/<br/>   if ((lpBhvrCom == (LPBHVRCOM) NULL) ||<br/>       (lpVoid    == (LPVOID)    NULL) ||<br/>       (lpDS      == (LPDSD55XML01E)	NULL))<br/>   {<br/>     jdeErrorSet (lpBhvrCom, lpVoid, (ID) 0, _J("4363"), (LPVOID) NULL);<br/>     return ER_ERROR;<br/>   }<br/><br/><br/>   /************************************************************************<br/>    * Set pointers<br/>    ************************************************************************/<br/><br/>   /************************************************************************<br/>    * Main Processing<br/>    ************************************************************************/<br/>   /*Initialize output parameters*/<br/>   lpDS-&gtcErrorCode = _J('0');<br/>   jdeStrcpy(lpDS-&gtszErrorMessageID, (const JCHAR *)(_J("")));<br/><br/>   lpDS-&gtidAPIs = 1;<br/><br/>     <br/>   xmlcStatus = XRCS_initEngine();<br/><br/>// xmlcStatus = XMLC_initEngine();<br/><br/>   if(xmlcStatus != XRCS_SUCCESS)<br/>// if(xmlcStatus != XMLC_SUCCESS)<br/>   {<br/>	   idReturn = ER_ERROR;<br/>	   jdeStrcpy(dsDSDE55X01.szErrorReason, (const JCHAR *)(_J("03")));<br/>	   jdeStrcpy(lpDS-&gtszErrorMessageID, (const JCHAR *)(_J("G55E002")));<br/>	   jdeTraceSz(NULL, _J("B55XML02 - Failed to init XML parser"));<br/>   }<br/><br/><br/><br/>   /************************************************************************<br/>    * Function Clean Up<br/>    ************************************************************************/<br/><br/>   if(idReturn != ER_SUCCESS)<br/>   {<br/>      lpDS-&gtcErrorCode = _J('1');<br/><br/>	  if(lpDS-&gtcSuppressErrorMessage != _J('1'))<br/>	  {<br/>		  jdeSetGBRErrorSubText(lpBhvrCom, lpVoid, (ID) 0, lpDS-&gtszErrorMessageID, &dsDSDE55X01);<br/>		<br/>	  }<br/>   }<br/><br/>   return (idReturn);<br/>}<br/><br/><br/>/**************************************************************************<br/> *  Business Function:  XMLUnloadAPIs_76B<br/> *<br/> *        Description:  XML Unload APIs 76B<br/> *<br/> *         Parameters:<br/> *           LPBHVRCOM           lpBhvrCom    Business Function Communications<br/> *           LPVOID              lpVoid       Void Parameter - DO NOT USE!<br/> *           LPDSD70XML01E       lpDS         Parameter Data Structure Pointer  <br/> *<br/> *************************************************************************/<br/><br/>JDEBFRTN (ID) JDEBFWINAPI XMLUnloadAPIs_55 (LPBHVRCOM lpBhvrCom, LPVOID lpVoid, LPDSD55XML01E lpDS)  <br/>{<br/>   /************************************************************************<br/>    *  Variable declarations<br/>    ************************************************************************/<br/>   ID                idReturn       = ER_SUCCESS;<br/>   XRCS_Status       xmlcStatus     = XRCS_SUCCESS;<br/>// XMLC_Status       xmlcStatus	    = XMLC_SUCCESS;<br/><br/>   /************************************************************************<br/>    * Declare structures<br/>    ************************************************************************/<br/><br/>   <br/>   DSDE55X01			dsDSDE55X01			= {0};		/* error text substitution structure */<br/><br/>   /************************************************************************<br/>    * Declare pointers<br/>    ************************************************************************/<br/><br/>   /************************************************************************<br/>    * Check for NULL pointers<br/>    ************************************************************************/<br/>   if ((lpBhvrCom == (LPBHVRCOM) NULL) ||<br/>       (lpVoid    == (LPVOID)    NULL) ||<br/>       (lpDS      == (LPDSD55XML01E)	NULL))<br/>   {<br/>     jdeErrorSet (lpBhvrCom, lpVoid, (ID) 0, _J("4363"), (LPVOID) NULL);<br/>     return ER_ERROR;<br/>   }<br/><br/><br/>   /************************************************************************<br/>    * Set pointers<br/>    ************************************************************************/<br/><br/>   /************************************************************************<br/>    * Main Processing<br/>    ************************************************************************/<br/>   /*Initialize output parameters*/<br/>   lpDS-&gtcErrorCode = _J('0');<br/>   jdeStrcpy(lpDS-&gtszErrorMessageID, (const JCHAR *)(_J("")));<br/><br/><br/>    /*terminate the parser*/<br/>    <br/>   xmlcStatus = XRCS_terminateEngine();<br/><br/>// xmlcStatus = XMLC_terminateEngine();<br/>   <br/>   if(xmlcStatus != XRCS_SUCCESS)<br/>// if(xmlcStatus != XMLC_SUCCESS)<br/>   {<br/>	   idReturn = ER_ERROR;<br/>	   jdeTraceSz(NULL, _J("B55XML01 - Failed to terminate XML parser"));<br/>	   jdeStrcpy(dsDSDE55X01.szErrorReason, (const JCHAR *)(_J("05")));		   <br/>	   jdeStrcpy(lpDS-&gtszErrorMessageID, (const JCHAR *)(_J("G55E002")));<br/>   }<br/><br/>   /************************************************************************<br/>    * Function Clean Up<br/>    ************************************************************************/<br/>   if(idReturn != ER_SUCCESS)<br/>   {<br/>      lpDS-&gtcErrorCode = _J('1');<br/>	  if(lpDS-&gtcSuppressErrorMessage != _J('1'))<br/>	  {<br/>		  jdeSetGBRErrorSubText(lpBhvrCom, lpVoid, (ID) 0, lpDS-&gtszErrorMessageID, &dsDSDE55X01);<br/>		<br/>	  }<br/>   }<br/>       <br/><br/>   return (idReturn);<br/>}<br/><br/><br/>/**************************************************************************<br/> *  Business Function:  XMLDoesFileExist<br/> *<br/> *        Description:  XML Does XML File Exist<br/> *<br/> *         Parameters:<br/> *           LPBHVRCOM           lpBhvrCom    Business Function Communications<br/> *           LPVOID              lpVoid       Void Parameter - DO NOT USE!<br/> *           LPDSD70XML01D       lpDS         Parameter Data Structure Pointer  <br/> *<br/> *************************************************************************/<br/><br/>JDEBFRTN (ID) JDEBFWINAPI XMLDoesFileExist_55 (LPBHVRCOM lpBhvrCom, LPVOID lpVoid, LPDSD55XML01D lpDS)  <br/>{<br/>   /************************************************************************<br/>    *  Variable declarations<br/>    ************************************************************************/<br/><br/>   ID						idReturn       = ER_SUCCESS;<br/>   ID						idJDBResult    = JDEDB_PASSED;<br/>   HUSER					hUser          = (HUSER)NULL;<br/><br/>   BOOL						bFileFound	   = FALSE;<br/>   BOOL						bErrorFound	   = FALSE;<br/><br/>   XRCS_hParser				hParser		   = (XRCS_hParser) NULL;<br/>   XRCS_Status				xmlcStatus	   = XRCS_SUCCESS;	<br/>   XRCS_hDocument			hDoc           = (XRCS_hDocument)NULL;<br/><br/>/* XMLC_hParser				hParser		   = NULL;<br/>   XMLC_Status				xmlcStatus	   = XMLC_SUCCESS;	<br/>   XMLC_hDocument			hDoc           = NULL; */<br/>   <br/><br/>   /************************************************************************<br/>    * Declare structures<br/>    ************************************************************************/<br/><br/>   <br/><br/>   DSDE55X01			dsDSDE55X01			= {0};		/* error text substitution structure */<br/><br/>   DSI55XML01ZFILE		dsDSI55XML01ZFILE	= {0};<br/>   DSI55XML01FILE		dsDSI55XML01FILE	= {0};<br/><br/><br/><br/>   /************************************************************************<br/>    * Declare pointers<br/>    ************************************************************************/<br/><br/><br/><br/>   /************************************************************************<br/>    * Check for NULL pointers<br/>    ************************************************************************/<br/>   if ((lpBhvrCom == (LPBHVRCOM) NULL) ||<br/>       (lpVoid    == (LPVOID)    NULL) ||<br/>       (lpDS      == (LPDSD55XML01D)	NULL))<br/>   {<br/>     jdeErrorSet (lpBhvrCom, lpVoid, (ID) 0, _J("4363"), (LPVOID) NULL);<br/>     return ER_ERROR;<br/>   }<br/><br/><br/><br/>   idJDBResult = JDB_InitBhvr((void *)lpBhvrCom, &hUser,<br/>                           (JCHAR *)NULL, JDEDB_COMMIT_AUTO);<br/><br/>   if (idJDBResult == JDEDB_FAILED)<br/>   {<br/>      jdeErrorSet(lpBhvrCom, lpVoid, (ID)0, _J("078S"), (LPVOID)NULL);<br/>      return ER_ERROR;<br/>   }<br/><br/>   /************************************************************************<br/>    * Set pointers<br/>    ************************************************************************/<br/><br/>   /************************************************************************<br/>    * Main Processing<br/>    ************************************************************************/<br/>   <br/>   /* Initialize output parameters */<br/>   /* ============================ */<br/>   lpDS-&gtcErrorCode = _J('0');<br/>   jdeStrcpy(lpDS-&gtszErrorDataItemCode, (const JCHAR *)(_J("")));<br/><br/>   lpDS-&gtcDoesFinalXMLFileExist = _J('N');<br/>   lpDS-&gtcDoesTemporalXMLFileExist = _J('N');<br/>   <br/><br/>   /* Verify Original XML File */<br/>   /* ======================== */<br/><br/>   jdeStripTrailingBlanks(lpDS-&gtszXMLFileNameWithPath);<br/><br/>   jdeTraceSz(NULL, _J("B55XML02 - Searching XML File:"));<br/>   jdeTraceSz(NULL, lpDS-&gtszXMLFileNameWithPath);<br/><br/>   if(!IsStringBlank(lpDS-&gtszXMLFileNameWithPath))<br/>   {<br/><br/>	   /* Open XML File */<br/>	   /* ------------- */<br/><br/>	   if (I55XML01_DoesXMLFileExists(lpDS-&gtszXMLFileNameWithPath))<br/>	   {<br/><br/><br/>		   bFileFound		= TRUE;<br/><br/>		   jdeStrcpy(lpDS-&gtszTemporalXMLFileWithPath, lpDS-&gtszXMLFileNameWithPath);<br/><br/>		   lpDS-&gtcDoesFinalXMLFileExist = _J('Y');		   <br/>		  	<br/>	   }<br/>	   <br/><br/>   }<br/><br/><br/><br/><br/>  /* Verify Original Temporal XML File */<br/>   /* ================================ */<br/><br/>   <br/>   if(!bFileFound ) <br/>   {<br/><br/>	   jdeStripTrailingBlanks(lpDS-&gtszXMLTemporalPath);<br/><br/>	   jdeTraceSz(NULL, _J("B55XML02 - Searching Temporal XML File"));<br/><br/>	   /* Create Temporal File Name */<br/>	   <br/>	   if(!IsStringBlank(lpDS-&gtszXMLTemporalPath))<br/>	   {<br/><br/>		   jdeTraceSz(NULL, _J("B55XML01 - Temporal Path informed:"));<br/>		   jdeTraceSz(NULL, lpDS-&gtszXMLTemporalPath);<br/><br/>	   }<br/><br/><br/>	   /* Create Temporal File Name */<br/>		<br/>		/* szEdiUserId */ <br/>		<br/>		jdeStrncpy (dsDSI55XML01FILE.szEdiUserId, (const JCHAR *)(lpDS-&gtszEdiUserId), DIM(dsDSI55XML01FILE.szEdiUserId));<br/>	   <br/>		/* szEdiBatchNumber */<br/>		<br/>		jdeStrncpy (dsDSI55XML01FILE.szEdiBatchNumber, (const JCHAR *)(lpDS-&gtszEdiBatchNumber), DIM(dsDSI55XML01FILE.szEdiBatchNumber));<br/>		<br/>		/* szEdiBatchNumber */<br/>		<br/>		jdeStrncpy (dsDSI55XML01FILE.szEdiTransactNumber, (const JCHAR *)(lpDS-&gtszEdiTransactNumber), DIM(dsDSI55XML01FILE.szEdiTransactNumber));<br/>		<br/>		/* mnEdiLineNumber */<br/>		<br/>		MathCopy (&dsDSI55XML01FILE.mnEdiLineNumber, &lpDS-&gtmnEdiLineNumber);<br/><br/>		/* szXMLInternalReference */<br/>		<br/>		jdeStrncpy (dsDSI55XML01FILE.szXMLInternalReference, (const JCHAR *)(lpDS-&gtszXMLInternalReference), DIM(dsDSI55XML01FILE.szXMLInternalReference));<br/><br/><br/>		/* cTemporalFile_YN */<br/><br/>		dsDSI55XML01FILE.cTemporalFile_YN = _J('Y');<br/><br/>		/* cTemporalFile_YN */<br/>		<br/>		jdeStrncpy (dsDSI55XML01FILE.szXMLFileContainerPath, (const JCHAR *)(lpDS-&gtszXMLTemporalPath), DIM(dsDSI55XML01FILE.szXMLFileContainerPath));<br/>		<br/>		<br/>		I55XML01_GenerateXMLFileName(	(LPBHVRCOM) lpBhvrCom,<br/>														(LPVOID) lpVoid, <br/>														(HUSER) hUser,<br/>														(LPDSI55XML01FILE) &dsDSI55XML01FILE);<br/><br/>		jdeStrcpy(lpDS-&gtszTemporalXMLFileWithPath, dsDSI55XML01FILE.szXMLFullFileName);<br/><br/>	   /* Open Temporal XML File */<br/>	   /* ---------------------- */<br/><br/><br/>	   if (I55XML01_DoesXMLFileExists(dsDSI55XML01FILE.szXMLFullFileName))<br/>	   {<br/><br/><br/>		   bFileFound		= TRUE;<br/><br/>		   lpDS-&gtcDoesTemporalXMLFileExist = _J('Y');		   <br/><br/>	   }<br/><br/><br/>   }<br/><br/><br/><br/>   /* Generate Temporal XML File */<br/>   /* ============================ */<br/><br/><br/>   if(!bFileFound && lpDS-&gtcGenerateTemporalXMLFileYN == _J('Y'))<br/>   {<br/><br/><br/>	   if(IsStringBlank(lpDS-&gtszXMLTemporalPath))<br/>	   {<br/><br/>		   memset((void *)(&dsDSDE55X01), (int)(_J('\0')), sizeof(dsDSDE55X01));<br/>		   jdeStrcpy(dsDSDE55X01.szErrorReason, (const JCHAR *)(_J("10")));<br/>		   jdeStrcpy(lpDS-&gtszErrorDataItemCode, (const JCHAR *)(_J("G55E004")));<br/>		   jdeTraceSz(NULL, _J("B55XML02 - Temporal XML file not informed"));<br/>		   idReturn = ER_ERROR;<br/><br/>	   }<br/>	   else<br/>	   {<br/><br/><br/>	   		<br/>	<br/>		   /* szEdiUserId */<br/>		   <br/>		   jdeStrncpy (dsDSI55XML01ZFILE.szEdiUserId, (const JCHAR *)(lpDS-&gtszEdiUserId), DIM(dsDSI55XML01ZFILE.szEdiUserId));<br/>		   <br/>		   /* szEdiBatchNumber */<br/>		   <br/>		   jdeStrncpy (dsDSI55XML01ZFILE.szEdiBatchNumber, (const JCHAR *)(lpDS-&gtszEdiBatchNumber), DIM(dsDSI55XML01ZFILE.szEdiBatchNumber));<br/>		   <br/>		   /* szEdiBatchNumber */<br/>		   <br/>		   jdeStrncpy (dsDSI55XML01ZFILE.szEdiTransactNumber, (const JCHAR *)(lpDS-&gtszEdiTransactNumber), DIM(dsDSI55XML01ZFILE.szEdiTransactNumber));<br/>		   <br/>		   /* mnEdiLineNumber */<br/>		   <br/>		   MathCopy (&dsDSI55XML01ZFILE.mnEdiLineNumber, &lpDS-&gtmnEdiLineNumber);<br/>	<br/>		   /* ErrorCode */<br/>		   <br/>		   jdeStrcpy (dsDSI55XML01ZFILE.szXMLErrorCode, (const JCHAR *)(_J("")));<br/>		   jdeStrcpy (dsDSI55XML01ZFILE.szErrorReason, (const JCHAR *)(_J("")));<br/>		   jdeStrcpy (dsDSI55XML01ZFILE.szErrorMessageID, (const JCHAR *)(_J("")));<br/>	<br/>	<br/>		   bErrorFound = I55XML01_GetXMLString(	(LPBHVRCOM) lpBhvrCom,<br/>												(LPVOID) lpVoid, <br/>												(HUSER) hUser,<br/>												(LPDSI55XML01ZFILE) &dsDSI55XML01ZFILE);<br/>	<br/>	<br/>		   if(!bErrorFound)<br/>		   {<br/>	<br/>					   /*  Get the Xerces Parser  */<br/>					   <br/>					   xmlcStatus = XRCS_getParser(&hParser);<br/>		//			   xmlcStatus = XMLC_getParser(&hParser);<br/>					   <br/>					   if(xmlcStatus == XRCS_SUCCESS)<br/>		//			   if(xmlcStatus == XMLC_SUCCESS)<br/>					   {<br/>						   <br/>						   /*  Parse From String  */<br/>						   <br/>						   xmlcStatus = XRCS_parseXMLString(hParser,dsDSI55XML01ZFILE.szXMLString,&hDoc);<br/>			//			   xmlcStatus = XMLC_parseXMLString(hParser,dsDSI55XML01ZFILE.szXMLString,&hDoc);<br/>						   <br/>						   if(xmlcStatus != XRCS_SUCCESS)<br/>			//			   if(xmlcStatus != XMLC_SUCCESS)<br/>						   {<br/>							   idReturn = ER_ERROR;<br/>							   bErrorFound = TRUE;<br/>							   jdeTraceSz(NULL, _J("B55XML02 - XMLC_getParser failed"));<br/>							   jdeStrcpy(dsDSDE55X01.szErrorReason, (const JCHAR *)(_J("04")));		   <br/>							   jdeStrcpy(lpDS-&gtszErrorDataItemCode, (const JCHAR *)(_J("G55E004")));<br/>						   }<br/>						   <br/>						   xmlcStatus = XRCS_freeParser(hParser);<br/>			//			   xmlcStatus = XMLC_freeParser(hParser);<br/>					   <br/>					   }<br/>					   else<br/>					   {<br/>						   idReturn = ER_ERROR;<br/>						   bErrorFound = TRUE;<br/>						   jdeTraceSz(NULL, _J("B55XML02 - XMLC_getParser failed"));<br/>						   jdeStrcpy(dsDSDE55X01.szErrorReason, (const JCHAR *)(_J("04")));		   <br/>						   jdeStrcpy(lpDS-&gtszErrorDataItemCode, (const JCHAR *)(_J("G55E004")));<br/>					   }<br/>	<br/>		   }<br/>		   else<br/>		   {<br/>	<br/>			   jdeStrcpy(dsDSDE55X01.szErrorReason, dsDSI55XML01ZFILE.szErrorReason);<br/>			   jdeStrcpy(lpDS-&gtszErrorDataItemCode, dsDSI55XML01ZFILE.szErrorMessageID );<br/>			   <br/>		   }<br/>	<br/>		   /* Create Temporal .xml file */<br/>	<br/>		   if(!bErrorFound)<br/>		   {<br/>	<br/>	<br/>			   /* Serialize Document To File */<br/>	<br/>			   xmlcStatus = XRCS_serializeDocumentToFile(hDoc, lpDS-&gtszTemporalXMLFileWithPath);<br/>//			   xmlcStatus = XMLC_serializeDocumentToFile(hDoc, lpDS-&gtszTemporalXMLFileWithPath);<br/>	<br/>			   if(xmlcStatus != XRCS_SUCCESS)<br/>//			   if(xmlcStatus != XMLC_SUCCESS)<br/>			   {<br/>			<br/>						 memset((void *)(&dsDSDE55X01), (int)(_J('\0')), sizeof(dsDSDE55X01));<br/>						 jdeStrcpy(dsDSDE55X01.szErrorReason, (const JCHAR *)(_J("10")));<br/>						 jdeStrcpy(lpDS-&gtszErrorDataItemCode, (const JCHAR *)(_J("G55E004")));<br/>						 xmlcStatus = XRCS_ERROR;<br/>			//			 xmlcStatus = XMLC_ERROR;<br/>						 jdeTraceSz(NULL, _J("B55XML02 - Failed to write temporal XML file"));<br/>						 jdeTraceSz(NULL, _J("Path:"));<br/>						 jdeTraceSz(NULL, lpDS-&gtszTemporalXMLFileWithPath);<br/>						 idReturn = ER_ERROR;<br/>			<br/>			<br/>				}<br/>			   else<br/>			   {<br/>	<br/>	<br/>						 jdeTraceSz(NULL, _J("B55XML02 - XML writed"));<br/>						 jdeTraceSz(NULL, lpDS-&gtszTemporalXMLFileWithPath);<br/>	<br/>	<br/>			<br/>			   }<br/>	<br/>	<br/>			   /* Free Document */<br/>	<br/>			   xmlcStatus = XRCS_freeDocument(hDoc);<br/>	//		   xmlcStatus = XMLC_freeDocument(hDoc);<br/>	<br/>		   }<br/>	<br/>	<br/>		   <br/>		   if(dsDSI55XML01ZFILE.cXMLStringAlloc == _J('Y'))<br/>		   {<br/>			   xmlcStatus = XRCS_freeString(dsDSI55XML01ZFILE.szXMLString);<br/>//			   xmlcStatus = XMLC_freeString(dsDSI55XML01ZFILE.szXMLString);<br/>	<br/>	<br/>		   }<br/>	<br/>	<br/>		   }<br/>	<br/>   }<br/><br/><br/><br/>   /************************************************************************<br/>    * Function Clean Up<br/>    ************************************************************************/<br/>    <br/>   if(idReturn != ER_SUCCESS)<br/>   {<br/>      lpDS-&gtcErrorCode = _J('1');<br/><br/>	  if(lpDS-&gtcSuppressErrorMessage != _J('1'))<br/>	  {<br/>		  jdeSetGBRErrorSubText(lpBhvrCom, lpVoid, (ID) 0, lpDS-&gtszErrorDataItemCode, &dsDSDE55X01);<br/>		<br/>	  }<br/>   }<br/>       <br/>   if (hUser)<br/>   {<br/>	   JDB_FreeBhvr(hUser);<br/>   }<br/><br/>   return (idReturn);<br/>}<br/><br/><br/><br/><br/>/**************************************************************************<br/> *  Business Function:  XMLWriteToZFile_76B<br/> *<br/> *        Description:  XML Write To Z-File 76B<br/> *<br/> *         Parameters:<br/> *           LPBHVRCOM           lpBhvrCom    Business Function Communications<br/> *           LPVOID              lpVoid       Void Parameter - DO NOT USE!<br/> *           LPDSD70XML01F       lpDS         Parameter Data Structure Pointer  <br/> *<br/> *************************************************************************/<br/><br/>JDEBFRTN (ID) JDEBFWINAPI XMLWriteToZFile_55 (LPBHVRCOM lpBhvrCom, LPVOID lpVoid, LPDSD55XML01F lpDS)  <br/>{<br/>   /************************************************************************<br/>    *  Variable declarations<br/>    ************************************************************************/<br/>	ID                idReturn       = ER_SUCCESS;<br/>    ID                idJDBResult    = JDEDB_PASSED;<br/>    HUSER             hUser          = (HUSER)NULL;<br/>    XRCS_Status       xmlcStatus     = XRCS_SUCCESS;<br/>	XRCS_hDocument    hDoc           = (XRCS_hDocument)NULL; <br/>/*	XMLC_Status       xmlcStatus     = XMLC_SUCCESS;<br/>	XMLC_hDocument    hDoc           = NULL; */<br/>	<br/><br/>	HREQUEST		  hReqF55XMLZ1			= NULL;<br/>	JDEDB_RESULT	  JDEDBResult			= JDEDB_PASSED;<br/>//	DBREF			dbRef					= {0};<br/>//	int				blobSize				= 0;<br/><br/>	BOOL			bErrorFound				= FALSE;<br/><br/><br/><br/>   /************************************************************************<br/>    * Declare structures<br/>    ************************************************************************/<br/><br/>	<br/><br/>	F55XMLZ1			dsF55XMLZ1			= {0};<br/><br/>	DSDE55X01			dsDSDE55X01			= {0};		/* error text substitution structure */<br/><br/><br/>	DSI55XML01FILE		dsDSI55XML01FILE	= {0};<br/><br/>   /************************************************************************<br/>    * Declare pointers<br/>    ************************************************************************/<br/><br/><br/>	JCHAR* szXMLString		= NULL;<br/><br/><br/>   /************************************************************************<br/>    * Check for NULL pointers<br/>    ************************************************************************/<br/>   if ((lpBhvrCom == (LPBHVRCOM) NULL) ||<br/>       (lpVoid    == (LPVOID)    NULL) ||<br/>       (lpDS      == (LPDSD55XML01F)	NULL))<br/>   {<br/>     jdeErrorSet (lpBhvrCom, lpVoid, (ID) 0, _J("4363"), (LPVOID) NULL);<br/>     return ER_ERROR;<br/>   }<br/><br/>   idJDBResult = JDB_InitBhvr((void *)lpBhvrCom, &hUser,<br/>                           (JCHAR *)NULL, JDEDB_COMMIT_AUTO);<br/><br/>   if (idJDBResult == JDEDB_FAILED)<br/>   {<br/>      jdeErrorSet(lpBhvrCom, lpVoid, (ID)0, _J("078S"), (LPVOID)NULL);<br/>      return ER_ERROR;<br/>   }<br/><br/>   /************************************************************************<br/>    * Set pointers<br/>    ************************************************************************/<br/><br/>   /************************************************************************<br/>    * Main Processing<br/>    ************************************************************************/<br/><br/>   /* Initialize output parameters */<br/>   /* ============================ */<br/><br/><br/>   lpDS-&gtcErrorCode = _J('0');<br/>   jdeStrcpy(lpDS-&gtszErrorMessageID, (const JCHAR *)(_J("")));<br/><br/>   <br/>   /* Check required parameters */<br/>   /* ========================= */<br/><br/>   if ((lpDS-&gtidDoc != 0))<br/>   {<br/>	   /* Retrieve document handle */<br/>	   /* ======================== */<br/><br/><br/>	   hDoc = jdeRetrieveDataPtr(hUser, lpDS-&gtidDoc);<br/><br/>	   if(hDoc == (XRCS_hDocument)NULL)<br/>//	   if(hDoc == NULL)<br/>	   {<br/><br/><br/>		   jdeStrcpy(dsDSDE55X01.szErrorReason, (const JCHAR *)(_J("06")));<br/>		   bErrorFound = TRUE;<br/>		   jdeTraceSz(NULL, _J("B55XML02 - jdeRetrieveDataPtr for idDoc failed"));<br/><br/>	   }<br/>	  <br/>   }<br/>   else<br/>   {  <br/>	   jdeStrcpy(dsDSDE55X01.szErrorReason, (const JCHAR *)(_J("01")));<br/>	   bErrorFound = TRUE;<br/>	   jdeTraceSz(NULL, _J("B55XML02 - Invalid parameters passed to XMLWriteToZ-File"));<br/>      <br/>   }<br/><br/><br/><br/>   /* Write To File */<br/>   /* ============= */<br/><br/><br/><br/>   if (!bErrorFound)<br/>   {<br/><br/><br/>	   if (lpDS-&gtcWriteToFileYN == _J('Y'))<br/>	   {<br/>		   /* Create File Name */	<br/>		   /* ================ */<br/><br/>				/* Create File Name */	<br/><br/>				/* szEdiUserId */ <br/>		<br/>				jdeStrncpy (dsDSI55XML01FILE.szEdiUserId, (const JCHAR *)(lpDS-&gtszEdiUserId), DIM(dsDSI55XML01FILE.szEdiUserId));<br/>			   <br/>				/* szEdiBatchNumber */<br/>				<br/>				jdeStrncpy (dsDSI55XML01FILE.szEdiBatchNumber, (const JCHAR *)(lpDS-&gtszEdiBatchNumber), DIM(dsDSI55XML01FILE.szEdiBatchNumber));<br/>				<br/>				/* szEdiBatchNumber */<br/>				<br/>				jdeStrncpy (dsDSI55XML01FILE.szEdiTransactNumber, (const JCHAR *)(lpDS-&gtszEdiTransactNumber), DIM(dsDSI55XML01FILE.szEdiTransactNumber));<br/>				<br/>				/* mnEdiLineNumber */<br/>				<br/>				MathCopy (&dsDSI55XML01FILE.mnEdiLineNumber, &lpDS-&gtmnEdiLineNumber);<br/>		<br/>				/* szXMLInternalReference */<br/>				<br/>				jdeStrncpy (dsDSI55XML01FILE.szXMLInternalReference, (const JCHAR *)(lpDS-&gtszXMLInternalReference), DIM(dsDSI55XML01FILE.szXMLInternalReference));<br/>		<br/>		<br/>				/* cTemporalFile_YN */<br/>		<br/>				dsDSI55XML01FILE.cTemporalFile_YN = _J('N');<br/>		<br/>				/* szXMLFileContainerPath */<br/>				<br/>				jdeStrncpy (dsDSI55XML01FILE.szXMLFileContainerPath, (const JCHAR *)(lpDS-&gtszFileName), DIM(dsDSI55XML01FILE.szXMLFileContainerPath));<br/>				<br/>				<br/>				I55XML01_GenerateXMLFileName(	(LPBHVRCOM) lpBhvrCom,<br/>																(LPVOID) lpVoid, <br/>																(HUSER) hUser,<br/>																(LPDSI55XML01FILE) &dsDSI55XML01FILE);<br/>		<br/>		<br/>		<br/>				 xmlcStatus = XRCS_serializeDocumentToFile(hDoc, dsDSI55XML01FILE.szXMLFullFileName);<br/>	//			 xmlcStatus = XMLC_serializeDocumentToFile(hDoc, dsDSI55XML01FILE.szXMLFullFileName);<br/>		<br/>		<br/>				 if(xmlcStatus != XRCS_SUCCESS)<br/>	//			 if(xmlcStatus != XMLC_SUCCESS)<br/>				 {<br/>		<br/>					 <br/>					 jdeStrcpy(dsDSDE55X01.szErrorReason, (const JCHAR *)(_J("04")));					 <br/>					 bErrorFound = TRUE;<br/>					 jdeTraceSz1(NULL, _J("B55XML02 - Failed to write XML to file:%ls"),dsDSI55XML01FILE.szXMLFullFileName);<br/>		<br/>				 }<br/>				 else<br/>				 {<br/><br/><br/>					 jdeTraceSz(NULL, _J("B55XML02 - XML writed"));<br/>					 jdeTraceSz(NULL, dsDSI55XML01FILE.szXMLFullFileName);<br/><br/><br/>				 }<br/><br/><br/><br/><br/>	   }<br/>	   else<br/>	   {<br/>		   jdeStrcpy (lpDS-&gtszXMLFileContainerPath, (const JCHAR *)(_J("")));<br/><br/>	   }<br/><br/><br/>   }<br/><br/><br/><br/>   /* Write To Z-File */<br/>   /* =============== */<br/><br/><br/>   if (!bErrorFound)<br/>   {<br/>		<br/>				 JDEDBResult = JDB_OpenTable(hUser, <br/>												NID_F55XMLZ1, <br/>												ID_F55XMLZ1_EDUS_EDBT_EDTN_EDLN, <br/>												NULL, <br/>												0, <br/>												NULL, <br/>												&hReqF55XMLZ1);<br/>		<br/>		<br/>				 if (JDEDBResult == JDEDB_PASSED)<br/>				 {<br/>		<br/>					 /* szEdiUserId */<br/>					 <br/>					 jdeStrncpy (dsF55XMLZ1.syedus, (const JCHAR *)(lpDS-&gtszEdiUserId), DIM(dsF55XMLZ1.syedus));<br/>		<br/>					 /* szEdiBatchNumber */<br/>					 <br/>					 jdeStrncpy (dsF55XMLZ1.syedbt, (const JCHAR *)(lpDS-&gtszEdiBatchNumber), DIM(dsF55XMLZ1.syedbt));<br/>		<br/>					 /* szEdiBatchNumber */<br/>		<br/>					 jdeStrncpy (dsF55XMLZ1.syedtn, (const JCHAR *)(lpDS-&gtszEdiTransactNumber), DIM(dsF55XMLZ1.syedtn));<br/>		<br/>					 /* mnEdiLineNumber */<br/>		<br/>					 MathCopy (&dsF55XMLZ1.syedln, &lpDS-&gtmnEdiLineNumber);<br/>		<br/>					 /* szEdiDocumentType */<br/>		<br/>					 jdeStrncpy (dsF55XMLZ1.syedct, (const JCHAR *)(lpDS-&gtszEdiDocumentType), DIM(dsF55XMLZ1.syedct));<br/>		<br/>					 /* szTypeTransaction */<br/>		<br/>					 jdeStrncpy (dsF55XMLZ1.sytytn, (const JCHAR *)(lpDS-&gtszTypeTransaction), DIM(dsF55XMLZ1.sytytn));<br/>		<br/>					 /* szEdiTranslationFormat */<br/>		<br/>					 jdeStrncpy (dsF55XMLZ1.syedft, (const JCHAR *)(lpDS-&gtszEdiTranslationFormat), DIM(dsF55XMLZ1.syedft));<br/>		<br/>					 /* szEdiTranslationFormat */<br/>					 <br/>					 JDEDATECopy(&dsF55XMLZ1.syeddt , &lpDS-&gtjdEdiTransmissionDate );<br/>		<br/>					 /* cDirectionIndicator */<br/>		<br/>					 dsF55XMLZ1.sydrin = lpDS-&gtcDirectionIndicator;<br/>		<br/>					 /* mnEdiLineNumber */<br/>		<br/>					 MathCopy (&dsF55XMLZ1.syeddl, &lpDS-&gtmnEdiDetailLinesProcess);<br/>		<br/>					 /* cEdiSuccessfullyProcess */<br/>		<br/>					 dsF55XMLZ1.syedsp = lpDS-&gtcEdiSuccessfullyProcess;<br/>		<br/>					 /* szTradingPartnerId */<br/>		<br/>					 jdeStrncpy (dsF55XMLZ1.sypnid, (const JCHAR *)(lpDS-&gtszTradingPartnerId), DIM(dsF55XMLZ1.sypnid));<br/>		<br/>					 /* szTransactionAction */<br/>		<br/>					 jdeStrncpy (dsF55XMLZ1.sytnac, (const JCHAR *)(lpDS-&gtszTransactionAction), DIM(dsF55XMLZ1.sytnac));<br/>		<br/>					 /* jdXMLDateProcessed */<br/>					 <br/>					 JDEDATECopy(&dsF55XMLZ1.sy55xdpr , &lpDS-&gtjdXMLDateProcessed );<br/>		<br/>					 /* szXMLTransactionGroup */<br/>		<br/>					 jdeStrncpy (dsF55XMLZ1.sy55xtg, (const JCHAR *)(lpDS-&gtszXMLTransactionGroup), DIM(dsF55XMLZ1.sy55xtg));<br/>		<br/>					 /* szXMLInternalReference */<br/>		<br/>					 jdeStrncpy (dsF55XMLZ1.sy55inre, (const JCHAR *)(lpDS-&gtszXMLInternalReference), DIM(dsF55XMLZ1.sy55inre));<br/>		<br/>					 /* szXMLAditionalCode */<br/>		<br/>					 jdeStrncpy (dsF55XMLZ1.sy55xcd, (const JCHAR *)(lpDS-&gtszXMLAditionalCode), DIM(dsF55XMLZ1.sy55xcd));<br/>		<br/>					 /* cXMLDocumentStatus */<br/>		<br/>					 dsF55XMLZ1.sy55xdos = lpDS-&gtcXMLDocumentStatus;<br/>		<br/>					 /* szXMLVersion */<br/>		<br/>					 jdeStrncpy (dsF55XMLZ1.sy55xmlv, (const JCHAR *)(lpDS-&gtszXMLVersion), DIM(dsF55XMLZ1.sy55xmlv));<br/>		<br/>					 /* szXMLAttributeStrGeneric1 */<br/>		<br/>					 jdeStrncpy (dsF55XMLZ1.sy55xsg1, (const JCHAR *)(lpDS-&gtszXMLAttributeStrGeneric1), DIM(dsF55XMLZ1.sy55xsg1));<br/>		<br/>					 /* szXMLAttributeStrGeneric2 */<br/>		<br/>					 jdeStrncpy (dsF55XMLZ1.sy55xsg2, (const JCHAR *)(lpDS-&gtszXMLAttributeStrGeneric2), DIM(dsF55XMLZ1.sy55xsg2));<br/>		<br/>					 /* szXMLAttributeStrGeneric3 */<br/>		<br/>					 jdeStrncpy (dsF55XMLZ1.sy55xsg3, (const JCHAR *)(lpDS-&gtszXMLAttributeStrGeneric3), DIM(dsF55XMLZ1.sy55xsg3));<br/>		<br/>					 /* mnXMLAttributeNumGeneric1 */<br/>		<br/>					 MathCopy (&dsF55XMLZ1.sy55xng1, &lpDS-&gtmnXMLAttributeNumGeneric1);<br/>		<br/>					 /* mnXMLAttributeNumGeneric1 */<br/>		<br/>					 MathCopy (&dsF55XMLZ1.sy55xng2, &lpDS-&gtmnXMLAttributeNumGeneric2);<br/>		<br/>					 /* mnXMLAttributeNumGeneric3 */<br/>		<br/>					 MathCopy (&dsF55XMLZ1.sy55xng3, &lpDS-&gtmnXMLAttributeNumGeneric3);<br/>		<br/>					 /* jdXMLAttributeDatGeneric1 */<br/>					 <br/>					 JDEDATECopy(&dsF55XMLZ1.sy55xdg1 , &lpDS-&gtjdXMLAttributeDatGeneric1 );<br/>		<br/>					 /* jdXMLAttributeDatGeneric2 */<br/>					 <br/>					 JDEDATECopy(&dsF55XMLZ1.sy55xdg2 , &lpDS-&gtjdXMLAttributeDatGeneric2 );<br/>		<br/>					 /* jdXMLAttributeDatGeneric3 */<br/>					 <br/>					 JDEDATECopy(&dsF55XMLZ1.sy55xdg3 , &lpDS-&gtjdXMLAttributeDatGeneric3 );<br/>		<br/>					 /* idXMLAttributeIntGeneric1 */<br/>		<br/>					 dsF55XMLZ1.sy55xig1 = lpDS-&gtidXMLAttributeIntGeneric1;<br/>		<br/>					 /* idXMLAttributeIntGeneric1 */<br/>		<br/>					 dsF55XMLZ1.sy55xcg1 = lpDS-&gtcXMLAttributeChrGeneric1;<br/>		<br/>					 /* idXMLAttributeIntGeneric2 */<br/>		<br/>					 dsF55XMLZ1.sy55xcg2 = lpDS-&gtcXMLAttributeChrGeneric2;<br/>		<br/>					 /* idXMLAttributeIntGeneric3 */<br/>		<br/>					 dsF55XMLZ1.sy55xcg3 = lpDS-&gtcXMLAttributeChrGeneric3;<br/>		<br/>					 /* mnXMLAddressNumber */<br/>		<br/>					 MathCopy (&dsF55XMLZ1.syan8, &lpDS-&gtmnXMLAddressNumber);<br/>		<br/>					 /* szXMLCostCenter */<br/>		<br/>					 jdeStrncpy (dsF55XMLZ1.symcu, (const JCHAR *)(lpDS-&gtszXMLCostCenter), DIM(dsF55XMLZ1.symcu));<br/>		<br/>					 /* szXMLCompany */<br/>		<br/>					 jdeStrncpy (dsF55XMLZ1.syco, (const JCHAR *)(lpDS-&gtszXMLCompany), DIM(dsF55XMLZ1.syco));<br/>		<br/>					 /* szXMLDocumentType */<br/>		<br/>					 jdeStrncpy (dsF55XMLZ1.sydct, (const JCHAR *)(lpDS-&gtszXMLDocumentType), DIM(dsF55XMLZ1.sydct));<br/>		<br/>					 /* szUserReservedCode */<br/>		<br/>					 jdeStrncpy (dsF55XMLZ1.syurcd, (const JCHAR *)(lpDS-&gtszUserReservedCode), DIM(dsF55XMLZ1.syurcd));<br/>		<br/>					 /* jdUserReservedDate */<br/>					 <br/>					 JDEDATECopy(&dsF55XMLZ1.syurdt , &lpDS-&gtjdUserReservedDate );<br/>					 <br/>					 /* mnUserReservedAmount */<br/>		<br/>					 MathCopy (&dsF55XMLZ1.syurat, &lpDS-&gtmnUserReservedAmount);<br/>		<br/>					 /* mnUserReservedNumber */<br/>		<br/>					 MathCopy (&dsF55XMLZ1.syurat, &lpDS-&gtmnUserReservedNumber);<br/>		<br/>					 /* szUserReservedReference */<br/>		<br/>					 jdeStrncpy (dsF55XMLZ1.syurrf, (const JCHAR *)(lpDS-&gtszUserReservedReference), DIM(dsF55XMLZ1.syurrf));<br/>		<br/>					 /* szTransactionOriginator */<br/>		<br/>					 jdeStrncpy (dsF55XMLZ1.sytorg, (const JCHAR *)(lpDS-&gtszTransactionOriginator), DIM(dsF55XMLZ1.sytorg));<br/>		<br/>					 /* szUserId */<br/>		<br/>					 jdeStrncpy (dsF55XMLZ1.syuser, (const JCHAR *)(lpDS-&gtszUserId), DIM(dsF55XMLZ1.syuser));<br/>		<br/>					 /* szProgramId */<br/>		<br/>					 jdeStrncpy (dsF55XMLZ1.sypid, (const JCHAR *)(lpDS-&gtszProgramId), DIM(dsF55XMLZ1.sypid));<br/>		<br/>					 /* szWorkStationId */<br/>		<br/>					 jdeStrncpy (dsF55XMLZ1.syjobn, (const JCHAR *)(lpDS-&gtszWorkStationId), DIM(dsF55XMLZ1.syjobn));<br/>		<br/>					 /* jdDateUpdated */<br/>					 <br/>					 JDEDATECopy(&dsF55XMLZ1.syupmj , &lpDS-&gtjdDateUpdated );<br/>		<br/>					 /* mnTimeLastUpdated */<br/>		<br/>					 MathCopy (&dsF55XMLZ1.syupmt, &lpDS-&gtmnTimeLastUpdated);<br/><br/>					 /* szXMLFullFileName */<br/><br/>					 jdeStrncpy (dsF55XMLZ1.sy55path, dsDSI55XML01FILE.szXMLFullFileName, DIM(dsF55XMLZ1.sy55path));<br/><br/>					 jdeStrncpy (lpDS-&gtszXMLFileContainerPath, (const JCHAR *)(dsDSI55XML01FILE.szXMLFullFileName), DIM(lpDS-&gtszXMLFileContainerPath));<br/><br/>					 <br/>		<br/>					 /* XML */<br/>		<br/>					 xmlcStatus = XRCS_serializeDocumentToXMLString(hDoc,&szXMLString);<br/>		//			 xmlcStatus = XMLC_serializeDocumentToXMLString(hDoc,&szXMLString);<br/>		<br/>/*					 jdeNIDcpy(dbRef.szTable, NID_F70XMLZ1);<br/>					 dbRef.idInstance = 0L;<br/>					 jdeNIDcpy(dbRef.szDict, NID_G70TXFT);<br/>					 blobSize = ( (strlen(szXMLString)+ 1) * sizeof(JCHAR ) ) ;<br/>					 dsF55XMLZ1.syg70txft.lpValue  = JDB_SetBLOBSize(hReqF70XMLZ1, dbRef, blobSize);<br/>					 dsF55XMLZ1.syg70txft.lSize	  = blobSize;<br/>					 dsF55XMLZ1.syg70txft.lMaxSize = MAX_BLOB_SIZE;<br/>		<br/>					 if(dsF55XMLZ1.syg70txft.lpValue != NULL)<br/>					 {<br/>		<br/>						 memcpy((void*)dsF55XMLZ1.syg70txft.lpValue, (void*)szXMLString,dsF55XMLZ1.syg70txft.lSize);<br/>		<br/>					 }<br/>*/					<br/>					 if(szXMLString != NULL)<br/>					 {<br/>						jdeStrncpy (dsF55XMLZ1.sytxvc, szXMLString, DIM(dsF55XMLZ1.sytxvc));<br/>					 }<br/>					 <br/>					 JDEDBResult = JDB_InsertTable(hReqF55XMLZ1, NID_F55XMLZ1, (ID)0, &dsF55XMLZ1);<br/>		<br/>		<br/>					 if (JDEDBResult != JDEDB_PASSED)<br/>					 {<br/>		<br/>						bErrorFound = TRUE;<br/>						jdeStrcpy(dsDSDE55X01.szErrorReason, (const JCHAR *)(_J("03")));<br/>						jdeTraceSz(NULL, _J("B55XML02 - Insert to table F55XMLZ1 failed"));<br/>		<br/>		<br/>					 }<br/>		<br/>		<br/>		<br/>					 JDB_CloseTable(hReqF55XMLZ1);<br/>							 <br/>					 if(szXMLString != NULL)<br/>					 {<br/>						 XRCS_freeString(szXMLString);<br/>			//			 XMLC_freeString(szXMLString);<br/>					 }<br/>		<br/>		<br/>				 }<br/>				 else<br/>				 {<br/>		<br/>					<br/>					 bErrorFound = TRUE;<br/>					 jdeStrcpy(dsDSDE55X01.szErrorReason, (const JCHAR *)(_J("02")));<br/>					 jdeTraceSz(NULL, _J("B55XML02 - Open for table F55XMLZ1 failed"));<br/>	<br/>				 }<br/>		<br/>		<br/>   }<br/><br/><br/>   /************************************************************************ <br/>    * Function Clean Up <br/>    ************************************************************************/ <br/><br/>   if(bErrorFound)<br/>   {<br/>      idReturn = ER_ERROR;<br/>      <br/>	  lpDS-&gtcErrorCode = _J('1');<br/>	  jdeStrcpy(lpDS-&gtszErrorMessageID, (const JCHAR *)(_J("G55E001")));<br/>	  <br/>	  if(lpDS-&gtcSuppressErrorMessage != _J('1'))<br/>	  {<br/>		  jdeSetGBRErrorSubText(lpBhvrCom, lpVoid, (ID) 0, lpDS-&gtszErrorMessageID, &dsDSDE55X01);<br/>		<br/>	  }<br/><br/>      jdeTraceSz(NULL, _J("B55XML02 - Failed to write XML to file"));<br/>   }<br/><br/>	if (hUser)<br/>	{<br/>		JDB_FreeBhvr(hUser);<br/>	}<br/>          <br/>   return (idReturn); <br/><br/>}<br/><br/>/**************************************************************************<br/> *  Business Function:  XMLFreeDocument_76B<br/> *<br/> *        Description:  XML Free Document 76B<br/> *<br/> *         Parameters:<br/> *           LPBHVRCOM           lpBhvrCom    Business Function Communications<br/> *           LPVOID              lpVoid       Void Parameter - DO NOT USE!<br/> *           LPDSD70XML01G       lpDS         Parameter Data Structure Pointer  <br/> *<br/> *************************************************************************/<br/><br/>JDEBFRTN (ID) JDEBFWINAPI XMLFreeDocument_55 (LPBHVRCOM lpBhvrCom, LPVOID lpVoid, LPDSD55XML01G lpDS)  <br/>{<br/>   /************************************************************************<br/>    *  Variable declarations<br/>    ************************************************************************/<br/>   ID                idReturn       = ER_SUCCESS;<br/>   ID                idJDBResult    = JDEDB_PASSED;<br/>   HUSER             hUser          = (HUSER)NULL;<br/>   XRCS_Status       xmlcStatus     = XRCS_SUCCESS;<br/>   XRCS_hElement     hElement       = (XRCS_hElement)NULL;<br/>   XRCS_hDocument    hDoc           = (XRCS_hDocument)NULL;<br/>// XMLC_Status       xmlcStatus	    = XMLC_SUCCESS;<br/>// XMLC_hElement	 hElement		= NULL;<br/>// XMLC_hDocument	 hDoc			= NULL;<br/>   <br/>   /************************************************************************<br/>    * Declare structures<br/>    ************************************************************************/<br/><br/>   <br/><br/>   DSDE55X01			dsDSDE55X01			= {0};		/* error text substitution structure */<br/><br/><br/>   /************************************************************************<br/>    * Declare pointers<br/>    ************************************************************************/<br/><br/>   /************************************************************************<br/>    * Check for NULL pointers<br/>    ************************************************************************/<br/>   if ((lpBhvrCom == (LPBHVRCOM) NULL) ||<br/>       (lpVoid    == (LPVOID)    NULL) ||<br/>       (lpDS      == (LPDSD55XML01G)	NULL))<br/>   {<br/>     jdeErrorSet (lpBhvrCom, lpVoid, (ID) 0, _J("4363"), (LPVOID) NULL);<br/>     return ER_ERROR;<br/>   }<br/><br/><br/>   idJDBResult = JDB_InitBhvr((void *)lpBhvrCom, &hUser,<br/>                           (JCHAR *)NULL, JDEDB_COMMIT_AUTO);<br/><br/>   if (idJDBResult == JDEDB_FAILED)<br/>   {<br/>      jdeErrorSet(lpBhvrCom, lpVoid, (ID)0, _J("078S"), (LPVOID)NULL);<br/>      return ER_ERROR;<br/>   }<br/><br/>   /************************************************************************<br/>    * Set pointers<br/>    ************************************************************************/<br/><br/>   /************************************************************************<br/>    * Main Processing<br/>    ************************************************************************/<br/>   <br/>   /* Initialize output parameters */<br/>   /* ============================ */<br/><br/>   lpDS-&gtcErrorCode = _J('0');<br/>   jdeStrcpy(lpDS-&gtszErrorMessageID, (const JCHAR *)(_J("")));<br/><br/>   <br/>   /* Check required parameters */<br/>   /* ========================= */<br/><br/><br/>   if ((lpDS-&gtidDoc != 0) &&<br/>       (lpDS-&gtidDocElement != 0))<br/>   {<br/><br/>		<br/>		  /* Remove Element handle */<br/>		  /* --------------------- */<br/><br/>		  hElement = jdeRemoveDataPtr(hUser, lpDS-&gtidDocElement);<br/><br/>		  if (hElement != (XRCS_hElement)NULL)<br/>//		  if (hElement != NULL)<br/>		  {<br/> 			  /* Free the element */<br/>			  /* ---------------- */<br/><br/>			  xmlcStatus = XRCS_freeElement(hElement);<br/>		//	  xmlcStatus = XMLC_freeElement(hElement);<br/><br/>			  if(xmlcStatus != XRCS_SUCCESS)<br/>		//	  if(xmlcStatus != XMLC_SUCCESS)<br/>			  {<br/>				  jdeStrcpy(dsDSDE55X01.szErrorReason, (const JCHAR *)(_J("05")));	   <br/>				  jdeTraceSz(NULL, _J("B55XML01 - Failed to get XML parser functions"));<br/>				  <br/>			  }<br/>			  <br/>			  /*Reset the ID to zero*/<br/>			  lpDS-&gtidDocElement = 0;<br/>		  }<br/>		  else<br/>		  {<br/>			  xmlcStatus = XRCS_ERROR;<br/>			  jdeStrcpy(dsDSDE55X01.szErrorReason, (const JCHAR *)(_J("05")));<br/>			  jdeTraceSz(NULL, _J("B55XML01 - Failed to remove Element Handle"));<br/><br/><br/>		  }<br/><br/>		  /* Remove Document handle */<br/>		  /* ---------------------- */<br/><br/>		  if(xmlcStatus == XRCS_SUCCESS)<br/>	//	  if(xmlcStatus == XMLC_SUCCESS)<br/>		  {<br/><br/>			  hDoc = jdeRemoveDataPtr(hUser, lpDS-&gtidDoc);<br/><br/>			  if (hDoc != (XRCS_hDocument)NULL)<br/>	//		  if (hDoc != NULL)<br/>			  {<br/><br/>				  /* Free the Document */<br/><br/>				  xmlcStatus = XRCS_freeDocument(hDoc);<br/>		//		  xmlcStatus = XMLC_freeDocument(hDoc);<br/><br/>				  if(xmlcStatus != XRCS_SUCCESS)<br/>		//		  if(xmlcStatus != XMLC_SUCCESS)<br/>				  {<br/>					  memset((void *)(&dsDSDE55X01), (int)(_J('\0')), sizeof(dsDSDE55X01));<br/>					  jdeStrcpy(dsDSDE55X01.szErrorReason, (const JCHAR *)(_J("05")));<br/>					  jdeStrcpy(lpDS-&gtszErrorMessageID, (const JCHAR *)(_J("G55E003")));	   <br/>					  jdeTraceSz(NULL, _J("B55XML01 - Failed to get XML parser functions"));<br/>					  <br/>				  }<br/><br/>				  /*Reset the ID to zero*/<br/><br/>				  lpDS-&gtidDoc = 0;<br/><br/>			  }<br/>			  else<br/>			  {<br/><br/>				  xmlcStatus = XRCS_ERROR;<br/>			//	  xmlcStatus = XMLC_ERROR;<br/>				  jdeStrcpy(dsDSDE55X01.szErrorReason, (const JCHAR *)(_J("05")));	   <br/>				  jdeTraceSz(NULL, _J("B55XML01 - Failed to remove Document Handle"));<br/><br/>			  }<br/><br/><br/>		  }<br/><br/><br/>      <br/>   }<br/>   else<br/>   {<br/>  		 xmlcStatus = XRCS_ERROR;<br/>	//   xmlcStatus = XMLC_ERROR;<br/>		 jdeStrcpy(dsDSDE55X01.szErrorReason, (const JCHAR *)(_J("04")));		   <br/>		 jdeTraceSz(NULL, _J("B55XML01 - Invalid parameters passed to XMLFreeDocument"));<br/><br/>   }<br/><br/>   /************************************************************************<br/>    * Function Clean Up<br/>    ************************************************************************/<br/>   if(xmlcStatus != XRCS_SUCCESS)<br/> //if(xmlcStatus != XMLC_SUCCESS)<br/>   {<br/>      idReturn = ER_ERROR;<br/>      lpDS-&gtcErrorCode = _J('1');      	  <br/>	  jdeStrcpy(lpDS-&gtszErrorMessageID, (const JCHAR *)(_J("G55E003")));	 <br/><br/>	  if(lpDS-&gtcSuppressErrorMessage != _J('1'))<br/>	  {<br/>		  jdeSetGBRErrorSubText(lpBhvrCom, lpVoid, (ID) 0, lpDS-&gtszErrorMessageID, &dsDSDE55X01);<br/>		<br/>	  }<br/>   <br/>   }<br/><br/>	if (hUser)<br/>	{<br/>		JDB_FreeBhvr(hUser);<br/>	}<br/>   <br/>   return (idReturn);<br/>}<br/><br/><br/><br/>/**************************************************************************<br/> *  Business Function:  XMLGetXMLValueByTagName<br/> *<br/> *        Description:  XML Get XML Value By Tag Name<br/> *<br/> *         Parameters:<br/> *           LPBHVRCOM           lpBhvrCom    Business Function Communications<br/> *           LPVOID              lpVoid       Void Parameter - DO NOT USE!<br/> *           LPDSD70XML01H       lpDS         Parameter Data Structure Pointer  <br/> *<br/> *<br/> *<br/> *   Input:  idAPIs                 <br/> *           szEdiUserId            F70XMLZ1 Key<br/> *           szEdiBatchNumber       F70XMLZ1 Key<br/> *           szEdiTransactNumber    F70XMLZ1 Key<br/> *           mnEdiLineNumber        F70XMLZ1 Key<br/> *           szElementName          Element Name to search value            <br/> *           szElementValueToCompare<br/> *           cSuppressErrorMessage<br/> *   Output: szElementValueFound<br/> *           cMatchValue_YN                               <br/> *           szErrorDataItemCode<br/> *           cErrorCode             ('1' Error Found)<br/> *<br/> *<br/> *************************************************************************/<br/><br/>JDEBFRTN (ID) JDEBFWINAPI XMLGetXMLValueByTagName_55 (LPBHVRCOM lpBhvrCom, LPVOID lpVoid, LPDSD55XML01H lpDS)  <br/>{<br/>   /************************************************************************<br/>    *  Variable declarations<br/>    ************************************************************************/<br/>   ID						idReturn       = ER_SUCCESS;<br/>   ID						idJDBResult    = JDEDB_PASSED;<br/>   HUSER					hUser          = (HUSER)NULL;<br/>   BOOL						bErrorFound		= FALSE;<br/><br/>   <br/>   XRCS_Status				xmlcStatus		= XRCS_SUCCESS;	<br/>   XRCS_hDocument			hDoc           = (XRCS_hDocument)NULL;<br/>   XRCS_hElement			hDocElement    = (XRCS_hElement)NULL;<br/>   XRCS_hElement*			lphElement		= (XRCS_hElement*)NULL; <br/><br/>/* XMLC_Status				xmlcStatus		= XMLC_SUCCESS;	<br/>   XMLC_hDocument			hDoc            = (XMLC_hDocument)NULL;<br/>   XMLC_hElement			hDocElement     = (XMLC_hElement)NULL;<br/>   XMLC_hElement*			lphElement		= (XMLC_hElement*)NULL; */<br/><br/>   unsigned int				iNumElements            = 0;<br/><br/>   JCHAR *            szTempString            = (JCHAR*)NULL;<br/>   JCHAR              *szMatch				= (JCHAR*)NULL;<br/><br/><br/>   /************************************************************************<br/>    * Declare structures<br/>    ************************************************************************/<br/><br/>   <br/>   DSDE55X01			dsDSDE55X01			= {0};		/* error text substitution structure */<br/><br/><br/>   /************************************************************************<br/>    * Declare pointers<br/>    ************************************************************************/<br/><br/>   /************************************************************************<br/>    * Check for NULL pointers<br/>    ************************************************************************/<br/>   if ((lpBhvrCom == (LPBHVRCOM) NULL) ||<br/>       (lpVoid    == (LPVOID)    NULL) ||<br/>       (lpDS      == (LPDSD55XML01H)	NULL))<br/>   {<br/>     jdeErrorSet (lpBhvrCom, lpVoid, (ID) 0, _J("4363"), (LPVOID) NULL);<br/>     return ER_ERROR;<br/>   }<br/><br/>   idJDBResult = JDB_InitBhvr((void *)lpBhvrCom, &hUser,<br/>                           (JCHAR *)NULL, JDEDB_COMMIT_AUTO);<br/><br/>   if (idJDBResult == JDEDB_FAILED)<br/>   {<br/>      jdeErrorSet(lpBhvrCom, lpVoid, (ID)0, _J("078S"), (LPVOID)NULL);<br/>      return ER_ERROR;<br/>   }<br/><br/><br/>   /************************************************************************<br/>    * Set pointers<br/>    ************************************************************************/<br/><br/>   /************************************************************************<br/>    * Main Processing<br/>    ************************************************************************/<br/>   lpDS-&gtcErrorCode = _J('0');<br/>   jdeStrcpy(lpDS-&gtszErrorDataItemCode, (const JCHAR *)(_J("")));<br/>   jdeStrcpy(lpDS-&gtszElementValueFound, (const JCHAR *)(_J("")));<br/>   lpDS-&gtcMatchValue_YN = _J('N');<br/><br/>   /*Check required parameters*/<br/>   <br/>	<br/>   if (lpDS-&gtidDoc != 0 && lpDS-&gtidDocElement != 0)<br/>   {<br/><br/>		   /*Retrieve function pointers*/<br/>		   	   <br/>		   hDoc = jdeRetrieveDataPtr(hUser, lpDS-&gtidDoc);<br/><br/>		   if(hDoc == (XRCS_hDocument)NULL)<br/>//		   if(hDoc == NULL)<br/>		   {<br/><br/>			   jdeTraceSz(NULL, _J("B55XML02 - Invalid Memory Reference: jdeRetrieveDataPtr for idDoc failed."));<br/>			   bErrorFound = TRUE;<br/>			   jdeStrcpy(dsDSDE55X01.szErrorReason, (const JCHAR *)(_J("02")));		   <br/><br/>		   }<br/><br/>		   hDocElement = jdeRetrieveDataPtr(hUser, lpDS-&gtidDocElement);<br/><br/>		   if(hDocElement == (XRCS_hElement*)NULL)<br/>//		   if(hDocElement == NULL)<br/>		   {<br/><br/>			   jdeTraceSz(NULL, _J("B55XML02 - Invalid Memory Reference: jdeRetrieveDataPtr for idDocElement failed."));<br/>			   bErrorFound = TRUE;<br/>			   jdeStrcpy(dsDSDE55X01.szErrorReason, (const JCHAR *)(_J("02")));		   <br/>			   <br/>		   }<br/><br/>	}<br/>	else<br/>	{<br/>		 bErrorFound = TRUE;<br/>		 jdeTraceSz(NULL, _J("B55XML02 - Invalid parameters passed to XMLGetXMLValueByTagName_76B"));<br/>		 jdeStrcpy(dsDSDE55X01.szErrorReason, (const JCHAR *)(_J("01")));		   <br/>		 <br/>	}<br/><br/><br/>	 <br/>   /* Search For Value */<br/>   /* ================ */<br/><br/>   if(!bErrorFound)<br/>   {<br/><br/><br/>	   /* Get Root Element of the File */<br/>	   /* ============================ */<br/><br/><br/>	   jdeStripTrailingBlanks(lpDS-&gtszElementName);<br/><br/>	<br/>	   xmlcStatus = XRCS_getElementsByTagName(	hDocElement,<br/>															lpDS-&gtszElementName,<br/>															&lphElement, <br/>															&iNumElements);<br/><br/>/*	   xmlcStatus = XMLC_getElementsByTagName(	hDocElement,<br/>															lpDS-&gtszElementName,<br/>															&lphElement, <br/>															&iNumElements); */<br/><br/><br/>		if(xmlcStatus == XRCS_SUCCESS)<br/>//		if(xmlcStatus == XMLC_SUCCESS)<br/>		{<br/><br/>			   if(iNumElements &gt 0 && lphElement != (XRCS_hElement*) NULL)<br/>//			   if(iNumElements &gt 0 && lphElement != (XMLC_hElement*) NULL)<br/>			   {<br/><br/>				   xmlcStatus = XRCS_getElementText(	lphElement[0],<br/>																&szTempString); <br/><br/>/*				   xmlcStatus = XMLC_getElementText(	lphElement[0],<br/>																&szTempString); */<br/><br/><br/><br/>				   if (szTempString != (JCHAR*)NULL)<br/>				   {<br/><br/>					                        <br/>					   jdeStrcpyAndTerminate((JCHAR*)lpDS-&gtszElementValueFound, <br/>												(const JCHAR*)szTempString, <br/>												DIM(lpDS-&gtszElementValueFound));          <br/>					   <br/>					   xmlcStatus = XRCS_freeString(szTempString);<br/>//					   xmlcStatus = XMLC_freeString(szTempString);<br/>					   <br/>					   szTempString = (JCHAR *)NULL; <br/><br/><br/>					   I55XML01_RemoveSurroundingBlanks(lpDS-&gtszElementValueFound);<br/>					   I55XML01_RemoveIllegalCharacterForAString(lpDS-&gtszElementValueFound);<br/>					   <br/>					   /* Compare Value */<br/><br/>					   if(!IsStringBlank(lpDS-&gtszElementValueToCompare))<br/>					   {<br/><br/>						   jdeStrupr(lpDS-&gtszElementValueFound);<br/>						   jdeStrupr(lpDS-&gtszElementValueToCompare);<br/><br/>						   if((szMatch = jdeStrstr(lpDS-&gtszElementValueFound,lpDS-&gtszElementValueToCompare )) != NULL)<br/>						   {<br/><br/>							   lpDS-&gtcMatchValue_YN = _J('Y');<br/>							   <br/><br/>						   }<br/>						   else<br/>						   {<br/><br/><br/>							   jdeStrcpy(lpDS-&gtszElementValueFound,_J(""));<br/><br/><br/>						   }<br/><br/><br/><br/>					   }<br/><br/><br/><br/>				   }<br/><br/><br/>			   }<br/>			   else<br/>			   {<br/><br/>				   bErrorFound = TRUE;<br/>				   jdeTraceSz1(NULL, _J("B55XML02 - Element Name %ls not Found"),lpDS-&gtszElementName);<br/>				   jdeStrcpy(dsDSDE55X01.szErrorReason, (const JCHAR *)(_J("03")));<br/><br/>			   }<br/><br/><br/><br/><br/>		}<br/>		else<br/>		{<br/>			<br/>			bErrorFound = TRUE;<br/>			jdeTraceSz1(NULL, _J("B55XML02 - Element Name %ls not Found"),lpDS-&gtszElementName);<br/>			jdeStrcpy(dsDSDE55X01.szErrorReason, (const JCHAR *)(_J("03")));<br/><br/><br/>		}<br/><br/>	   	   <br/>	   /*Free Array of Elements */<br/>	<br/>	   if (lphElement != (XRCS_hElement*)NULL)<br/>//	   if (lphElement != (XMLC_hElement*)NULL)<br/>	   {<br/>		   xmlcStatus = XRCS_freeElementArray(lphElement, iNumElements);  <br/>//		   xmlcStatus = XMLC_freeElementArray(lphElement, iNumElements);<br/>		   lphElement = (XRCS_hElement*)NULL;<br/>//		   lphElement = (XMLC_hElement*)NULL;<br/>	   }<br/><br/>   <br/>   }<br/><br/><br/><br/><br/><br/>   /************************************************************************<br/>    * Function Clean Up<br/>    ************************************************************************/<br/><br/>   if(bErrorFound)<br/>   {<br/>      lpDS-&gtcErrorCode = _J('1');<br/>	  idReturn = ER_ERROR;<br/>	  jdeStrcpy(lpDS-&gtszErrorDataItemCode, (const JCHAR *)(_J("G55E008")));<br/><br/>	  if(lpDS-&gtcSuppressErrorMessage != _J('1'))<br/>	  {<br/>		  jdeSetGBRErrorSubText(lpBhvrCom, lpVoid, (ID) 0, lpDS-&gtszErrorDataItemCode, &dsDSDE55X01);<br/>		<br/>	  }<br/>   }<br/>       <br/>   if (hUser)<br/>   {<br/>	   JDB_FreeBhvr(hUser);<br/>   }<br/><br/>   return (idReturn);<br/><br/>}<br/><br/><br/><br/>/**************************************************************************<br/> *  Business Function:  XMLCreateDocumentFromZFile_76B<br/> *<br/> *        Description:  XML Create Document From Z File 76B<br/> *<br/> *         Parameters:<br/> *           LPBHVRCOM           lpBhvrCom    Business Function Communications<br/> *           LPVOID              lpVoid       Void Parameter - DO NOT USE!<br/> *           LPDSD70XML01I       lpDS         Parameter Data Structure Pointer  <br/> *<br/> *************************************************************************/<br/><br/>JDEBFRTN (ID) JDEBFWINAPI XMLCreateDocumentFromZFile_55 (LPBHVRCOM lpBhvrCom, LPVOID lpVoid, LPDSD55XML01I lpDS)  <br/>{<br/>   /************************************************************************<br/>    *  Variable declarations<br/>    ************************************************************************/<br/>   ID						idReturn       = ER_SUCCESS;<br/>   ID						idJDBResult    = JDEDB_PASSED;<br/>   HUSER					hUser          = (HUSER)NULL;<br/>   BOOL						bErrorFound		= FALSE;<br/><br/>   XRCS_hParser				hParser			= (XRCS_hParser) NULL;<br/>   XRCS_Status				xmlcStatus		= XRCS_SUCCESS;	<br/>   XRCS_hDocument			hDoc            = (XRCS_hDocument)NULL;<br/>   XRCS_hElement			hDocElement     = (XRCS_hElement)NULL;<br/><br/>/* XMLC_hParser				hParser			= (XMLC_hParser) NULL;<br/>   XMLC_Status				xmlcStatus		= XMLC_SUCCESS;	<br/>   XMLC_hDocument			hDoc            = (XMLC_hDocument)NULL;<br/>   XMLC_hElement			hDocElement     = (XMLC_hElement)NULL; */<br/><br/>   /************************************************************************<br/>    * Declare structures<br/>    ************************************************************************/<br/><br/>   <br/>   DSDE55X01			dsDSDE55X01			= {0};		/* error text substitution structure */<br/>   DSI55XML01ZFILE		dsDSI55XML01ZFILE	= {0};<br/><br/><br/>   /************************************************************************<br/>    * Declare pointers<br/>    ************************************************************************/<br/><br/>   /************************************************************************<br/>    * Check for NULL pointers<br/>    ************************************************************************/<br/>   if ((lpBhvrCom == (LPBHVRCOM) NULL) ||<br/>       (lpVoid    == (LPVOID)    NULL) ||<br/>       (lpDS      == (LPDSD55XML01I)	NULL))<br/>   {<br/>     jdeErrorSet (lpBhvrCom, lpVoid, (ID) 0, _J("4363"), (LPVOID) NULL);<br/>     return ER_ERROR;<br/>   }<br/><br/>   idJDBResult = JDB_InitBhvr((void *)lpBhvrCom, &hUser,<br/>                           (JCHAR *)NULL, JDEDB_COMMIT_AUTO);<br/><br/>   if (idJDBResult == JDEDB_FAILED)<br/>   {<br/>      jdeErrorSet(lpBhvrCom, lpVoid, (ID)0, _J("078S"), (LPVOID)NULL);<br/>      return ER_ERROR;<br/>   }<br/><br/><br/>   /************************************************************************<br/>    * Set pointers<br/>    ************************************************************************/<br/><br/>   /************************************************************************<br/>    * Main Processing<br/>    ************************************************************************/<br/>   <br/>   lpDS-&gtcErrorCode = _J('0');<br/>   jdeStrcpy(lpDS-&gtszErrorMessageID, (const JCHAR *)(_J("")));<br/>   jdeStrcpy(lpDS-&gtszXMLErrorCode, (const JCHAR *)(_J("")));<br/>   lpDS-&gtidDoc = 0;<br/>   lpDS-&gtidDocElement = 0;<br/><br/>   /* Variable cTakeXMLfromFileYN = 'N' Only search the XML in Blob Field */<br/>   /*          cTakeXMLfromFileYN = 'Y' The process takes the XML from .XML only if blob is empty */<br/>   /*          cTakeXMLfromFileYN = '*' The process takes the XML only from .XML */<br/><br/>   /* Get XML String */<br/>   /* ============== */<br/>	<br/>   /* szEdiUserId */<br/>   <br/>   jdeStrncpy (dsDSI55XML01ZFILE.szEdiUserId, (const JCHAR *)(lpDS-&gtszEdiUserId), DIM(dsDSI55XML01ZFILE.szEdiUserId));<br/>   <br/>   /* szEdiBatchNumber */<br/>   <br/>   jdeStrncpy (dsDSI55XML01ZFILE.szEdiBatchNumber, (const JCHAR *)(lpDS-&gtszEdiBatchNumber), DIM(dsDSI55XML01ZFILE.szEdiBatchNumber));<br/>   <br/>   /* szEdiBatchNumber */<br/>   <br/>   jdeStrncpy (dsDSI55XML01ZFILE.szEdiTransactNumber, (const JCHAR *)(lpDS-&gtszEdiTransactNumber), DIM(dsDSI55XML01ZFILE.szEdiTransactNumber));<br/>   <br/>   /* mnEdiLineNumber */<br/>   <br/>   MathCopy (&dsDSI55XML01ZFILE.mnEdiLineNumber, &lpDS-&gtmnEdiLineNumber);<br/><br/>   /* Error Code */<br/><br/>   jdeStrcpy (dsDSI55XML01ZFILE.szXMLErrorCode, (const JCHAR *)(_J("")));<br/>   jdeStrcpy (dsDSI55XML01ZFILE.szErrorReason, (const JCHAR *)(_J("")));<br/>   jdeStrcpy (dsDSI55XML01ZFILE.szErrorMessageID, (const JCHAR *)(_J("")));<br/><br/> <br/>   bErrorFound = I55XML01_GetXMLString(	(LPBHVRCOM) lpBhvrCom,<br/>										(LPVOID) lpVoid, <br/>										(HUSER) hUser,<br/>										(LPDSI55XML01ZFILE) &dsDSI55XML01ZFILE);<br/><br/><br/><br/>   if(!bErrorFound)<br/>   {<br/><br/>			   /*  Get the Xerces Parser  */<br/>			   <br/>			   xmlcStatus = XRCS_getParser(&hParser);<br/>//			   xmlcStatus = XMLC_getParser(&hParser);<br/>			   <br/>			   if(xmlcStatus == XRCS_SUCCESS)<br/>//			   if(xmlcStatus == XMLC_SUCCESS)<br/>			   {<br/>				   <br/>				   /*  Parse From String or File */<br/>				   /*  ========================= */<br/>				   <br/>				   if(dsDSI55XML01ZFILE.lBlobSize == 0  || lpDS-&gtcTakeXMLfromFileYN == _J('*'))<br/>				   {<br/>					   <br/>					   if(lpDS-&gtcTakeXMLfromFileYN == _J('Y') || lpDS-&gtcTakeXMLfromFileYN == _J('*'))<br/>					   {<br/>						   <br/>						   if(I55XML01_DoesXMLFileExists(dsDSI55XML01ZFILE.szXMLFileContainerPath))<br/>						   {<br/>							   <br/>							   xmlcStatus = XRCS_parseXMLFile(hParser,dsDSI55XML01ZFILE.szXMLFileContainerPath,&hDoc);<br/>//							   xmlcStatus = XMLC_parseXMLFile(hParser,dsDSI55XML01ZFILE.szXMLFileContainerPath,&hDoc);<br/>							   <br/>							   if(xmlcStatus != XRCS_SUCCESS)<br/>//							   if(xmlcStatus != XMLC_SUCCESS)<br/>							   {<br/>								   bErrorFound = TRUE;<br/>								   jdeTraceSz(NULL, _J("B55XML02 - Failed to get .xml file"));<br/>								   jdeStrcpy(dsDSDE55X01.szErrorReason, (const JCHAR *)(_J("08")));		   <br/>								   jdeStrcpy(lpDS-&gtszErrorMessageID, (const JCHAR *)(_J("G55E004")));<br/>								   jdeStrcpy(lpDS-&gtszXMLErrorCode, (const JCHAR *)(_J("011")));<br/>							   }<br/>						   }<br/>						   else<br/>						   {<br/>							   bErrorFound = TRUE;<br/>							   jdeTraceSz(NULL, _J("B55XML02 - XML Empty Doc in Z-File and there is not .xml file"));<br/>							   jdeStrcpy(dsDSDE55X01.szErrorReason, (const JCHAR *)(_J("07")));		   <br/>							   jdeStrcpy(lpDS-&gtszErrorMessageID, (const JCHAR *)(_J("G55E004")));<br/>							   jdeStrcpy(lpDS-&gtszXMLErrorCode, (const JCHAR *)(_J("010")));<br/>						   }<br/>					   <br/>					   }<br/>					   else<br/>					   {<br/>						   <br/>						   bErrorFound = TRUE;<br/>						   jdeTraceSz(NULL, _J("B55XML02 - XML doesn't exist in the Z-File"));<br/>						   jdeStrcpy(dsDSDE55X01.szErrorReason, (const JCHAR *)(_J("05")));		   <br/>						   jdeStrcpy(lpDS-&gtszErrorMessageID, (const JCHAR *)(_J("G55E004")));<br/>						   jdeStrcpy(lpDS-&gtszXMLErrorCode, (const JCHAR *)(_J("010")));<br/>					   <br/>					   }<br/><br/><br/>				   }<br/>				   else<br/>				   { <br/>					   xmlcStatus = XRCS_parseXMLString(hParser,dsDSI55XML01ZFILE.szXMLString,&hDoc);<br/>//					   xmlcStatus = XMLC_parseXMLString(hParser,dsDSI55XML01ZFILE.szXMLString,&hDoc);<br/>					   <br/>					   if(xmlcStatus != XRCS_SUCCESS)<br/>//					   if(xmlcStatus != XMLC_SUCCESS)<br/>					   {<br/>						   bErrorFound = TRUE;<br/>						   jdeTraceSz(NULL, _J("B55XML02 - Failed creating XML Document from Z-File."));<br/>						   jdeStrcpy(dsDSDE55X01.szErrorReason, (const JCHAR *)(_J("06")));		   <br/>						   jdeStrcpy(lpDS-&gtszErrorMessageID, (const JCHAR *)(_J("G55E004")));<br/>						   jdeStrcpy(lpDS-&gtszXMLErrorCode, (const JCHAR *)(_J("009")));<br/>						   <br/>					   }<br/>				   <br/>				   }<br/><br/><br/>				   if(!bErrorFound)<br/>				   {<br/>					   jdeTraceSz(NULL, _J("B55XML02 - Document Created:"));<br/>					   <br/>					   <br/>					   /* Get Root Element of the File */<br/>					   /* ============================ */<br/>					   <br/>					   xmlcStatus = XRCS_getDocumentElement(hDoc, &hDocElement);<br/>//					   xmlcStatus = XMLC_getDocumentElement(hDoc, &hDocElement);<br/>					   <br/>					   if(xmlcStatus == XRCS_SUCCESS)<br/>//					   if(xmlcStatus == XMLC_SUCCESS)<br/>					   {<br/>						   lpDS-&gtidDoc = jdeStoreDataPtr(hUser, hDoc);<br/>						   lpDS-&gtidDocElement = jdeStoreDataPtr(hUser, hDocElement);<br/>					   }<br/>					   else<br/>					   {<br/>						   idReturn = ER_ERROR;<br/>						   bErrorFound = TRUE;<br/>						   jdeTraceSz(NULL, _J("B55XML02 - XMLC bad format. There is not root element"));<br/>						   jdeStrcpy(dsDSDE55X01.szErrorReason, (const JCHAR *)(_J("09")));		   <br/>						   jdeStrcpy(lpDS-&gtszErrorMessageID, (const JCHAR *)(_J("G55E004")));<br/>						   jdeStrcpy(lpDS-&gtszXMLErrorCode, (const JCHAR *)(_J("012")));<br/>					   }<br/>				   }<br/>				   <br/>				   xmlcStatus = XRCS_freeParser(hParser);<br/>//				   xmlcStatus = XMLC_freeParser(hParser);<br/>			   <br/>			   }<br/>			   else<br/>			   {<br/>				 <br/>				 bErrorFound = TRUE;<br/>				 jdeTraceSz(NULL, _J("B55XML02 - XRCS_getParser failed"));<br/>				 jdeStrcpy(dsDSDE55X01.szErrorReason, (const JCHAR *)(_J("04")));		   <br/>				 jdeStrcpy(lpDS-&gtszErrorMessageID, (const JCHAR *)(_J("G55E004")));<br/>				 jdeStrcpy(lpDS-&gtszXMLErrorCode, (const JCHAR *)(_J("002")));<br/><br/>			 <br/>			   }<br/><br/>			 <br/><br/>	   <br/>   }<br/>   else<br/>   {<br/>	   jdeStrcpy(dsDSDE55X01.szErrorReason, dsDSI55XML01ZFILE.szErrorReason);<br/>	   jdeStrcpy(lpDS-&gtszErrorMessageID, dsDSI55XML01ZFILE.szErrorMessageID );<br/>	   jdeStrcpy(lpDS-&gtszXMLErrorCode, dsDSI55XML01ZFILE.szXMLErrorCode );<br/><br/>   }<br/><br/><br/><br/><br/>   if(dsDSI55XML01ZFILE.cXMLStringAlloc == _J('Y'))<br/>   {<br/>	   jdeFree(dsDSI55XML01ZFILE.szXMLString);<br/>   <br/>   }<br/><br/><br/>   /************************************************************************<br/>    * Function Clean Up<br/>    ************************************************************************/<br/>   if(bErrorFound)<br/>   {<br/>      lpDS-&gtcErrorCode = _J('1');<br/>	  idReturn = ER_ERROR;<br/><br/>	  if(lpDS-&gtcSuppressErrorMessage != _J('1'))<br/>	  {<br/>		  jdeSetGBRErrorSubText(lpBhvrCom, lpVoid, (ID) 0, lpDS-&gtszErrorMessageID, &dsDSDE55X01);<br/>		<br/>	  }<br/>   }<br/>       <br/>   if (hUser)<br/>   {<br/>	   JDB_FreeBhvr(hUser);<br/>   }<br/><br/>   return (idReturn);<br/><br/>}<br/><br/><br/><br/><br/><br/><br/><br/>/**************************************************************************<br/> *  Business Function:  XMLUpdateZFile_76B<br/> *<br/> *        Description:  XML Update Z File  76B<br/> *<br/> *         Parameters:<br/> *           LPBHVRCOM           lpBhvrCom    Business Function Communications<br/> *           LPVOID              lpVoid       Void Parameter - DO NOT USE!<br/> *           LPDSD70XML01J       lpDS         Parameter Data Structure Pointer  <br/> *<br/> *************************************************************************/<br/><br/>JDEBFRTN (ID) JDEBFWINAPI XMLUpdateZFile_55 (LPBHVRCOM lpBhvrCom, LPVOID lpVoid, LPDSD55XML01J lpDS)  <br/>{<br/>   /************************************************************************<br/>    *  Variable declarations<br/>    ************************************************************************/<br/>	ID                idReturn       = ER_SUCCESS;<br/>    ID                idJDBResult    = JDEDB_PASSED;<br/>    HUSER             hUser          = (HUSER)NULL;<br/>    XRCS_Status       xmlcStatus     = XRCS_SUCCESS;<br/>	XRCS_hDocument    hDoc           = (XRCS_hDocument)NULL;<br/>/*	XMLC_Status       xmlcStatus     = XMLC_SUCCESS;<br/>	XMLC_hDocument    hDoc           = (XMLC_hDocument)NULL; */<br/><br/>	HREQUEST		  hReqF55XMLZ1			= NULL;<br/>	JDEDB_RESULT	  JDEDBResult			= JDEDB_PASSED;<br/>//	DBREF			dbRef					= {0};<br/>//	int				blobSize				= 0;<br/><br/><br/><br/>   /************************************************************************<br/>    * Declare structures<br/>    ************************************************************************/<br/>	<br/><br/>	F55XMLZ1			dsF55XMLZ1			= {0};<br/>	KEY1_F55XMLZ1		dsF55XMLZ1Key1			= {0};<br/><br/>	DSDE55X01			dsDSDE55X01			= {0};		/* error text substitution structure */<br/><br/><br/>	BOOL				bErrorFound		= FALSE;<br/><br/><br/>   /************************************************************************<br/>    * Declare pointers<br/>    ************************************************************************/<br/><br/>	JCHAR* szXMLString		= NULL;<br/><br/>   /************************************************************************<br/>    * Check for NULL pointers<br/>    ************************************************************************/<br/>   if ((lpBhvrCom == (LPBHVRCOM) NULL) ||<br/>       (lpVoid    == (LPVOID)    NULL) ||<br/>       (lpDS      == (LPDSD55XML01J)	NULL))<br/>   {<br/>     jdeErrorSet (lpBhvrCom, lpVoid, (ID) 0, _J("4363"), (LPVOID) NULL);<br/>     return ER_ERROR;<br/>   }<br/><br/>      <br/>   idJDBResult = JDB_InitBhvr((void *)lpBhvrCom, &hUser,<br/>                           (JCHAR *)NULL, JDEDB_COMMIT_AUTO);<br/><br/>   if (idJDBResult == JDEDB_FAILED)<br/>   {<br/>      jdeErrorSet(lpBhvrCom, lpVoid, (ID)0, _J("078S"), (LPVOID)NULL);<br/>      return ER_ERROR;<br/>   }<br/><br/><br/><br/>   /************************************************************************<br/>    * Set pointers<br/>    ************************************************************************/<br/><br/>   /************************************************************************<br/>    * Main Processing<br/>    ************************************************************************/<br/>   <br/>   /* Initialize output parameters */<br/>   /* ============================ */<br/><br/>   lpDS-&gtcErrorCode = _J('0');<br/>   jdeStrcpy(lpDS-&gtszErrorMessageID, (const JCHAR *)(_J("")));<br/>   jdeStrcpy(lpDS-&gtszXMLErrorCode, (const JCHAR *)(_J("")));<br/><br/><br/>   <br/>   /* Check required parameters */<br/>   /* ========================= */<br/><br/>   if (lpDS-&gtidDoc != 0)<br/>   {<br/><br/>	<br/>	  /* Retrieve document handle */<br/>	  /* ======================== */<br/>	  <br/>	<br/>	  hDoc = jdeRetrieveDataPtr(hUser, lpDS-&gtidDoc);<br/>	  <br/>	  if(hDoc == (XRCS_hDocument)NULL)<br/>//	  if(hDoc == (XMLC_hDocument)NULL)<br/>	  {<br/><br/>		  jdeTraceSz(NULL, _J("B55XML02 - jdeRetrieveDataPtr for idDoc failed"));<br/>		  jdeStrcpy(dsDSDE55X01.szErrorReason, (const JCHAR *)(_J("02")));<br/>		  jdeStrcpy(lpDS-&gtszXMLErrorCode, (const JCHAR *)(_J("002")));<br/>		  bErrorFound = TRUE;<br/>	  }<br/><br/>   }<br/>   else<br/>   {<br/>	   jdeStrcpy(dsDSDE55X01.szErrorReason, (const JCHAR *)(_J("01")));<br/>	   jdeTraceSz(NULL, _J("B55XML02 - Invalid parameters passed to XMLUpdateZFile_76B"));<br/>	   jdeStrcpy(lpDS-&gtszXMLErrorCode, (const JCHAR *)(_J("001")));<br/>	   bErrorFound = TRUE;<br/>   }<br/><br/>  <br/>   /* Update XML doc XML To File */<br/>   /* ========================== */<br/><br/>   if (!bErrorFound)<br/>   {<br/>      <br/>			  /* Update XML doc XML To File */<br/>			  /* ========================== */<br/>			  <br/>			  if (lpDS-&gtcWriteToFileYN == _J('Y') && lpDS-&gtcUpdateBlobYN ==  _J('Y') && !IsStringBlank(lpDS-&gtszXMLFileContainerPath))<br/>			  {<br/>		<br/>				 xmlcStatus = XRCS_serializeDocumentToFile(hDoc, lpDS-&gtszXMLFileContainerPath);<br/>//				 xmlcStatus = XMLC_serializeDocumentToFile(hDoc, lpDS-&gtszXMLFileContainerPath);<br/>		<br/>		<br/>				 if(xmlcStatus != XRCS_SUCCESS)<br/>//				 if(xmlcStatus != XMLC_SUCCESS)<br/>				 {<br/>		<br/>					 bErrorFound = TRUE;<br/>					 jdeStrcpy(dsDSDE55X01.szErrorReason, (const JCHAR *)(_J("04")));<br/>					 jdeTraceSz1(NULL, _J("B55XML02 - Failed to write XML to file:%ls"),lpDS-&gtszXMLFileContainerPath);<br/>					 jdeStrcpy(lpDS-&gtszXMLErrorCode, (const JCHAR *)(_J("004")));<br/>		<br/>				 }<br/>				 else<br/>				 {<br/><br/><br/>					 jdeTraceSz1(NULL, _J("B55XML02 - XML %ls writed"),lpDS-&gtszXMLFileContainerPath);<br/>		<br/><br/>				 }<br/>		<br/>			 }<br/>		<br/>		<br/>		      /* Write XML to Z File */<br/>			  /* =================== */<br/>		<br/>		<br/>			 if(!bErrorFound)<br/>			 {<br/>		<br/>			<br/>				 JDEDBResult = JDB_OpenTable(hUser, <br/>												NID_F55XMLZ1, <br/>												ID_F55XMLZ1_EDUS_EDBT_EDTN_EDLN, <br/>												NULL, <br/>												0, <br/>												NULL, <br/>												&hReqF55XMLZ1);<br/>		<br/>		<br/>				 if (JDEDBResult == JDEDB_PASSED)<br/>				 {<br/><br/>					 /* Fetch Record */<br/>					 /* ============ */<br/>					 <br/>					 /* Init Key */<br/>					 /* -------- */<br/>					 <br/>					 /* szEdiUserId */<br/>					 <br/>					 jdeStrncpy (dsF55XMLZ1Key1.syedus, (const JCHAR *)(lpDS-&gtszEdiUserId), DIM(dsF55XMLZ1Key1.syedus));<br/><br/>					 /* szEdiBatchNumber */<br/>					 <br/>					 jdeStrncpy (dsF55XMLZ1Key1.syedbt, (const JCHAR *)(lpDS-&gtszEdiBatchNumber), DIM(dsF55XMLZ1Key1.syedbt));<br/>					 <br/>					 /* szEdiBatchNumber */<br/>					 <br/>					 jdeStrncpy (dsF55XMLZ1Key1.syedtn, (const JCHAR *)(lpDS-&gtszEdiTransactNumber), DIM(dsF55XMLZ1Key1.syedtn));<br/>					 <br/>					 /* mnEdiLineNumber */<br/>					 <br/>					 MathCopy (&dsF55XMLZ1Key1.syedln, &lpDS-&gtmnEdiLineNumber);<br/>					 <br/>					 /* Fetch */<br/>					 /* ----- */<br/>					 <br/>					 JDEDBResult = JDB_FetchKeyed(hReqF55XMLZ1,<br/>	        										(ID) ID_F55XMLZ1_EDUS_EDBT_EDTN_EDLN, <br/>												    (void *)(&dsF55XMLZ1Key1), <br/>													(short)(4),<br/>													(void *)(&dsF55XMLZ1),<br/>													FALSE);<br/><br/>					 if (JDEDBResult == JDEDB_PASSED)<br/>					 {<br/>						<br/>						<br/>						<br/>						/* Update Record */<br/>						/* ============= */<br/>						<br/>						/* szEdiDocumentType */<br/>						<br/>						jdeStrncpy (dsF55XMLZ1.syedct, (const JCHAR *)(lpDS-&gtszEdiDocumentType), DIM(dsF55XMLZ1.syedct));<br/>						<br/>						/* szTypeTransaction */<br/>						<br/>						jdeStrncpy (dsF55XMLZ1.sytytn, (const JCHAR *)(lpDS-&gtszTypeTransaction), DIM(dsF55XMLZ1.sytytn));<br/>						<br/>						/* szEdiTranslationFormat */<br/>						<br/>						jdeStrncpy (dsF55XMLZ1.syedft, (const JCHAR *)(lpDS-&gtszEdiTranslationFormat), DIM(dsF55XMLZ1.syedft));<br/>						<br/>						/* szEdiTranslationFormat */<br/>						<br/>						JDEDATECopy(&dsF55XMLZ1.syeddt , &lpDS-&gtjdEdiTransmissionDate );<br/>						<br/>						/* cDirectionIndicator */<br/>						<br/>						dsF55XMLZ1.sydrin = lpDS-&gtcDirectionIndicator;<br/>						<br/>						/* mnEdiLineNumber */<br/>						<br/>						MathCopy (&dsF55XMLZ1.syeddl, &lpDS-&gtmnEdiDetailLinesProcess);<br/>						<br/>						/* cEdiSuccessfullyProcess */<br/>						<br/>						dsF55XMLZ1.syedsp = lpDS-&gtcEdiSuccessfullyProcess;<br/>						<br/>						/* szTradingPartnerId */<br/>						<br/>						jdeStrncpy (dsF55XMLZ1.sypnid, (const JCHAR *)(lpDS-&gtszTradingPartnerId), DIM(dsF55XMLZ1.sypnid));<br/>						<br/>						/* szTransactionAction */<br/>						<br/>						jdeStrncpy (dsF55XMLZ1.sytnac, (const JCHAR *)(lpDS-&gtszTransactionAction), DIM(dsF55XMLZ1.sytnac));<br/>						<br/>						/* jdXMLDateProcessed */<br/>						<br/>						JDEDATECopy(&dsF55XMLZ1.sy55xdpr , &lpDS-&gtjdXMLDateProcessed );<br/>						<br/>						/* szXMLTransactionGroup */<br/>						<br/>						jdeStrncpy (dsF55XMLZ1.sy55xtg, (const JCHAR *)(lpDS-&gtszXMLTransactionGroup), DIM(dsF55XMLZ1.sy55xtg));<br/>						<br/>						/* szXMLInternalReference */<br/>						<br/>						jdeStrncpy (dsF55XMLZ1.sy55inre, (const JCHAR *)(lpDS-&gtszXMLInternalReference), DIM(dsF55XMLZ1.sy55inre));<br/>						<br/>						/* szXMLAditionalCode */<br/>						<br/>						jdeStrncpy (dsF55XMLZ1.sy55xcd, (const JCHAR *)(lpDS-&gtszXMLAditionalCode), DIM(dsF55XMLZ1.sy55xcd));<br/>						<br/>						/* cXMLDocumentStatus */<br/>						<br/>						dsF55XMLZ1.sy55xdos = lpDS-&gtcXMLDocumentStatus;<br/>						<br/>						/* szXMLVersion */<br/>						<br/>						jdeStrncpy (dsF55XMLZ1.sy55xmlv, (const JCHAR *)(lpDS-&gtszXMLVersion), DIM(dsF55XMLZ1.sy55xmlv));<br/>						<br/>						/* szXMLAttributeStrGeneric1 */<br/>						<br/>						jdeStrncpy (dsF55XMLZ1.sy55xsg1, (const JCHAR *)(lpDS-&gtszXMLAttributeStrGeneric1), DIM(dsF55XMLZ1.sy55xsg1));<br/>						<br/>						/* szXMLAttributeStrGeneric2 */<br/>						<br/>						jdeStrncpy (dsF55XMLZ1.sy55xsg2, (const JCHAR *)(lpDS-&gtszXMLAttributeStrGeneric2), DIM(dsF55XMLZ1.sy55xsg2));<br/>						<br/>						/* szXMLAttributeStrGeneric3 */<br/>						<br/>						jdeStrncpy (dsF55XMLZ1.sy55xsg3, (const JCHAR *)(lpDS-&gtszXMLAttributeStrGeneric3), DIM(dsF55XMLZ1.sy55xsg3));<br/>						<br/>						/* mnXMLAttributeNumGeneric1 */<br/>						<br/>						MathCopy (&dsF55XMLZ1.sy55xng1, &lpDS-&gtmnXMLAttributeNumGeneric1);<br/>						<br/>						/* mnXMLAttributeNumGeneric1 */<br/>						<br/>						MathCopy (&dsF55XMLZ1.sy55xng2, &lpDS-&gtmnXMLAttributeNumGeneric1);<br/>						<br/>						/* mnXMLAttributeNumGeneric3 */<br/>						<br/>						MathCopy (&dsF55XMLZ1.sy55xng3, &lpDS-&gtmnXMLAttributeNumGeneric1);<br/>						<br/>						/* jdXMLAttributeDatGeneric1 */<br/>						<br/>						JDEDATECopy(&dsF55XMLZ1.sy55xdg1 , &lpDS-&gtjdXMLAttributeDatGeneric1 );<br/>						<br/>						/* jdXMLAttributeDatGeneric2 */<br/>						<br/>						JDEDATECopy(&dsF55XMLZ1.sy55xdg2 , &lpDS-&gtjdXMLAttributeDatGeneric2 );<br/>						<br/>						/* jdXMLAttributeDatGeneric3 */<br/>						<br/>						JDEDATECopy(&dsF55XMLZ1.sy55xdg3 , &lpDS-&gtjdXMLAttributeDatGeneric3 );<br/>						<br/>						/* idXMLAttributeIntGeneric1 */<br/>						<br/>						dsF55XMLZ1.sy55xig1 = lpDS-&gtidXMLAttributeIntGeneric1;<br/>						<br/>						/* idXMLAttributeIntGeneric1 */<br/>						<br/>						dsF55XMLZ1.sy55xcg1 = lpDS-&gtcXMLAttributeChrGeneric1;<br/>						<br/>						/* idXMLAttributeIntGeneric2 */<br/>						<br/>						dsF55XMLZ1.sy55xcg2 = lpDS-&gtcXMLAttributeChrGeneric2;<br/>						<br/>						/* idXMLAttributeIntGeneric3 */<br/>						<br/>						dsF55XMLZ1.sy55xcg3 = lpDS-&gtcXMLAttributeChrGeneric3;<br/>						<br/>						/* mnXMLAddressNumber */<br/>						<br/>						MathCopy (&dsF55XMLZ1.syan8, &lpDS-&gtmnXMLAddressNumber);<br/>						<br/>						/* szXMLCostCenter */<br/>						<br/>						jdeStrncpy (dsF55XMLZ1.symcu, (const JCHAR *)(lpDS-&gtszXMLCostCenter), DIM(dsF55XMLZ1.symcu));<br/>						<br/>						/* szXMLCompany */<br/>						<br/>						jdeStrncpy (dsF55XMLZ1.syco, (const JCHAR *)(lpDS-&gtszXMLCompany), DIM(dsF55XMLZ1.syco));<br/>						<br/>						/* szXMLDocumentType */<br/>						<br/>						jdeStrncpy (dsF55XMLZ1.sydct, (const JCHAR *)(lpDS-&gtszXMLDocumentType), DIM(dsF55XMLZ1.sydct));<br/>						<br/>						/* szUserReservedCode */<br/>						<br/>						jdeStrncpy (dsF55XMLZ1.syurcd, (const JCHAR *)(lpDS-&gtszUserReservedCode), DIM(dsF55XMLZ1.syurcd));<br/>						<br/>						/* jdUserReservedDate */<br/>						<br/>						JDEDATECopy(&dsF55XMLZ1.syurdt , &lpDS-&gtjdUserReservedDate );<br/>						<br/>						/* mnUserReservedAmount */<br/>						<br/>						MathCopy (&dsF55XMLZ1.syurat, &lpDS-&gtmnUserReservedAmount);<br/>						<br/>						/* mnUserReservedNumber */<br/>						<br/>						MathCopy (&dsF55XMLZ1.syurat, &lpDS-&gtmnUserReservedNumber);<br/>						<br/>						/* szUserReservedReference */<br/>						<br/>						jdeStrncpy (dsF55XMLZ1.syurrf, (const JCHAR *)(lpDS-&gtszUserReservedReference), DIM(dsF55XMLZ1.syurrf));<br/>						<br/>						/* szTransactionOriginator */<br/>						<br/>						jdeStrncpy (dsF55XMLZ1.sytorg, (const JCHAR *)(lpDS-&gtszTransactionOriginator), DIM(dsF55XMLZ1.sytorg));<br/>						<br/>						/* szUserId */<br/>						<br/>						jdeStrncpy (dsF55XMLZ1.syuser, (const JCHAR *)(lpDS-&gtszUserId), DIM(dsF55XMLZ1.syuser));<br/>						<br/>						/* szProgramId */<br/>						<br/>						jdeStrncpy (dsF55XMLZ1.sypid, (const JCHAR *)(lpDS-&gtszProgramId), DIM(dsF55XMLZ1.sypid));<br/>						<br/>						/* szWorkStationId */<br/>						<br/>						jdeStrncpy (dsF55XMLZ1.syjobn, (const JCHAR *)(lpDS-&gtszWorkStationId), DIM(dsF55XMLZ1.syjobn));<br/>						<br/>						/* jdDateUpdated */<br/>						<br/>						JDEDATECopy(&dsF55XMLZ1.syupmj , &lpDS-&gtjdDateUpdated );<br/>						<br/>						/* mnTimeLastUpdated */<br/>						<br/>						MathCopy (&dsF55XMLZ1.syupmt, &lpDS-&gtmnTimeLastUpdated);<br/>						<br/>						/* szXMLFullFileName */<br/>						<br/>						jdeStrncpy (dsF55XMLZ1.sy55path, (const JCHAR *)(lpDS-&gtszXMLFileContainerPath), DIM(dsF55XMLZ1.sy55path));		<br/><br/>						/* New Error Code */<br/><br/>						jdeStrncpy (dsF55XMLZ1.sy55xecd, (const JCHAR *)(lpDS-&gtszXMLNewErrorCode), DIM(dsF55XMLZ1.sy55xecd));		<br/><br/><br/>						<br/>						<br/>						/* XML */<br/><br/>						if(lpDS-&gtcUpdateBlobYN == _J('Y'))<br/>						{<br/>						<br/>								xmlcStatus = XRCS_serializeDocumentToXMLString(hDoc,&szXMLString);<br/>//								xmlcStatus = XMLC_serializeDocumentToXMLString(hDoc,&szXMLString);<br/>/*								<br/>								jdeNIDcpy(dbRef.szTable, NID_F70XMLZ1);<br/>								dbRef.idInstance = 0L;<br/>								jdeNIDcpy(dbRef.szDict, NID_G70TXFT);<br/>								blobSize = ( (strlen(szXMLString)+ 1) * sizeof(JCHAR ) ) ;<br/>								dsF55XMLZ1.syg70txft.lpValue  = JDB_SetBLOBSize(hReqF70XMLZ1, dbRef, blobSize);<br/>								dsF55XMLZ1.syg70txft.lSize	  = blobSize;<br/>								dsF55XMLZ1.syg70txft.lMaxSize = MAX_BLOB_SIZE;<br/>						<br/>								if(dsF55XMLZ1.syg70txft.lpValue != NULL)<br/>								{<br/>									memcpy((void*)dsF55XMLZ1.syg70txft.lpValue, (void*)szXMLString,dsF55XMLZ1.syg70txft.lSize);<br/>									<br/>								} */<br/><br/>								if(szXMLString != NULL)<br/>								{<br/>									jdeStrncpy (dsF55XMLZ1.sytxvc, szXMLString, DIM(dsF55XMLZ1.sytxvc));<br/>								}<br/>						<br/>						}<br/>						<br/><br/>						JDEDBResult = JDB_UpdateTable(	 hReqF55XMLZ1, <br/>														 NID_F55XMLZ1, <br/>														 (ID) 0,<br/>														 (ID) ID_F55XMLZ1_EDUS_EDBT_EDTN_EDLN,<br/>														&dsF55XMLZ1Key1,<br/>														4, <br/>														&dsF55XMLZ1);<br/><br/>						<br/>						<br/>						if (JDEDBResult != JDEDB_PASSED)<br/>						{<br/><br/>							bErrorFound = TRUE;<br/>							jdeStrcpy(dsDSDE55X01.szErrorReason, (const JCHAR *)(_J("07")));<br/>							jdeTraceSz(NULL, _J("B55XML02 - Update to table F70XMLZ1 failed"));<br/>							jdeStrcpy(lpDS-&gtszXMLErrorCode, (const JCHAR *)(_J("007")));<br/>						<br/>						<br/>						}<br/><br/><br/>					 }<br/>					 else<br/>					 {<br/><br/>						bErrorFound = TRUE;<br/>						<br/>						jdeStrcpy(dsDSDE55X01.szErrorReason, (const JCHAR *)(_J("06")));<br/>						jdeTraceSz(NULL, _J("B55XML02 - Transaction not found in F55XMLZ1."));<br/>						jdeStrcpy(lpDS-&gtszXMLErrorCode, (const JCHAR *)(_J("006")));<br/><br/><br/><br/>					 }<br/>		<br/>		<br/>		<br/>					 JDB_CloseTable(hReqF55XMLZ1);<br/>		<br/>					 <br/>					 if(szXMLString != NULL)<br/>					 {<br/>						 XRCS_freeString(szXMLString);<br/>//						 XMLC_freeString(szXMLString);<br/>					 }<br/>		<br/>		<br/>		<br/>				 }<br/>				 else<br/>				 {<br/>		<br/>					<br/>					 <br/>					 jdeStrcpy(dsDSDE55X01.szErrorReason, (const JCHAR *)(_J("05")));<br/>					 jdeTraceSz(NULL, _J("B55XML02 - Open for table F55XMLZ1 failed"));<br/>					 jdeStrcpy(lpDS-&gtszXMLErrorCode, (const JCHAR *)(_J("005")));<br/>					 bErrorFound = TRUE;<br/>		<br/>				 }<br/>		<br/>		<br/>			 }<br/><br/>		 <br/><br/>   }<br/>   <br/><br/>   /************************************************************************ <br/>    * Function Clean Up <br/>    ************************************************************************/ <br/>   if(bErrorFound)<br/>   {<br/>      idReturn = ER_ERROR;<br/>      <br/>	  lpDS-&gtcErrorCode = _J('1');<br/><br/>	  jdeStrcpy(lpDS-&gtszErrorMessageID, (const JCHAR *)(_J("G55E006")));<br/>	  <br/>	  if(lpDS-&gtcSuppressErrorMessage != _J('1'))<br/>	  {<br/>		  jdeSetGBRErrorSubText(lpBhvrCom, lpVoid, (ID) 0, lpDS-&gtszErrorMessageID, &dsDSDE55X01);<br/>		<br/>	  }<br/><br/>      jdeTraceSz(NULL, _J("B55XML01 - Failed to write XML to file"));<br/>   }<br/><br/>	if (hUser)<br/>	{<br/>		JDB_FreeBhvr(hUser);<br/>	}<br/>          <br/>   return (idReturn); <br/>}<br/><br/><br/><br/>/**************************************************************************<br/> *  Business Function:  XMLGetElementsByTagName_76B<br/> *<br/> *        Description:  XML Get Elements By Tag Name 76B<br/> *<br/> *         Parameters:<br/> *           LPBHVRCOM           lpBhvrCom    Business Function Communications<br/> *           LPVOID              lpVoid       Void Parameter - DO NOT USE!<br/> *           LPDSD70XML01K       lpDS         Parameter Data Structure Pointer  <br/> *<br/> *************************************************************************/<br/><br/>JDEBFRTN (ID) JDEBFWINAPI XMLGetElementsByTagName_55 (LPBHVRCOM lpBhvrCom, LPVOID lpVoid, LPDSD55XML01K lpDS)  <br/>{<br/>   /************************************************************************<br/>    *  Variable declarations<br/>    ************************************************************************/<br/>   ID						idReturn       = ER_SUCCESS;<br/>   ID						idJDBResult    = JDEDB_PASSED;<br/>   HUSER					hUser          = (HUSER)NULL;<br/>   BOOL						bErrorFound		= FALSE;<br/>   <br/>     XRCS_Status			xmlcStatus		= XRCS_SUCCESS;	<br/>     XRCS_hDocument			hDoc           = (XRCS_hDocument)NULL;<br/>     XRCS_hElement			hDocElement    = (XRCS_hElement)NULL;<br/>     XRCS_hElement*			lphDocElement		= (XRCS_hElement*)NULL;<br/>     XRCS_hElement*			lphElement		= (XRCS_hElement*)NULL;<br/>   <br/>//   XMLC_Status				xmlcStatus		= XMLC_SUCCESS;	<br/>//   XMLC_hDocument	        hDoc			= NULL;<br/>//   XMLC_hElement	        hDocElement		= NULL;<br/>//   XMLC_hElement*	        lphDocElement	= NULL;<br/>//   XMLC_hElement*	        lphElement		= NULL;<br/>      <br/>   unsigned int				iNumElements            = 0;<br/><br/>   JCHAR *           szTempString            = (JCHAR*)NULL;<br/><br/><br/>   int				iPos            = 0;<br/><br/><br/>   /************************************************************************<br/>    * Declare structures<br/>    ************************************************************************/<br/>   <br/>   <br/>   DSDE55X01			dsDSDE55X01			= {0};		/* error text substitution structure */<br/><br/><br/>   /************************************************************************<br/>    * Declare pointers<br/>    ************************************************************************/<br/><br/>   /************************************************************************<br/>    * Check for NULL pointers<br/>    ************************************************************************/<br/>   if ((lpBhvrCom == (LPBHVRCOM) NULL) ||<br/>       (lpVoid    == (LPVOID)    NULL) ||<br/>       (lpDS      == (LPDSD55XML01K)	NULL))<br/>   {<br/>     jdeErrorSet (lpBhvrCom, lpVoid, (ID) 0, _J("4363"), (LPVOID) NULL);<br/>     return ER_ERROR;<br/>   }<br/>   idJDBResult = JDB_InitBhvr((void *)lpBhvrCom, &hUser,<br/>                           (JCHAR *)NULL, JDEDB_COMMIT_AUTO);<br/><br/>   if (idJDBResult == JDEDB_FAILED)<br/>   {<br/>      jdeErrorSet(lpBhvrCom, lpVoid, (ID)0, _J("078S"), (LPVOID)NULL);<br/>      return ER_ERROR;<br/>   }<br/><br/><br/>   /************************************************************************<br/>    * Set pointers<br/>    ************************************************************************/<br/><br/>   /************************************************************************<br/>    * Main Processing<br/>    ************************************************************************/<br/><br/>   /* Init Output Var */<br/>   <br/>   lpDS-&gtcErrorCode = _J('0');<br/>   jdeStrcpy(lpDS-&gtszErrorMessageID, (const JCHAR *)(_J("")));<br/>   lpDS-&gtidArrayElements = 0;<br/>   ZeroMathNumeric(&lpDS-&gtmnNumberOfElements);<br/>   jdeStrcpy(lpDS-&gtszElementValue, (const JCHAR *)(_J("")));<br/><br/>   /*Check required parameters*/<br/>   <br/>	<br/>   if (lpDS-&gtidDoc != 0 && lpDS-&gtidFromElement != 0)<br/>   {<br/><br/>		   hDoc = jdeRetrieveDataPtr(hUser, lpDS-&gtidDoc);<br/><br/>		   if(hDoc == (XRCS_hDocument)NULL)<br/>	//	   if(hDoc == NULL)<br/>		   {<br/><br/>			   jdeTraceSz(NULL, _J("B55XML01 - Invalid Memory Reference."));<br/>			   bErrorFound = TRUE;<br/>			   jdeStrcpy(dsDSDE55X01.szErrorReason, (const JCHAR *)(_J("03")));		   <br/>			   <br/><br/>		   }<br/><br/><br/><br/>		   if(lpDS-&gtcIsIDFromElementAnArrayYN == _J('Y'))<br/>		   {<br/>			   <br/>			   lphDocElement = jdeRetrieveDataPtr(hUser, lpDS-&gtidFromElement);<br/>			   <br/>			   if(lphDocElement == (XRCS_hElement*)NULL)<br/>		//	   if(lphDocElement == NULL)<br/>			   {<br/>				   jdeTraceSz(NULL, _J("B55XML01 - Invalid Memory Reference."));<br/>				   bErrorFound = TRUE;<br/>				   jdeStrcpy(dsDSDE55X01.szErrorReason, (const JCHAR *)(_J("03")));		   <br/>				    <br/>			   }<br/><br/><br/>		   }<br/>		   else<br/>		   {<br/><br/>			   hDocElement = jdeRetrieveDataPtr(hUser, lpDS-&gtidFromElement);<br/><br/>			   if(hDocElement == (XRCS_hElement)NULL)<br/>		//	   if(hDocElement == NULL)<br/>			   {<br/>				   jdeTraceSz(NULL, _J("B55XML01 - Invalid Memory Reference."));<br/>				   bErrorFound = TRUE;<br/>				   jdeStrcpy(dsDSDE55X01.szErrorReason, (const JCHAR *)(_J("03")));		   <br/>				    <br/>			   }<br/><br/>		   }<br/><br/><br/>	}<br/>	else<br/>	{<br/><br/>		 <br/>		 bErrorFound = TRUE;<br/>		 jdeTraceSz(NULL, _J("B55XML01 - Invalid parameters passed to XMLGetElementsByTagName_G70"));<br/>		 jdeStrcpy(dsDSDE55X01.szErrorReason, (const JCHAR *)(_J("01")));		   <br/>		 <br/><br/>	}<br/><br/><br/>	 <br/>   /* Search For Value */<br/>   /* ================ */<br/><br/>   if(!bErrorFound)<br/>   {<br/><br/><br/>	   /* Get Element  */<br/>	   /* ============ */<br/><br/>	   /* Set Element Name */<br/>	   /* ---------------- */<br/><br/>	   jdeStripTrailingBlanks(lpDS-&gtszElementName);<br/><br/><br/>	   if(lpDS-&gtcIsIDFromElementAnArrayYN == _J('Y'))<br/>	   {<br/><br/>		   MathNumericToInt(&lpDS-&gtmnFromElementNumber,&iPos);<br/><br/>		   xmlcStatus = XRCS_getElementsByTagName(	lphDocElement[iPos],<br/>															lpDS-&gtszElementName,<br/>															&lphElement, <br/>															&iNumElements);<br/>		   <br/>	/*	   xmlcStatus = XMLC_getElementsByTagName(	lphDocElement[iPos],<br/>															lpDS-&gtszElementName,<br/>															&lphElement, <br/>															&iNumElements); */<br/>		   <br/><br/>	   }<br/>	   else<br/>	   {<br/><br/>		   xmlcStatus = XRCS_getElementsByTagName(	hDocElement,<br/>															lpDS-&gtszElementName,<br/>															&lphElement, <br/>															&iNumElements); <br/><br/>	/*	   xmlcStatus = XMLC_getElementsByTagName(	hDocElement,<br/>															lpDS-&gtszElementName,<br/>															&lphElement, <br/>															&iNumElements); */<br/><br/>	   }<br/>	   <br/>	   <br/>	   if(xmlcStatus == XRCS_SUCCESS)<br/>//	   if(xmlcStatus == XMLC_SUCCESS)<br/>	   {<br/>		   <br/>		   /* Element Name Found? */<br/>		   /* ------------------- */<br/><br/>		   if(iNumElements &gt 0 && lphElement != (XRCS_hElement*) NULL)<br/>//		   if(iNumElements &gt 0 && lphElement != NULL)<br/>		   {<br/><br/>			   /* Return Value ? */<br/>			   /* ============== */<br/><br/>			   if(lpDS-&gtcReturnValueYN == _J('Y'))<br/>			   {<br/><br/>				   xmlcStatus = XRCS_getElementText( lphElement[0],<br/>																&szTempString); <br/><br/>			/*	   xmlcStatus = XMLC_getElementText( lphElement[0],<br/>																&szTempString); */<br/><br/><br/>				   if (szTempString != (JCHAR*)NULL)<br/>				   {<br/><br/><br/>					   /* Return Value */<br/>					   /* ------------ */<br/>					                        <br/>					   jdeStrcpyAndTerminate((JCHAR*)lpDS-&gtszElementValue, <br/>												(const JCHAR*)szTempString, <br/>												DIM(lpDS-&gtszElementValue));<br/><br/>					   I55XML01_RemoveSurroundingBlanks(lpDS-&gtszElementValue);<br/>					   I55XML01_RemoveIllegalCharacterForAString(lpDS-&gtszElementValue);<br/>					   <br/>					   /* Free String */<br/>					   /* ----------- */<br/>					   <br/>					   xmlcStatus = XRCS_freeString(szTempString);<br/><br/>				//	   xmlcStatus = XMLC_freeString(szTempString);<br/>					   <br/>					   szTempString = (JCHAR *)NULL; <br/><br/>					   <br/>					   /* Free Array of Elements */<br/>					   /* ---------------------- */<br/>					   <br/>					   if (lphElement != (XRCS_hElement*)NULL)<br/>				//	   if (lphElement != NULL)<br/>					   {<br/>						   xmlcStatus = XRCS_freeElementArray(lphElement, (unsigned int) iNumElements);            <br/>						   <br/>				//		   xmlcStatus = XMLC_freeElementArray(lphElement, (unsigned int) iNumElements); <br/><br/>						   lphElement = (XRCS_hElement*)NULL;<br/><br/>				//		   lphElement = NULL;<br/>					   <br/>					   }<br/><br/>				   }<br/><br/><br/>			   }<br/>			   else<br/>			   {<br/><br/><br/>				   lpDS-&gtidArrayElements = jdeStoreDataPtr(hUser, lphElement);<br/>				   IntToMathNumeric(iNumElements,&lpDS-&gtmnNumberOfElements);<br/><br/><br/>			   }<br/><br/>			   <br/>		   }<br/>		   else<br/>		   {<br/>			   <br/>			   bErrorFound = TRUE;<br/>			   jdeTraceSz1(NULL, _J("B55XML01 - Element Name %ls not found "),lpDS-&gtszElementName);<br/>			   jdeStrcpy(dsDSDE55X01.szErrorReason, (const JCHAR *)(_J("02")));		   <br/><br/>		   }<br/>	   <br/>	   <br/>	   <br/>	   }<br/>	   else<br/>	   {<br/><br/>		 <br/>		 bErrorFound = TRUE;<br/>		 jdeTraceSz1(NULL, _J("B55XML01 - Element Name %ls not found "),lpDS-&gtszElementName);<br/>		 jdeStrcpy(dsDSDE55X01.szErrorReason, (const JCHAR *)(_J("02")));		   <br/>	   }<br/><br/><br/><br/>   }<br/><br/><br/><br/><br/><br/>   /************************************************************************<br/>    * Function Clean Up<br/>    ************************************************************************/<br/><br/>   if(bErrorFound)<br/>   {<br/>      lpDS-&gtcErrorCode = '1';<br/><br/>	  idReturn = ER_ERROR;<br/><br/>	  jdeStrcpy(lpDS-&gtszErrorMessageID, (const JCHAR *)(_J("G55E007")));<br/><br/>	  if(lpDS-&gtcSuppressErrorMessage != _J('1'))<br/>	  {<br/>		  jdeSetGBRErrorSubText(lpBhvrCom, lpVoid, (ID) 0, lpDS-&gtszErrorMessageID, &dsDSDE55X01);<br/>		<br/>	  }<br/>   }<br/>       <br/>   if (hUser)<br/>   {<br/>	   JDB_FreeBhvr(hUser);<br/>   }<br/><br/>   return (idReturn);<br/><br/>}<br/><br/><br/>/**************************************************************************<br/> *  Business Function:  XMLFreeArrayOfElements_76B<br/> *<br/> *        Description:  XML Free Array of Elements 76B<br/> *<br/> *         Parameters:<br/> *           LPBHVRCOM           lpBhvrCom    Business Function Communications<br/> *           LPVOID              lpVoid       Void Parameter - DO NOT USE!<br/> *           LPDSD70XML01L       lpDS         Parameter Data Structure Pointer  <br/> *<br/> *************************************************************************/<br/><br/>JDEBFRTN (ID) JDEBFWINAPI XMLFreeArrayOfElements_55 (LPBHVRCOM lpBhvrCom, LPVOID lpVoid, LPDSD55XML01L lpDS)  <br/>{<br/>   /************************************************************************<br/>    *  Variable declarations<br/>    ************************************************************************/<br/>   ID						idReturn       = ER_SUCCESS;<br/>   ID						idJDBResult    = JDEDB_PASSED;<br/>   HUSER					hUser          = (HUSER)NULL;<br/>   BOOL						bErrorFound		= FALSE;<br/><br/>  <br/>   XRCS_Status				xmlcStatus		= XRCS_SUCCESS;	<br/>   XRCS_hDocument			hDoc           = (XRCS_hDocument)NULL;<br/>   XRCS_hElement*			lphDocElement		= (XRCS_hElement*)NULL;<br/>   XRCS_hElement*			lphElement		= (XRCS_hElement*)NULL;<br/><br/>/* XMLC_Status				xmlcStatus		= XMLC_SUCCESS;	<br/>   XMLC_hDocument			hDoc            = (XMLC_hDocument)NULL;<br/>   XMLC_hElement*			lphDocElement	= (XMLC_hElement*)NULL;<br/>   XMLC_hElement*			lphElement		= (XMLC_hElement*)NULL; */<br/><br/>   int					    iNumElements            = 0;<br/><br/><br/>   /************************************************************************<br/>    * Declare structures<br/>    ************************************************************************/<br/>   <br/>   DSDE55X01			dsDSDE55X01			= {0};		/* error text substitution structure */<br/><br/>   /************************************************************************<br/>    * Declare pointers<br/>    ************************************************************************/<br/><br/>   /************************************************************************<br/>    * Check for NULL pointers<br/>    ************************************************************************/<br/>   if ((lpBhvrCom == (LPBHVRCOM) NULL) ||<br/>       (lpVoid    == (LPVOID)    NULL) ||<br/>       (lpDS      == (LPDSD55XML01L)	NULL))<br/>   {<br/>     jdeErrorSet (lpBhvrCom, lpVoid, (ID) 0, _J("4363"), (LPVOID) NULL);<br/>     return ER_ERROR;<br/>   }<br/><br/>   idJDBResult = JDB_InitBhvr((void *)lpBhvrCom, &hUser,<br/>                           (JCHAR *)NULL, JDEDB_COMMIT_AUTO);<br/><br/>   if (idJDBResult == JDEDB_FAILED)<br/>   {<br/>      jdeErrorSet(lpBhvrCom, lpVoid, (ID)0, _J("078S"), (LPVOID)NULL);<br/>      return ER_ERROR;<br/>   }<br/><br/><br/>   /************************************************************************<br/>    * Set pointers<br/>    ************************************************************************/<br/><br/>   /************************************************************************<br/>    * Main Processing<br/>    ************************************************************************/<br/><br/>   /* Init Output Var */<br/>   <br/>   lpDS-&gtcErrorCode = _J('0');<br/>   jdeStrcpy(lpDS-&gtszErrorMessageID, (const JCHAR *)(_J("")));<br/>   <br/>   <br/>   /*Check required parameters*/<br/>   <br/>	<br/>   if (lpDS-&gtidDoc != 0 && lpDS-&gtidArrayElements != 0)<br/>   {<br/><br/>		   hDoc = jdeRetrieveDataPtr(hUser, lpDS-&gtidDoc);<br/><br/>		   if(hDoc == (XRCS_hDocument)NULL)<br/>//		   if(hDoc == (XMLC_hDocument)NULL)<br/>		   {<br/><br/>			   jdeTraceSz(NULL, _J("B55XML02 - Invalid Memory Reference:jdeRetrieveDataPtr for idDoc."));<br/>			   bErrorFound = TRUE;<br/>			   jdeStrcpy(dsDSDE55X01.szErrorReason, (const JCHAR *)(_J("03")));		   <br/>			   <br/><br/>		   }<br/>			   <br/>		<br/>		   lphDocElement = jdeRemoveDataPtr(hUser, lpDS-&gtidArrayElements);	<br/>		   		  <br/>		   if(lphDocElement == (XRCS_hElement*)NULL)<br/>//		   if(lphDocElement == (XMLC_hElement*)NULL)<br/>		   {<br/>			   jdeTraceSz(NULL, _J("B55XML02 - Invalid Memory Reference: jdeRemoveDataPtr for idArrayElment failed."));<br/>			   bErrorFound = TRUE;<br/>			   jdeStrcpy(dsDSDE55X01.szErrorReason, (const JCHAR *)(_J("03")));		   <br/>			   <br/>		   }<br/>		   else<br/>		   {<br/><br/><br/>			   lpDS-&gtidArrayElements = 0;<br/><br/>		   }<br/><br/><br/><br/>	}<br/>	else<br/>	{<br/><br/>		 <br/>		 bErrorFound = TRUE;<br/>		 jdeTraceSz(NULL, _J("B55XML02 - Invalid parameters passed to XMLGetElementsByTagName_76B"));<br/>		 jdeStrcpy(dsDSDE55X01.szErrorReason, (const JCHAR *)(_J("01")));		   <br/>		 <br/><br/>	}<br/><br/><br/>	 <br/>   /* Release Array */<br/>   /* ============= */<br/><br/>   if(!bErrorFound)<br/>   {<br/><br/>	   MathNumericToInt(&lpDS-&gtmnNumberOfElements,&iNumElements);<br/><br/>	   xmlcStatus = XRCS_freeElementArray(lphDocElement, (unsigned int) iNumElements);  <br/>//	   xmlcStatus = XMLC_freeElementArray(lphDocElement, (unsigned int) iNumElements);  <br/>	   <br/>	   lphElement = (XRCS_hElement*)NULL;<br/>//	   lphElement = (XMLC_hElement*)NULL;<br/>	   <br/>	   ZeroMathNumeric(&lpDS-&gtmnNumberOfElements);<br/><br/><br/><br/>   }<br/><br/><br/>   /************************************************************************<br/>    * Function Clean Up<br/>    ************************************************************************/<br/><br/>   if(bErrorFound)<br/>   {<br/>      lpDS-&gtcErrorCode = _J('1');<br/><br/>	  idReturn = ER_ERROR;<br/><br/>	  jdeStrcpy(lpDS-&gtszErrorMessageID, (const JCHAR *)(_J("G55E007")));<br/><br/>	  if(lpDS-&gtcSuppressErrorMessage != _J('1'))<br/>	  {<br/>		  jdeSetGBRErrorSubText(lpBhvrCom, lpVoid, (ID) 0, lpDS-&gtszErrorMessageID, &dsDSDE55X01);<br/>		<br/>	  }<br/>   }<br/>       <br/>   if (hUser)<br/>   {<br/>	   JDB_FreeBhvr(hUser);<br/>   }<br/><br/>   return (idReturn);<br/><br/>}<br/><br/><br/><br/><br/>/* Internal function comment block */<br/>/**************************************************************************<br/> *   Function:  I55XML01_GetXMLString<br/> *                           <br/> *      Notes:<br/> *<br/> *    Returns:<br/> *<br/> * Parameters:<br/> **************************************************************************/<br/><br/>BOOL I55XML01_GetXMLString(LPBHVRCOM lpBhvrCom,LPVOID lpVoid, HUSER hUser,LPDSI55XML01ZFILE lpF55XMLZ1)<br/>{<br/><br/><br/>	/************************************************************************ <br/>    *  Variable declarations <br/>    ************************************************************************/ <br/><br/><br/>	JDEDB_RESULT			idJDBReturn			= JDEDB_PASSED;<br/><br/>	BOOL					bErrorFound		= FALSE;<br/><br/>	HREQUEST				hReqF55XMLZ1			= NULL;<br/><br/>//	BLOBVALUE				BlobData;<br/>//  DBREF					dbRef;<br/>//  LPCOLINFO				lpCol;<br/>	<br/>	JCHAR					 xmlDeclaration[25]   = {0};<br/>	JCHAR					 xmlString[32100]	  = {0};<br/><br/>   /************************************************************************ <br/>    * Declare structures <br/>    ************************************************************************/ <br/><br/>	F55XMLZ1				dsF55XMLZ1			= {0};<br/>	KEY1_F55XMLZ1			dsF55XMLZ1Key1			= {0};<br/><br/>   /************************************************************************<br/>    * Main Processing<br/>    ************************************************************************/<br/><br/><br/>	jdeStrcpy(lpF55XMLZ1-&gtszErrorMessageID, (const JCHAR *)(_J("")));<br/>	jdeStrcpy(lpF55XMLZ1-&gtszErrorReason, (const JCHAR *)(_J("")));<br/>	jdeStrcpy(lpF55XMLZ1-&gtszXMLErrorCode, (const JCHAR *)(_J("")));<br/><br/>	lpF55XMLZ1-&gtcXMLStringAlloc = _J('N');<br/><br/><br/>						 <br/>	idJDBReturn = JDB_OpenTable(hUser, <br/>								NID_F55XMLZ1, <br/>								ID_F55XMLZ1_EDUS_EDBT_EDTN_EDLN, <br/>								NULL, <br/>								0, <br/>								NULL, <br/>								&hReqF55XMLZ1);<br/><br/><br/><br/>	if (idJDBReturn == JDEDB_PASSED)<br/>	{<br/><br/>		/* Init Key */<br/>		/* -------- */<br/><br/>		/* szEdiUserId */<br/>					 <br/>		jdeStrncpy (dsF55XMLZ1Key1.syedus, (const JCHAR *)(lpF55XMLZ1-&gtszEdiUserId), DIM(dsF55XMLZ1Key1.syedus));<br/>		<br/>		/* szEdiBatchNumber */<br/>					 <br/>		jdeStrncpy (dsF55XMLZ1Key1.syedbt, (const JCHAR *)(lpF55XMLZ1-&gtszEdiBatchNumber), DIM(dsF55XMLZ1Key1.syedbt));<br/>		<br/>		/* szEdiBatchNumber */<br/>		<br/>		jdeStrncpy (dsF55XMLZ1Key1.syedtn, (const JCHAR *)(lpF55XMLZ1-&gtszEdiTransactNumber), DIM(dsF55XMLZ1Key1.syedtn));<br/>		<br/>		/* mnEdiLineNumber */<br/>		<br/>		MathCopy (&dsF55XMLZ1Key1.syedln, &lpF55XMLZ1-&gtmnEdiLineNumber);<br/><br/>		/* Fetch */<br/>		/* ----- */<br/><br/>      <br/>		idJDBReturn = JDB_FetchKeyed(hReqF55XMLZ1,<br/>	        	                   (ID) ID_F55XMLZ1_EDUS_EDBT_EDTN_EDLN, <br/>                                   (void *)(&dsF55XMLZ1Key1), <br/>                                   (short)(4),<br/>                                   (void *)(&dsF55XMLZ1),<br/>								   FALSE);<br/><br/><br/>		if (idJDBReturn == JDEDB_PASSED)<br/>		{<br/><br/><br/>			/* szXMLInternalReference */<br/><br/>			jdeStrncpy (lpF55XMLZ1-&gtszXMLInternalReference, (const JCHAR *)(dsF55XMLZ1.sy55inre), DIM(lpF55XMLZ1-&gtszXMLInternalReference));<br/><br/>			jdeStrncpy (lpF55XMLZ1-&gtszXMLFileContainerPath, (const JCHAR *)(dsF55XMLZ1.sy55path), DIM(lpF55XMLZ1-&gtszXMLFileContainerPath));<br/>			<br/>			jdeStrcpy(xmlDeclaration, _J("&lt?xml version=\"1.0\"?&gt"));<br/>			jdeStrcpy(xmlString, xmlDeclaration);<br/>			jdeStrcat(xmlString, dsF55XMLZ1.sytxvc);	<br/><br/>			lpF55XMLZ1-&gtlBlobSize = DIM(xmlString);<br/><br/>			lpF55XMLZ1-&gtszXMLString = (JCHAR *)jdeAlloc(COMMON_POOL, lpF55XMLZ1-&gtlBlobSize, MEM_ZEROINIT);<br/><br/>			jdeStrncpy (lpF55XMLZ1-&gtszXMLString, xmlString, lpF55XMLZ1-&gtlBlobSize);<br/><br/>			lpF55XMLZ1-&gtcXMLStringAlloc = _J('Y');<br/><br/>			/* Convert Blob Field */<br/>/*<br/>			jdeNIDcpy(dbRef.szTable, NID_F70XMLZ1);<br/><br/>			dbRef.idInstance = 0L;<br/><br/>			jdeNIDcpy(dbRef.szDict, NID_G70TXFT);<br/><br/>			lpCol = JDB_GetTableColInfo(hReqF70XMLZ1, dbRef);<br/><br/>			/* Copy the data into a BLOBVALUE structure <br/><br/>			memcpy(&BlobData, lpCol-&gtlpJDEValue, sizeof(BLOBVALUE));<br/><br/>			/* Now copy the actual blobdata string into the space you just allocated <br/><br/>			lpF70XMLZ1-&gtlBlobSize = BlobData.lSize;<br/><br/>			if(BlobData.lSize &gt 0)<br/>			{<br/>				/* Allocate enough space to hold the blob value <br/>				<br/>				lpF70XMLZ1-&gtszXMLString = (JCHAR *)jdeAlloc(COMMON_POOL, BlobData.lSize + 1, MEM_ZEROINIT);<br/>				<br/>				if(lpF70XMLZ1-&gtszXMLString)<br/>				{<br/>					memcpy(lpF70XMLZ1-&gtszXMLString, BlobData.lpValue, BlobData.lSize);<br/>					lpF70XMLZ1-&gtcXMLStringAlloc = _J('Y');<br/>				}<br/>				else<br/>				{<br/>					<br/>					jdeStrcpy(lpF70XMLZ1-&gtszErrorReason, (const JCHAR *)(_J("03")));<br/>					jdeStrcpy(lpF70XMLZ1-&gtszErrorMessageID, (const JCHAR *)(_J("G55E004")));<br/>					jdeStrcpy(lpF70XMLZ1-&gtszXMLErrorCode, (const JCHAR *)(_J("008")));<br/>					<br/>					bErrorFound		= TRUE;<br/>					<br/>				}<br/><br/><br/>			}<br/>		<br/>*/<br/>		}<br/>		else<br/>		{<br/><br/>			jdeStrcpy(lpF55XMLZ1-&gtszErrorReason, (const JCHAR *)(_J("02")));<br/>			jdeStrcpy(lpF55XMLZ1-&gtszErrorMessageID, (const JCHAR *)(_J("G55E004")));<br/>			bErrorFound		= TRUE;<br/>			jdeStrcpy(lpF55XMLZ1-&gtszXMLErrorCode, (const JCHAR *)(_J("006")));<br/><br/>		}<br/><br/><br/><br/><br/>		JDB_CloseTable(hReqF55XMLZ1);<br/><br/><br/>	}<br/>	else<br/>	{<br/>		jdeStrcpy(lpF55XMLZ1-&gtszErrorReason, (const JCHAR *)(_J("01")));<br/>		jdeStrcpy(lpF55XMLZ1-&gtszErrorMessageID, (const JCHAR *)(_J("G55E004")));<br/>		bErrorFound		= TRUE;<br/>		jdeStrcpy(lpF55XMLZ1-&gtszXMLErrorCode, (const JCHAR *)(_J("005")));<br/><br/>	}<br/><br/>	return bErrorFound;<br/><br/>}<br/><br/><br/>/**************************************************************************<br/> *   Function:  I55XML01_GetXMLString<br/> *                           <br/> *      Notes:<br/> *<br/> *    Returns:<br/> *<br/> * Parameters:<br/> **************************************************************************/<br/><br/>void I55XML01_GenerateXMLFileName (LPBHVRCOM lpBhvrCom,LPVOID lpVoid, HUSER hUser,LPDSI55XML01FILE lpF55XML)<br/>{<br/><br/>	<br/>	jdeStripTrailingBlanks(lpF55XML-&gtszXMLFileContainerPath);<br/>			<br/>	if(IsStringBlank(lpF55XML-&gtszXMLFileContainerPath))<br/>	{<br/>		GetPrintQueueDirectoryPathName( lpF55XML-&gtszXMLFullFileName);<br/>		<br/>	}<br/>	else<br/>	{<br/><br/>		jdeStrcpy(lpF55XML-&gtszXMLFullFileName, lpF55XML-&gtszXMLFileContainerPath);<br/><br/><br/>	}<br/><br/>	I55XML01_AppendDirectorySeparator(lpF55XML-&gtszXMLFullFileName);<br/><br/>	jdeStripTrailingBlanks(lpF55XML-&gtszXMLInternalReference);<br/>	jdeStripTrailingBlanks(lpF55XML-&gtszEdiTransactNumber);<br/>	jdeStripTrailingBlanks(lpF55XML-&gtszEdiBatchNumber);<br/>	<br/>	if(lpF55XML-&gtcTemporalFile_YN == _J('Y'))<br/>	{<br/><br/>		jdeSprintf((JCHAR *) lpF55XML-&gtszXMLFileName,_J("%ls_%ls_%ls_tmp.xml"),lpF55XML-&gtszEdiBatchNumber,lpF55XML-&gtszEdiTransactNumber,lpF55XML-&gtszXMLInternalReference);<br/><br/>	}<br/>	else<br/>	{<br/><br/>		jdeSprintf((JCHAR *) lpF55XML-&gtszXMLFileName,_J("%ls_%ls_%ls.xml"),lpF55XML-&gtszEdiBatchNumber,lpF55XML-&gtszEdiTransactNumber,lpF55XML-&gtszXMLInternalReference);<br/><br/>	}<br/>	<br/><br/><br/>	jdeStrncat (lpF55XML-&gtszXMLFullFileName, lpF55XML-&gtszXMLFileName, DIM(lpF55XML-&gtszXMLFullFileName));<br/>		<br/><br/><br/>}<br/><br/><br/>/**************************************************************************<br/> *   Function:  I55XML01_AppendDirectorySeparator<br/> *                           <br/> *      Notes:<br/> *<br/> *    Returns:<br/> *<br/> * Parameters:<br/> **************************************************************************/<br/><br/>void I55XML01_AppendDirectorySeparator(JCHAR *szPath)<br/>{<br/><br/>	int			nPathLength;<br/>	JCHAR		szDirSeparator[2] = {0};<br/><br/><br/>	AppendDirectorySeparator(szDirSeparator);<br/>	nPathLength = jdeStrlen(szPath);<br/><br/><br/>	if (szPath[nPathLength-1] != szDirSeparator[0])<br/>	{<br/>		szDirSeparator[1]=0;<br/>		jdeStrcat(szPath, szDirSeparator);<br/>	}<br/><br/><br/>}<br/><br/>/**************************************************************************<br/> *   Function:  I55XML01_ConvertMathNumericToAString<br/> *                           <br/> *      Notes:<br/> *<br/> *    Returns:<br/> *<br/> * Parameters:<br/> **************************************************************************/<br/><br/>void I55XML01_ConvertMathNumericToAString(LPMATH_NUMERIC lpmnNumber, JCHAR *szReturnString)<br/>{<br/><br/><br/>    short                  nDecimals            = 0;<br/>    short                  nMaxLen              = 30;<br/>    short                  nPrecision           = 30;<br/><br/><br/><br/>	/* Get decimals from mnMathNumericToConvert in data structure*/<br/><br/>	<br/>    nDecimals = (short) jdeMathGetDecimalPosition(lpmnNumber); <br/><br/>   /* Clear output string */<br/>    jdeStrncpy(szReturnString, (const JCHAR *) (_J("\0")),<br/>         DIM(szReturnString));<br/>  <br/>   /*Convert the Math Numeric to a String with Decimails*/  <br/>    FormatMathNumericWithMask(szReturnString, <br/>                              nMaxLen, <br/>                              lpmnNumber, <br/>                              nPrecision, <br/>                              nDecimals, <br/>                              EC_SHOWDECIMAL);      <br/><br/><br/><br/><br/>}<br/><br/><br/>/**************************************************************************<br/> *   Function:  I55XML01_ConvertMathNumericToAString<br/> *                           <br/> *      Notes:<br/> *<br/> *    Returns:<br/> *<br/> * Parameters:<br/> **************************************************************************/<br/><br/>void I55XML01_ConvertAmountToAString(LPMATH_NUMERIC lpmnNumber, JCHAR *szReturnString)<br/>{<br/><br/><br/>    int                    iCurrencyDecimals    = 0;  <br/>    short                  nDecimals            = 0;<br/>    short                  nMaxLen              = 30;<br/>    short                  nPrecision           = 30;<br/><br/><br/><br/>	/* Get decimals from mnMathNumericToConvert in data structure*/<br/><br/>	iCurrencyDecimals = Decimals(lpmnNumber);<br/>    nDecimals = (short) iCurrencyDecimals; <br/><br/>   /* Clear output string */<br/>    jdeStrncpy(szReturnString, (const JCHAR *) (_J("\0")),<br/>         DIM(szReturnString));<br/>  <br/>   /*Convert the Math Numeric to a String with Decimails*/  <br/>    FormatMathNumericWithMask(szReturnString, <br/>                              nMaxLen, <br/>                              lpmnNumber, <br/>                              nPrecision, <br/>                              nDecimals, <br/>                              EC_SHOWDECIMAL);      <br/><br/><br/><br/><br/>}<br/><br/>/**************************************************************************<br/> *   Function:  I55XML01_ConvertCharacterToString<br/> *                           <br/> *      Notes:<br/> *<br/> *    Returns:<br/> *<br/> * Parameters:<br/> **************************************************************************/<br/><br/><br/>void I55XML01_ConvertCharacterToString(JCHAR cCharacterToConvert, JCHAR *szReturnString)<br/>{<br/><br/><br/>    JCHAR					szArray[2]; <br/><br/><br/>	szArray[0] = cCharacterToConvert;<br/>	szArray[1] = _J('\0');<br/><br/>    jdeStrncpy((JCHAR *)szReturnString,(const JCHAR *)(szArray), DIM(szReturnString)-1);<br/><br/>	/* BEGIN SAR 8498691 */<br/>	szReturnString[1] = _J('\0');<br/>	/* END SAR 8498691 */<br/><br/><br/>}<br/><br/><br/>/**************************************************************************<br/> *   Function:  I55XML01_ConvertDateToString<br/> *                           <br/> *      Notes:<br/> *<br/> *    Returns:<br/> *<br/> * Parameters:<br/> **************************************************************************/<br/><br/><br/>void I55XML01_ConvertDateToString(LPJDEDATE lpjdDateToConvert, JCHAR *szReturnString)<br/>{<br/><br/><br/>    /****************************************************************** <br/>     ** Validate the Date by passing NULL <br/>     ** NULL uses the environment variables of either the system or<br/>     ** the user override. The environment variables are set up when<br/>     ** a user logs into OneWorld.<br/>     ******************************************************************/<br/>	<br/>		<br/>	FormatDate(szReturnString, lpjdDateToConvert, (JCHAR*) (JCHAR*) "ASOSE");<br/><br/><br/>}<br/><br/>/**************************************************************************<br/> *   Function:  I55XML01_ConvertTimeToString<br/> *                           <br/> *      Notes:<br/> *<br/> *    Returns:<br/> *<br/> * Parameters:<br/> **************************************************************************/<br/><br/><br/>void I55XML01_ConvertTimeToString(int iTimeToConvert, JCHAR *szReturnString)<br/>{<br/><br/><br/><br/>   int   iVal;<br/>   int   iFirst, iSecond, iThird;<br/><br/>   iFirst = (int)(iTimeToConvert/10000);<br/>   iSecond = (int)((iTimeToConvert%10000)/100);<br/>   iThird = (int)(iTimeToConvert%100);<br/><br/>   jdeSprintf(szReturnString, _J("%02d:%02d:%02d"), iFirst, iSecond, iThird );<br/><br/><br/><br/><br/>}<br/><br/>/**************************************************************************<br/> *   Function:  I55XML01_ConvertMathNumericToAString<br/> *                           <br/> *      Notes:<br/> *<br/> *    Returns:<br/> *<br/> * Parameters:<br/> **************************************************************************/<br/><br/><br/>BOOL I55XML01_DoesXMLFileExists(JCHAR *szXMLFile)<br/>{<br/>  /************************************************************************<br/>    *  Variable declarations<br/>    ************************************************************************/<br/><br/><br/>	BOOL		bReturnValue = FALSE;<br/><br/>   /************************************************************************<br/>    * Declare pointers<br/>    ************************************************************************/<br/><br/>   FILE              *fpFlat           = (FILE *)NULL;<br/><br/>   /************************************************************************<br/>    * Main Processing<br/>    ************************************************************************/<br/><br/>   /* Open XML File */<br/>   /* ------------- */<br/>	<br/>   <br/>   fpFlat = jdeFopen(szXMLFile, _J("rb"));<br/>   <br/>   if (fpFlat != NULL)<br/>   {<br/>	   jdeTraceSz1(NULL, _J("B55XML02 - XML file %ls Found"), szXMLFile);<br/>	   <br/>	   bReturnValue		= TRUE;<br/>	   <br/>	   jdeFclose(fpFlat);<br/>   }<br/>   else<br/>   {<br/>	   jdeTraceSz1(NULL, _J("B55XML02 - XML file %ls Not Found"), szXMLFile);<br/>   }<br/>   <br/>   return bReturnValue;<br/><br/>}<br/><br/><br/><br/><br/><br/>/**************************************************************************<br/> *   Function:  I76BX001_RemoveSurroundingBlanks<br/> *                           <br/> *      Notes:<br/> *<br/> *    Returns:<br/> *<br/> * Parameters:<br/> **************************************************************************/<br/> void I55XML01_RemoveSurroundingBlanks(JCHAR *szString)<br/>  {<br/>	<br/>	unsigned int	ni;<br/>	JCHAR	*p;<br/>	JCHAR	*s;<br/>	JCHAR	*pi;<br/> <br/>	ni = jdeStrlen(szString);		/* Get initial length of string */<br/>	s = (JCHAR *) calloc(ni+1, sizeof(*s));  /* allow for the null JCHAR at end of string */<br/>	jdeStrncpy(s, (const JCHAR *) szString, ni);	<br/>	pi = s;<br/><br/>	if (*s != _J('\0'))<br/>	{	while (jdeIsspace(*s) && *s != _J('\0'))	/* Skip leading spaces */<br/>			++s;<br/>		p = s;<br/>		<br/>		if (*s)								/* Proceed if remaining string is not null */<br/>		{<br/>			for (;*s != _J('\0'); ++s);			/* go to end of string */<br/>			--s;							/* back up one JCHAR to point to last JCHAR in string */<br/>			while (jdeIsspace(*s))				/* remove spaces from end of string */<br/>			{<br/>				*s = _J('\0');<br/>				--s;<br/>			}<br/>		}<br/>		jdeStrncpy(szString, (const JCHAR *) p, ni);<br/>	}<br/>	free(pi);<br/>  }<br/><br/><br/>/**************************************************************************<br/> *   Function:  I55XML01_RemoveIllegalCharacterForAString<br/> *                           <br/> *      Notes:<br/> *<br/> *    Returns:<br/> *<br/> * Parameters:<br/> **************************************************************************/<br/><br/>void I55XML01_RemoveIllegalCharacterForAString(PJSTR lpName)<br/>{<br/>	PJSTR szTmp = lpName;<br/><br/>	while (*szTmp)<br/>	{<br/>		switch (*szTmp)<br/>		{<br/>		case _J('^'):<br/>		case _J('\n'):<br/>		case _J('\r'):<br/>			*szTmp = _J(' ');<br/>			break;<br/>		default:<br/>			break;<br/>		}<br/>		szTmp++;<br/>	}<br/>	return;<br/>}<br/><br/><br/><br/><br/><br/><br/><br/> <br/>/************************************************************************** <br/> *  Business Function:  XMLCreateDocumentFromString_76B <br/> * <br/> *        Description:  XML Create Document From String 76B<br/> * <br/> *         Parameters: <br/> *           LPBHVRCOM           lpBhvrCom    Business Function Communications <br/> *           LPVOID              lpVoid       Void Parameter - DO NOT USE! <br/> *           LPDSD70XM           lpDS         Parameter Data Structure Pointer   <br/> * <br/> *************************************************************************/ <br/> <br/>JDEBFRTN (ID) JDEBFWINAPI XMLCreateDocumentFromString_55 (LPBHVRCOM lpBhvrCom, LPVOID lpVoid, LPDSD55XML01M lpDS)  <br/> <br/>{ <br/>   /************************************************************************ <br/>    *  Variable declarations <br/>    ************************************************************************/ <br/>   ID						idReturn       = ER_SUCCESS;<br/>   ID						idJDBResult    = JDEDB_PASSED;<br/>   HUSER					hUser          = (HUSER)NULL;<br/>   BOOL						bErrorFound		= FALSE;<br/><br/>   XRCS_hParser				hParser			= (XRCS_hParser) NULL;<br/>   XRCS_Status				xmlcStatus		= XRCS_SUCCESS;	<br/>   XRCS_hDocument			hDoc           = (XRCS_hDocument)NULL;<br/>   XRCS_hElement			hDocElement    = (XRCS_hElement)NULL; <br/><br/>/* XMLC_hParser				hParser			= (XMLC_hParser) NULL;<br/>   XMLC_Status				xmlcStatus		= XMLC_SUCCESS;	<br/>   XMLC_hDocument			hDoc            = (XMLC_hDocument)NULL;<br/>   XMLC_hElement			hDocElement     = (XMLC_hElement)NULL;	*/<br/><br/>   JCHAR *				    hXMLString		= (JCHAR *)NULL;<br/><br/>   /************************************************************************ <br/>    * Declare structures <br/>    ************************************************************************/ <br/>	DSDE55X01			dsDSDE55X01			= {0};		/* error text substitution structure */<br/>   /************************************************************************ <br/>    * Declare pointers <br/>    ************************************************************************/ <br/> <br/>   /************************************************************************ <br/>    * Check for NULL pointers <br/>    ************************************************************************/ <br/>   if ((lpBhvrCom == (LPBHVRCOM) NULL) || <br/>       (lpVoid    == (LPVOID)    NULL) || <br/>       (lpDS      == (LPDSD55XML01M)	NULL)) <br/>   { <br/>     jdeErrorSet (lpBhvrCom, lpVoid, (ID) 0, _J("4363"), (LPVOID) NULL); <br/>     return ER_ERROR; <br/>   } <br/>   idJDBResult = JDB_InitBhvr((void *)lpBhvrCom, &hUser,<br/>                           (JCHAR *)NULL, JDEDB_COMMIT_AUTO);<br/><br/>   if (idJDBResult == JDEDB_FAILED)<br/>   {<br/>      jdeErrorSet(lpBhvrCom, lpVoid, (ID)0, _J("078S"), (LPVOID)NULL);<br/>      return ER_ERROR;<br/>   }<br/> <br/>   /************************************************************************ <br/>    * Set pointers <br/>    ************************************************************************/ <br/> <br/>   /************************************************************************ <br/>    * Main Processing <br/>    ************************************************************************/ <br/>	lpDS-&gtcErrorCode = _J('0');<br/>	jdeStrcpy(lpDS-&gtszErrorMessageID, (const JCHAR *)(_J("")));<br/>	jdeStrcpy(lpDS-&gtszXMLErrorCode, (const JCHAR *)(_J("")));<br/>	lpDS-&gtidDoc = 0;<br/>	lpDS-&gtidDocElement = 0;<br/><br/>	/* Retrieve document handle */<br/>	/* ======================== */<br/>	  <br/>	<br/>	  hXMLString =(JCHAR *) jdeRetrieveDataPtr(hUser, (HDATA)lpDS-&gtidXMLString);<br/>	  <br/>	  /*  Get the Xerces Parser  */<br/>			   <br/>	  xmlcStatus = XRCS_getParser(&hParser);<br/>//	  xmlcStatus = XMLC_getParser(&hParser);<br/>		   <br/>	  if(xmlcStatus == XRCS_SUCCESS)<br/>//	  if(xmlcStatus == XMLC_SUCCESS)<br/>	   {<br/>			   <br/>		 /*  Parse From String         */<br/>		 /*  ========================= */<br/><br/>		   xmlcStatus = XRCS_parseXMLString(hParser,hXMLString,&hDoc);<br/>//		   xmlcStatus = XMLC_parseXMLString(hParser,hXMLString,&hDoc);<br/>					   <br/>			if(xmlcStatus != XRCS_SUCCESS)<br/>//			if(xmlcStatus != XMLC_SUCCESS)<br/>			{<br/>				bErrorFound = TRUE;<br/>				jdeTraceSz(NULL, _J("B55XML02 - Failed creating XML Document from String"));<br/>				jdeStrcpy(dsDSDE55X01.szErrorReason, (const JCHAR *)(_J("06")));		   <br/>				jdeStrcpy(lpDS-&gtszErrorMessageID, (const JCHAR *)(_J("G55E008")));<br/>				jdeStrcpy(lpDS-&gtszXMLErrorCode, (const JCHAR *)(_J("009")));<br/>				<br/>			}<br/><br/>				if(!bErrorFound)<br/>				   {<br/>					   jdeTraceSz(NULL, _J("B55XML02 - Document Created:"));<br/>					   <br/>					   <br/>					   /* Get Root Element of the File */<br/>					   /* ============================ */<br/>					   <br/>					   xmlcStatus = XRCS_getDocumentElement(hDoc, &hDocElement);<br/>//					   xmlcStatus = XMLC_getDocumentElement(hDoc, &hDocElement);<br/>					   <br/>					   if(xmlcStatus == XRCS_SUCCESS)<br/>//					   if(xmlcStatus == XMLC_SUCCESS)<br/>					   {<br/>						   lpDS-&gtidDoc = jdeStoreDataPtr(hUser, hDoc);<br/>						   lpDS-&gtidDocElement = jdeStoreDataPtr(hUser, hDocElement);<br/>					   }<br/>					   else<br/>					   {<br/>						   idReturn = ER_ERROR;<br/>						   bErrorFound = TRUE;<br/>						   jdeTraceSz(NULL, _J("B55XML02 - XMLC bad format. There is not root element"));<br/>						   jdeStrcpy(dsDSDE55X01.szErrorReason, (const JCHAR *)(_J("09")));		   <br/>						   jdeStrcpy(lpDS-&gtszErrorMessageID, (const JCHAR *)(_J("G55E004")));<br/>						   jdeStrcpy(lpDS-&gtszXMLErrorCode, (const JCHAR *)(_J("012")));<br/>					   }<br/>				   }<br/>				   <br/>				   xmlcStatus = XRCS_freeParser(hParser);<br/>//				   xmlcStatus = XMLC_freeParser(hParser);<br/><br/>	   }<br/>	    else<br/>			   {<br/>				 <br/>				 bErrorFound = TRUE;<br/>				 jdeTraceSz(NULL, _J("B55XML02 - XRCS_getParser failed"));<br/>				 jdeStrcpy(dsDSDE55X01.szErrorReason, (const JCHAR *)(_J("04")));		   <br/>				 jdeStrcpy(lpDS-&gtszErrorMessageID, (const JCHAR *)(_J("G55E004")));<br/>				 jdeStrcpy(lpDS-&gtszXMLErrorCode, (const JCHAR *)(_J("002")));<br/><br/>			 <br/>			   }<br/>	 <br/>   /************************************************************************ <br/>    * Function Clean Up <br/>    ************************************************************************/ <br/>	if(bErrorFound)<br/>   {<br/>      lpDS-&gtcErrorCode = _J('1');<br/>	  idReturn = ER_ERROR;<br/><br/>	  if(lpDS-&gtcSuppressErrorMessage != _J('1'))<br/>	  {<br/>		  jdeSetGBRErrorSubText(lpBhvrCom, lpVoid, (ID) 0, lpDS-&gtszErrorMessageID, &dsDSDE55X01);<br/>		<br/>	  }<br/>   }<br/>       <br/>   if (hUser)<br/>   {<br/>	   JDB_FreeBhvr(hUser);<br/>   }<br/><br/>   return (idReturn); <br/>} <br/> <br/> <br/>/************************************************************************** <br/> *  Business Function:  XMLSerializeDocToXMLString_G70 <br/> * <br/> *        Description:  XML Serialize Document To XMLString G70 <br/> * <br/> *         Parameters: <br/> *           LPBHVRCOM           lpBhvrCom    Business Function Communications <br/> *           LPVOID              lpVoid       Void Parameter - DO NOT USE! <br/> *           LPDSD70XM           lpDS         Parameter Data Structure Pointer   <br/> * <br/> *************************************************************************/ <br/>/* Action Code -&gt 1  Serialize String and return ID.<br/> * Action Code -&gt 2  Free String.										*/<br/> <br/>JDEBFRTN (ID) JDEBFWINAPI XMLSerializeDocToXMLString_55 (LPBHVRCOM lpBhvrCom, LPVOID lpVoid, LPDSD55XML01N lpDS)  <br/> <br/>{ <br/>   /************************************************************************ <br/>    *  Variable declarations <br/>    ************************************************************************/ <br/>	XRCS_Status				xmlcStatus		= XRCS_SUCCESS;	<br/>	XRCS_hDocument			hDoc           = (XRCS_hDocument)NULL;<br/><br/>/*	XMLC_Status				xmlcStatus		= XMLC_SUCCESS;	<br/>	XMLC_hDocument			hDoc           = (XMLC_hDocument)NULL; */<br/>	JCHAR*				    hXMLString		= (JCHAR *)NULL;<br/>	HUSER					hUser          = (HUSER)NULL;<br/>	BOOL					bErrorFound		= FALSE;<br/>	ID						idReturn       = ER_SUCCESS;<br/>	ID						idJDBResult    = JDEDB_PASSED;<br/>   /************************************************************************ <br/>    * Declare structures <br/>    ************************************************************************/ <br/>	DSDE55X01			dsDSDE55X01			= {0};		/* error text substitution structure */<br/>	/************************************************************************ <br/>    * Declare pointers <br/>    ************************************************************************/ <br/> <br/>   /************************************************************************ <br/>    * Check for NULL pointers <br/>    ************************************************************************/ <br/>   if ((lpBhvrCom == (LPBHVRCOM) NULL) || <br/>       (lpVoid    == (LPVOID)    NULL) || <br/>       (lpDS      == (LPDSD55XML01N)	NULL)) <br/>   { <br/>     jdeErrorSet (lpBhvrCom, lpVoid, (ID) 0, _J("4363"), (LPVOID) NULL); <br/>     return ER_ERROR; <br/>   } <br/>	idJDBResult = JDB_InitBhvr((void *)lpBhvrCom, &hUser,<br/>                           (JCHAR *)NULL, JDEDB_COMMIT_AUTO);<br/><br/>   if (idJDBResult == JDEDB_FAILED)<br/>   {<br/>      jdeErrorSet(lpBhvrCom, lpVoid, (ID)0, _J("078S"), (LPVOID)NULL);<br/>      return ER_ERROR;<br/>   }<br/>   /************************************************************************ <br/>    * Set pointers <br/>    ************************************************************************/ <br/> <br/>   /************************************************************************ <br/>    * Main Processing <br/>    ************************************************************************/ <br/>	lpDS-&gtcErrorCode = _J('0');<br/>	jdeStrcpy(lpDS-&gtszErrorMessageID, (const JCHAR *)(_J("")));<br/>	jdeStrcpy(lpDS-&gtszXMLErrorCode, (const JCHAR *)(_J("")));<br/>	<br/><br/>	if (lpDS-&gtcActionCode == _J('1'))<br/>	{<br/>		lpDS-&gtidXMLString = 0;<br/>		hDoc = jdeRetrieveDataPtr(hUser, lpDS-&gtidDoc);<br/><br/>		if(hDoc == (XRCS_hDocument)NULL)<br/>//		if(hDoc == (XMLC_hDocument)NULL)<br/>	   {<br/>		   bErrorFound = TRUE;<br/>		   idReturn = ER_ERROR;<br/>		   jdeTraceSz(NULL, _J("B55XML01 - jdeRetrieveDataPtr for idDoc failed"));<br/>		   jdeStrcpy(dsDSDE55X01.szErrorReason, (const JCHAR *)(_J("08")));<br/>	   }<br/>		else<br/>		{<br/>			xmlcStatus = XRCS_serializeDocumentToXMLString(hDoc,&hXMLString);<br/>//			xmlcStatus = XMLC_serializeDocumentToXMLString(hDoc,&hXMLString);<br/><br/>			if(xmlcStatus == XRCS_SUCCESS)<br/>//			if(xmlcStatus == XMLC_SUCCESS)<br/>			{<br/>				lpDS-&gtidXMLString = jdeStoreDataPtr(hUser, hXMLString);<br/>			}<br/>			else<br/>			{<br/>				idReturn = ER_ERROR;<br/>				bErrorFound = TRUE;<br/>				jdeTraceSz(NULL, _J("B55XML02 - Failed execute API: XMLC_serializeDocumentToXMLString"));<br/>				<br/>			}<br/>	   }<br/>	}<br/>	if (lpDS-&gtcActionCode == _J('2'))<br/>	{<br/>		hXMLString =(JCHAR *) jdeRetrieveDataPtr(hUser, (HDATA)lpDS-&gtidXMLString);<br/>		<br/>		if(hXMLString != NULL)<br/>		 {<br/>			XRCS_freeString(hXMLString);<br/>//			XMLC_freeString(hXMLString);<br/>         }<br/>		else<br/>		 {<br/>			 idReturn = ER_ERROR;<br/>			 bErrorFound = TRUE;<br/>		 }<br/>		<br/>		<br/>	}<br/><br/><br/>   /************************************************************************ <br/>    * Function Clean Up <br/>    ************************************************************************/ <br/>	if(bErrorFound)<br/>	{<br/>      lpDS-&gtcErrorCode = _J('1');<br/>	}<br/>	if (hUser)<br/>   {<br/>	   JDB_FreeBhvr(hUser);<br/>   }<br/><br/>   return (idReturn); <br/>} <br/> <br/> /* Begin SAR 8666675 */<br/>/************************************************************************** <br/> *  Business Function:  XMLCreateDocWithAttrib_76B <br/> * <br/> *        Description:  XML Create Document -With Attributes <br/> * <br/> *         Parameters: <br/> *           LPBHVRCOM           lpBhvrCom    Business Function Communications <br/> *           LPVOID              lpVoid       Void Parameter - DO NOT USE! <br/> *           LPDSD70XM           lpDS         Parameter Data Structure Pointer   <br/> * <br/> *************************************************************************/ <br/> <br/>JDEBFRTN (ID) JDEBFWINAPI XMLCreateDocWithAttrib_55 (LPBHVRCOM lpBhvrCom, LPVOID lpVoid, LPDSD55XML01O lpDS)  <br/> <br/>{ <br/>   <br/>/************************************************************************<br/>    *  Variable declarations<br/>    ************************************************************************/<br/>    ID                idReturn       = ER_SUCCESS;<br/>    ID                idJDBResult    = JDEDB_PASSED;<br/>    HUSER             hUser          = (HUSER)NULL;<br/>    XRCS_Status       xmlcStatus     = XRCS_SUCCESS;<br/>	XRCS_hDocument    hDoc           = (XRCS_hDocument)NULL;<br/>	XRCS_hElement     hDocElement    = (XRCS_hElement)NULL;<br/>	XRCS_hAttribute   hAttribute     = (XRCS_hAttribute)NULL; <br/><br/>/*	XMLC_Status       xmlcStatus     = XMLC_SUCCESS;<br/>	XMLC_hDocument    hDoc           = (XMLC_hDocument)NULL;<br/>	XMLC_hElement     hDocElement    = (XMLC_hElement)NULL;<br/>	XMLC_hAttribute   hAttribute     = (XMLC_hAttribute)NULL; */<br/><br/>   /************************************************************************<br/>    * Declare structures<br/>    ************************************************************************/<br/><br/>	<br/>	DSDE55X01			dsDSDE55X01			= {0};		/* error text substitution structure */<br/><br/>   /************************************************************************<br/>    * Declare pointers<br/>    ************************************************************************/<br/><br/>   /************************************************************************<br/>    * Check for NULL pointers<br/>    ************************************************************************/<br/>   if ((lpBhvrCom == (LPBHVRCOM) NULL) ||<br/>       (lpVoid    == (LPVOID)    NULL) ||<br/>       (lpDS      == (LPDSD55XML01O)	NULL))<br/>   {<br/>     jdeErrorSet (lpBhvrCom, lpVoid, (ID) 0, _J("4363"), (LPVOID) NULL);<br/>     return ER_ERROR;<br/>   }<br/><br/>   idJDBResult = JDB_InitBhvr((void *)lpBhvrCom, &hUser,<br/>                           (JCHAR *)NULL, JDEDB_COMMIT_AUTO);<br/><br/>   if (idJDBResult == JDEDB_FAILED)<br/>   {<br/>      jdeErrorSet(lpBhvrCom, lpVoid, (ID)0, _J("078S"), (LPVOID)NULL);<br/>      return ER_ERROR;<br/>   }<br/><br/>   /************************************************************************<br/>    * Set pointers<br/>    ************************************************************************/<br/><br/>   /************************************************************************<br/>    * Main Processing<br/>    ************************************************************************/<br/>      <br/>   <br/>   <br/>   /* Initialize output parameters */<br/>   /* ============================ */<br/><br/>   lpDS-&gtcErrorCode = _J('0');<br/>   lpDS-&gtidDoc = 0;<br/>   lpDS-&gtidDocElement = 0;<br/>   jdeStrcpy(lpDS-&gtszErrorMessageID, (const JCHAR *)(_J("")));<br/>   <br/>   /* Check required parameters */<br/>   /* ========================= */<br/><br/><br/>   if (!IsStringBlank(lpDS-&gtszDocumentName))<br/>   {<br/>         /*Create the XML Document in memory*/<br/>		   <br/>		  xmlcStatus = XRCS_createEmptyDocument(&hDoc);<br/>//		  xmlcStatus = XMLC_createEmptyDocument(&hDoc);<br/><br/>         if(xmlcStatus == XRCS_SUCCESS)<br/>//		 if(xmlcStatus == XMLC_SUCCESS)<br/>         {<br/>            /*create document element*/<br/>			 jdeTraceSz(NULL, _J("B55XML02 - Document Created:"));<br/>			 jdeTraceSz(NULL, lpDS-&gtszDocumentName);<br/><br/>            xmlcStatus = XRCS_createElement(hDoc, lpDS-&gtszDocumentName, &hDocElement);<br/>//			xmlcStatus = XMLC_createElement(hDoc, lpDS-&gtszDocumentName, &hDocElement);<br/>            <br/>            if(xmlcStatus == XRCS_SUCCESS)<br/>//			if(xmlcStatus == XMLC_SUCCESS)<br/>            {<br/>				/*Add document attribute*/<br/>				xmlcStatus = XRCS_createAttribute(hDoc, lpDS-&gtszAttribute1Name,<br/>                                                lpDS-&gtszAttribute1Value,<br/>                                                &hAttribute); <br/>				<br/>/*				xmlcStatus = XMLC_createAttribute(hDoc, lpDS-&gtszAttribute1Name,<br/>                                                lpDS-&gtszAttribute1Value,<br/>                                                &hAttribute); */<br/><br/>			   if(xmlcStatus == XRCS_SUCCESS)<br/>//			   if(xmlcStatus == XMLC_SUCCESS)<br/>               {<br/>                  xmlcStatus = XRCS_appendAttribute(hDocElement, hAttribute);<br/>//				  xmlcStatus = XMLC_appendAttribute(hDocElement, hAttribute);<br/>               }<br/>			   xmlcStatus = XRCS_createAttribute(hDoc, lpDS-&gtszAttribute2Name,<br/>                                                lpDS-&gtszAttribute2Value,<br/>                                                &hAttribute);<br/><br/>/*			   xmlcStatus = XMLC_createAttribute(hDoc, lpDS-&gtszAttribute2Name,<br/>                                                lpDS-&gtszAttribute2Value,<br/>                                                &hAttribute); */<br/><br/>			   if(xmlcStatus == XRCS_SUCCESS)<br/>//			   if(xmlcStatus == XMLC_SUCCESS)<br/>               {<br/>                  xmlcStatus = XRCS_appendAttribute(hDocElement, hAttribute);<br/>//				  xmlcStatus = XMLC_appendAttribute(hDocElement, hAttribute);<br/>               }<br/>			   xmlcStatus = XRCS_createAttribute(hDoc, lpDS-&gtszAttribute3Name,<br/>                                                lpDS-&gtszAttribute3Value,<br/>                                                &hAttribute); <br/><br/>/*			   xmlcStatus = XMLC_createAttribute(hDoc, lpDS-&gtszAttribute3Name,<br/>                                                lpDS-&gtszAttribute3Value,<br/>                                                &hAttribute); */<br/><br/>			   if(xmlcStatus == XRCS_SUCCESS)<br/>//			   if(xmlcStatus == XMLC_SUCCESS)<br/>               {<br/>                  xmlcStatus = XRCS_appendAttribute(hDocElement, hAttribute);<br/>//				  xmlcStatus = XMLC_appendAttribute(hDocElement, hAttribute);<br/>               }<br/>			   xmlcStatus = XRCS_createAttribute(hDoc, lpDS-&gtszAttribute4Name,<br/>                                                lpDS-&gtszAttribute4Value,<br/>                                                &hAttribute); <br/><br/>/*			   xmlcStatus = XMLC_createAttribute(hDoc, lpDS-&gtszAttribute4Name,<br/>                                                lpDS-&gtszAttribute4Value,<br/>                                                &hAttribute); */<br/><br/>               if(xmlcStatus == XRCS_SUCCESS)<br/>//			   if(xmlcStatus == XMLC_SUCCESS)<br/>               {<br/>                  xmlcStatus = XRCS_appendAttribute(hDocElement, hAttribute);<br/>//				  xmlcStatus = XMLC_appendAttribute(hDocElement, hAttribute);<br/>               }<br/>			   xmlcStatus = XRCS_createAttribute(hDoc, lpDS-&gtszAttribute5Name,<br/>                                                lpDS-&gtszAttribute5Value,<br/>                                                &hAttribute);<br/><br/>/*			   xmlcStatus = XMLC_createAttribute(hDoc, lpDS-&gtszAttribute5Name,<br/>                                                lpDS-&gtszAttribute5Value,<br/>                                                &hAttribute); */<br/><br/>				if(xmlcStatus == XRCS_SUCCESS)<br/>//				if(xmlcStatus == XMLC_SUCCESS)<br/>               {<br/>                  xmlcStatus = XRCS_appendAttribute(hDocElement, hAttribute);<br/>//				  xmlcStatus = XMLC_appendAttribute(hDocElement, hAttribute);<br/>               }<br/>			   xmlcStatus = XRCS_createAttribute(hDoc, lpDS-&gtszAttribute6Name,<br/>                                                lpDS-&gtszAttribute6Value,<br/>                                                &hAttribute);<br/><br/>/*			   xmlcStatus = XMLC_createAttribute(hDoc, lpDS-&gtszAttribute6Name,<br/>                                                lpDS-&gtszAttribute6Value,<br/>                                                &hAttribute); */<br/><br/>				if(xmlcStatus == XRCS_SUCCESS)<br/>//				if(xmlcStatus == XMLC_SUCCESS)<br/>               {<br/>                  xmlcStatus = XRCS_appendAttribute(hDocElement, hAttribute);<br/>//				  xmlcStatus = XMLC_appendAttribute(hDocElement, hAttribute);<br/>               }<br/>			   if (xmlcStatus != XRCS_SUCCESS)<br/>//			   if (xmlcStatus != XMLC_SUCCESS)<br/>			   {<br/>				   jdeTraceSz(NULL, _J("B55XML02 - Append Attribute Failed"));<br/><br/>			   }<br/>			   if(xmlcStatus == XRCS_SUCCESS)<br/>//			   if(xmlcStatus == XMLC_SUCCESS)<br/>			   {<br/><br/>               /*Add document element*/<br/>				<br/>				jdeTraceSz(NULL, _J("B55XML02 - root element created"));<br/><br/>               xmlcStatus = XRCS_setDocumentElement(hDoc, hDocElement);<br/>//			   xmlcStatus = XMLC_setDocumentElement(hDoc, hDocElement);<br/><br/>               if(xmlcStatus == XRCS_SUCCESS)<br/>//			   if(xmlcStatus == XMLC_SUCCESS)<br/>               {<br/>                  /*Store the handles and return IDs*/<br/>                  lpDS-&gtidDoc = jdeStoreDataPtr(hUser, hDoc);<br/>                  lpDS-&gtidDocElement = jdeStoreDataPtr(hUser, hDocElement);<br/>				  jdeTraceSz(NULL, _J("B55XML02 - root element assigned to document"));<br/>               }<br/>			   else<br/>			   {<br/><br/>				   memset((void *)(&dsDSDE55X01), (int)(_J('\0')), sizeof(dsDSDE55X01));<br/>				   jdeStrcpy(dsDSDE55X01.szErrorReason, (const JCHAR *)(_J("03")));<br/>				   jdeStrcpy(lpDS-&gtszErrorMessageID, (const JCHAR *)(_J("G55E003")));	   <br/>				   jdeTraceSz(NULL, _J("B55XML02 - Failed to create element into XML document"));<br/><br/><br/>			   }<br/>			   }<br/>            }<br/>         }<br/>		 else<br/>		 {<br/><br/>			 memset((void *)(&dsDSDE55X01), (int)(_J('\0')), sizeof(dsDSDE55X01));<br/>			 jdeStrcpy(dsDSDE55X01.szErrorReason, (const JCHAR *)(_J("03")));<br/>			 jdeStrcpy(lpDS-&gtszErrorMessageID, (const JCHAR *)(_J("G55E003")));	   <br/>			 jdeTraceSz(NULL, _J("B55XML02 - Failed to create XML document"));<br/><br/>		 }<br/>      <br/><br/>   }<br/>   else<br/>   {<br/>	   xmlcStatus = XRCS_ERROR;	<br/>//	   xmlcStatus = XMLC_ERROR;<br/>	   memset((void *)(&dsDSDE55X01), (int)(_J('\0')), sizeof(dsDSDE55X01));<br/>	   jdeStrcpy(dsDSDE55X01.szErrorReason, (const JCHAR *)(_J("01")));<br/>	   jdeStrcpy(lpDS-&gtszErrorMessageID, (const JCHAR *)(_J("G55E003")));	   <br/>	   jdeTraceSz(NULL, _J("B55XML02 - Invalid parameters passed to XMLCreateDocument"));<br/><br/><br/>   }<br/><br/>   /************************************************************************ <br/>    * Function Clean Up <br/>    ************************************************************************/ <br/>   if(xmlcStatus != XRCS_SUCCESS)<br/>// if(xmlcStatus != XMLC_SUCCESS)<br/>   {<br/>      idReturn = ER_ERROR;<br/>      lpDS-&gtcErrorCode = _J('1');<br/>	  if(lpDS-&gtcSuppressErrorMessage != _J('1'))<br/>	  {<br/>		  jdeSetGBRErrorSubText(lpBhvrCom, lpVoid, (ID) 0, lpDS-&gtszErrorMessageID, &dsDSDE55X01);<br/>		<br/>	  }<br/>      <br/>   }<br/><br/>	if (hUser)<br/>	{<br/>		JDB_FreeBhvr(hUser);<br/>	}<br/>   <br/>   return (idReturn);<br/>}<br/>  <br/><br/> <br/> <br/>/************************************************************************** <br/> *  Business Function:  XMLWriteToZFile_UTF8_76B <br/> * <br/> *        Description:  XML Write To Z File -UTF8-No Hyphen 76B <br/> * <br/> *         Parameters: <br/> *           LPBHVRCOM           lpBhvrCom    Business Function Communications <br/> *           LPVOID              lpVoid       Void Parameter - DO NOT USE! <br/> *           LPDSD70XM           lpDS         Parameter Data Structure Pointer   <br/> * <br/> *************************************************************************/ <br/> <br/>JDEBFRTN (ID) JDEBFWINAPI XMLWriteToZFile_UTF8_55 (LPBHVRCOM lpBhvrCom, LPVOID lpVoid, LPDSD55XML01P lpDS)  <br/> <br/>{ <br/>   /************************************************************************<br/>    *  Variable declarations<br/>    ************************************************************************/<br/>	ID                idReturn       = ER_SUCCESS;<br/>    ID                idJDBResult    = JDEDB_PASSED;<br/>    HUSER             hUser          = (HUSER)NULL;<br/>    XRCS_Status       xmlcStatus     = XRCS_SUCCESS;<br/>	XRCS_hDocument    hDoc           = (XRCS_hDocument)NULL; <br/><br/>/*	XMLC_Status       xmlcStatus     = XMLC_SUCCESS;<br/>	XMLC_hDocument    hDoc           = (XMLC_hDocument)NULL; */<br/>	<br/><br/>	HREQUEST		  hReqF55XMLZ1			= NULL;<br/>	JDEDB_RESULT	  JDEDBResult			= JDEDB_PASSED;<br/>//	DBREF			dbRef					= {0};<br/>//	int				blobSize				= 0;<br/><br/>	BOOL			bErrorFound				= FALSE;<br/><br/><br/><br/>   /************************************************************************<br/>    * Declare structures<br/>    ************************************************************************/<br/><br/>	<br/><br/>	F55XMLZ1			dsF55XMLZ1			= {0};<br/><br/>	DSDE55X01			dsDSDE55X01			= {0};		/* error text substitution structure */<br/><br/><br/>	DSI55XML01FILE		dsDSI55XML01FILE	= {0};<br/><br/>   /************************************************************************<br/>    * Declare pointers<br/>    ************************************************************************/<br/><br/><br/>	JCHAR* szXMLString		= NULL;<br/><br/><br/>   /************************************************************************<br/>    * Check for NULL pointers<br/>    ************************************************************************/<br/>   if ((lpBhvrCom == (LPBHVRCOM) NULL) ||<br/>       (lpVoid    == (LPVOID)    NULL) ||<br/>       (lpDS      == (LPDSD55XML01P)	NULL))<br/>   {<br/>     jdeErrorSet (lpBhvrCom, lpVoid, (ID) 0, _J("4363"), (LPVOID) NULL);<br/>     return ER_ERROR;<br/>   }<br/><br/>   idJDBResult = JDB_InitBhvr((void *)lpBhvrCom, &hUser,<br/>                           (JCHAR *)NULL, JDEDB_COMMIT_AUTO);<br/><br/>   if (idJDBResult == JDEDB_FAILED)<br/>   {<br/>      jdeErrorSet(lpBhvrCom, lpVoid, (ID)0, _J("078S"), (LPVOID)NULL);<br/>      return ER_ERROR;<br/>   }<br/><br/>   /************************************************************************<br/>    * Set pointers<br/>    ************************************************************************/<br/><br/>   /************************************************************************<br/>    * Main Processing<br/>    ************************************************************************/<br/><br/>   /* Initialize output parameters */<br/>   /* ============================ */<br/><br/><br/>   lpDS-&gtcErrorCode = _J('0');<br/>   jdeStrcpy(lpDS-&gtszErrorMessageID, (const JCHAR *)(_J("")));<br/><br/>   <br/>   /* Check required parameters */<br/>   /* ========================= */<br/><br/>   if ((lpDS-&gtidDoc != 0))<br/>   {<br/>	   /* Retrieve document handle */<br/>	   /* ======================== */<br/><br/><br/>	   hDoc = jdeRetrieveDataPtr(hUser, lpDS-&gtidDoc);<br/><br/>	   if(hDoc == (XRCS_hDocument)NULL)<br/>//	   if(hDoc == (XMLC_hDocument)NULL)<br/>	   {<br/><br/><br/>		   jdeStrcpy(dsDSDE55X01.szErrorReason, (const JCHAR *)(_J("06")));<br/>		   bErrorFound = TRUE;<br/>		   jdeTraceSz(NULL, _J("B55XML02 - jdeRetrieveDataPtr for idDoc failed"));<br/><br/>	   }<br/>	  <br/>   }<br/>   else<br/>   {  <br/>	   jdeStrcpy(dsDSDE55X01.szErrorReason, (const JCHAR *)(_J("01")));<br/>	   bErrorFound = TRUE;<br/>	   jdeTraceSz(NULL, _J("B55XML02 - Invalid parameters passed to XMLWriteToZ-File"));<br/>      <br/>   }<br/><br/><br/><br/>   /* Write To File */<br/>   /* ============= */<br/><br/><br/><br/>   if (!bErrorFound)<br/>   {<br/><br/><br/>	   if (lpDS-&gtcWriteToFileYN == _J('Y'))<br/>	   {<br/>		   /* Create File Name */	<br/>		   /* ================ */<br/><br/>				/* Create File Name */	<br/><br/>				/* szEdiUserId */ <br/>		<br/>				jdeStrncpy (dsDSI55XML01FILE.szEdiUserId, (const JCHAR *)(lpDS-&gtszEdiUserId), DIM(dsDSI55XML01FILE.szEdiUserId));<br/>			   <br/>				/* szEdiBatchNumber */<br/>				<br/>				jdeStrncpy (dsDSI55XML01FILE.szEdiBatchNumber, (const JCHAR *)(lpDS-&gtszEdiBatchNumber), DIM(dsDSI55XML01FILE.szEdiBatchNumber));<br/>				<br/>				/* szEdiBatchNumber */<br/>				<br/>				jdeStrncpy (dsDSI55XML01FILE.szEdiTransactNumber, (const JCHAR *)(lpDS-&gtszEdiTransactNumber), DIM(dsDSI55XML01FILE.szEdiTransactNumber));<br/>				<br/>				/* mnEdiLineNumber */<br/>				<br/>				MathCopy (&dsDSI55XML01FILE.mnEdiLineNumber, &lpDS-&gtmnEdiLineNumber);<br/>		<br/>				/* szXMLInternalReference */<br/>				<br/>				jdeStrncpy (dsDSI55XML01FILE.szXMLInternalReference, (const JCHAR *)(lpDS-&gtszXMLInternalReference), DIM(dsDSI55XML01FILE.szXMLInternalReference));<br/>		<br/>		<br/>				/* cTemporalFile_YN */<br/>		<br/>				dsDSI55XML01FILE.cTemporalFile_YN = _J('N');<br/>		<br/>				/* szXMLFileContainerPath */<br/>				<br/>				jdeStrncpy (dsDSI55XML01FILE.szXMLFileContainerPath, (const JCHAR *)(lpDS-&gtszFileName), DIM(dsDSI55XML01FILE.szXMLFileContainerPath));<br/>				<br/>				<br/>				I55XML01_GenerateXMLFileNameWithoutHyphens(	(LPBHVRCOM) lpBhvrCom,<br/>																(LPVOID) lpVoid, <br/>																(HUSER) hUser,<br/>																(LPDSI55XML01FILE) &dsDSI55XML01FILE);<br/><br/>				<br/>				xmlcStatus = XRCS_serializeDocumentToFile(hDoc, dsDSI55XML01FILE.szXMLFullFileName);<br/>//				xmlcStatus = XMLC_serializeDocumentToFile(hDoc, dsDSI55XML01FILE.szXMLFullFileName);<br/>				/*xmlcStatus = XRCS_serializeDocumentToFileWithEncoding(hDoc, dsDSI55XML01FILE.szXMLFullFileName,_J("UTF-8"));*/<br/>		<br/>		<br/>				<br/>		<br/>		       <br/>				 if(xmlcStatus != XRCS_SUCCESS)<br/>//				 if(xmlcStatus != XMLC_SUCCESS)<br/>				 {<br/>		<br/>					 <br/>					 jdeStrcpy(dsDSDE55X01.szErrorReason, (const JCHAR *)(_J("04")));					 <br/>					 bErrorFound = TRUE;<br/>					 jdeTraceSz1(NULL, _J("B55XML02 - Failed to write XML to file:%ls"),dsDSI55XML01FILE.szXMLFullFileName);<br/>		<br/>				 }<br/>				 else<br/>				 {<br/><br/><br/>					 jdeTraceSz(NULL, _J("B55XML02 - XML writed"));<br/>					 jdeTraceSz(NULL, dsDSI55XML01FILE.szXMLFullFileName);<br/><br/><br/>				 }<br/><br/><br/><br/><br/>	   }<br/>	   else<br/>	   {<br/>		   jdeStrcpy (lpDS-&gtszXMLFileContainerPath, (const JCHAR *)(_J("")));<br/><br/>	   }<br/><br/><br/>   }<br/><br/><br/><br/>   /* Write To Z-File */<br/>   /* =============== */<br/><br/><br/>   if (!bErrorFound)<br/>   {<br/>		<br/>				 JDEDBResult = JDB_OpenTable(hUser, <br/>												NID_F55XMLZ1, <br/>												ID_F55XMLZ1_EDUS_EDBT_EDTN_EDLN, <br/>												NULL, <br/>												0, <br/>												NULL, <br/>												&hReqF55XMLZ1);<br/>		<br/>		<br/>				 if (JDEDBResult == JDEDB_PASSED)<br/>				 {<br/>		<br/>					 /* szEdiUserId */<br/>					 <br/>					 jdeStrncpy (dsF55XMLZ1.syedus, (const JCHAR *)(lpDS-&gtszEdiUserId), DIM(dsF55XMLZ1.syedus));<br/>		<br/>					 /* szEdiBatchNumber */<br/>					 <br/>					 jdeStrncpy (dsF55XMLZ1.syedbt, (const JCHAR *)(lpDS-&gtszEdiBatchNumber), DIM(dsF55XMLZ1.syedbt));<br/>		<br/>					 /* szEdiBatchNumber */<br/>		<br/>					 jdeStrncpy (dsF55XMLZ1.syedtn, (const JCHAR *)(lpDS-&gtszEdiTransactNumber), DIM(dsF55XMLZ1.syedtn));<br/>		<br/>					 /* mnEdiLineNumber */<br/>		<br/>					 MathCopy (&dsF55XMLZ1.syedln, &lpDS-&gtmnEdiLineNumber);<br/>		<br/>					 /* szEdiDocumentType */<br/>		<br/>					 jdeStrncpy (dsF55XMLZ1.syedct, (const JCHAR *)(lpDS-&gtszEdiDocumentType), DIM(dsF55XMLZ1.syedct));<br/>		<br/>					 /* szTypeTransaction */<br/>		<br/>					 jdeStrncpy (dsF55XMLZ1.sytytn, (const JCHAR *)(lpDS-&gtszTypeTransaction), DIM(dsF55XMLZ1.sytytn));<br/>		<br/>					 /* szEdiTranslationFormat */<br/>		<br/>					 jdeStrncpy (dsF55XMLZ1.syedft, (const JCHAR *)(lpDS-&gtszEdiTranslationFormat), DIM(dsF55XMLZ1.syedft));<br/>		<br/>					 /* szEdiTranslationFormat */<br/>					 <br/>					 JDEDATECopy(&dsF55XMLZ1.syeddt , &lpDS-&gtjdEdiTransmissionDate );<br/>		<br/>					 /* cDirectionIndicator */<br/>		<br/>					 dsF55XMLZ1.sydrin = lpDS-&gtcDirectionIndicator;<br/>		<br/>					 /* mnEdiLineNumber */<br/>		<br/>					 MathCopy (&dsF55XMLZ1.syeddl, &lpDS-&gtmnEdiDetailLinesProcess);<br/>		<br/>					 /* cEdiSuccessfullyProcess */<br/>		<br/>					 dsF55XMLZ1.syedsp = lpDS-&gtcEdiSuccessfullyProcess;<br/>		<br/>					 /* szTradingPartnerId */<br/>		<br/>					 jdeStrncpy (dsF55XMLZ1.sypnid, (const JCHAR *)(lpDS-&gtszTradingPartnerId), DIM(dsF55XMLZ1.sypnid));<br/>		<br/>					 /* szTransactionAction */<br/>		<br/>					 jdeStrncpy (dsF55XMLZ1.sytnac, (const JCHAR *)(lpDS-&gtszTransactionAction), DIM(dsF55XMLZ1.sytnac));<br/>		<br/>					 /* jdXMLDateProcessed */<br/>					 <br/>					 JDEDATECopy(&dsF55XMLZ1.sy55xdpr , &lpDS-&gtjdXMLDateProcessed );<br/>		<br/>					 /* szXMLTransactionGroup */<br/>		<br/>					 jdeStrncpy (dsF55XMLZ1.sy55xtg, (const JCHAR *)(lpDS-&gtszXMLTransactionGroup), DIM(dsF55XMLZ1.sy55xtg));<br/>		<br/>					 /* szXMLInternalReference */<br/>		<br/>					 jdeStrncpy (dsF55XMLZ1.sy55inre, (const JCHAR *)(lpDS-&gtszXMLInternalReference), DIM(dsF55XMLZ1.sy55inre));<br/>		<br/>					 /* szXMLAditionalCode */<br/>		<br/>					 jdeStrncpy (dsF55XMLZ1.sy55xcd, (const JCHAR *)(lpDS-&gtszXMLAditionalCode), DIM(dsF55XMLZ1.sy55xcd));<br/>		<br/>					 /* cXMLDocumentStatus */<br/>		<br/>					 dsF55XMLZ1.sy55xdos = lpDS-&gtcXMLDocumentStatus;<br/>		<br/>					 /* szXMLVersion */<br/>		<br/>					 jdeStrncpy (dsF55XMLZ1.sy55xmlv, (const JCHAR *)(lpDS-&gtszXMLVersion), DIM(dsF55XMLZ1.sy55xmlv));<br/>		<br/>					 /* szXMLAttributeStrGeneric1 */<br/>		<br/>					 jdeStrncpy (dsF55XMLZ1.sy55xsg1, (const JCHAR *)(lpDS-&gtszXMLAttributeStrGeneric1), DIM(dsF55XMLZ1.sy55xsg1));<br/>		<br/>					 /* szXMLAttributeStrGeneric2 */<br/>		<br/>					 jdeStrncpy (dsF55XMLZ1.sy55xsg2, (const JCHAR *)(lpDS-&gtszXMLAttributeStrGeneric2), DIM(dsF55XMLZ1.sy55xsg2));<br/>		<br/>					 /* szXMLAttributeStrGeneric3 */<br/>		<br/>					 jdeStrncpy (dsF55XMLZ1.sy55xsg3, (const JCHAR *)(lpDS-&gtszXMLAttributeStrGeneric3), DIM(dsF55XMLZ1.sy55xsg3));<br/>		<br/>					 /* mnXMLAttributeNumGeneric1 */<br/>		<br/>					 MathCopy (&dsF55XMLZ1.sy55xng1, &lpDS-&gtmnXMLAttributeNumGeneric1);<br/>		<br/>					 /* mnXMLAttributeNumGeneric1 */<br/>		<br/>					 MathCopy (&dsF55XMLZ1.sy55xng2, &lpDS-&gtmnXMLAttributeNumGeneric2);<br/>		<br/>					 /* mnXMLAttributeNumGeneric3 */<br/>		<br/>					 MathCopy (&dsF55XMLZ1.sy55xng3, &lpDS-&gtmnXMLAttributeNumGeneric3);<br/>		<br/>					 /* jdXMLAttributeDatGeneric1 */<br/>					 <br/>					 JDEDATECopy(&dsF55XMLZ1.sy55xdg1 , &lpDS-&gtjdXMLAttributeDatGeneric1 );<br/>		<br/>					 /* jdXMLAttributeDatGeneric2 */<br/>					 <br/>					 JDEDATECopy(&dsF55XMLZ1.sy55xdg2 , &lpDS-&gtjdXMLAttributeDatGeneric2 );<br/>		<br/>					 /* jdXMLAttributeDatGeneric3 */<br/>					 <br/>					 JDEDATECopy(&dsF55XMLZ1.sy55xdg3 , &lpDS-&gtjdXMLAttributeDatGeneric3 );<br/>		<br/>					 /* idXMLAttributeIntGeneric1 */<br/>		<br/>					 dsF55XMLZ1.sy55xig1 = lpDS-&gtidXMLAttributeIntGeneric1;<br/>		<br/>					 /* idXMLAttributeIntGeneric1 */<br/>		<br/>					 dsF55XMLZ1.sy55xcg1 = lpDS-&gtcXMLAttributeChrGeneric1;<br/>		<br/>					 /* idXMLAttributeIntGeneric2 */<br/>		<br/>					 dsF55XMLZ1.sy55xcg2 = lpDS-&gtcXMLAttributeChrGeneric2;<br/>		<br/>					 /* idXMLAttributeIntGeneric3 */<br/>		<br/>					 dsF55XMLZ1.sy55xcg3 = lpDS-&gtcXMLAttributeChrGeneric3;<br/>		<br/>					 /* mnXMLAddressNumber */<br/>		<br/>					 MathCopy (&dsF55XMLZ1.syan8, &lpDS-&gtmnXMLAddressNumber);<br/>		<br/>					 /* szXMLCostCenter */<br/>		<br/>					 jdeStrncpy (dsF55XMLZ1.symcu, (const JCHAR *)(lpDS-&gtszXMLCostCenter), DIM(dsF55XMLZ1.symcu));<br/>		<br/>					 /* szXMLCompany */<br/>		<br/>					 jdeStrncpy (dsF55XMLZ1.syco, (const JCHAR *)(lpDS-&gtszXMLCompany), DIM(dsF55XMLZ1.syco));<br/>		<br/>					 /* szXMLDocumentType */<br/>		<br/>					 jdeStrncpy (dsF55XMLZ1.sydct, (const JCHAR *)(lpDS-&gtszXMLDocumentType), DIM(dsF55XMLZ1.sydct));<br/>		<br/>					 /* szUserReservedCode */<br/>		<br/>					 jdeStrncpy (dsF55XMLZ1.syurcd, (const JCHAR *)(lpDS-&gtszUserReservedCode), DIM(dsF55XMLZ1.syurcd));<br/>		<br/>					 /* jdUserReservedDate */<br/>					 <br/>					 JDEDATECopy(&dsF55XMLZ1.syurdt , &lpDS-&gtjdUserReservedDate );<br/>					 <br/>					 /* mnUserReservedAmount */<br/>		<br/>					 MathCopy (&dsF55XMLZ1.syurat, &lpDS-&gtmnUserReservedAmount);<br/>		<br/>					 /* mnUserReservedNumber */<br/>		<br/>					 MathCopy (&dsF55XMLZ1.syurat, &lpDS-&gtmnUserReservedNumber);<br/>		<br/>					 /* szUserReservedReference */<br/>		<br/>					 jdeStrncpy (dsF55XMLZ1.syurrf, (const JCHAR *)(lpDS-&gtszUserReservedReference), DIM(dsF55XMLZ1.syurrf));<br/>		<br/>					 /* szTransactionOriginator */<br/>		<br/>					 jdeStrncpy (dsF55XMLZ1.sytorg, (const JCHAR *)(lpDS-&gtszTransactionOriginator), DIM(dsF55XMLZ1.sytorg));<br/>		<br/>					 /* szUserId */<br/>		<br/>					 jdeStrncpy (dsF55XMLZ1.syuser, (const JCHAR *)(lpDS-&gtszUserId), DIM(dsF55XMLZ1.syuser));<br/>		<br/>					 /* szProgramId */<br/>		<br/>					 jdeStrncpy (dsF55XMLZ1.sypid, (const JCHAR *)(lpDS-&gtszProgramId), DIM(dsF55XMLZ1.sypid));<br/>		<br/>					 /* szWorkStationId */<br/>		<br/>					 jdeStrncpy (dsF55XMLZ1.syjobn, (const JCHAR *)(lpDS-&gtszWorkStationId), DIM(dsF55XMLZ1.syjobn));<br/>		<br/>					 /* jdDateUpdated */<br/>					 <br/>					 JDEDATECopy(&dsF55XMLZ1.syupmj , &lpDS-&gtjdDateUpdated );<br/>		<br/>					 /* mnTimeLastUpdated */<br/>		<br/>					 MathCopy (&dsF55XMLZ1.syupmt, &lpDS-&gtmnTimeLastUpdated);<br/><br/>					 /* szXMLFullFileName */<br/><br/>					 jdeStrncpy (dsF55XMLZ1.sy55path, dsDSI55XML01FILE.szXMLFullFileName, DIM(dsF55XMLZ1.sy55path));<br/><br/>					 jdeStrncpy (lpDS-&gtszXMLFileContainerPath, (const JCHAR *)(dsDSI55XML01FILE.szXMLFullFileName), DIM(lpDS-&gtszXMLFileContainerPath));<br/><br/>					 <br/>		<br/>					 /* XML */<br/>		<br/>					 xmlcStatus = XRCS_serializeDocumentToXMLString(hDoc,&szXMLString);<br/>//					 xmlcStatus = XMLC_serializeDocumentToXMLString(hDoc,&szXMLString);<br/>/*		<br/>					 jdeNIDcpy(dbRef.szTable, NID_F70XMLZ1);<br/>					 dbRef.idInstance = 0L;<br/>					 jdeNIDcpy(dbRef.szDict, NID_G70TXFT);<br/>					 blobSize = ( (strlen(szXMLString)+ 1) * sizeof(JCHAR ) ) ;<br/>					 dsF55XMLZ1.syg70txft.lpValue  = JDB_SetBLOBSize(hReqF70XMLZ1, dbRef, blobSize);<br/>					 dsF55XMLZ1.syg70txft.lSize	  = blobSize;<br/>					 dsF55XMLZ1.syg70txft.lMaxSize = MAX_BLOB_SIZE;<br/>		<br/>					 if(dsF55XMLZ1.syg70txft.lpValue != NULL)<br/>					 {<br/>		<br/>						 memcpy((void*)dsF55XMLZ1.syg70txft.lpValue, (void*)szXMLString,dsF55XMLZ1.syg70txft.lSize);<br/>		<br/>					 } */<br/><br/>					 if(szXMLString != NULL)<br/>					 {<br/>						jdeStrncpy (dsF55XMLZ1.sytxvc, szXMLString, DIM(dsF55XMLZ1.sytxvc));<br/>					 }<br/>					 <br/>		<br/>					 <br/>					 JDEDBResult = JDB_InsertTable(hReqF55XMLZ1, NID_F55XMLZ1, (ID)0, &dsF55XMLZ1);<br/>		<br/>		<br/>					 if (JDEDBResult != JDEDB_PASSED)<br/>					 {<br/>		<br/>						bErrorFound = TRUE;<br/>						jdeStrcpy(dsDSDE55X01.szErrorReason, (const JCHAR *)(_J("03")));<br/>						jdeTraceSz(NULL, _J("B55XML02 - Insert to table F55XMLZ1 failed"));<br/>		<br/>		<br/>					 }<br/>		<br/>		<br/>		<br/>					 JDB_CloseTable(hReqF55XMLZ1);<br/>							 <br/>					 if(szXMLString != NULL)<br/>					 {<br/>						 XRCS_freeString(szXMLString);<br/>//						 XMLC_freeString(szXMLString);<br/>					 }<br/>		<br/>		<br/>				 }<br/>				 else<br/>				 {<br/>		<br/>					<br/>					 bErrorFound = TRUE;<br/>					 jdeStrcpy(dsDSDE55X01.szErrorReason, (const JCHAR *)(_J("02")));<br/>					 jdeTraceSz(NULL, _J("B55XML01 - Open for table F55XMLZ1 failed"));<br/>		<br/>				 }<br/>		<br/>		<br/>   }<br/><br/><br/>   /************************************************************************ <br/>    * Function Clean Up <br/>    ************************************************************************/ <br/><br/>   if(bErrorFound)<br/>   {<br/>      idReturn = ER_ERROR;<br/>      <br/>	  lpDS-&gtcErrorCode = _J('1');<br/>	  jdeStrcpy(lpDS-&gtszErrorMessageID, (const JCHAR *)(_J("G55E001")));<br/>	  <br/>	  if(lpDS-&gtcSuppressErrorMessage != _J('1'))<br/>	  {<br/>		  jdeSetGBRErrorSubText(lpBhvrCom, lpVoid, (ID) 0, lpDS-&gtszErrorMessageID, &dsDSDE55X01);<br/>		<br/>	  }<br/><br/>      jdeTraceSz(NULL, _J("B55XML02 - Failed to write XML to file"));<br/>   }<br/><br/>	if (hUser)<br/>	{<br/>		JDB_FreeBhvr(hUser);<br/>	}<br/>          <br/>   return (idReturn); <br/><br/>}<br/><br/> <br/><br/>/**************************************************************************<br/> *   Function:  I55XML01_GenerateXMLFileNameWithoutHyphens<br/> *                           <br/> *      Notes:<br/> *<br/> *    Returns:<br/> *<br/> * Parameters:<br/> **************************************************************************/<br/><br/>void I55XML01_GenerateXMLFileNameWithoutHyphens(LPBHVRCOM lpBhvrCom,LPVOID lpVoid, HUSER hUser,LPDSI55XML01FILE lpF55XML)<br/>{<br/><br/>	<br/>	jdeStripTrailingBlanks(lpF55XML-&gtszXMLFileContainerPath);<br/>			<br/>	if(IsStringBlank(lpF55XML-&gtszXMLFileContainerPath))<br/>	{<br/>		GetPrintQueueDirectoryPathName( lpF55XML-&gtszXMLFullFileName);<br/>		<br/>	}<br/>	else<br/>	{<br/><br/>		jdeStrcpy(lpF55XML-&gtszXMLFullFileName, lpF55XML-&gtszXMLFileContainerPath);<br/><br/><br/>	}<br/><br/>	I55XML01_AppendDirectorySeparator(lpF55XML-&gtszXMLFullFileName);<br/><br/>	jdeStripTrailingBlanks(lpF55XML-&gtszXMLInternalReference);<br/>	jdeStripTrailingBlanks(lpF55XML-&gtszEdiTransactNumber);<br/>	jdeStripTrailingBlanks(lpF55XML-&gtszEdiBatchNumber);<br/>	<br/>	if(lpF55XML-&gtcTemporalFile_YN == _J('Y'))<br/>	{<br/><br/>		jdeSprintf((JCHAR *) lpF55XML-&gtszXMLFileName,_J("%ls%ls%lstmp.xml"),lpF55XML-&gtszEdiBatchNumber,lpF55XML-&gtszEdiTransactNumber,lpF55XML-&gtszXMLInternalReference);<br/><br/>	}<br/>	else<br/>	{<br/><br/>		jdeSprintf((JCHAR *) lpF55XML-&gtszXMLFileName,_J("%ls%ls%ls.xml"),lpF55XML-&gtszEdiBatchNumber,lpF55XML-&gtszEdiTransactNumber,lpF55XML-&gtszXMLInternalReference);<br/><br/>	}<br/>	<br/><br/><br/>	jdeStrncat (lpF55XML-&gtszXMLFullFileName, lpF55XML-&gtszXMLFileName, DIM(lpF55XML-&gtszXMLFullFileName));<br/><br/>}<br/> /* End SAR 8666675 */<br/><br/>/**************************************************************************<br/>*   Function:  I55XML02_RightTrimSpaces<br/>*<br/>*      Notes:  This internal function will remove spaces on the right of the<br/>*              null-terminated string.<br/>*<br/>*    Returns:  NONE<br/>*<br/>* Parameters:<br/>**************************************************************************/<br/>/*<br/>static void I55XML02_RightTrimSpaces(JCHAR *szString)<br/>{<br/>	int         iLength  = 0;<br/><br/>	iLength = jdeStrlen( szString );<br/>	while ( iLength &gt 0 && *(szString+iLength-1) == _J(' ') )<br/>	{<br/>		*(szString+(--iLength)) = _J('\0');<br/>	}<br/>	return;<br/>}<br/>*/<br/></pre></div></div><div class='section'>EVENTS<div class='objectheader'>C Function: XML common functions for Localization - [XMLCreateDocWithAttrib_55]</div><div class='er'><div class='dstrmembers'><B>Data Structure: D55XML01O - XML Create Document -With Attributes                        </B><BR>BF szDocumentName [PARMSTRG]<BR>BF idDoc [GENLNG]<BR>BF idDocElement [GENLNG]<BR>BF cErrorCode [EV01]<BR>BF idAPIs [GENLNG]<BR>BF szAttribute1Name [PARMSTRG]<BR>BF szAttribute1Value [PARMSTRG]<BR>BF szAttribute2Name [PARMSTRG]<BR>BF szAttribute2Value [PARMSTRG]<BR>BF szAttribute3Name [PARMSTRG]<BR>BF szAttribute3Value [PARMSTRG]<BR>BF szAttribute4Name [PARMSTRG]<BR>BF szAttribute4Value [PARMSTRG]<BR>BF szAttribute5Name [PARMSTRG]<BR>BF szAttribute5Value [PARMSTRG]<BR>BF szAttribute6Name [PARMSTRG]<BR>BF szAttribute6Value [PARMSTRG]<BR>BF szErrorMessageID [DTAI]<BR>BF cSuppressErrorMessage [SUPPS]<BR></div></div></div><div class='section'>EVENTS<div class='objectheader'>C Function: XML common functions for Localization - [XMLCreateDocumentFromString_55]</div><div class='er'><div class='dstrmembers'><B>Data Structure: D55XML01M - XML Create Document From String - G70                       </B><BR>BF idXMLString [GENLNG]<BR>BF idAPIs [GENLNG]<BR>BF idDoc [GENLNG]<BR>BF idDocElement [GENLNG]<BR>BF cSuppressErrorMessage [SUPPS]<BR>BF szErrorMessageID [DTAI]<BR>BF cErrorCode [EV01]<BR>BF szXMLErrorCode [55XECD]<BR></div></div></div><div class='section'>EVENTS<div class='objectheader'>C Function: XML common functions for Localization - [XMLCreateDocumentFromZFile_55]</div><div class='er'><div class='dstrmembers'><B>Data Structure: D55XML01I - XML Create Document From Z-File - G70                       </B><BR>BF szEdiUserId [EDUS]<BR>BF szEdiBatchNumber [EDBT]<BR>BF szEdiTransactNumber [EDTN]<BR>BF mnEdiLineNumber [EDLN]<BR>BF idAPIs [GENLNG]<BR>BF idDoc [GENLNG]<BR>BF idDocElement [GENLNG]<BR>BF cSuppressErrorMessage [SUPPS]<BR>BF szErrorMessageID [DTAI]<BR>BF cErrorCode [EV01]<BR>BF cTakeXMLfromFileYN [EV01]<BR>BF szXMLErrorCode [55XECD]<BR></div></div></div><div class='section'>EVENTS<div class='objectheader'>C Function: XML common functions for Localization - [XMLCreateDocument_55]</div><div class='er'><div class='dstrmembers'><B>Data Structure: D55XML01A - XML Create Document                                         </B><BR>BF szDocumentName [PARMSTRG]<BR>BF idDoc [GENLNG]<BR>BF idDocElement [GENLNG]<BR>BF cErrorCode [EV01]<BR>BF idAPIs [GENLNG]<BR>BF cSuppressErrorMessage [SUPPS]<BR>BF szErrorMessageID [DTAI]<BR></div></div></div><div class='section'>EVENTS<div class='objectheader'>C Function: XML common functions for Localization - [XMLDoesFileExist_55]</div><div class='er'><div class='dstrmembers'><B>Data Structure: D55XML01D - XML Does the XML File exist                                 </B><BR>BF szXMLFileNameWithPath [55PATH]<BR>BF szXMLTemporalPath [55PATH]<BR>BF cGenerateTemporalXMLFileYN [EV01]<BR>BF szEdiUserId [EDUS]<BR>BF szEdiBatchNumber [EDBT]<BR>BF szEdiTransactNumber [EDTN]<BR>BF mnEdiLineNumber [EDLN]<BR>BF cDoesFinalXMLFileExist [EV01]<BR>BF cDoesTemporalXMLFileExist [EV01]<BR>BF szTemporalXMLFileWithPath [55PATH]<BR>BF cSuppressErrorMessage [SUPPS]<BR>BF szErrorDataItemCode [DTAI]<BR>BF cErrorCode [EV01]<BR>BF idAPIs [GENLNG]<BR>BF szXMLInternalReference [55INRE]<BR></div></div></div><div class='section'>EVENTS<div class='objectheader'>C Function: XML common functions for Localization - [XMLFreeArrayOfElements_55]</div><div class='er'><div class='dstrmembers'><B>Data Structure: D55XML01L - XML Free Array of Elements - G70                            </B><BR>BF idAPIs [GENLNG]<BR>BF idDoc [GENLNG]<BR>BF idArrayElements [GENLNG]<BR>BF mnNumberOfElements [MATH01]<BR>BF cSuppressErrorMessage [SUPPS]<BR>BF szErrorMessageID [DTAI]<BR>BF cErrorCode [EV01]<BR></div></div></div><div class='section'>EVENTS<div class='objectheader'>C Function: XML common functions for Localization - [XMLFreeDocument_55]</div><div class='er'><div class='dstrmembers'><B>Data Structure: D55XML01G - XML Free Document                                           </B><BR>BF szDocumentName [PARMSTRG]<BR>BF idDoc [GENLNG]<BR>BF idDocElement [GENLNG]<BR>BF cErrorCode [EV01]<BR>BF idAPIs [GENLNG]<BR>BF cSuppressErrorMessage [SUPPS]<BR>BF szErrorMessageID [DTAI]<BR></div></div></div><div class='section'>EVENTS<div class='objectheader'>C Function: XML common functions for Localization - [XMLFreeElement_55]</div><div class='er'><div class='dstrmembers'><B>Data Structure: D55XML01C - XML Free Element                                            </B><BR>BF idElementToFree [GENLNG]<BR>BF cErrorCode [EV01]<BR>BF idAPIs [GENLNG]<BR>BF cSuppressErrorMessage [SUPPS]<BR>BF szErrorMessageID [DTAI]<BR></div></div></div><div class='section'>EVENTS<div class='objectheader'>C Function: XML common functions for Localization - [XMLGetElementsByTagName_55]</div><div class='er'><div class='dstrmembers'><B>Data Structure: D55XML01K - XML Get Element By Tag Name - G70                           </B><BR>BF idAPIs [GENLNG]<BR>BF idDoc [GENLNG]<BR>BF idFromElement [GENLNG]<BR>BF szElementName [PARMSTRG]<BR>BF cReturnValueYN [EV01]<BR>BF clsIDFromElementAnArrayYN [EV01]<BR>BF mnFromElementNumber [MATH01]<BR>BF idArrayElements [GENLNG]<BR>BF mnNumberOfElements [MATH01]<BR>BF szElementValue [PARMSTRG]<BR>BF cSuppressErrorMessage [SUPPS]<BR>BF szErrorMessageID [DTAI]<BR>BF cErrorCode [EV01]<BR></div></div></div><div class='section'>EVENTS<div class='objectheader'>C Function: XML common functions for Localization - [XMLGetXMLValueByTagName_55]</div><div class='er'><div class='dstrmembers'><B>Data Structure: D55XML01H - XML Get Element Value by Name                               </B><BR>BF idAPIs [GENLNG]<BR>BF szElementName [PARMSTRG]<BR>BF szElementValueToCompare [PARMSTRG]<BR>BF szElementValueFound [PARMSTRG]<BR>BF cMatchValue_YN [EV01]<BR>BF cSuppressErrorMessage [SUPPS]<BR>BF szErrorDataItemCode [DTAI]<BR>BF cErrorCode [EV01]<BR>BF idDoc [GENLNG]<BR>BF idDocElement [GENLNG]<BR></div></div></div><div class='section'>EVENTS<div class='objectheader'>C Function: XML common functions for Localization - [XMLLoadAPIs_55]</div><div class='er'><div class='dstrmembers'><B>Data Structure: D55XML01E - XML Load APIs                                               </B><BR>BF cErrorCode [EV01]<BR>BF idAPIs [GENLNG]<BR>BF cSuppressErrorMessage [SUPPS]<BR>BF szErrorMessageID [DTAI]<BR></div></div></div><div class='section'>EVENTS<div class='objectheader'>C Function: XML common functions for Localization - [XMLSerializeDocToXMLString_55]</div><div class='er'><div class='dstrmembers'><B>Data Structure: D55XML01N - XML Serialize Document To XMLString - G70                   </B><BR>BF idXMLString [GENLNG]<BR>BF idDoc [GENLNG]<BR>BF cSuppressErrorMessage [SUPPS]<BR>BF szErrorMessageID [DTAI]<BR>BF cErrorCode [EV01]<BR>BF szXMLErrorCode [55XECD]<BR>BF idApis [GENLNG]<BR>BF cActionCode [EV01]<BR></div></div></div><div class='section'>EVENTS<div class='objectheader'>C Function: XML common functions for Localization - [XMLUnloadAPIs_55]</div><div class='er'><div class='dstrmembers'><B>Data Structure: D55XML01E - XML Load APIs                                               </B><BR>BF cErrorCode [EV01]<BR>BF idAPIs [GENLNG]<BR>BF cSuppressErrorMessage [SUPPS]<BR>BF szErrorMessageID [DTAI]<BR></div></div></div><div class='section'>EVENTS<div class='objectheader'>C Function: XML common functions for Localization - [XMLUpdateZFile_55]</div><div class='er'><div class='dstrmembers'><B>Data Structure: D55XML01J - XML Update Z File                                           </B><BR>BF idDoc [GENLNG]<BR>BF cErrorCode [EV01]<BR>BF idAPIs [GENLNG]<BR>BF cSuppressErrorMessage [SUPPS]<BR>BF szErrorMessageID [DTAI]<BR>BF cWriteToFileYN [EV01]<BR>BF szXMLFileContainerPath [55PATH]<BR>BF szEdiUserId [EDUS]<BR>BF szEdiBatchNumber [EDBT]<BR>BF szEdiTransactNumber [EDTN]<BR>BF mnEdiLineNumber [EDLN]<BR>BF szEdiDocumentType [EDCT]<BR>BF szTypeTransaction [TYTN]<BR>BF szEdiTranslationFormat [EDFT]<BR>BF jdEdiTransmissionDate [EDDT]<BR>BF cDirectionIndicator [DRIN]<BR>BF mnEdiDetailLinesProcess [EDDL]<BR>BF cEdiSuccessfullyProcess [EDSP]<BR>BF szTradingPartnerId [PNID]<BR>BF szTransactionAction [TNAC]<BR>BF jdXMLDateProcessed [55XDPR]<BR>BF szXMLTransactionGroup [55XTG]<BR>BF szXMLInternalReference [55INRE]<BR>BF szXMLAdditionalCode [55XCD]<BR>BF cXMLDocumentStatus [55XDOS]<BR>BF szXMLVersion [55XMLV]<BR>BF szXMLAttributeStrGeneric1 [55XSG1]<BR>BF szXMLAttributeStrGeneric2 [55XSG2]<BR>BF szXMLAttributeStrGeneric3 [55XSG3]<BR>BF mnXMLAttributeNumGeneric1 [55XNG1]<BR>BF mnXMLAttributeNumGeneric2 [55XNG2]<BR>BF mnXMLAttributeNumGeneric3 [55XNG3]<BR>BF jdXMLAttributeDatGeneric1 [55XDG1]<BR>BF jdXMLAttributeDatGeneric2 [55XDG2]<BR>BF jdXMLAttributeDatGeneric3 [55XDG3]<BR>BF idXMLAttributeIntGeneric1 [55XIG1]<BR>BF cXMLAttributeChrGeneric1 [55XCG1]<BR>BF cXMLAttributeChrGeneric2 [55XCG2]<BR>BF cXMLAttributeChrGeneric3 [55XCG3]<BR>BF mnXMLAddressNumber [AN8]<BR>BF szXMLCostCenter [MCU]<BR>BF szXMLCompany [CO]<BR>BF szXMLDocumentType [DCT]<BR>BF szUserReservedCode [URCD]<BR>BF jdUserReservedDate [URDT]<BR>BF mnUserReservedAmount [URAT]<BR>BF mnUserReservedNumber [URAB]<BR>BF szUserReservedReference [URRF]<BR>BF szTransactionOriginator [TORG]<BR>BF szUserId [USER]<BR>BF szProgramId [PID]<BR>BF szWorkStationId [JOBN]<BR>BF jdDateUpdated [UPMJ]<BR>BF mnTimeLastUpdated [UPMT]<BR>BF szXMLErrorCode [55XECD]<BR>BF cUpdateBlobYN [EV01]<BR>BF szXMLNewErrorCode [55XECD]<BR></div></div></div><div class='section'>EVENTS<div class='objectheader'>C Function: XML common functions for Localization - [XMLWriteToZFile_55]</div><div class='er'><div class='dstrmembers'><B>Data Structure: D55XML01F - XML Write To Z File                                         </B><BR>BF idDoc [GENLNG]<BR>BF szFileName [PARMSTRG]<BR>BF cErrorCode [EV01]<BR>BF idAPIs [GENLNG]<BR>BF cSuppressErrorMessage [SUPPS]<BR>BF szErrorMessageID [DTAI]<BR>BF cWriteToFileYN [EV01]<BR>BF szXMLFileContainerPath [55PATH]<BR>BF szEdiUserId [EDUS]<BR>BF szEdiBatchNumber [EDBT]<BR>BF szEdiTransactNumber [EDTN]<BR>BF mnEdiLineNumber [EDLN]<BR>BF szEdiDocumentType [EDCT]<BR>BF szTypeTransaction [TYTN]<BR>BF szEdiTranslationFormat [EDFT]<BR>BF jdEdiTransmissionDate [EDDT]<BR>BF cDirectionIndicator [DRIN]<BR>BF mnEdiDetailLinesProcess [EDDL]<BR>BF cEdiSuccessfullyProcess [EDSP]<BR>BF szTradingPartnerId [PNID]<BR>BF szTransactionAction [TNAC]<BR>BF jdXMLDateProcessed [55XDPR]<BR>BF szXMLTransactionGroup [55XTG]<BR>BF szXMLInternalReference [55INRE]<BR>BF szXMLAdditionalCode [55XCD]<BR>BF cXMLDocumentStatus [55XDOS]<BR>BF szXMLVersion [55XMLV]<BR>BF szXMLAttributeStrGeneric1 [55XSG1]<BR>BF szXMLAttributeStrGeneric2 [55XSG2]<BR>BF szXMLAttributeStrGeneric3 [55XSG3]<BR>BF mnXMLAttributeNumGeneric1 [55XNG1]<BR>BF mnXMLAttributeNumGeneric2 [55XNG2]<BR>BF mnXMLAttributeNumGeneric3 [55XNG3]<BR>BF jdXMLAttributeDatGeneric1 [55XDG1]<BR>BF jdXMLAttributeDatGeneric2 [55XDG2]<BR>BF jdXMLAttributeDatGeneric3 [55XDG3]<BR>BF idXMLAttributeIntGeneric1 [55XIG1]<BR>BF cXMLAttributeChrGeneric1 [55XCG1]<BR>BF cXMLAttributeChrGeneric2 [55XCG2]<BR>BF cXMLAttributeChrGeneric3 [55XCG3]<BR>BF mnXMLAddressNumber [AN8]<BR>BF szXMLCostCenter [MCU]<BR>BF szXMLCompany [CO]<BR>BF szXMLDocumentType [DCT]<BR>BF szUserReservedCode [URCD]<BR>BF jdUserReservedDate [URDT]<BR>BF mnUserReservedAmount [URAT]<BR>BF mnUserReservedNumber [URAB]<BR>BF szUserReservedReference [URRF]<BR>BF szTransactionOriginator [TORG]<BR>BF szUserId [USER]<BR>BF szProgramId [PID]<BR>BF szWorkStationId [JOBN]<BR>BF jdDateUpdated [UPMJ]<BR>BF mnTimeLastUpdated [UPMT]<BR></div></div></div><div class='section'>EVENTS<div class='objectheader'>C Function: XML common functions for Localization - [XMLWriteToZFile_UTF8_55]</div><div class='er'><div class='dstrmembers'><B>Data Structure: D55XML01P - XML Write To Z File -UTF8-No Hyphen                         </B><BR>BF idDoc [GENLNG]<BR>BF szFileName [PARMSTRG]<BR>BF cErrorCode [EV01]<BR>BF idAPIs [GENLNG]<BR>BF cSuppressErrorMessage [SUPPS]<BR>BF szErrorMessageID [DTAI]<BR>BF cWriteToFileYN [EV01]<BR>BF szXMLFileContainerPath [55PATH]<BR>BF szEdiUserId [EDUS]<BR>BF szEdiBatchNumber [EDBT]<BR>BF szEdiTransactNumber [EDTN]<BR>BF mnEdiLineNumber [EDLN]<BR>BF szEdiDocumentType [EDCT]<BR>BF szTypeTransaction [TYTN]<BR>BF szEdiTranslationFormat [EDFT]<BR>BF jdEdiTransmissionDate [EDDT]<BR>BF cDirectionIndicator [DRIN]<BR>BF mnEdiDetailLinesProcess [EDDL]<BR>BF cEdiSuccessfullyProcess [EDSP]<BR>BF szTradingPartnerId [PNID]<BR>BF szTransactionAction [TNAC]<BR>BF jdXMLDateProcessed [55XDPR]<BR>BF szXMLTransactionGroup [55XTG]<BR>BF szXMLInternalReference [55INRE]<BR>BF szXMLAdditionalCode [55XCD]<BR>BF cXMLDocumentStatus [55XDOS]<BR>BF szXMLVersion [55XMLV]<BR>BF szXMLAttributeStrGeneric1 [55XSG1]<BR>BF szXMLAttributeStrGeneric2 [55XSG2]<BR>BF szXMLAttributeStrGeneric3 [55XSG3]<BR>BF mnXMLAttributeNumGeneric1 [55XNG1]<BR>BF mnXMLAttributeNumGeneric2 [55XNG2]<BR>BF mnXMLAttributeNumGeneric3 [55XNG3]<BR>BF jdXMLAttributeDatGeneric1 [55XDG1]<BR>BF jdXMLAttributeDatGeneric2 [55XDG2]<BR>BF jdXMLAttributeDatGeneric3 [55XDG3]<BR>BF idXMLAttributeIntGeneric1 [55XIG1]<BR>BF cXMLAttributeChrGeneric1 [55XCG1]<BR>BF cXMLAttributeChrGeneric2 [55XCG2]<BR>BF cXMLAttributeChrGeneric3 [55XCG3]<BR>BF mnXMLAddressNumber [AN8]<BR>BF szXMLCostCenter [MCU]<BR>BF szXMLCompany [CO]<BR>BF szXMLDocumentType [DCT]<BR>BF szUserReservedCode [URCD]<BR>BF jdUserReservedDate [URDT]<BR>BF mnUserReservedAmount [URAT]<BR>BF mnUserReservedNumber [URAB]<BR>BF szUserReservedReference [URRF]<BR>BF szTransactionOriginator [TORG]<BR>BF szUserId [USER]<BR>BF szProgramId [PID]<BR>BF szWorkStationId [JOBN]<BR>BF jdDateUpdated [UPMJ]<BR>BF mnTimeLastUpdated [UPMT]<BR></div></div></div></body></html>