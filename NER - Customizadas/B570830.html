<!DOCTYPE html><html lang = "en"><head><meta charset = "utf-8"><meta name = "viewport" content = "width=device-width, initial-scale=1"><title>JDE Object Browser HTML Extract</title>
<style type='text/css'>body,th{font-family: Courier New, Courier, mono;font-size: 12px; width:auto}
.section{font-family: Arial, Helvetica, sans-serif;font-size: 12px;font-weight: bold;border: thin groove #CC9966;width: 100%;padding-left: 5px;padding-top: 5px;padding-bottom: 5px; padding-right: 5px; box-sizing: border-box }
.objectheader {font-family: Arial, Helvetica, sans-serif;font-size: 12px;font-weight: bold;border: thin groove #CC9966;width:auto;background-color: #FFFFCC;padding-left: 5px;padding-top: 5px;padding-bottom: 5px;padding-right: 5px; box-sizing: border-box }
.details{font-family: Arial, Helvetica, sans-serif;font-size: 11px;font-weight: normal;border: thin groove #CC9966;width:100%;padding-left: 5px;padding-top: 5px;padding-bottom: 5px;padding-right: 5px;box-sizing: border-box }
.er {background-color: #FFFFFF;font-family: Courier New, Courier, mono;font-size: 12px; font-weight: normal; border: thin solid #CCCCCC; width:auto; padding-left: 5px;padding-top: 5px;padding-bottom: 5px; padding-right: 5px; box-sizing: border-box }
.dstrmembers {background-color: #FFFDDD;font-family: Courier New, Courier, mono;font-size: 12px;border: thin groove #CC9966;padding-left: 5px;padding-top: 5px;padding-bottom: 5px;padding-right: 5px; box-sizing: border-box }
.disabled {font-family: Courier New, Courier, mono;font-size: 12px;	font-style: italic; color:#CC9933}
.parameters {font-family: Courier New, Courier, mono;font-size: 12px; color:#3333FF}
.comment {font-family: Courier New, Courier, mono;font-size: 12px;	color: #339933}
.subtable {font-family: Arial, Helvetica, sans-serif;font-size: 11px;font-weight: normal;width:100%}
.lineno {color:#6E6E6E;font-family: Courier New, Courier, mono;font-size: 12px; font-weight: normal;}
.iokey {color:#FF6905;font-family: Courier New, Courier, mono;font-size: 12px; font-weight: normal;}
.logicline {color:#000000;font-family: Courier New, Courier, mono;font-size: 12px; font-weight: normal;}
.versionoverride {background-color: #FFCC99;}
.overrideflags{font-family: Arial, Helvetica, sans-serif;font-size: 11px;font-weight: normal;border: thin groove #CC9966;width:auto;padding-left: 5px;padding-top: 5px;padding-bottom: 5px;padding-right: 5px; background-color: #FFCC99; box-sizing: border-box }
.bsfnprops {font-family: Courier New, Courier, mono;font-size: 12px; color:#E01B4C}
.searchresult {font-family: Courier New, Courier, mono;font-size: 12px; font-weight: bold; background-color:#8BF3A0}
.expand {font-family: Courier New, Courier, mono;font-size: 11px; font-weight: bold; cursor:pointer; border: 1px solid gray; position: relative; left: -3px; display:inline; line-height:8px;}
.expand2 { display:inline; cursor:pointer; font-size: 9px; border: 1px solid gray; position: relative; left: -3px;}
</style>
<script type='text/javascript'>function load(){location.href = '#result';}</script>
<script language='JavaScript' type='text/javascript'>function ExpandCollapse(ElementId){ var ClickedElement = document.getElementById(ElementId); var SectionName = ElementId + ':hide'; var Section = document.getElementById(SectionName); if (ClickedElement.innerHTML == '-') { 	 ClickedElement.innerHTML = '+';	Section.style.display = 'none'; }  else  { 		ClickedElement.innerHTML = '-'; 	Section.style.display = 'inline';}} </script>
<base target = "_parent"></head><body onload='load()'>
<div class ='objectheader'>Business Function: B570830 - Executa Regra<BR>Function Type: C</div><div class='section'>EVENTS<div class='objectheader'>C Function: Executa Regra - [AbreCursor]</div><div class='er'><div class='dstrmembers'><B>Data Structure: D570830D - Estrutura de dados da BSFN B570830                          </B><BR>BF cErro [EV01]<BR>BF szMsgRetorno [CF500]<BR>BF mnNumRegra [CNTF]<BR>BF idRegras [GENLNG]<BR>BF idCursor [GENLNG]<BR>BF mnNumRegraBase [CNTF]<BR>BF cUsarRegraBase [EV01]<BR>BF idRegraBase [GENLNG]<BR>BF szRegra [ALPH]<BR>BF szNomeRegraBase [ALPH]<BR>BF szNomeRegra [ALPH]<BR>BF szOvrDataSource [CVVTABNM]<BR>BF cLock [EV01]<BR></div><pre><div class='dstrmembers'><B>Header File: b570830.h</B><BR></div> <br/>/***************************************************************************** <br/> *    Header File:  B570830.h <br/> * <br/> *    Description:  Executa Regra Header File <br/> * <br/> *        History: <br/> *          Date        Programmer  SAR# - Description <br/> *          ----------  ----------  ------------------------------------------- <br/> *   Author 13/10/15    MATEU       Unknown  - Created  <br/> * <br/> * <br/> * Copyright (c) J.D. Edwards World Source Company, 1996 <br/> * <br/> * This unpublished material is proprietary to J.D. Edwards World Source  <br/> * Company.  All rights reserved.  The methods and techniques described  <br/> * herein are considered trade secrets and/or confidential.  Reproduction <br/> * or distribution, in whole or in part, is forbidden except by express <br/> * written permission of J.D. Edwards World Source Company. <br/> ****************************************************************************/ <br/> <br/>#ifndef __B570830_H<br/>#define __B570830_H <br/> <br/>/***************************************************************************** <br/> * Table Header Inclusions <br/> ****************************************************************************/ <br/>#include &ltf570836.h&gt<br/>#include &ltf570836a.h&gt<br/>#include &ltf570830.h&gt<br/>/***************************************************************************** <br/> * External Business Function Header Inclusions <br/> ****************************************************************************/ <br/> <br/>/***************************************************************************** <br/> * Global Definitions <br/> ****************************************************************************/ <br/> <br/>/***************************************************************************** <br/> * Structure Definitions <br/> ****************************************************************************/ <br/> typedef struct {<br/><br/>     JCHAR                szNomeRegra[41]; // Nome da Regra<br/>     JCHAR                szDataSource[11]; // Tabela ou View origem da regra<br/>     short                nTamanhoSelecao;<br/>     short                nTamanhoSelecaoOriginal;<br/>     short                nNpeOriginal;<br/>     short                nNpdOriginal;<br/>     short                nTamanhoOrdenacao;<br/>     short                nTamanhoOrdenacaoOriginal;<br/>     LPNESTEDSELECTSTRUCT lpSelect; //Selecao de dados da regra<br/>     LPSORTSTRUCT         lpSort;    <br/><br/> } dsRegra;<br/><br/> typedef struct {<br/>     int   Tamanho;<br/>     JCHAR **Chaves;<br/>     int   *Posicoes;<br/> } dsHash;<br/><br/> typedef struct {<br/>     <br/>     dsHash *hash;<br/>     dsRegra *Regras;<br/><br/> } dsRegras;<br/><br/><br/> typedef struct tagDDINFO { <br/>	<br/>	LPGLOBALCOL lpGlobalCol; <br/>	LPVOID lpValue; <br/>	PJSTR lpScreenValue; <br/>	WORD wStatus; <br/>	DWORD dwOverrideFlag; <br/>	LPDDEDIT lpEditRules; <br/>	LPDDFORMAT lpFormatRules; <br/>	<br/>} DSDDINFO;<br/><br/>/***************************************************************************** <br/> * DS Template Type Definitions <br/> ****************************************************************************/ <br/><br/>/**<br/> * TYPEDEF for Data Structure<br/> * D570830A : Estrutura de dados da BSFN B570830<br/> *<br/> * Copyright Oracle USA<br/> *<br/> * This is a JDEdwards EnterpriseOne generated file.<br/> * Do not modify this file.<br/> * Only re-generate with the appropriate tool.<br/> * Generation Date : 18/01/16<br/> */<br/><br/>#ifndef DATASTRUCTURE_D570830A<br/>#define DATASTRUCTURE_D570830A<br/><br/>typedef struct tagDSD570830A<br/>{<br/>  JCHAR          szProcesso[351];<br/>  JCHAR          cErro;<br/>  JCHAR          szMsgRetorno[501];<br/>  MATH_NUMERIC   mnAnoMesProcessamento;<br/>  ID             idRegras;<br/>  MATH_NUMERIC   mnNumRegras;<br/>  JCHAR          szCasoEspecial[7];<br/>} DSD570830A , *LPDSD570830A;<br/><br/>#define IDERRszProcesso_1                         1L<br/>#define IDERRcErro_2                              2L<br/>#define IDERRszMsgRetorno_3                       3L<br/>#define IDERRmnAnoMesProcessamento_4              4L<br/>#define IDERRidRegras_5                           5L<br/>#define IDERRmnNumRegras_6                        6L<br/>#define IDERRszCasoEspecial_7                     7L<br/><br/>#endif /* DATASTRUCTURE_D570830A */<br/><br/>/**<br/> * TYPEDEF for Data Structure<br/> * D570830B : Estrutura de dados da BSFN B570830<br/> *<br/> * Copyright Oracle USA<br/> *<br/> * This is a JDEdwards EnterpriseOne generated file.<br/> * Do not modify this file.<br/> * Only re-generate with the appropriate tool.<br/> * Generation Date : 11/11/15<br/> */<br/><br/>#ifndef DATASTRUCTURE_D570830B<br/>#define DATASTRUCTURE_D570830B<br/><br/>typedef struct tagDSD570830B<br/>{<br/>  JCHAR          cErro;<br/>  JCHAR          szMsgRetorno[501];<br/>  ID             idRegras;<br/>} DSD570830B , *LPDSD570830B;<br/><br/>#define IDERRcErro_1                              1L<br/>#define IDERRszMsgRetorno_2                       2L<br/>#define IDERRidRegras_3                           3L<br/><br/>#endif /* DATASTRUCTURE_D570830B */<br/><br/><br/>/**<br/> * TYPEDEF for Data Structure<br/> * D570830C : Estrutura de dados da BSFN B570830<br/> *<br/> * Copyright Oracle USA<br/> *<br/> * This is a JDEdwards EnterpriseOne generated file.<br/> * Do not modify this file.<br/> * Only re-generate with the appropriate tool.<br/> * Generation Date : 11/11/15<br/> */<br/><br/>#ifndef DATASTRUCTURE_D570830C<br/>#define DATASTRUCTURE_D570830C<br/><br/>typedef struct tagDSD570830C<br/>{<br/>  JCHAR          cErro;<br/>  JCHAR          szMsgRetorno[501];<br/>  ID             idRegras;<br/>  MATH_NUMERIC   mnNumRegras;<br/>} DSD570830C , *LPDSD570830C;<br/><br/>#define IDERRcErro_1                              1L<br/>#define IDERRszMsgRetorno_2                       2L<br/>#define IDERRidRegra_3                            3L<br/>#define IDERRmnNumRegras_4                        4L<br/><br/>#endif /* DATASTRUCTURE_D570830C */<br/><br/>/**<br/> * TYPEDEF for Data Structure<br/> * D570830D : Estrutura de dados da BSFN B570830<br/> *<br/> * Copyright Oracle USA<br/> *<br/> * This is a JDEdwards EnterpriseOne generated file.<br/> * Do not modify this file.<br/> * Only re-generate with the appropriate tool.<br/> * Generation Date : 09/05/16<br/> */<br/><br/>#ifndef DATASTRUCTURE_D570830D<br/>#define DATASTRUCTURE_D570830D<br/><br/>typedef struct tagDSD570830D<br/>{<br/>  JCHAR          cErro;<br/>  JCHAR          szMsgRetorno[501];<br/>  MATH_NUMERIC   mnNumRegra;<br/>  ID             idRegras;<br/>  ID             idCursor;<br/>  MATH_NUMERIC   mnNumRegraBase;<br/>  JCHAR          cUsarRegraBase;<br/>  ID             idRegraBase;<br/>  JCHAR          szRegra[41];<br/>  JCHAR          szNomeRegraBase[41];<br/>  JCHAR          szNomeRegra[41];<br/>  JCHAR          szOvrDataSource[12];<br/>  JCHAR          cLock;<br/>} DSD570830D , *LPDSD570830D;<br/><br/>#define IDERRcErro_1                              1L<br/>#define IDERRszMsgRetorno_2                       2L<br/>#define IDERRmnNumRegra_7                         7L<br/>#define IDERRidRegras_8                           8L<br/>#define IDERRidCursor_9                           9L<br/>#define IDERRmnNumRegraBase_10                    10L<br/>#define IDERRcUsarRegraBase_11                    11L<br/>#define IDERRidRegraBase_12                       12L<br/>#define IDERRszRegra_13                           13L<br/>#define IDERRszNomeRegraBase_14                   14L<br/>#define IDERRszNomeRegra_15                       15L<br/>#define IDERRszOvrDataSource_16                   16L<br/>#define IDERRcLock_17                             17L<br/><br/>#endif /* DATASTRUCTURE_D570830D */<br/><br/>/**<br/> * TYPEDEF for Data Structure<br/> * D570830E : Estrutura de dados da BSFN B570830<br/> *<br/> * Copyright Oracle USA<br/> *<br/> * This is a JDEdwards EnterpriseOne generated file.<br/> * Do not modify this file.<br/> * Only re-generate with the appropriate tool.<br/> * Generation Date : 09/05/16<br/> */<br/><br/>#ifndef DATASTRUCTURE_D570830E<br/>#define DATASTRUCTURE_D570830E<br/><br/>typedef struct tagDSD570830E<br/>{<br/>  JCHAR          cErro;<br/>  JCHAR          szMsgRetorno[501];<br/>  ID             idCursor;<br/>  JCHAR          cLock;<br/>} DSD570830E , *LPDSD570830E;<br/><br/>#define IDERRcErro_2                              2L<br/>#define IDERRszMsgRetorno_3                       3L<br/>#define IDERRidCursor_7                           7L<br/>#define IDERRcLock_8                              8L<br/><br/>#endif /* DATASTRUCTURE_D570830E */<br/><br/>/**<br/> * TYPEDEF for Data Structure<br/> * D570830F : Estrutura de dados da BSFN B570830<br/> *<br/> * Copyright Oracle USA<br/> *<br/> * This is a JDEdwards EnterpriseOne generated file.<br/> * Do not modify this file.<br/> * Only re-generate with the appropriate tool.<br/> * Generation Date : 25/11/15<br/> */<br/><br/>#ifndef DATASTRUCTURE_D570830F<br/>#define DATASTRUCTURE_D570830F<br/><br/>typedef struct tagDSD570830F<br/>{<br/>  JCHAR          cErro;<br/>  JCHAR          szMsgRetorno[501];<br/>  ID             idCursor;<br/>  JCHAR          szTabela[12];<br/>  JCHAR          szCampo[12];<br/>  MATH_NUMERIC   mnRetornoMath;<br/>} DSD570830F , *LPDSD570830F;<br/><br/>#define IDERRcErro_2                              2L<br/>#define IDERRszMsgRetorno_3                       3L<br/>#define IDERRidCursor_7                           7L<br/>#define IDERRszTabela_8                           8L<br/>#define IDERRszCampo_9                            9L<br/>#define IDERRmnRetornoMath_10                     10L<br/><br/>#endif /* DATASTRUCTURE_D570830F */<br/><br/>/**<br/> * TYPEDEF for Data Structure<br/> * D570830G : Estrutura de dados da BSFN B570830<br/> *<br/> * Copyright Oracle USA<br/> *<br/> * This is a JDEdwards EnterpriseOne generated file.<br/> * Do not modify this file.<br/> * Only re-generate with the appropriate tool.<br/> * Generation Date : 25/11/15<br/> */<br/><br/>#ifndef DATASTRUCTURE_D570830G<br/>#define DATASTRUCTURE_D570830G<br/><br/>typedef struct tagDSD570830G<br/>{<br/>  JCHAR          cErro;<br/>  JCHAR          szMsgRetorno[501];<br/>  ID             idCursor;<br/>  JCHAR          szTabela[12];<br/>  JCHAR          szCampo[12];<br/>  JCHAR          szRetornoString[351];<br/>} DSD570830G , *LPDSD570830G;<br/><br/>#define IDERRcErro_2                              2L<br/>#define IDERRszMsgRetorno_3                       3L<br/>#define IDERRidCursor_7                           7L<br/>#define IDERRszTabela_8                           8L<br/>#define IDERRszCampo_9                            9L<br/>#define IDERRszRetornoString_11                   11L<br/><br/>#endif /* DATASTRUCTURE_D570830G */<br/><br/>/**<br/> * TYPEDEF for Data Structure<br/> * D570830H : Estrutura de dados da BSFN B570830<br/> *<br/> * Copyright Oracle USA<br/> *<br/> * This is a JDEdwards EnterpriseOne generated file.<br/> * Do not modify this file.<br/> * Only re-generate with the appropriate tool.<br/> * Generation Date : 25/11/15<br/> */<br/><br/>#ifndef DATASTRUCTURE_D570830H<br/>#define DATASTRUCTURE_D570830H<br/><br/>typedef struct tagDSD570830H<br/>{<br/>  JCHAR          cErro;<br/>  JCHAR          szMsgRetorno[501];<br/>  ID             idCursor;<br/>  JCHAR          szTabela[12];<br/>  JCHAR          szCampo[12];<br/>  int            nRetornoInt;<br/>} DSD570830H , *LPDSD570830H;<br/><br/>#define IDERRcErro_2                              2L<br/>#define IDERRszMsgRetorno_3                       3L<br/>#define IDERRidCursor_7                           7L<br/>#define IDERRszTabela_8                           8L<br/>#define IDERRszCampo_9                            9L<br/>#define IDERRnRetornoInt_12                       12L<br/><br/>#endif /* DATASTRUCTURE_D570830H */<br/><br/>/**<br/> * TYPEDEF for Data Structure<br/> * D570830I : Estrutura de dados da BSFN B570830<br/> *<br/> * Copyright Oracle USA<br/> *<br/> * This is a JDEdwards EnterpriseOne generated file.<br/> * Do not modify this file.<br/> * Only re-generate with the appropriate tool.<br/> * Generation Date : 25/11/15<br/> */<br/><br/>#ifndef DATASTRUCTURE_D570830I<br/>#define DATASTRUCTURE_D570830I<br/><br/>typedef struct tagDSD570830I<br/>{<br/>  JCHAR          cErro;<br/>  JCHAR          szMsgRetorno[501];<br/>  ID             idCursor;<br/>  JCHAR          szTabela[12];<br/>  JCHAR          szCampo[12];<br/>  JDEDATE        jdRetornoData;<br/>} DSD570830I , *LPDSD570830I;<br/><br/>#define IDERRcErro_2                              2L<br/>#define IDERRszMsgRetorno_3                       3L<br/>#define IDERRidCursor_7                           7L<br/>#define IDERRszTabela_8                           8L<br/>#define IDERRszCampo_9                            9L<br/>#define IDERRjdRetornoData_13                     13L<br/><br/>#endif /* DATASTRUCTURE_D570830I */<br/><br/>/**<br/> * TYPEDEF for Data Structure<br/> * D570830J : Estrutura de dados da BSFN B570830<br/> *<br/> * Copyright Oracle USA<br/> *<br/> * This is a JDEdwards EnterpriseOne generated file.<br/> * Do not modify this file.<br/> * Only re-generate with the appropriate tool.<br/> * Generation Date : 17/12/15<br/> */<br/><br/>#ifndef DATASTRUCTURE_D570830J<br/>#define DATASTRUCTURE_D570830J<br/><br/>typedef struct tagDSD570830J<br/>{<br/>  JCHAR          cErro;<br/>  JCHAR          szMsgRetorno[501];<br/>  JCHAR          szTabela[12];<br/>  JCHAR          szCampo[12];<br/>  JCHAR          szValorString[351];<br/>  JCHAR          szOperador[3];<br/>  JCHAR          szEouOU[4];<br/>  MATH_NUMERIC   mnNumRegra;<br/>  ID             idRegras;<br/>  JCHAR          cParenteseEsquerdo;<br/>  JCHAR          cParenteseDireito;<br/>  MATH_NUMERIC   mnNumParEsquerda;<br/>  MATH_NUMERIC   mnNumParDireita;<br/>  JCHAR          szAppendEOu[4];<br/>  JCHAR          cReseta;<br/>  JCHAR          szNomeRegra[41];<br/>} DSD570830J , *LPDSD570830J;<br/><br/>#define IDERRcErro_2                              2L<br/>#define IDERRszMsgRetorno_3                       3L<br/>#define IDERRszTabela_8                           8L<br/>#define IDERRszCampo_9                            9L<br/>#define IDERRszValorString_15                     15L<br/>#define IDERRszOperador_18                        18L<br/>#define IDERRszEouOU_19                           19L<br/>#define IDERRmnNumRegra_20                        20L<br/>#define IDERRidRegras_21                          21L<br/>#define IDERRcParenteseEsquerdo_22                22L<br/>#define IDERRcParenteseDireito_23                 23L<br/>#define IDERRmnNumParEsquerda_24                  24L<br/>#define IDERRmnNumParDireita_25                   25L<br/>#define IDERRszAppendEOu_26                       26L<br/>#define IDERRcReseta_27                           27L<br/>#define IDERRszNomeRegra_28                       28L<br/><br/>#endif /* DATASTRUCTURE_D570830J */<br/><br/>/**<br/> * TYPEDEF for Data Structure<br/> * D570830K : Estrutura de dados da BSFN B570830<br/> *<br/> * Copyright Oracle USA<br/> *<br/> * This is a JDEdwards EnterpriseOne generated file.<br/> * Do not modify this file.<br/> * Only re-generate with the appropriate tool.<br/> * Generation Date : 12/04/16<br/> */<br/><br/>#ifndef DATASTRUCTURE_D570830K<br/>#define DATASTRUCTURE_D570830K<br/><br/>typedef struct tagDSD570830K<br/>{<br/>  JCHAR          cErro;<br/>  JCHAR          szMsgRetorno[501];<br/>  JCHAR          szTabela[12];<br/>  JCHAR          szCampo[12];<br/>  JCHAR          szValorString[351];<br/>  JCHAR          szOperador[3];<br/>  JCHAR          szEouOU[4];<br/>  MATH_NUMERIC   mnNumRegra;<br/>  ID             idRegras;<br/>  MATH_NUMERIC   mnNumCampo;<br/>  JCHAR          cParenteseEsquerdo;<br/>  JCHAR          cParenteseDireito;<br/>  MATH_NUMERIC   mnNumParEsquerda;<br/>  MATH_NUMERIC   mnNumParDireita;<br/>  JCHAR          szNomeRegra[41];<br/>} DSD570830K , *LPDSD570830K;<br/><br/>#define IDERRcErro_2                              2L<br/>#define IDERRszMsgRetorno_3                       3L<br/>#define IDERRszTabela_8                           8L<br/>#define IDERRszCampo_9                            9L<br/>#define IDERRszValorString_15                     15L<br/>#define IDERRszOperador_18                        18L<br/>#define IDERRszEouOU_19                           19L<br/>#define IDERRmnNumRegra_20                        20L<br/>#define IDERRidRegras_21                          21L<br/>#define IDERRmnNumCampo_22                        22L<br/>#define IDERRcParenteseEsquerdo_23                23L<br/>#define IDERRcParenteseDireito_24                 24L<br/>#define IDERRmnNumParEsquerda_25                  25L<br/>#define IDERRmnNumParDireita_26                   26L<br/>#define IDERRszNomeRegra_27                       27L<br/><br/>#endif /* DATASTRUCTURE_D570830K */<br/><br/>/**<br/> * TYPEDEF for Data Structure<br/> * D570830L : Estrutura de dados da BSFN B570830<br/> *<br/> * Copyright Oracle USA<br/> *<br/> * This is a JDEdwards EnterpriseOne generated file.<br/> * Do not modify this file.<br/> * Only re-generate with the appropriate tool.<br/> * Generation Date : 30/11/15<br/> */<br/><br/>#ifndef DATASTRUCTURE_D570830L<br/>#define DATASTRUCTURE_D570830L<br/><br/>typedef struct tagDSD570830L<br/>{<br/>  JCHAR          cErro;<br/>  JCHAR          szMsgRetorno[501];<br/>  ID             idRegras;<br/>  MATH_NUMERIC   mnRegraOrigem;<br/>  MATH_NUMERIC   mnRegraDestino;<br/>} DSD570830L , *LPDSD570830L;<br/><br/>#define IDERRcErro_2                              2L<br/>#define IDERRszMsgRetorno_3                       3L<br/>#define IDERRidRegras_21                          21L<br/>#define IDERRmnRegraOrigem_23                     23L<br/>#define IDERRmnRegraDestino_24                    24L<br/><br/>#endif /* DATASTRUCTURE_D570830L */<br/><br/>/**<br/> * TYPEDEF for Data Structure<br/> * D570830M : Estrutura de dados da BSFN B570830<br/> *<br/> * Copyright Oracle USA<br/> *<br/> * This is a JDEdwards EnterpriseOne generated file.<br/> * Do not modify this file.<br/> * Only re-generate with the appropriate tool.<br/> * Generation Date : 15/12/15<br/> */<br/><br/>/**<br/> * TYPEDEF for Data Structure<br/> * D570830M : Estrutura de dados da BSFN B570830<br/> *<br/> * Copyright Oracle USA<br/> *<br/> * This is a JDEdwards EnterpriseOne generated file.<br/> * Do not modify this file.<br/> * Only re-generate with the appropriate tool.<br/> * Generation Date : 16/12/15<br/> */<br/><br/>#ifndef DATASTRUCTURE_D570830M<br/>#define DATASTRUCTURE_D570830M<br/><br/>typedef struct tagDSD570830M<br/>{<br/>  JCHAR          cErro;<br/>  JCHAR          szMsgRetorno[501];<br/>  ID             idCursor;<br/>} DSD570830M , *LPDSD570830M;<br/><br/>#define IDERRcErro_1                              1L<br/>#define IDERRszMsgRetorno_2                       2L<br/>#define IDERRidCursor_9                           9L<br/><br/>#endif /* DATASTRUCTURE_D570830M */<br/><br/>/**<br/> * TYPEDEF for Data Structure<br/> * D570830N : Estrutura de dados da BSFN B570830<br/> *<br/> * Copyright Oracle USA<br/> *<br/> * This is a JDEdwards EnterpriseOne generated file.<br/> * Do not modify this file.<br/> * Only re-generate with the appropriate tool.<br/> * Generation Date : 19/01/16<br/> */<br/><br/>#ifndef DATASTRUCTURE_D570830N<br/>#define DATASTRUCTURE_D570830N<br/><br/>typedef struct tagDSD570830N<br/>{<br/>  JCHAR          cErro;<br/>  JCHAR          szMsgRetorno[501];<br/>  ID             idCursor;<br/>  JCHAR          szTabela[12];<br/>  JCHAR          szCampo[12];<br/>  JCHAR          cRetornoChar;<br/>} DSD570830N , *LPDSD570830N;<br/><br/>#define IDERRcErro_2                              2L<br/>#define IDERRszMsgRetorno_3                       3L<br/>#define IDERRidCursor_7                           7L<br/>#define IDERRszTabela_8                           8L<br/>#define IDERRszCampo_9                            9L<br/>#define IDERRcRetornoChar_13                      13L<br/><br/>#endif /* DATASTRUCTURE_D570830N */<br/><br/>/**<br/> * TYPEDEF for Data Structure<br/> * D570830O : Estrutura de dados da BSFN B570830<br/> *<br/> * Copyright Oracle USA<br/> *<br/> * This is a JDEdwards EnterpriseOne generated file.<br/> * Do not modify this file.<br/> * Only re-generate with the appropriate tool.<br/> * Generation Date : 04/04/16<br/> */<br/><br/>#ifndef DATASTRUCTURE_D570830O<br/>#define DATASTRUCTURE_D570830O<br/><br/>typedef struct tagDSD570830O<br/>{<br/>  JCHAR          cErro;<br/>  JCHAR          szMsgRetorno[501];<br/>  JCHAR          szNomeRegra[41];<br/>  ID             idRegras;<br/>  JCHAR          szDataSource[12];<br/>} DSD570830O , *LPDSD570830O;<br/><br/>#define IDERRcErro_2                              2L<br/>#define IDERRszMsgRetorno_3                       3L<br/>#define IDERRszNomeRegra_14                       14L<br/>#define IDERRidRegras_15                          15L<br/>#define IDERRszDataSource_16                      16L<br/><br/>#endif /* DATASTRUCTURE_D570830O */<br/><br/>/**<br/> * TYPEDEF for Data Structure<br/> * D570830P : Estrutura de dados da BSFN B570830<br/> *<br/> * Copyright Oracle USA<br/> *<br/> * This is a JDEdwards EnterpriseOne generated file.<br/> * Do not modify this file.<br/> * Only re-generate with the appropriate tool.<br/> * Generation Date : 26/04/16<br/> */<br/><br/>#ifndef DATASTRUCTURE_D570830P<br/>#define DATASTRUCTURE_D570830P<br/><br/>typedef struct tagDSD570830P<br/>{<br/>  JCHAR          cErro;<br/>  JCHAR          szMsgRetorno[501];<br/>  ID             idRegras;<br/>  MATH_NUMERIC   mnNumRegra;<br/>  JCHAR          szNomeRegra[41];<br/>} DSD570830P , *LPDSD570830P;<br/><br/>#define IDERRcErro_2                              2L<br/>#define IDERRszMsgRetorno_3                       3L<br/>#define IDERRidRegras_15                          15L<br/>#define IDERRmnNumRegra_17                        17L<br/>#define IDERRszNomeRegra_18                       18L<br/><br/>#endif /* DATASTRUCTURE_D570830P */<br/><br/>/**<br/> * TYPEDEF for Data Structure<br/> * D570830Q : Estrutura de dados da BSFN B570830<br/> *<br/> * Copyright Oracle USA<br/> *<br/> * This is a JDEdwards EnterpriseOne generated file.<br/> * Do not modify this file.<br/> * Only re-generate with the appropriate tool.<br/> * Generation Date : 04/05/16<br/> */<br/><br/>#ifndef DATASTRUCTURE_D570830Q<br/>#define DATASTRUCTURE_D570830Q<br/><br/>typedef struct tagDSD570830Q<br/>{<br/>  JCHAR          cErro;<br/>  JCHAR          szMsgRetorno[501];<br/>  JCHAR          szTabela[12];<br/>  JCHAR          szCampo[12];<br/>  JCHAR          szValorString[351];<br/>  JCHAR          szOperador[3];<br/>  JCHAR          szEouOU[4];<br/>  MATH_NUMERIC   mnNumRegra;<br/>  ID             idRegras;<br/>  MATH_NUMERIC   mnNumCampo;<br/>  JCHAR          cParenteseEsquerdo;<br/>  JCHAR          cParenteseDireito;<br/>  MATH_NUMERIC   mnNumParEsquerda;<br/>  MATH_NUMERIC   mnNumParDireita;<br/>  JCHAR          szNomeRegra[41];<br/>} DSD570830Q , *LPDSD570830Q;<br/><br/>#define IDERRcErro_2                              2L<br/>#define IDERRszMsgRetorno_3                       3L<br/>#define IDERRszTabela_8                           8L<br/>#define IDERRszCampo_9                            9L<br/>#define IDERRszValorString_15                     15L<br/>#define IDERRszOperador_18                        18L<br/>#define IDERRszEouOU_19                           19L<br/>#define IDERRmnNumRegra_20                        20L<br/>#define IDERRidRegras_21                          21L<br/>#define IDERRmnNumCampo_22                        22L<br/>#define IDERRcParenteseEsquerdo_23                23L<br/>#define IDERRcParenteseDireito_24                 24L<br/>#define IDERRmnNumParEsquerda_25                  25L<br/>#define IDERRmnNumParDireita_26                   26L<br/>#define IDERRszNomeRegra_27                       27L<br/><br/>#endif /* DATASTRUCTURE_D570830Q */<br/><br/>/**<br/> * TYPEDEF for Data Structure<br/> * D570830R : Estrutura de dados da BSFN B570830<br/> *<br/> * Copyright Oracle USA<br/> *<br/> * This is a JDEdwards EnterpriseOne generated file.<br/> * Do not modify this file.<br/> * Only re-generate with the appropriate tool.<br/> * Generation Date : 10/05/16<br/> */<br/><br/>#ifndef DATASTRUCTURE_D570830R<br/>#define DATASTRUCTURE_D570830R<br/><br/>typedef struct tagDSD570830R<br/>{<br/>  JCHAR          cErro;<br/>  JCHAR          szMsgRetorno[501];<br/>  JCHAR          szTabela[12];<br/>  JCHAR          szCampo[12];<br/>  MATH_NUMERIC   mnNumRegra;<br/>  ID             idRegras;<br/>  JCHAR          cReseta;<br/>  JCHAR          szNomeRegra[41];<br/>  JCHAR          cAscendenteDescendente;<br/>} DSD570830R , *LPDSD570830R;<br/><br/>#define IDERRcErro_2                              2L<br/>#define IDERRszMsgRetorno_3                       3L<br/>#define IDERRszTabela_8                           8L<br/>#define IDERRszCampo_9                            9L<br/>#define IDERRmnNumRegra_20                        20L<br/>#define IDERRidRegras_21                          21L<br/>#define IDERRcReseta_27                           27L<br/>#define IDERRszNomeRegra_28                       28L<br/>#define IDERRcAscendenteDescendente_29            29L<br/><br/>#endif /* DATASTRUCTURE_D570830R */<br/><br/>/***************************************************************************** <br/> * Source Preprocessor Definitions <br/> ****************************************************************************/ <br/>#if defined (JDEBFRTN) <br/>	#undef JDEBFRTN <br/>#endif <br/> <br/>#if defined (WIN32) <br/>	#if defined (WIN32) <br/>		#define JDEBFRTN(r) __declspec(dllexport) r <br/>	#else <br/>		#define JDEBFRTN(r) __declspec(dllimport) r <br/>	#endif <br/>#else <br/>	#define JDEBFRTN(r) r <br/>#endif <br/> <br/>/***************************************************************************** <br/> * Business Function Prototypes <br/> ****************************************************************************/ <br/> JDEBFRTN (ID) JDEBFWINAPI ExecutaRegras                    (LPBHVRCOM lpBhvrCom, LPVOID lpVoid, LPDSD570830B lpDS); <br/> JDEBFRTN (ID) JDEBFWINAPI InicializaRegras                 (LPBHVRCOM lpBhvrCom, LPVOID lpVoid, LPDSD570830A lpDS); <br/> JDEBFRTN (ID) JDEBFWINAPI FinalizaRegras                   (LPBHVRCOM lpBhvrCom, LPVOID lpVoid, LPDSD570830C lpDS); <br/> JDEBFRTN (ID) JDEBFWINAPI AbreCursor                       (LPBHVRCOM lpBhvrCom, LPVOID lpVoid, LPDSD570830D lpDS); <br/> JDEBFRTN (ID) JDEBFWINAPI AvancaCursor                     (LPBHVRCOM lpBhvrCom, LPVOID lpVoid, LPDSD570830E lpDS); <br/> JDEBFRTN (ID) JDEBFWINAPI BuscaMathNumeric                 (LPBHVRCOM lpBhvrCom, LPVOID lpVoid, LPDSD570830F lpDS); <br/> JDEBFRTN (ID) JDEBFWINAPI BuscaString                      (LPBHVRCOM lpBhvrCom, LPVOID lpVoid, LPDSD570830G lpDS); <br/> JDEBFRTN (ID) JDEBFWINAPI BuscaInteger                     (LPBHVRCOM lpBhvrCom, LPVOID lpVoid, LPDSD570830H lpDS); <br/> JDEBFRTN (ID) JDEBFWINAPI BuscaData                        (LPBHVRCOM lpBhvrCom, LPVOID lpVoid, LPDSD570830I lpDS); <br/> JDEBFRTN (ID) JDEBFWINAPI AdicionaCampoSelecao             (LPBHVRCOM lpBhvrCom, LPVOID lpVoid, LPDSD570830J lpDS); <br/> JDEBFRTN (ID) JDEBFWINAPI ModificaCampoSelecao             (LPBHVRCOM lpBhvrCom, LPVOID lpVoid, LPDSD570830K lpDS); <br/> JDEBFRTN (ID) JDEBFWINAPI AdicionaSelecaoRegra             (LPBHVRCOM lpBhvrCom, LPVOID lpVoid, LPDSD570830L lpDS); <br/> JDEBFRTN (ID) JDEBFWINAPI FechaCursorRegra                 (LPBHVRCOM lpBhvrCom, LPVOID lpVoid, LPDSD570830M lpDS); <br/> JDEBFRTN (ID) JDEBFWINAPI BuscaChar                        (LPBHVRCOM lpBhvrCom, LPVOID lpVoid, LPDSD570830N lpDS); <br/> JDEBFRTN (ID) JDEBFWINAPI CriaRegra                        (LPBHVRCOM lpBhvrCom, LPVOID lpVoid, LPDSD570830O lpDS); <br/> JDEBFRTN (ID) JDEBFWINAPI ResetaSelecaoCursor              (LPBHVRCOM lpBhvrCom, LPVOID lpVoid, LPDSD570830P lpDS); <br/> JDEBFRTN (ID) JDEBFWINAPI BuscaCampoSelecao                (LPBHVRCOM lpBhvrCom, LPVOID lpVoid, LPDSD570830Q lpDS); <br/> JDEBFRTN (ID) JDEBFWINAPI AdcionaOrdenacaoRegra            (LPBHVRCOM lpBhvrCom, LPVOID lpVoid, LPDSD570830R lpDS); <br/> <br/>/***************************************************************************** <br/> * Internal Function Prototypes <br/> ****************************************************************************/ <br/> ID    I570830_MontaSelectRegra ( KEY1_F570836A dsChave, HREQUEST hF570836A, LPNESTEDSELECTSTRUCT lpSelecao, short *nTamanhoSelecao, JCHAR *CasoEspecial);<br/> void *I570830_CriaValor (JCHAR *szCampo, JCHAR *szValor);<br/> JCHAR *I570830_SeparaValores( JCHAR *Lista, JCHAR Separador );<br/> short I570830_ContaElementos( JCHAR *String, JCHAR Caracter );<br/> void  I570830_StrPadRight( JCHAR *lpszString, const JCHAR *szPad, size_t nLen ); <br/> void  I570830_StrPadLeft ( JCHAR *lpszString, const JCHAR *szPad, size_t nLen ); <br/> ID    I570830_MontaParametros( HREQUEST hData, void **dsParametros, JCHAR *szNomeEstrutura);<br/> ID    I570830_BuscaDataSource( HUSER hUser, JCHAR *szProcesso, JCHAR* szDataSource);<br/> //funções auxiliares para criar um indice paras regras<br/> int   I570830_HashIndex  (dsHash *hash, JCHAR Chave[41] );<br/> void  I570830_HashInsert (dsHash *hash, JCHAR Chave[41], int Posicao );<br/> int   I570830_HashLookup (dsHash *hash, JCHAR Chave[41] );<br/> unsigned int I570830_Hash(char szChave[41]);<br/>#endif    /* __B570830_H */ <br/>  <br/></pre><BR/><pre><div class='dstrmembers'><B>Source File: b570830.c</B><BR></div>#include &ltjde.h&gt <br/> <br/>#define b570830_c <br/> <br/> <br/>/***************************************************************************** <br/> *    Source File:  b570830 <br/> * <br/> *    Description:  Executa Regra Source File <br/> * <br/> *        History: <br/> *          Date        Programmer  SAR# - Description <br/> *          ----------  ----------  ------------------------------------------- <br/> *   Author 13/10/15    MATEU       Unknown  - Created   <br/> * <br/> * Copyright (c) J.D. Edwards World Source Company, 1996 <br/> * <br/> * This unpublished material is proprietary to J.D. Edwards World Source Company. <br/> * All rights reserved.  The methods and techniques described herein are <br/> * considered trade secrets and/or confidential.  Reproduction or <br/> * distribution, in whole or in part, is forbidden except by express <br/> * written permission of J.D. Edwards World Source Company. <br/> ****************************************************************************/ <br/>/************************************************************************** <br/> * Notes: <br/> * <br/> **************************************************************************/ <br/> <br/>#include &ltb570830.h&gt <br/><br/>/************************************************************************** <br/> *  Business Function:  AdicionaSelecaoRegra <br/> * <br/> *        Description:  Abre o Cursor para uma regra especifica<br/> * <br/> *         Parameters: <br/> *           LPBHVRCOM           lpBhvrCom    Business Function Communications <br/> *           LPVOID              lpVoid       Void Parameter - DO NOT USE! <br/> *           LPDSD570            lpDS         Parameter Data Structure Pointer   <br/> * <br/> *************************************************************************/ <br/><br/>JDEBFRTN (ID) JDEBFWINAPI AdicionaSelecaoRegra             (LPBHVRCOM lpBhvrCom, LPVOID lpVoid, LPDSD570830L lpDS) {<br/><br/>   /************************************************************************ <br/>    *  Variable declarations <br/>    ************************************************************************/ <br/>    HUSER				hUser							= (HUSER)NULL;<br/>    ID					idJDBReturn		            	=  JDEDB_PASSED;    <br/>    dsRegras            *lpRegras                       = NULL; <br/>    int                 nRegraOrigem                    = 0;<br/>    int                 nRegraDestino                   = 0;<br/><br/>   /************************************************************************ <br/>    * Check for NULL pointers <br/>    ************************************************************************/ <br/>   if ((lpBhvrCom == (LPBHVRCOM) NULL) || <br/>       (lpVoid    == (LPVOID)    NULL) || <br/>       (lpDS      == (LPDSD570830L)	NULL)) <br/>   { <br/>     jdeErrorSet (lpBhvrCom, lpVoid, (ID) 0, _J("4363"), (LPVOID) NULL); <br/>     return ER_ERROR ;<br/>   } <br/> <br/>   /************************************************************************ <br/>    * Main Processing <br/>    ************************************************************************/ <br/>    idJDBReturn = JDB_InitBhvr( lpBhvrCom , &hUser , NULL , JDEDB_COMMIT_AUTO );<br/><br/>    if (idJDBReturn != JDEDB_PASSED) <br/>    {<br/><br/>        lpDS-&gtcErro = 'S';<br/>        jdeStrcpyAndTerminate(lpDS-&gtszMsgRetorno, _J("Não conseguiu inicializar o ambiente !!!"), DIM(lpDS-&gtszMsgRetorno));<br/>        return ER_ERROR;<br/><br/>    }<br/><br/>    MathNumericToInt( &lpDS-&gtmnRegraOrigem, &nRegraOrigem );<br/>    MathNumericToInt( &lpDS-&gtmnRegraDestino, &nRegraDestino );<br/>    lpRegras = jdeRetrieveDataPtr( hUser, lpDS-&gtidRegras );<br/><br/>    if ( lpRegras == NULL ) {<br/><br/>        lpDS-&gtcErro = 'S';<br/>        jdeStrcpyAndTerminate(lpDS-&gtszMsgRetorno, _J("Não conseguiu carregar a regra !!!"), DIM(lpDS-&gtszMsgRetorno));<br/>        return ER_ERROR;<br/><br/>    }<br/><br/>    JDB_FreeBhvr( hUser );<br/>    return ER_SUCCESS;<br/><br/>}<br/><br/>/************************************************************************** <br/> *  Business Function:  ModificaCampoSelecao <br/> * <br/> *        Description:  Abre o Cursor para uma regra especifica<br/> * <br/> *         Parameters: <br/> *           LPBHVRCOM           lpBhvrCom    Business Function Communications <br/> *           LPVOID              lpVoid       Void Parameter - DO NOT USE! <br/> *           LPDSD570            lpDS         Parameter Data Structure Pointer   <br/> * <br/> *************************************************************************/ <br/><br/>JDEBFRTN (ID) JDEBFWINAPI ModificaCampoSelecao             (LPBHVRCOM lpBhvrCom, LPVOID lpVoid, LPDSD570830K lpDS) {<br/><br/>   /************************************************************************ <br/>    *  Variable declarations <br/>    ************************************************************************/ <br/>    HUSER				 hUser							= (HUSER)NULL;<br/>    ID					 idJDBReturn		            = JDEDB_PASSED;    <br/>    dsRegras             *lpRegras                      = NULL; <br/>    int                  nNumRegra                      = 0;<br/>    int                  nNumCampo                      = 0;<br/>    LPNESTEDSELECTSTRUCT lpSelecao                      = NULL;     <br/>   /************************************************************************ <br/>    * Check for NULL pointers <br/>    ************************************************************************/ <br/><br/>   if ((lpBhvrCom == (LPBHVRCOM) NULL) || <br/>       (lpVoid    == (LPVOID)    NULL) || <br/>       (lpDS      == (LPDSD570830K)	NULL)) <br/>   { <br/>     jdeErrorSet (lpBhvrCom, lpVoid, (ID) 0, _J("4363"), (LPVOID) NULL); <br/>     return ER_ERROR ;<br/>   } <br/> <br/>   /************************************************************************ <br/>    * Main Processing <br/>    ************************************************************************/ <br/>    idJDBReturn = JDB_InitBhvr( lpBhvrCom , &hUser , NULL , JDEDB_COMMIT_AUTO );<br/><br/>    if (idJDBReturn != JDEDB_PASSED) <br/>    {<br/><br/>        lpDS-&gtcErro = 'S';<br/>        jdeStrcpyAndTerminate(lpDS-&gtszMsgRetorno, _J("Não conseguiu inicializar o ambiente !!!"), DIM(lpDS-&gtszMsgRetorno));<br/>        return ER_ERROR;<br/><br/>    }<br/><br/>    lpRegras = jdeRetrieveDataPtr( hUser, lpDS-&gtidRegras );<br/><br/>    if ( !jdeIsBlankOrNull(lpDS-&gtszNomeRegra) ) {<br/>        <br/>        jdeStrcpyFillBlankAndTerminate(lpDS-&gtszNomeRegra, lpDS-&gtszNomeRegra, DIM(lpDS-&gtszNomeRegra));<br/>        nNumRegra = I570830_HashLookup( lpRegras-&gthash, lpDS-&gtszNomeRegra );<br/><br/>        if ( nNumRegra &lt 0 ) <br/>        {<br/><br/>            lpDS-&gtcErro = 'S';<br/>            jdeStrcpyAndTerminate(lpDS-&gtszMsgRetorno, _J("Não conseguiu achar a regra !!!"), DIM(lpDS-&gtszMsgRetorno));<br/>            JDB_FreeBhvr( hUser );<br/>            return ER_ERROR;<br/><br/>        }<br/><br/>    } else {<br/><br/>        MathNumericToInt( &lpDS-&gtmnNumRegra, &nNumRegra );<br/><br/>    }<br/><br/>    if ( lpRegras == NULL ) {<br/><br/>        lpDS-&gtcErro = 'S';<br/>        jdeStrcpyAndTerminate(lpDS-&gtszMsgRetorno, _J("Não conseguiu carregar a regra !!!"), DIM(lpDS-&gtszMsgRetorno));<br/>        JDB_FreeBhvr( hUser );<br/>        return ER_ERROR;<br/><br/>    }<br/><br/>    MathNumericToInt( &lpDS-&gtmnNumCampo, &nNumCampo );<br/><br/>    if ( lpRegras-&gtRegras[nNumRegra].lpSelect == NULL )<br/>    {<br/><br/>        lpDS-&gtcErro = 'S';<br/>        jdeStrcpyAndTerminate(lpDS-&gtszMsgRetorno, _J("Falha Realocando Memoria !!!"), DIM(lpDS-&gtszMsgRetorno));<br/>        JDB_FreeBhvr( hUser );<br/>        return ER_ERROR;<br/><br/>    }<br/><br/>    lpSelecao = lpRegras-&gtRegras[nNumRegra].lpSelect;<br/><br/>    if ( !jdeIsBlankOrNull(lpDS-&gtszValorString) && !jdeIsBlankOrNull(lpDS-&gtszCampo)<br/>          && !jdeIsBlankOrNull(lpDS-&gtszTabela)) {<br/><br/>        jdeNIDcpy( lpSelecao[nNumCampo].Item1.szDict , lpDS-&gtszCampo ); // Campo<br/>        jdeNIDcpy( lpSelecao[nNumCampo].Item1.szTable , lpDS-&gtszTabela ); // Tabela<br/>        jdeNIDcpy( lpSelecao[nNumCampo].Item2.szDict , _J(" ") );<br/>        jdeNIDcpy( lpSelecao[nNumCampo].Item2.szTable , _J(" ") );<br/>        lpSelecao[nNumCampo].Item1.idInstance = 0;<br/>        lpSelecao[nNumCampo].Item2.idInstance = 0;<br/>        lpSelecao[nNumCampo].lpValue = I570830_CriaValor( lpDS-&gtszCampo, lpDS-&gtszValorString ); // Valor<br/>        lpSelecao[nNumCampo].nValues = 1;<br/><br/>    }<br/><br/>    if ( jdestrcmp( lpDS-&gtszEouOU, _J("E") ) == 0 ) {<br/><br/>        lpSelecao[nNumCampo].nAndOr = JDEDB_ANDOR_AND; // Operador Logico E<br/><br/>    } else if (jdestrcmp( lpDS-&gtszEouOU, _J("OU") ) == 0) {<br/><br/>        lpSelecao[nNumCampo].nAndOr = JDEDB_ANDOR_OR; // Operador Logico OU<br/><br/>    }<br/><br/>    if ( jdestrcmp( lpDS-&gtszOperador, _J("=") ) == 0 ) {<br/>        <br/>        lpSelecao[nNumCampo].nCmp = JDEDB_CMP_EQ; // igual<br/><br/>    } else if ( jdestrcmp( lpDS-&gtszOperador, _J("&lt&gt") ) == 0 ) {<br/><br/>        lpSelecao[nNumCampo].nCmp = JDEDB_CMP_NE; // diferente<br/><br/>    } else if ( jdestrcmp( lpDS-&gtszOperador, _J("&gt") ) == 0 ) {<br/><br/>        lpSelecao[nNumCampo].nCmp = JDEDB_CMP_GT; // maior<br/><br/>    } else if ( jdestrcmp( lpDS-&gtszOperador, _J("&lt") ) == 0 ) {<br/><br/>        lpSelecao[nNumCampo].nCmp = JDEDB_CMP_LT; // menor<br/><br/>    } else if ( jdestrcmp( lpDS-&gtszOperador, _J("&gt=") ) == 0 ) {<br/><br/>        lpSelecao[nNumCampo].nCmp = JDEDB_CMP_GE; // maior igual<br/><br/>    } else if ( jdestrcmp( lpDS-&gtszOperador, _J("&lt=") ) == 0 ) {<br/><br/>        lpSelecao[nNumCampo].nCmp = JDEDB_CMP_LE; // menor igual<br/><br/>    } else if ( jdestrcmp( lpDS-&gtszOperador, _J("*") ) == 0 ) {<br/><br/>        lpSelecao[nNumCampo].nCmp = JDEDB_CMP_LK;<br/><br/>    }<br/><br/>    if ( lpDS-&gtcParenteseEsquerdo == _J('(') && lpDS-&gtcParenteseDireito != _J(')') ) {<br/><br/>        lpSelecao[nNumCampo].nParen = JDEDB_PAREN_OPEN; // Abre parentese<br/>        if ( MathZeroTest( &lpDS-&gtmnNumParEsquerda ) != 0) {<br/><br/>                lpSelecao[nNumCampo].parenCount = (unsigned short)atoi(lpDS-&gtmnNumParEsquerda.String);<br/><br/>        }<br/><br/>    }<br/><br/>    if ( lpDS-&gtcParenteseEsquerdo != _J('(') && lpDS-&gtcParenteseDireito == _J(')') ) {<br/><br/>        lpSelecao[nNumCampo].nParen = JDEDB_PAREN_CLOSE; // Fecha parentese<br/>        if ( MathZeroTest( &lpDS-&gtmnNumParDireita ) != 0) {<br/><br/>            lpSelecao[nNumCampo].parenCount = (unsigned short)atoi(lpDS-&gtmnNumParDireita.String);<br/><br/>        }<br/><br/>    }<br/><br/>    if ( lpDS-&gtcParenteseEsquerdo != _J('(') && lpDS-&gtcParenteseDireito != _J(')')) {<br/><br/>        lpSelecao[nNumCampo].nParen = JDEDB_PAREN_NONE;<br/>        lpSelecao[nNumCampo].parenCount = 0;<br/><br/>    }<br/><br/>    JDB_FreeBhvr( hUser );<br/>    return ER_SUCCESS;<br/><br/>}<br/><br/>/************************************************************************** <br/> *  Business Function:  AdicionaCampoSelecao <br/> * <br/> *        Description:  Abre o Cursor para uma regra especifica<br/> * <br/> *         Parameters: <br/> *           LPBHVRCOM           lpBhvrCom    Business Function Communications <br/> *           LPVOID              lpVoid       Void Parameter - DO NOT USE! <br/> *           LPDSD570            lpDS         Parameter Data Structure Pointer   <br/> * <br/> *************************************************************************/ <br/><br/>JDEBFRTN (ID) JDEBFWINAPI AdicionaCampoSelecao             (LPBHVRCOM lpBhvrCom, LPVOID lpVoid, LPDSD570830J lpDS) {<br/><br/>   /************************************************************************ <br/>    *  Variable declarations <br/>    ************************************************************************/ <br/>    HUSER				 hUser							= (HUSER)NULL;<br/>    ID					 idJDBReturn		            = JDEDB_PASSED;    <br/>    dsRegras             *lpRegras                      = NULL; <br/>    LPNESTEDSELECTSTRUCT lpSelecao                      = NULL;     <br/>    int                  nNumRegra                      = 0;<br/>    unsigned short       nNumSelecao                    = 0; <br/>    short                nCont                          = 0;  <br/><br/>   /************************************************************************ <br/>    * Check for NULL pointers <br/>    ************************************************************************/ <br/>   if ((lpBhvrCom == (LPBHVRCOM) NULL) || <br/>       (lpVoid    == (LPVOID)    NULL) || <br/>       (lpDS      == (LPDSD570830J)	NULL)) <br/>   { <br/>     jdeErrorSet (lpBhvrCom, lpVoid, (ID) 0, _J("4363"), (LPVOID) NULL); <br/>     return ER_ERROR; <br/>   } <br/> <br/>   /************************************************************************ <br/>    * Main Processing <br/>    ************************************************************************/ <br/>    idJDBReturn = JDB_InitBhvr( lpBhvrCom , &hUser , NULL , JDEDB_COMMIT_AUTO );<br/><br/>    if (idJDBReturn != JDEDB_PASSED) <br/>    {<br/><br/>        lpDS-&gtcErro = 'S';<br/>        jdeStrcpyAndTerminate(lpDS-&gtszMsgRetorno, _J("Não conseguiu inicializar o ambiente !!!"), DIM(lpDS-&gtszMsgRetorno));<br/>        return ER_ERROR;<br/><br/>    }<br/><br/>    lpRegras = jdeRetrieveDataPtr( hUser, lpDS-&gtidRegras );<br/><br/>    if ( !jdeIsBlankOrNull(lpDS-&gtszNomeRegra) ) {<br/>        <br/>        jdeStrcpyFillBlankAndTerminate(lpDS-&gtszNomeRegra, lpDS-&gtszNomeRegra, DIM(lpDS-&gtszNomeRegra));<br/>        nNumRegra = I570830_HashLookup( lpRegras-&gthash, lpDS-&gtszNomeRegra );<br/><br/>        if ( nNumRegra &lt 0 ) <br/>        {<br/><br/>            lpDS-&gtcErro = 'S';<br/>            jdeStrcpyAndTerminate(lpDS-&gtszMsgRetorno, _J("Não conseguiu achar a regra !!!"), DIM(lpDS-&gtszMsgRetorno));<br/>            JDB_FreeBhvr( hUser );<br/>            return ER_ERROR;<br/><br/>        }<br/><br/>    } else {<br/><br/>        MathNumericToInt( &lpDS-&gtmnNumRegra, &nNumRegra );<br/><br/>    }<br/><br/><br/>    if ( lpRegras == NULL ) {<br/><br/>        lpDS-&gtcErro = 'S';<br/>        jdeStrcpyAndTerminate(lpDS-&gtszMsgRetorno, _J("Não conseguiu carregar a regra !!!"), DIM(lpDS-&gtszMsgRetorno));<br/>        JDB_FreeBhvr( hUser );<br/>        return ER_ERROR;<br/><br/>    }<br/>    <br/>    if ( lpDS-&gtcReseta == _J('S')) <br/>    {<br/><br/>        nNumSelecao = lpRegras-&gtRegras[nNumRegra].nTamanhoSelecaoOriginal;    <br/><br/>        for (nCont = nNumSelecao; nCont &lt lpRegras-&gtRegras[nNumRegra].nTamanhoSelecao; nCont++ )<br/>        {<br/><br/>            jdeFree ( lpRegras-&gtRegras[nNumRegra].lpSelect[nCont].lpValue );<br/><br/>        }                <br/><br/>        if ( nNumSelecao &lt lpRegras-&gtRegras[nNumRegra].nTamanhoSelecao) <br/>        {<br/><br/>            lpRegras-&gtRegras[nNumRegra].nTamanhoSelecao = nNumSelecao;<br/>            lpRegras-&gtRegras[nNumRegra].lpSelect = jdeReAllocEx(lpRegras-&gtRegras[nNumRegra].lpSelect, (nNumSelecao) * sizeof(NESTEDSELECTSTRUCT));<br/><br/>            if ( lpRegras-&gtRegras[nNumRegra].lpSelect == NULL ) <br/>            {<br/><br/>                lpDS-&gtcErro = 'S';<br/>                jdeStrcpyAndTerminate(lpDS-&gtszMsgRetorno, _J("Não conseguiu realocar memoria !!!"), DIM(lpDS-&gtszMsgRetorno));<br/>                JDB_FreeBhvr( hUser );    <br/>                return ER_ERROR;<br/><br/>            }<br/><br/>        }<br/><br/>        if (nNumSelecao &gt 1 )<br/>        {<br/><br/>            lpRegras-&gtRegras[nNumRegra].lpSelect[0].nParen = JDEDB_PAREN_OPEN;<br/>            lpRegras-&gtRegras[nNumRegra].lpSelect[0].parenCount = lpRegras-&gtRegras[nNumRegra].nNpeOriginal+1;<br/>            lpRegras-&gtRegras[nNumRegra].lpSelect[nNumSelecao-1].nParen = JDEDB_PAREN_CLOSE;<br/>            lpRegras-&gtRegras[nNumRegra].lpSelect[nNumSelecao-1].parenCount = lpRegras-&gtRegras[nNumRegra].nNpdOriginal+1;<br/><br/>        } else {<br/><br/>            lpRegras-&gtRegras[nNumRegra].lpSelect[0].nParen = JDEDB_PAREN_NONE;<br/>            lpRegras-&gtRegras[nNumRegra].lpSelect[0].parenCount = 0;<br/><br/>        }<br/><br/>    } else {<br/><br/>        nNumSelecao = lpRegras-&gtRegras[nNumRegra].nTamanhoSelecao;<br/><br/>    }<br/><br/>    lpRegras-&gtRegras[nNumRegra].lpSelect = jdeReAllocEx(lpRegras-&gtRegras[nNumRegra].lpSelect, (nNumSelecao+1) * sizeof(NESTEDSELECTSTRUCT));<br/><br/>    if ( lpRegras-&gtRegras[nNumRegra].lpSelect == NULL )<br/>    {<br/><br/>        lpDS-&gtcErro = 'S';<br/>        jdeStrcpyAndTerminate(lpDS-&gtszMsgRetorno, _J("Falha Realocando Memoria !!!"), DIM(lpDS-&gtszMsgRetorno));<br/>        JDB_FreeBhvr( hUser );<br/>        return ER_ERROR;<br/><br/>    }<br/><br/>    lpSelecao = lpRegras-&gtRegras[nNumRegra].lpSelect;<br/><br/>    jdeNIDcpy( lpSelecao[nNumSelecao].Item1.szDict , lpDS-&gtszCampo ); // Campo<br/>    jdeNIDcpy( lpSelecao[nNumSelecao].Item1.szTable , lpDS-&gtszTabela ); // Tabela<br/>    jdeNIDcpy( lpSelecao[nNumSelecao].Item2.szDict , _J(" ") );<br/>    jdeNIDcpy( lpSelecao[nNumSelecao].Item2.szTable , _J(" ") );<br/>    lpSelecao[nNumSelecao].Item1.idInstance = 0;<br/>    lpSelecao[nNumSelecao].Item2.idInstance = 0;<br/><br/>    lpSelecao[nNumSelecao].lpValue = I570830_CriaValor( lpDS-&gtszCampo, lpDS-&gtszValorString ); // Valor<br/><br/>    lpSelecao[nNumSelecao].nValues = 1;<br/><br/>    lpSelecao[nNumSelecao].nParen = JDEDB_PAREN_NONE;<br/>    lpSelecao[nNumSelecao].parenCount = 0;<br/><br/>    if ( jdestrcmp( lpDS-&gtszEouOU, _J("E") ) == 0 ) {<br/><br/>        lpSelecao[nNumSelecao].nAndOr = JDEDB_ANDOR_AND; // Operador Logico E<br/><br/>    } else if (jdestrcmp( lpDS-&gtszEouOU, _J("OU") ) == 0) {<br/><br/>        lpSelecao[nNumSelecao].nAndOr = JDEDB_ANDOR_OR; // Operador Logico OU<br/><br/>    }<br/><br/>    if ( jdestrcmp( lpDS-&gtszOperador, _J("=") ) == 0 ) {<br/>        <br/>        lpSelecao[nNumSelecao].nCmp = JDEDB_CMP_EQ; // igual<br/><br/>    } else if ( jdestrcmp( lpDS-&gtszOperador, _J("&lt&gt") ) == 0 ) {<br/><br/>        lpSelecao[nNumSelecao].nCmp = JDEDB_CMP_NE; // diferente<br/><br/>    } else if ( jdestrcmp( lpDS-&gtszOperador, _J("&gt") ) == 0 ) {<br/><br/>        lpSelecao[nNumSelecao].nCmp = JDEDB_CMP_GT; // maior<br/><br/>    } else if ( jdestrcmp( lpDS-&gtszOperador, _J("&lt") ) == 0 ) {<br/><br/>        lpSelecao[nNumSelecao].nCmp = JDEDB_CMP_LT; // menor<br/><br/>    } else if ( jdestrcmp( lpDS-&gtszOperador, _J("&gt=") ) == 0 ) {<br/><br/>        lpSelecao[nNumSelecao].nCmp = JDEDB_CMP_GE; // maior igual<br/><br/>    } else if ( jdestrcmp( lpDS-&gtszOperador, _J("&lt=") ) == 0 ) {<br/><br/>        lpSelecao[nNumSelecao].nCmp = JDEDB_CMP_LE; // menor igual<br/><br/>    } else if ( jdestrcmp( lpDS-&gtszOperador, _J("*") ) == 0 ) {<br/><br/>        lpSelecao[nNumSelecao].nCmp = JDEDB_CMP_LK; // like<br/><br/>    }<br/>    <br/>    if ( lpDS-&gtcParenteseEsquerdo == _J('(') && lpDS-&gtcParenteseDireito != _J(')') ) {<br/><br/>        lpSelecao[nNumSelecao].nParen = JDEDB_PAREN_OPEN; // Abre parentese<br/>        if ( MathZeroTest( &lpDS-&gtmnNumParEsquerda ) != 0) {<br/><br/>                lpSelecao[nNumSelecao].parenCount = (unsigned short)atoi(lpDS-&gtmnNumParEsquerda.String);<br/><br/>        }<br/><br/>    }<br/><br/>    if ( lpDS-&gtcParenteseEsquerdo != _J('(') && lpDS-&gtcParenteseDireito == _J(')') ) {<br/><br/>        lpSelecao[nNumSelecao].nParen = JDEDB_PAREN_CLOSE; // Fecha parentese<br/>        if ( MathZeroTest( &lpDS-&gtmnNumParDireita ) != 0) {<br/><br/>            lpSelecao[nNumSelecao].parenCount = (unsigned short)atoi(lpDS-&gtmnNumParDireita.String);<br/><br/>        }<br/><br/>    }<br/><br/>    lpRegras-&gtRegras[nNumRegra].nTamanhoSelecao = nNumSelecao + 1;<br/><br/>    JDB_FreeBhvr( hUser );<br/>    return ER_SUCCESS;<br/>};<br/><br/>/************************************************************************** <br/> *  Business Function:  FechaCursorRegra <br/> * <br/> *        Description:  Abre o Cursor para uma regra especifica<br/> * <br/> *         Parameters: <br/> *           LPBHVRCOM           lpBhvrCom    Business Function Communications <br/> *           LPVOID              lpVoid       Void Parameter - DO NOT USE! <br/> *           LPDSD570            lpDS         Parameter Data Structure Pointer   <br/> * <br/> *************************************************************************/ <br/><br/>JDEBFRTN (ID) JDEBFWINAPI FechaCursorRegra                (LPBHVRCOM lpBhvrCom, LPVOID lpVoid, LPDSD570830M lpDS) {<br/><br/>    HUSER				hUser							= (HUSER)NULL;<br/>    ID					idJDBReturn		            	=  JDEDB_PASSED;<br/>    HREQUEST		    hDataSource    	     			= (HREQUEST)NULL;<br/><br/>   /************************************************************************ <br/>    * Check for NULL pointers <br/>    ************************************************************************/ <br/>   if ((lpBhvrCom == (LPBHVRCOM) NULL) || <br/>       (lpVoid    == (LPVOID)    NULL) || <br/>       (lpDS      == (LPDSD570830M)	NULL)) <br/>   { <br/>     jdeErrorSet (lpBhvrCom, lpVoid, (ID) 0, _J("4363"), (LPVOID) NULL); <br/>     return ER_ERROR; <br/>   } <br/> <br/>   /************************************************************************ <br/>    * Main Processing <br/>    ************************************************************************/ <br/>    idJDBReturn = JDB_InitBhvr( lpBhvrCom , &hUser , NULL , JDEDB_COMMIT_AUTO );<br/><br/>    if (idJDBReturn != JDEDB_PASSED) <br/>    {<br/><br/>        lpDS-&gtcErro = _J('S');<br/>        jdeStrcpyAndTerminate(lpDS-&gtszMsgRetorno, _J("Não conseguiu inicializar o ambiente !!!"), DIM(lpDS-&gtszMsgRetorno));<br/>        return ER_ERROR;<br/><br/>    }<br/><br/>    hDataSource = jdeRetrieveDataPtr( hUser, lpDS-&gtidCursor );<br/><br/>    if ( hDataSource == NULL )<br/>    {<br/><br/>        lpDS-&gtcErro = _J('S');<br/>        jdeStrcpyAndTerminate(lpDS-&gtszMsgRetorno, _J("Cursor invalido !!!"), DIM(lpDS-&gtszMsgRetorno));<br/>        JDB_FreeBhvr( hUser );<br/>        return ER_ERROR;<br/><br/>    }<br/><br/><br/>    idJDBReturn = JDB_CloseTable( hDataSource );<br/><br/>    if (idJDBReturn != JDEDB_PASSED) <br/>    {<br/><br/>        lpDS-&gtcErro = _J('S');<br/>        jdeStrcpyAndTerminate(lpDS-&gtszMsgRetorno, _J("Não conseguiu fechar a tabela !!!"), DIM(lpDS-&gtszMsgRetorno));<br/>        jdeRemoveDataPtr( hUser, lpDS-&gtidCursor );<br/>        JDB_FreeBhvr( hUser );<br/>        return ER_ERROR;<br/><br/>    }<br/><br/>    jdeRemoveDataPtr( hUser, lpDS-&gtidCursor );<br/>    JDB_FreeBhvr( hUser );<br/>    return ER_SUCCESS;<br/><br/>}<br/><br/>/************************************************************************** <br/> *  Business Function:  AbreCursor <br/> * <br/> *        Description:  Abre o Cursor para uma regra especifica<br/> * <br/> *         Parameters: <br/> *           LPBHVRCOM           lpBhvrCom    Business Function Communications <br/> *           LPVOID              lpVoid       Void Parameter - DO NOT USE! <br/> *           LPDSD570            lpDS         Parameter Data Structure Pointer   <br/> * <br/> *************************************************************************/ <br/><br/>JDEBFRTN (ID) JDEBFWINAPI AbreCursor                       (LPBHVRCOM lpBhvrCom, LPVOID lpVoid, LPDSD570830D lpDS) {<br/><br/>   /************************************************************************ <br/>    *  Variable declarations <br/>    ************************************************************************/ <br/>    HUSER				hUser							= (HUSER)NULL;<br/>    ID					idJDBReturn		            	=  JDEDB_PASSED;<br/>    HREQUEST		    hDataSource    	     			= (HREQUEST)NULL;<br/>    dsRegras            *lpRegras                       = NULL;    <br/>    dsRegras            *lpRegrasBase                   = NULL;    <br/>    dsRegra             lpSelecao                       = {'0'};   <br/>    int                 nNumRegra                       = 0;<br/>    int                 nNumRegraBase                   = 0;<br/>    NID	                nidColumns[1]                   = {'0'};<br/><br/><br/>   /************************************************************************ <br/>    * Check for NULL pointers <br/>    ************************************************************************/ <br/>   if ((lpBhvrCom == (LPBHVRCOM) NULL) || <br/>       (lpVoid    == (LPVOID)    NULL) || <br/>       (lpDS      == (LPDSD570830D)	NULL)) <br/>   { <br/>     jdeErrorSet (lpBhvrCom, lpVoid, (ID) 0, _J("4363"), (LPVOID) NULL); <br/>     return ER_ERROR; <br/>   } <br/> <br/>   /************************************************************************ <br/>    * Main Processing <br/>    ************************************************************************/ <br/>    idJDBReturn = JDB_InitBhvr( lpBhvrCom , &hUser , NULL , JDEDB_COMMIT_AUTO );<br/>   <br/>    if (idJDBReturn != JDEDB_PASSED) <br/>    {<br/><br/>        lpDS-&gtcErro = _J('S');<br/>        jdeStrcpyAndTerminate(lpDS-&gtszMsgRetorno, _J("Não conseguiu inicializar o ambiente !!!"), DIM(lpDS-&gtszMsgRetorno));<br/>        return ER_ERROR;<br/><br/>    }<br/>  <br/>    if ( lpDS-&gtcUsarRegraBase == _J('S') ) {<br/><br/>        lpRegrasBase = jdeRetrieveDataPtr( hUser, lpDS-&gtidRegraBase );<br/><br/>        if ( lpRegrasBase == NULL ) {<br/><br/>            lpDS-&gtcErro = _J('S');<br/>            jdeStrcpyAndTerminate(lpDS-&gtszMsgRetorno, _J("Não conseguiu carregar a regra !!!"), DIM(lpDS-&gtszMsgRetorno));<br/>            JDB_FreeBhvr( hUser );<br/>            return ER_ERROR;<br/><br/>        }<br/><br/>		if ( !jdeIsBlankOrNull(lpDS-&gtszNomeRegraBase) ) {<br/><br/>			jdeStrcpyFillBlankAndTerminate(lpDS-&gtszNomeRegraBase, lpDS-&gtszNomeRegraBase, DIM(lpDS-&gtszNomeRegraBase));<br/>			nNumRegraBase = I570830_HashLookup( lpRegrasBase-&gthash, lpDS-&gtszNomeRegraBase );<br/><br/>			if ( nNumRegraBase &lt 0 ) <br/>			{<br/><br/>				lpDS-&gtcErro = 'S';<br/>				jdeStrcpyAndTerminate(lpDS-&gtszMsgRetorno, _J("Não conseguiu achar a regra base !!!"), DIM(lpDS-&gtszMsgRetorno));<br/>				JDB_FreeBhvr( hUser );<br/>				return ER_ERROR;<br/><br/>			}<br/><br/><br/>		} else {<br/><br/>			MathNumericToInt( &lpDS-&gtmnNumRegraBase, &nNumRegraBase );<br/><br/>		}<br/><br/><br/>    }<br/><br/>    lpRegras = jdeRetrieveDataPtr( hUser, lpDS-&gtidRegras );<br/>    <br/>    if ( lpRegras == NULL ) {<br/><br/>        lpDS-&gtcErro = _J('S');<br/>        jdeStrcpyAndTerminate(lpDS-&gtszMsgRetorno, _J("Não conseguiu carregar a regra !!!"), DIM(lpDS-&gtszMsgRetorno));<br/>        JDB_FreeBhvr( hUser );<br/>        return ER_ERROR;<br/><br/>    }<br/><br/>    if ( !jdeIsBlankOrNull(lpDS-&gtszNomeRegra) ) {<br/><br/>        jdeStrcpyFillBlankAndTerminate(lpDS-&gtszNomeRegra, lpDS-&gtszNomeRegra, DIM(lpDS-&gtszNomeRegra));<br/>        nNumRegra = I570830_HashLookup( lpRegras-&gthash, lpDS-&gtszNomeRegra );<br/><br/>        if ( nNumRegra &lt 0 ) <br/>        {<br/><br/>            lpDS-&gtcErro = 'S';<br/>            jdeStrcpyAndTerminate(lpDS-&gtszMsgRetorno, _J("Não conseguiu achar a regra !!!"), DIM(lpDS-&gtszMsgRetorno));<br/>            JDB_FreeBhvr( hUser );<br/>            return ER_ERROR;<br/><br/>        }<br/><br/><br/>    } else {<br/><br/>        MathNumericToInt( &lpDS-&gtmnNumRegra, &nNumRegra );<br/><br/>    }<br/>    <br/>    <br/><br/>    lpSelecao = lpRegras-&gtRegras[nNumRegra];<br/><br/>    jdeStrncpyTerminate( lpDS-&gtszRegra, lpSelecao.szNomeRegra, DIM(lpDS-&gtszRegra) );<br/>    <br/>    if ( !jdeIsBlankOrNull( lpDS-&gtszOvrDataSource ) ) {<br/><br/>        if ( lpDS-&gtszOvrDataSource[0] == _J('V') ) {<br/><br/>            idJDBReturn = JDB_OpenView( hUser, lpDS-&gtszOvrDataSource, NULL, &hDataSource );<br/><br/>        } else {<br/><br/>            idJDBReturn = JDB_OpenTable( hUser, lpDS-&gtszOvrDataSource, 0, NULL, (ushort) 0,  (JCHAR *) NULL, &hDataSource ); //Abre Origem dos Dados<br/><br/>        }        <br/><br/>    } else {<br/><br/>        if ( lpSelecao.szDataSource[0] == _J('V') ) {<br/><br/>            idJDBReturn = JDB_OpenView( hUser, lpSelecao.szDataSource, NULL, &hDataSource );<br/><br/>        } else {<br/><br/>            idJDBReturn = JDB_OpenTable( hUser, lpSelecao.szDataSource, 0, NULL, (ushort) 0,  (JCHAR *) NULL, &hDataSource ); //Abre Origem dos Dados<br/><br/>        }                <br/><br/>    }<br/>    <br/>    <br/>    if (idJDBReturn != JDEDB_PASSED) <br/>    {<br/><br/>        lpDS-&gtcErro = _J('S');<br/>        jdeStrcpyAndTerminate(lpDS-&gtszMsgRetorno, _J("Não conseguiu abrir o Data Source !!!"), DIM(lpDS-&gtszMsgRetorno));<br/>        JDB_CloseTable( hDataSource );<br/>        JDB_FreeBhvr( hUser );<br/>        return ER_ERROR;<br/><br/>    }  <br/><br/>    idJDBReturn = JDB_SetNestedSelection( hDataSource, lpSelecao.lpSelect, lpSelecao.nTamanhoSelecao, JDEDB_SET_REPLACE );<br/><br/>    if ( lpDS-&gtcUsarRegraBase == _J('S') && lpRegrasBase-&gtRegras[nNumRegraBase].lpSelect != NULL) {<br/><br/>        idJDBReturn = JDB_SetNestedSelection( hDataSource, lpRegrasBase-&gtRegras[nNumRegraBase].lpSelect, lpRegrasBase-&gtRegras[nNumRegraBase].nTamanhoSelecao, JDEDB_SET_APPEND );<br/><br/>        if (idJDBReturn != JDEDB_PASSED) {<br/><br/>            lpDS-&gtcErro = _J('S');<br/>            jdeStrcpyAndTerminate(lpDS-&gtszMsgRetorno, _J("Não conseguiu setar a seleção de dados no Data Source !!!"), DIM(lpDS-&gtszMsgRetorno));<br/>            JDB_CloseTable ( hDataSource );<br/>            JDB_FreeBhvr( hUser );<br/>            return ER_ERROR;<br/><br/>        }<br/><br/>    }<br/><br/>    if (idJDBReturn != JDEDB_PASSED) {<br/><br/>        lpDS-&gtcErro = _J('S');<br/>        jdeStrcpyAndTerminate(lpDS-&gtszMsgRetorno, _J("Não conseguiu setar a seleção de dados no Data Source !!!"), DIM(lpDS-&gtszMsgRetorno));<br/>        JDB_CloseTable ( hDataSource );<br/>        JDB_FreeBhvr( hUser );<br/>        return ER_ERROR;<br/><br/>    }<br/><br/>    if ( lpRegras-&gtRegras[nNumRegra].lpSort != NULL) {<br/><br/>        idJDBReturn = JDB_ClearSequencing( hDataSource );<br/>        if (idJDBReturn != JDEDB_PASSED) {<br/><br/>            lpDS-&gtcErro = _J('S');<br/>            jdeStrcpyAndTerminate(lpDS-&gtszMsgRetorno, _J("Não conseguiu limpar a ordenação Data Source !!!"), DIM(lpDS-&gtszMsgRetorno));<br/>            JDB_CloseTable ( hDataSource );<br/>            JDB_FreeBhvr( hUser );<br/>            return ER_ERROR;<br/><br/>        }<br/><br/>        idJDBReturn = JDB_SetSequencing( hDataSource, lpRegras-&gtRegras[nNumRegra].lpSort, lpRegras-&gtRegras[nNumRegra].nTamanhoOrdenacao ,JDEDB_SET_REPLACE  );<br/>        if (idJDBReturn != JDEDB_PASSED) {<br/><br/>            lpDS-&gtcErro = _J('S');<br/>            jdeStrcpyAndTerminate(lpDS-&gtszMsgRetorno, _J("Não conseguiu setar a ordenação Data Source !!!"), DIM(lpDS-&gtszMsgRetorno));<br/>            JDB_CloseTable ( hDataSource );<br/>            JDB_FreeBhvr( hUser );<br/>            return ER_ERROR;<br/><br/>        }<br/><br/><br/>    }<br/><br/>    if ( lpDS-&gtcLock == _J('S') ) {<br/>        <br/>        jdeNIDcpy(nidColumns[0], _J("AID"));<br/>        idJDBReturn = JDB_SelectKeyedForUpdate( hDataSource, (ID)NULL,  NULL, (short)(0), nidColumns, (short)(1) );                      <br/><br/>    } else {<br/><br/>        idJDBReturn = JDB_SelectKeyed( hDataSource, (ID)(0), (void *) NULL, (short)(0) );<br/><br/>    }<br/><br/>    if (idJDBReturn != JDEDB_PASSED) {<br/><br/>        lpDS-&gtcErro = _J('S');<br/>        jdeStrcpyAndTerminate(lpDS-&gtszMsgRetorno, _J("Não conseguiu executar a seleção de dados no Data Source !!!"), DIM(lpDS-&gtszMsgRetorno));<br/>        JDB_CloseTable ( hDataSource );<br/>        JDB_FreeBhvr( hUser );<br/>        return ER_ERROR;<br/><br/>    }<br/><br/>    lpDS-&gtidCursor = jdeStoreDataPtr( hUser, hDataSource );<br/>    JDB_FreeBhvr( hUser );<br/>    return ER_SUCCESS;<br/><br/>}<br/><br/>/************************************************************************** <br/> *  Business Function:  AvancaCursor <br/> * <br/> *        Description:  Avanca o Cursor <br/> * <br/> *         Parameters: <br/> *           LPBHVRCOM           lpBhvrCom    Business Function Communications <br/> *           LPVOID              lpVoid       Void Parameter - DO NOT USE! <br/> *           LPDSD570            lpDS         Parameter Data Structure Pointer   <br/> * <br/> *************************************************************************/ <br/><br/>JDEBFRTN (ID) JDEBFWINAPI AvancaCursor                     (LPBHVRCOM lpBhvrCom, LPVOID lpVoid, LPDSD570830E lpDS) {<br/>    <br/>   /************************************************************************ <br/>    *  Variable declarations <br/>    ************************************************************************/ <br/>    HUSER				hUser							= (HUSER)NULL;<br/>    ID					idJDBReturn		            	=  JDEDB_PASSED;<br/>    HREQUEST		    hDataSource    	     			= (HREQUEST)NULL;<br/><br/>   /************************************************************************ <br/>    * Check for NULL pointers <br/>    ************************************************************************/ <br/>   if ((lpBhvrCom == (LPBHVRCOM) NULL) || <br/>       (lpVoid    == (LPVOID)    NULL) || <br/>       (lpDS      == (LPDSD570830E)	NULL)) <br/>   { <br/>     jdeErrorSet (lpBhvrCom, lpVoid, (ID) 0, _J("4363"), (LPVOID) NULL); <br/>     return ER_ERROR; <br/>   } <br/> <br/>   /************************************************************************ <br/>    * Main Processing <br/>    ************************************************************************/ <br/>    idJDBReturn = JDB_InitBhvr( lpBhvrCom , &hUser , NULL , JDEDB_COMMIT_AUTO );<br/><br/>    if (idJDBReturn != JDEDB_PASSED) <br/>    {<br/><br/>        lpDS-&gtcErro = _J('S');<br/>        jdeStrcpyAndTerminate(lpDS-&gtszMsgRetorno, _J("Não conseguiu inicializar o ambiente !!!"), DIM(lpDS-&gtszMsgRetorno));<br/>        return ER_ERROR;<br/><br/>    }<br/><br/>    hDataSource = jdeRetrieveDataPtr( hUser, lpDS-&gtidCursor );<br/><br/>    if ( hDataSource == NULL ) {<br/><br/>        lpDS-&gtcErro = _J('S');<br/>        jdeStrcpyAndTerminate(lpDS-&gtszMsgRetorno, _J("Não conseguiu carregar o cursor !!!"), DIM(lpDS-&gtszMsgRetorno));<br/>        return ER_ERROR;<br/><br/>    }<br/><br/>    if ( lpDS-&gtcLock == _J('S') ) {<br/>    <br/>        idJDBReturn = JDB_FetchForUpdate( hDataSource , NULL, 0 );<br/><br/>    } else {<br/><br/>        idJDBReturn = JDB_Fetch( hDataSource , NULL, 0 );<br/><br/>    }    <br/><br/>    if (idJDBReturn != JDEDB_PASSED) <br/>    {<br/><br/>        lpDS-&gtcErro = _J('S');<br/>        jdeStrcpyAndTerminate(lpDS-&gtszMsgRetorno, _J("Não conseguiu fazer o fetch !!!"), DIM(lpDS-&gtszMsgRetorno));<br/>        JDB_FreeBhvr( hUser );<br/>        return ER_ERROR;<br/><br/>    }<br/><br/>    JDB_FreeBhvr( hUser );<br/>    return ER_SUCCESS;<br/><br/>}<br/><br/><br/>/************************************************************************** <br/> *  Business Function:  BuscaMathNumeric <br/> * <br/> *        Description:  Busca Valor Math Numeric no Cursor<br/> * <br/> *         Parameters: <br/> *           LPBHVRCOM           lpBhvrCom    Business Function Communications <br/> *           LPVOID              lpVoid       Void Parameter - DO NOT USE! <br/> *           LPDSD570            lpDS         Parameter Data Structure Pointer   <br/> * <br/> *************************************************************************/ <br/><br/><br/>JDEBFRTN (ID) JDEBFWINAPI BuscaMathNumeric                 (LPBHVRCOM lpBhvrCom, LPVOID lpVoid, LPDSD570830F lpDS) {<br/>    <br/>   /************************************************************************ <br/>    *  Variable declarations <br/>    ************************************************************************/ <br/>    HUSER				hUser							= (HUSER)NULL;<br/>    ID					idJDBReturn		            	=  JDEDB_PASSED;<br/>    HREQUEST		    hDataSource    	     			= (HREQUEST)NULL;<br/>    DBREF               dbRef	                        = {0};<br/><br/>   /************************************************************************ <br/>    * Check for NULL pointers <br/>    ************************************************************************/ <br/>   if ((lpBhvrCom == (LPBHVRCOM) NULL) || <br/>       (lpVoid    == (LPVOID)    NULL) || <br/>       (lpDS      == (LPDSD570830F)	NULL)) <br/>   { <br/>     jdeErrorSet (lpBhvrCom, lpVoid, (ID) 0, _J("4363"), (LPVOID) NULL); <br/>     return ER_ERROR; <br/>   } <br/> <br/>   /************************************************************************ <br/>    * Main Processing <br/>    ************************************************************************/ <br/>    idJDBReturn = JDB_InitBhvr( lpBhvrCom , &hUser , NULL , JDEDB_COMMIT_AUTO );<br/><br/>    if (idJDBReturn != JDEDB_PASSED) <br/>    {<br/><br/>        lpDS-&gtcErro = _J('S');<br/>        jdeStrcpyAndTerminate(lpDS-&gtszMsgRetorno, _J("Não conseguiu inicializar o ambiente !!!"), DIM(lpDS-&gtszMsgRetorno));<br/>        return ER_ERROR;<br/><br/>    }<br/><br/>    hDataSource = jdeRetrieveDataPtr( hUser, lpDS-&gtidCursor );<br/><br/>    if ( hDataSource == NULL ) {<br/><br/>        lpDS-&gtcErro = _J('S');<br/>        jdeStrcpyAndTerminate(lpDS-&gtszMsgRetorno, _J("Não conseguiu carregar o cursor !!!"), DIM(lpDS-&gtszMsgRetorno));<br/>        return ER_ERROR;<br/><br/>    }<br/><br/>    jdeNIDcpy (dbRef.szTable, lpDS-&gtszTabela);<br/>    dbRef.idInstance = 0;<br/>    jdeStripTrailingBlanks(lpDS-&gtszCampo);<br/>     <br/>    if(jdeStrcmp( lpDS-&gtszCampo, _J(" ") ) !=0 )<br/>    {<br/><br/>        jdeNIDcpy( dbRef.szDict, lpDS-&gtszCampo ); <br/>        MathCopy( &lpDS-&gtmnRetornoMath, (LPMATH_NUMERIC)JDB_GetTableColValue( hDataSource, dbRef));        <br/><br/>    }    <br/><br/>    JDB_FreeBhvr( hUser );<br/>    return ER_SUCCESS;<br/><br/>} <br/><br/>/************************************************************************** <br/> *  Business Function:  BuscaString <br/> * <br/> *        Description:  Busca Valor String no Cursor<br/> * <br/> *         Parameters: <br/> *           LPBHVRCOM           lpBhvrCom    Business Function Communications <br/> *           LPVOID              lpVoid       Void Parameter - DO NOT USE! <br/> *           LPDSD570            lpDS         Parameter Data Structure Pointer   <br/> * <br/> *************************************************************************/ <br/><br/>JDEBFRTN (ID) JDEBFWINAPI BuscaString                      (LPBHVRCOM lpBhvrCom, LPVOID lpVoid, LPDSD570830G lpDS) {<br/>    <br/>   /************************************************************************ <br/>    *  Variable declarations <br/>    ************************************************************************/ <br/>    HUSER				hUser							= (HUSER)NULL;<br/>    ID					idJDBReturn		            	=  JDEDB_PASSED;<br/>    HREQUEST		    hDataSource    	     			= (HREQUEST)NULL;<br/>    DBREF               dbRef	                        = {0};<br/><br/>   /************************************************************************ <br/>    * Check for NULL pointers <br/>    ************************************************************************/ <br/>   if ((lpBhvrCom == (LPBHVRCOM) NULL) || <br/>       (lpVoid    == (LPVOID)    NULL) || <br/>       (lpDS      == (LPDSD570830G)	NULL)) <br/>   { <br/>     jdeErrorSet (lpBhvrCom, lpVoid, (ID) 0, _J("4363"), (LPVOID) NULL); <br/>     return ER_ERROR; <br/>   } <br/> <br/>   /************************************************************************ <br/>    * Main Processing <br/>    ************************************************************************/ <br/>    idJDBReturn = JDB_InitBhvr( lpBhvrCom , &hUser , NULL , JDEDB_COMMIT_AUTO );<br/><br/>    if (idJDBReturn != JDEDB_PASSED) <br/>    {<br/><br/>        lpDS-&gtcErro = _J('S');<br/>        jdeStrcpyAndTerminate(lpDS-&gtszMsgRetorno, _J("Não conseguiu inicializar o ambiente !!!"), DIM(lpDS-&gtszMsgRetorno));<br/>        return ER_ERROR;<br/><br/>    }<br/><br/>    hDataSource = jdeRetrieveDataPtr( hUser, lpDS-&gtidCursor );<br/><br/>    if ( hDataSource == NULL ) {<br/><br/>        lpDS-&gtcErro = _J('S');<br/>        jdeStrcpyAndTerminate( lpDS-&gtszMsgRetorno, _J("Não conseguiu carregar o cursor !!!"), DIM(lpDS-&gtszMsgRetorno) );<br/>        return ER_ERROR;<br/><br/>    }<br/><br/>    jdeNIDcpy (dbRef.szTable, lpDS-&gtszTabela);<br/>    dbRef.idInstance = 0;<br/>    jdeStripTrailingBlanks(lpDS-&gtszCampo);<br/>     <br/>    if(jdeStrcmp( lpDS-&gtszCampo, _J(" ") ) !=0 )<br/>    {<br/><br/>        jdeNIDcpy( dbRef.szDict, lpDS-&gtszCampo ); <br/>        jdeStrcpyAndTerminate( lpDS-&gtszRetornoString, (JCHAR *)JDB_GetTableColValue( hDataSource, dbRef), DIM(lpDS-&gtszRetornoString) );<br/><br/>    }    <br/><br/>    JDB_FreeBhvr( hUser );<br/>    return ER_SUCCESS;<br/><br/>}<br/><br/>/************************************************************************** <br/> *  Business Function:  BuscaInteger <br/> * <br/> *        Description:  Busca Valor Inteiro no Cursor<br/> * <br/> *         Parameters: <br/> *           LPBHVRCOM           lpBhvrCom    Business Function Communications <br/> *           LPVOID              lpVoid       Void Parameter - DO NOT USE! <br/> *           LPDSD570            lpDS         Parameter Data Structure Pointer   <br/> * <br/> *************************************************************************/ <br/>JDEBFRTN (ID) JDEBFWINAPI BuscaInteger                     (LPBHVRCOM lpBhvrCom, LPVOID lpVoid, LPDSD570830H lpDS) {<br/>    <br/>   /************************************************************************ <br/>    *  Variable declarations <br/>    ************************************************************************/ <br/>    HUSER				hUser							= (HUSER)NULL;<br/>    ID					idJDBReturn		            	=  JDEDB_PASSED;<br/>    HREQUEST		    hDataSource    	     			= (HREQUEST)NULL;<br/>    DBREF               dbRef	                        = {0};<br/><br/>   /************************************************************************ <br/>    * Check for NULL pointers <br/>    ************************************************************************/ <br/>   if ((lpBhvrCom == (LPBHVRCOM) NULL) || <br/>       (lpVoid    == (LPVOID)    NULL) || <br/>       (lpDS      == (LPDSD570830H)	NULL)) <br/>   { <br/>     jdeErrorSet (lpBhvrCom, lpVoid, (ID) 0, _J("4363"), (LPVOID) NULL); <br/>     return ER_ERROR; <br/>   } <br/> <br/>   /************************************************************************ <br/>    * Main Processing <br/>    ************************************************************************/ <br/>    idJDBReturn = JDB_InitBhvr( lpBhvrCom , &hUser , NULL , JDEDB_COMMIT_AUTO );<br/>    <br/>    if (idJDBReturn != JDEDB_PASSED) <br/>    {<br/><br/>        lpDS-&gtcErro = 'S';<br/>        jdeStrcpyAndTerminate(lpDS-&gtszMsgRetorno, _J("Não conseguiu inicializar o ambiente !!!"), DIM(lpDS-&gtszMsgRetorno));<br/>        return ER_ERROR;<br/><br/>    }<br/><br/>    hDataSource = jdeRetrieveDataPtr( hUser, lpDS-&gtidCursor );<br/><br/>    if ( hDataSource == NULL ) {<br/><br/>        lpDS-&gtcErro = 'S';<br/>        jdeStrcpyAndTerminate(lpDS-&gtszMsgRetorno, _J("Não conseguiu carregar o cursor !!!"), DIM(lpDS-&gtszMsgRetorno));<br/>        return ER_ERROR;<br/><br/>    }<br/><br/>    jdeNIDcpy (dbRef.szTable, lpDS-&gtszTabela);<br/>    dbRef.idInstance = 0;<br/>    jdeStripTrailingBlanks(lpDS-&gtszCampo);<br/>     <br/>    if(jdeStrcmp( lpDS-&gtszCampo, _J(" ") ) !=0 )<br/>    {<br/><br/>        jdeNIDcpy( dbRef.szDict, lpDS-&gtszCampo ); <br/>        lpDS-&gtnRetornoInt = (int)JDB_GetTableColValue( hDataSource, dbRef);        <br/><br/>    }    <br/><br/>    JDB_FreeBhvr( hUser );<br/>    return ER_SUCCESS;<br/><br/>}<br/><br/>/************************************************************************** <br/> *  Business Function:  BuscaData <br/> * <br/> *        Description:  Busca Valor Data no Cursor<br/> * <br/> *         Parameters: <br/> *           LPBHVRCOM           lpBhvrCom    Business Function Communications <br/> *           LPVOID              lpVoid       Void Parameter - DO NOT USE! <br/> *           LPDSD570            lpDS         Parameter Data Structure Pointer   <br/> * <br/> *************************************************************************/ <br/><br/>JDEBFRTN (ID) JDEBFWINAPI BuscaData                        (LPBHVRCOM lpBhvrCom, LPVOID lpVoid, LPDSD570830I lpDS) {<br/>    <br/>   /************************************************************************ <br/>    *  Variable declarations <br/>    ************************************************************************/ <br/>    HUSER				hUser							= (HUSER)NULL;<br/>    ID					idJDBReturn		            	=  JDEDB_PASSED;<br/>    HREQUEST		    hDataSource    	     			= (HREQUEST)NULL;<br/>    DBREF               dbRef	                        = {0};<br/><br/>   /************************************************************************ <br/>    * Check for NULL pointers <br/>    ************************************************************************/ <br/>   if ((lpBhvrCom == (LPBHVRCOM) NULL) || <br/>       (lpVoid    == (LPVOID)    NULL) || <br/>       (lpDS      == (LPDSD570830I)	NULL)) <br/>   { <br/>     jdeErrorSet (lpBhvrCom, lpVoid, (ID) 0, _J("4363"), (LPVOID) NULL); <br/>     return ER_ERROR; <br/>   } <br/> <br/>   /************************************************************************ <br/>    * Main Processing <br/>    ************************************************************************/ <br/>    idJDBReturn = JDB_InitBhvr( lpBhvrCom , &hUser , NULL , JDEDB_COMMIT_AUTO );<br/><br/>    if (idJDBReturn != JDEDB_PASSED) <br/>    {<br/><br/>        lpDS-&gtcErro = 'S';<br/>        jdeStrcpyAndTerminate(lpDS-&gtszMsgRetorno, _J("Não conseguiu inicializar o ambiente !!!"), DIM(lpDS-&gtszMsgRetorno));<br/>        return ER_ERROR;<br/><br/>    }<br/><br/>    hDataSource = jdeRetrieveDataPtr( hUser, lpDS-&gtidCursor );<br/><br/>    if ( hDataSource == NULL ) {<br/><br/>        lpDS-&gtcErro = 'S';<br/>        jdeStrcpyAndTerminate(lpDS-&gtszMsgRetorno, _J("Não conseguiu carregar o cursor !!!"), DIM(lpDS-&gtszMsgRetorno));<br/>        return ER_ERROR;<br/><br/>    }<br/><br/>    jdeNIDcpy (dbRef.szTable, lpDS-&gtszTabela);<br/>    dbRef.idInstance = 0;<br/>    jdeStripTrailingBlanks(lpDS-&gtszCampo);<br/>     <br/>    if(jdeStrcmp( lpDS-&gtszCampo, _J(" ") ) !=0 )<br/>    {<br/><br/>        jdeNIDcpy( dbRef.szDict, lpDS-&gtszCampo ); <br/>        memcpy( &lpDS-&gtjdRetornoData, (JDEDATE*)JDB_GetTableColValue( hDataSource, dbRef), sizeof(JDEDATE));<br/><br/>    }    <br/><br/>    JDB_FreeBhvr( hUser );<br/>    return ER_SUCCESS;<br/><br/>}<br/><br/>/************************************************************************** <br/> *  Business Function:  BuscaInteger <br/> * <br/> *        Description:  Busca Valor Inteiro no Cursor<br/> * <br/> *         Parameters: <br/> *           LPBHVRCOM           lpBhvrCom    Business Function Communications <br/> *           LPVOID              lpVoid       Void Parameter - DO NOT USE! <br/> *           LPDSD570            lpDS         Parameter Data Structure Pointer   <br/> * <br/> *************************************************************************/ <br/>JDEBFRTN (ID) JDEBFWINAPI BuscaChar                    (LPBHVRCOM lpBhvrCom, LPVOID lpVoid, LPDSD570830N lpDS) {<br/>    <br/>   /************************************************************************ <br/>    *  Variable declarations <br/>    ************************************************************************/ <br/>    HUSER				hUser							= (HUSER)NULL;<br/>    ID					idJDBReturn		            	=  JDEDB_PASSED;<br/>    HREQUEST		    hDataSource    	     			= (HREQUEST)NULL;<br/>    DBREF               dbRef	                        = {0};<br/><br/>   /************************************************************************ <br/>    * Check for NULL pointers <br/>    ************************************************************************/ <br/>   if ((lpBhvrCom == (LPBHVRCOM) NULL) || <br/>       (lpVoid    == (LPVOID)    NULL) || <br/>       (lpDS      == (LPDSD570830N)	NULL)) <br/>   { <br/>     jdeErrorSet (lpBhvrCom, lpVoid, (ID) 0, _J("4363"), (LPVOID) NULL); <br/>     return ER_ERROR; <br/>   } <br/> <br/>   /************************************************************************ <br/>    * Main Processing <br/>    ************************************************************************/ <br/>    idJDBReturn = JDB_InitBhvr( lpBhvrCom , &hUser , NULL , JDEDB_COMMIT_AUTO );<br/>    <br/>    if (idJDBReturn != JDEDB_PASSED) <br/>    {<br/><br/>        lpDS-&gtcErro = 'S';<br/>        jdeStrcpyAndTerminate(lpDS-&gtszMsgRetorno, _J("Não conseguiu inicializar o ambiente !!!"), DIM(lpDS-&gtszMsgRetorno));<br/>        return ER_ERROR;<br/><br/>    }<br/><br/>    hDataSource = jdeRetrieveDataPtr( hUser, lpDS-&gtidCursor );<br/><br/>    if ( hDataSource == NULL ) {<br/><br/>        lpDS-&gtcErro = 'S';<br/>        jdeStrcpyAndTerminate(lpDS-&gtszMsgRetorno, _J("Não conseguiu carregar o cursor !!!"), DIM(lpDS-&gtszMsgRetorno));<br/>        return ER_ERROR;<br/><br/>    }<br/><br/>    jdeNIDcpy (dbRef.szTable, lpDS-&gtszTabela);<br/>    dbRef.idInstance = 0;<br/>    jdeStripTrailingBlanks(lpDS-&gtszCampo);<br/>     <br/>    if(jdeStrcmp( lpDS-&gtszCampo, _J(" ") ) !=0 )<br/>    {<br/><br/>        jdeNIDcpy( dbRef.szDict, lpDS-&gtszCampo ); <br/>        lpDS-&gtcRetornoChar = *((JCHAR*)JDB_GetTableColValue(hDataSource, dbRef));        <br/><br/>    }    <br/><br/>    JDB_FreeBhvr( hUser );<br/>    return ER_SUCCESS;<br/><br/>}<br/><br/>/************************************************************************** <br/> *  Business Function:  ExecutaRegras <br/> * <br/> *        Description:  Executa Regras  - Processa todas as regras usando <br/> * uma sequencia de comandos pré-cadastrados.<br/> * <br/> *         Parameters: <br/> *           LPBHVRCOM           lpBhvrCom    Business Function Communications <br/> *           LPVOID              lpVoid       Void Parameter - DO NOT USE! <br/> *           LPDSD570            lpDS         Parameter Data Structure Pointer   <br/> * <br/> *************************************************************************/ <br/> <br/>JDEBFRTN (ID) JDEBFWINAPI ExecutaRegras (LPBHVRCOM lpBhvrCom, LPVOID lpVoid, LPDSD570830B lpDS)   <br/>{ <br/>   /************************************************************************ <br/>    *  Variable declarations <br/>    ************************************************************************/ <br/>    /*HUSER				hUser							= (HUSER)NULL;<br/>    ID					idJDBReturn		            	=  JDEDB_PASSED;<br/>    HREQUEST		    hDataSource    	     			= (HREQUEST)NULL;<br/>    dsRegras             *lpRegras                       = NULL;    <br/>    void                *dsFetch                        = NULL;*/<br/><br/>   /************************************************************************ <br/>    * Check for NULL pointers <br/>    ************************************************************************/ <br/>   if ((lpBhvrCom == (LPBHVRCOM) NULL) || <br/>       (lpVoid    == (LPVOID)    NULL) || <br/>       (lpDS      == (LPDSD570830B)	NULL)) <br/>   { <br/>     jdeErrorSet (lpBhvrCom, lpVoid, (ID) 0, _J("4363"), (LPVOID) NULL); <br/>     return ER_ERROR; <br/>   } <br/> <br/>   /************************************************************************ <br/>    * Main Processing <br/>    ************************************************************************/ <br/>    /*idJDBReturn = JDB_InitBhvr( lpBhvrCom , &hUser , NULL , JDEDB_COMMIT_AUTO );<br/><br/>    if (idJDBReturn != JDEDB_PASSED) <br/>    {<br/><br/>        lpDS-&gtcErro = 'S';<br/>        jdeStrcpyAndTerminate(lpDS-&gtszMsgRetorno, _J("Não conseguiu inicializar o ambiente !!!"), DIM(lpDS-&gtszMsgRetorno));<br/>        return ER_ERROR;<br/><br/>    }<br/><br/>    lpRegras = jdeRetrieveDataPtr( hUser, lpDS-&gtidRegras );<br/><br/>    idJDBReturn = JDB_OpenTable(hUser, lpRegras[0].szDataSource, 0, NULL, (ushort) 0,  (JCHAR *) NULL, &hDataSource); //Abre Origem dos Dados<br/><br/>    if (idJDBReturn != JDEDB_PASSED) <br/>    {<br/><br/>        lpDS-&gtcErro = 'S';<br/>        jdeStrcpyAndTerminate(lpDS-&gtszMsgRetorno, _J("Não conseguiu abrir o Data Source !!!"), DIM(lpDS-&gtszMsgRetorno));<br/>        return ER_ERROR;<br/><br/>    }<br/><br/>    idJDBReturn = JDB_SetSelectionX( hDataSource, lpRegras[0].lpSelect, lpRegras[0].nTamanhoSelecao, JDEDB_SET_REPLACE );<br/><br/>    if (idJDBReturn != JDEDB_PASSED) {<br/><br/>        lpDS-&gtcErro = 'S';<br/>        jdeStrcpyAndTerminate(lpDS-&gtszMsgRetorno, _J("Não conseguiu setar a seleção de dados no Data Source !!!"), DIM(lpDS-&gtszMsgRetorno));<br/>        return ER_ERROR;<br/><br/>    }<br/><br/>    idJDBReturn = JDB_SelectKeyed( hDataSource, (ID)(0), (void *) NULL, (short)(0) );<br/><br/>    if (idJDBReturn != JDEDB_PASSED) {<br/><br/>        lpDS-&gtcErro = 'S';<br/>        jdeStrcpyAndTerminate(lpDS-&gtszMsgRetorno, _J("Não conseguiu executar a seleção de dados no Data Source !!!"), DIM(lpDS-&gtszMsgRetorno));<br/>        return ER_ERROR;<br/><br/>    }<br/><br/>    while(JDB_Fetch( hDataSource , &dsFetch, 0 )) {*/<br/><br/>        //I570830_MontaParametros( hData, &dsFetch , _J("D5576B03") );<br/><br/>    //}<br/>    <br/>   /************************************************************************ <br/>    * Function Clean Up <br/>    ************************************************************************/ <br/>    <br/>   return (ER_SUCCESS); <br/>} <br/> <br/> <br/>/************************************************************************** <br/> *  Business Function:  InicializaRegras <br/> * <br/> *        Description:  Inicaliza Regras <br/> * <br/> *         Parameters: <br/> *           LPBHVRCOM           lpBhvrCom    Business Function Communications <br/> *           LPVOID              lpVoid       Void Parameter - DO NOT USE! <br/> *           LPDSD570            lpDS         Parameter Data Structure Pointer   <br/> * <br/> *************************************************************************/ <br/> <br/>JDEBFRTN (ID) JDEBFWINAPI InicializaRegras (LPBHVRCOM lpBhvrCom, LPVOID lpVoid, LPDSD570830A lpDS)  <br/>{ <br/> 	HREQUEST			hReqF570836						= (HREQUEST)NULL;<br/>	HREQUEST		    hReqF570836A					= (HREQUEST)NULL;<br/>    HUSER				hUser							= (HUSER)NULL;<br/>    ID					idJDBReturn		            	=  JDEDB_PASSED;<br/>    int                 iTamanhoSel                     = 0;<br/>    int                 iNumRegras                      = 0;    <br/>    int                 iCont                           = 0;<br/>    JCHAR               szDataSource[11]                = {'0'};<br/><br/>   /************************************************************************ <br/>    * Declare structures <br/>    ************************************************************************/ <br/>    SELECTSTRUCT        lpSelecaoRegras[3]              = {0};<br/>    dsRegras            *lpRegras                       = NULL;    <br/>    dsRegra             *BufferRegras                   = NULL;<br/>    KEY1_F570836A       dsChaveF570836A                 = {0};<br/>    F570836             dsF570836                       = {0};<br/>    <br/>   /************************************************************************ <br/>    * Check for NULL pointers <br/>    ************************************************************************/ <br/>   if ((lpBhvrCom == (LPBHVRCOM) NULL) || <br/>       (lpVoid    == (LPVOID)    NULL) || <br/>       (lpDS      == (LPDSD570830A)	NULL)) <br/>   { <br/><br/>     jdeErrorSet (lpBhvrCom, lpVoid, (ID) 0, _J("4363"), (LPVOID) NULL); <br/>     return ER_ERROR; <br/><br/>   } <br/> <br/>   /************************************************************************ <br/>    * Main Processing <br/>    ************************************************************************/ <br/>    idJDBReturn = JDB_InitBhvr( lpBhvrCom , &hUser , NULL , JDEDB_COMMIT_AUTO );<br/><br/>    if (idJDBReturn != JDEDB_PASSED) <br/>    {<br/><br/>        lpDS-&gtcErro = 'S';<br/>        jdeStrcpyAndTerminate(lpDS-&gtszMsgRetorno, _J("Não conseguiu inicializar o ambiente !!!"), DIM(lpDS-&gtszMsgRetorno));<br/>        return ER_ERROR;<br/><br/>    }<br/><br/>    lpRegras = jdeAlloc( COMMON_POOL, sizeof(dsRegras), MEM_ZEROINIT );<br/><br/>    idJDBReturn = JDB_OpenTable(hUser, NID_F570836, 0, NULL, (ushort) 0,  (JCHAR *) NULL, &hReqF570836); //Abre Cabeçalho das Regras<br/><br/>    if (idJDBReturn != JDEDB_PASSED) <br/>    {<br/><br/>        lpDS-&gtcErro = 'S';<br/>        jdeStrcpyAndTerminate(lpDS-&gtszMsgRetorno, _J("Não conseguiu abrir a tabela F570836 !!!"), DIM(lpDS-&gtszMsgRetorno));<br/>        JDB_CloseTable( hReqF570836 );        <br/>        JDB_FreeBhvr( hUser );<br/>        return ER_ERROR;<br/><br/>    }<br/><br/><br/>    idJDBReturn = JDB_OpenTable(hUser, NID_F570836A, 0, NULL, (ushort) 0,  (JCHAR *) NULL, &hReqF570836A); //Abre o Detalhe das Regras<br/><br/>    if (idJDBReturn != JDEDB_PASSED) {<br/><br/>         lpDS-&gtcErro = 'S';<br/>         jdeStrcpyAndTerminate(lpDS-&gtszMsgRetorno, _J("Não conseguiu abrir a tabela F570836A !!!"), DIM(lpDS-&gtszMsgRetorno));<br/>         JDB_CloseTable( hReqF570836A );<br/>         JDB_FreeBhvr( hUser );         <br/>         return ER_ERROR;<br/><br/>    }<br/><br/>    //Seleciona todas as Regras do processo dentro do periodo de validade;<br/>	jdeNIDcpy( lpSelecaoRegras[0].Item1.szDict , NID_PDNM ); // Processo<br/>    jdeNIDcpy( lpSelecaoRegras[0].Item1.szTable , NID_F570836 );<br/>    lpSelecaoRegras[0].Item1.idInstance = 0;<br/>	lpSelecaoRegras[0].lpValue = &lpDS-&gtszProcesso;<br/>	lpSelecaoRegras[0].nValues = 1;<br/>    lpSelecaoRegras[0].nAndOr = JDEDB_ANDOR_AND;<br/>    lpSelecaoRegras[0].nCmp = JDEDB_CMP_EQ;<br/><br/>	jdeNIDcpy( lpSelecaoRegras[1].Item1.szDict , NID_ANMESENT ); // Inicio Validade Regra<br/>    jdeNIDcpy( lpSelecaoRegras[1].Item1.szTable , NID_F570836 );<br/>    lpSelecaoRegras[1].Item1.idInstance = 0;<br/>	lpSelecaoRegras[1].lpValue = &lpDS-&gtmnAnoMesProcessamento;<br/>	lpSelecaoRegras[1].nValues = 1;<br/>    lpSelecaoRegras[1].nAndOr = JDEDB_ANDOR_AND;<br/>    lpSelecaoRegras[1].nCmp = JDEDB_CMP_LE;<br/><br/>	jdeNIDcpy( lpSelecaoRegras[2].Item1.szDict , NID_ANMEEMI ); // Final Validade Regra<br/>    jdeNIDcpy( lpSelecaoRegras[2].Item1.szTable , NID_F570836 );<br/>    lpSelecaoRegras[2].Item1.idInstance = 0;<br/>	lpSelecaoRegras[2].lpValue = &lpDS-&gtmnAnoMesProcessamento;<br/>	lpSelecaoRegras[2].nValues = 1;<br/>    lpSelecaoRegras[2].nAndOr = JDEDB_ANDOR_AND;<br/>    lpSelecaoRegras[2].nCmp = JDEDB_CMP_GE;<br/><br/>    idJDBReturn = JDB_SetSelection(hReqF570836, lpSelecaoRegras, 3, JDEDB_SET_REPLACE);<br/>    <br/>    if (idJDBReturn != JDEDB_PASSED) {<br/><br/>        lpDS-&gtcErro = 'S';<br/>        jdeStrcpyAndTerminate(lpDS-&gtszMsgRetorno, _J("Não conseguiu setar a seleção de dados na F570836 !!!"), DIM(lpDS-&gtszMsgRetorno));<br/>        return ER_ERROR;<br/><br/>    }<br/><br/>    idJDBReturn = JDB_SelectKeyed(hReqF570836, (ID)(0), (void *) NULL, (short)(0));<br/><br/>    if (idJDBReturn != JDEDB_PASSED) {<br/><br/>        lpDS-&gtcErro = 'S';<br/>        jdeStrcpyAndTerminate(lpDS-&gtszMsgRetorno, _J("Não conseguiu executar a seleção de dados na F570836 !!!"), DIM(lpDS-&gtszMsgRetorno));<br/>        return ER_ERROR;<br/><br/>    }<br/><br/>    while(JDB_Fetch( hReqF570836 , &dsF570836 , 0 )) {<br/>    <br/>        jdeStrcpyAndTerminate( dsChaveF570836A.dbpdnm, lpDS-&gtszProcesso, DIM(dsChaveF570836A.dbpdnm) ); // Nome Processo<br/>        jdeStrcpyAndTerminate( dsChaveF570836A.dbalph, dsF570836.cbalph, DIM(dsChaveF570836A.dbalph) ); // Nome Regra<br/>        MathCopy( &dsChaveF570836A.dbanmesent, &dsF570836.cbanmesent); // Inicio da Vigencia<br/>        MathCopy( &dsChaveF570836A.dbanmeemi, &dsF570836.cbanmeemi); // Fim da Vigencia<br/><br/>        if ( iNumRegras &gt 0 ) {<br/><br/>            BufferRegras = jdeReAllocEx(lpRegras-&gtRegras, (iNumRegras + 1) * sizeof(dsRegra));<br/>            if ( BufferRegras != NULL ) <br/>            {<br/><br/>                lpRegras-&gtRegras = BufferRegras;<br/><br/>            } else {<br/><br/>                lpDS-&gtcErro = 'S';<br/>                jdeStrcpyAndTerminate(lpDS-&gtszMsgRetorno, _J("Não conseguiu realocar memoria !!!"), DIM(lpDS-&gtszMsgRetorno));<br/>                return ER_ERROR;<br/><br/>            }<br/><br/>        } else {<br/><br/>            lpRegras-&gtRegras = jdeAlloc( COMMON_POOL, sizeof(dsRegra), MEM_ZEROINIT );      <br/><br/>        }<br/>        <br/>        MathNumericToInt( &dsF570836.cbcntf, &iTamanhoSel );<br/>        lpRegras-&gtRegras[iNumRegras].lpSelect = jdeAlloc( COMMON_POOL, iTamanhoSel*sizeof(NESTEDSELECTSTRUCT), MEM_ZEROINIT | MEM_RESIZEABLE );<br/><br/>        jdeStrncpyTerminate( lpRegras-&gtRegras[iNumRegras].szNomeRegra, dsF570836.cbalph, DIM(dsF570836.cbalph) );<br/>        idJDBReturn = I570830_BuscaDataSource( hUser, lpDS-&gtszProcesso, (JCHAR*)szDataSource);<br/><br/>        if (idJDBReturn != ER_SUCCESS) {<br/><br/>            lpDS-&gtcErro = 'S';<br/>            jdeStrcpyAndTerminate(lpDS-&gtszMsgRetorno, _J("Não conseguiu carregar o DataSource da regra : "), DIM(lpDS-&gtszMsgRetorno));<br/>            jdeStrcat( lpDS-&gtszMsgRetorno, dsF570836.cbalph);<br/>            jdeStrcat( lpDS-&gtszMsgRetorno, _J(" !!!"));<br/>            return ER_ERROR;<br/><br/>        }<br/><br/>        jdeStrcpyAndTerminate( lpRegras-&gtRegras[iNumRegras].szDataSource, szDataSource, DIM(szDataSource));<br/>        //<br/>        idJDBReturn = I570830_MontaSelectRegra ( dsChaveF570836A, hReqF570836A, lpRegras-&gtRegras[iNumRegras].lpSelect, &lpRegras-&gtRegras[iNumRegras].nTamanhoSelecao, lpDS-&gtszCasoEspecial );<br/>        //<br/>        lpRegras-&gtRegras[iNumRegras].nTamanhoSelecaoOriginal = lpRegras-&gtRegras[iNumRegras].nTamanhoSelecao;<br/>        lpRegras-&gtRegras[iNumRegras].nNpeOriginal = lpRegras-&gtRegras[iNumRegras].lpSelect[0].parenCount;<br/>        lpRegras-&gtRegras[iNumRegras].nNpdOriginal = lpRegras-&gtRegras[iNumRegras].lpSelect[lpRegras-&gtRegras[iNumRegras].nTamanhoSelecao - 1].parenCount;<br/><br/>        if (idJDBReturn != ER_SUCCESS) {<br/><br/>            lpDS-&gtcErro = 'S';<br/>            jdeStrcpyAndTerminate(lpDS-&gtszMsgRetorno, _J("Não conseguiu carregar a regra : "), DIM(lpDS-&gtszMsgRetorno));<br/>            jdeStrcat( lpDS-&gtszMsgRetorno, dsF570836.cbalph);<br/>            jdeStrcat( lpDS-&gtszMsgRetorno, _J(" !!!"));<br/>            JDB_CloseTable(hReqF570836);<br/>            JDB_CloseTable(hReqF570836A);<br/>            JDB_FreeBhvr( hUser );<br/>            return ER_ERROR;<br/><br/>        }<br/><br/>        iNumRegras++;<br/><br/>    }<br/>    <br/>    //Monta Indice das regras<br/>    lpRegras-&gthash = jdeAlloc( COMMON_POOL, sizeof(dsHash), MEM_ZEROINIT );<br/>    lpRegras-&gthash-&gtTamanho = iNumRegras + 1;<br/>    lpRegras-&gthash-&gtChaves = jdeAlloc( COMMON_POOL, (lpRegras-&gthash-&gtTamanho)*(sizeof(JCHAR*)), MEM_ZEROINIT );<br/>    for ( iCont = 0;  iCont &lt lpRegras-&gthash-&gtTamanho; iCont++ ) {<br/>        lpRegras-&gthash-&gtChaves[iCont] = jdeAlloc( COMMON_POOL, (sizeof(JCHAR)*41), MEM_ZEROINIT );<br/>    }<br/>    lpRegras-&gthash-&gtPosicoes = jdeAlloc( COMMON_POOL, (lpRegras-&gthash-&gtTamanho)*(sizeof(int)), MEM_ZEROINIT );<br/><br/>    for (iCont = 0; iCont &lt iNumRegras; iCont++) {<br/>    <br/>        I570830_HashInsert( lpRegras-&gthash, lpRegras-&gtRegras[iCont].szNomeRegra, iCont);<br/><br/>    }<br/><br/>   /************************************************************************ <br/>    * Function Clean Up <br/>    ************************************************************************/ <br/>    lpDS-&gtidRegras = jdeStoreDataPtr( hUser,  lpRegras);<br/>    IntToMathNumeric( iNumRegras, &lpDS-&gtmnNumRegras );<br/>    JDB_CloseTable(hReqF570836);<br/>    JDB_CloseTable(hReqF570836A);<br/>    JDB_FreeBhvr( hUser );<br/>    return (ER_SUCCESS); <br/>} <br/><br/>JDEBFRTN (ID) JDEBFWINAPI FinalizaRegras (LPBHVRCOM lpBhvrCom, LPVOID lpVoid, LPDSD570830C lpDS) {<br/><br/>    HUSER				hUser							= (HUSER)NULL;<br/>    dsRegras            *lpRegras                       = NULL; <br/>    ID					idJDBReturn		            	= JDEDB_PASSED;<br/>    short               nNumRegras                      = 0;<br/>    short               nTamSelecao                     = 0;<br/><br/>   /************************************************************************ <br/>    * Check for NULL pointers <br/>    ************************************************************************/ <br/>   if ((lpBhvrCom == (LPBHVRCOM) NULL) || <br/>       (lpVoid    == (LPVOID)    NULL) || <br/>       (lpDS      == (LPDSD570830C)	NULL)) <br/>   { <br/>     jdeErrorSet (lpBhvrCom, lpVoid, (ID) 0, _J("4363"), (LPVOID) NULL); <br/>     return ER_ERROR; <br/>   } <br/> <br/>   /************************************************************************ <br/>    * Main Processing <br/>    ************************************************************************/ <br/><br/>    idJDBReturn = JDB_InitBhvr( lpBhvrCom , &hUser , NULL , JDEDB_COMMIT_AUTO );<br/><br/>    if (idJDBReturn != JDEDB_PASSED) {<br/><br/>        lpDS-&gtcErro = 'S';<br/>        jdeStrcpyAndTerminate( lpDS-&gtszMsgRetorno, _J("Não conseguiu inicializar o ambiente !!!"), DIM(lpDS-&gtszMsgRetorno) );<br/>        return ER_ERROR;<br/><br/>    }<br/><br/>    lpRegras = jdeRetrieveDataPtr( hUser, lpDS-&gtidRegras );<br/><br/>    if ( lpRegras != NULL ) {<br/><br/>        for ( nNumRegras = 0; nNumRegras &lt lpRegras-&gthash-&gtTamanho; nNumRegras++) {<br/><br/>            for ( nTamSelecao = 0; nTamSelecao &lt lpRegras-&gtRegras-&gtnTamanhoSelecao; nTamSelecao++ )   {<br/><br/>                jdeFree( lpRegras-&gtRegras[nNumRegras].lpSelect[nTamSelecao].lpValue );<br/><br/>            }<br/>        <br/><br/>        }<br/><br/>        jdefree( lpRegras-&gtRegras-&gtlpSelect );   <br/>        jdefree( lpRegras-&gthash-&gtChaves );   <br/>        jdefree( lpRegras-&gthash-&gtPosicoes );   <br/>        jdefree( lpRegras );<br/><br/>        jdeRemoveDataPtr( hUser, lpDS-&gtidRegras  );<br/><br/>    }<br/><br/>    JDB_FreeBhvr( hUser );<br/>   /************************************************************************ <br/>    * Function Clean Up <br/>    ************************************************************************/ <br/>    return ( ER_SUCCESS );<br/><br/>}<br/><br/>JDEBFRTN (ID) JDEBFWINAPI CriaRegra (LPBHVRCOM lpBhvrCom, LPVOID lpVoid, LPDSD570830O lpDS) {<br/><br/>    HUSER				hUser							= (HUSER)NULL;<br/>    dsRegras            *lpRegras                       = NULL; <br/>    ID					idJDBReturn		            	= JDEDB_PASSED;<br/><br/>   /************************************************************************ <br/>    * Check for NULL pointers <br/>    ************************************************************************/ <br/>   if ((lpBhvrCom == (LPBHVRCOM) NULL) || <br/>       (lpVoid    == (LPVOID)    NULL) || <br/>       (lpDS      == (LPDSD570830O)	NULL)) <br/>   { <br/>     jdeErrorSet (lpBhvrCom, lpVoid, (ID) 0, _J("4363"), (LPVOID) NULL); <br/>     return ER_ERROR; <br/>   } <br/> <br/>   /************************************************************************ <br/>    * Main Processing <br/>    ************************************************************************/ <br/><br/>    idJDBReturn = JDB_InitBhvr( lpBhvrCom , &hUser , NULL , JDEDB_COMMIT_AUTO );<br/><br/>    if (idJDBReturn != JDEDB_PASSED) {<br/><br/>        lpDS-&gtcErro = 'S';<br/>        jdeStrcpyAndTerminate( lpDS-&gtszMsgRetorno, _J("Não conseguiu inicializar o ambiente !!!"), DIM(lpDS-&gtszMsgRetorno) );<br/>        return ER_ERROR;<br/><br/>    }<br/>    <br/>    lpRegras = jdeAlloc( COMMON_POOL, sizeof(dsRegras), MEM_ZEROINIT );<br/>    lpRegras-&gtRegras = jdeAlloc( COMMON_POOL, sizeof(dsRegra), MEM_ZEROINIT );      <br/><br/>    jdeStrcpyAndTerminate( lpRegras-&gtRegras[0].szNomeRegra, lpDS-&gtszNomeRegra, DIM(lpDS-&gtszNomeRegra));        <br/>    jdeStrcpyAndTerminate( lpRegras-&gtRegras[0].szDataSource, lpDS-&gtszDataSource, DIM(lpDS-&gtszDataSource));<br/><br/>    //Monta Indice das regras<br/>    lpRegras-&gthash = jdeAlloc( COMMON_POOL, sizeof(dsHash), MEM_ZEROINIT );<br/>    lpRegras-&gthash-&gtTamanho = 1;<br/>    lpRegras-&gthash-&gtChaves = jdeAlloc( COMMON_POOL, sizeof(JCHAR*), MEM_ZEROINIT );<br/>    lpRegras-&gthash-&gtChaves[0] = jdeAlloc( COMMON_POOL, (sizeof(JCHAR)*41), MEM_ZEROINIT );   <br/>    lpRegras-&gthash-&gtPosicoes = jdeAlloc( COMMON_POOL, sizeof(int), MEM_ZEROINIT );<br/>    I570830_HashInsert( lpRegras-&gthash, lpRegras-&gtRegras[0].szNomeRegra, 0);  <br/><br/>    lpDS-&gtidRegras = jdeStoreDataPtr( hUser, lpRegras );<br/><br/>   /************************************************************************ <br/>    * Function Clean Up <br/>    ************************************************************************/ <br/>    JDB_FreeBhvr( hUser );<br/>    return ( ER_SUCCESS );<br/><br/>}<br/><br/>JDEBFRTN (ID) JDEBFWINAPI ResetaSelecaoCursor (LPBHVRCOM lpBhvrCom, LPVOID lpVoid, LPDSD570830P lpDS) {<br/><br/>    HUSER				hUser							= (HUSER)NULL;<br/>    dsRegras            *lpRegras                       = NULL; <br/>    ID					idJDBReturn		            	= JDEDB_PASSED;<br/>    unsigned short      nNumSelecao                     = 0; <br/>    unsigned short      nCont                           = 0;<br/>    int                 nNumRegra                       = 0;<br/><br/>   /************************************************************************ <br/>    * Check for NULL pointers <br/>    ************************************************************************/ <br/>   if ((lpBhvrCom == (LPBHVRCOM) NULL) || <br/>       (lpVoid    == (LPVOID)    NULL) || <br/>       (lpDS      == (LPDSD570830P)	NULL)) <br/>   { <br/>     jdeErrorSet (lpBhvrCom, lpVoid, (ID) 0, _J("4363"), (LPVOID) NULL); <br/>     return ER_ERROR; <br/>   } <br/> <br/>   /************************************************************************ <br/>    * Main Processing <br/>    ************************************************************************/ <br/><br/>    idJDBReturn = JDB_InitBhvr( lpBhvrCom , &hUser , NULL , JDEDB_COMMIT_AUTO );<br/><br/>    if (idJDBReturn != JDEDB_PASSED) {<br/><br/>        lpDS-&gtcErro = 'S';<br/>        jdeStrcpyAndTerminate( lpDS-&gtszMsgRetorno, _J("Não conseguiu inicializar o ambiente !!!"), DIM(lpDS-&gtszMsgRetorno) );<br/>        return ER_ERROR;<br/><br/>    }<br/><br/>    lpRegras = jdeRetrieveDataPtr( hUser, lpDS-&gtidRegras );<br/><br/>    if ( lpRegras == NULL ) {<br/><br/>        lpDS-&gtcErro = 'S';<br/>        jdeStrcpyAndTerminate(lpDS-&gtszMsgRetorno, _J("Não conseguiu carregar a regra !!!"), DIM(lpDS-&gtszMsgRetorno));<br/>        JDB_FreeBhvr( hUser );<br/>        return ER_ERROR;<br/><br/>    }<br/><br/>    if ( !jdeIsBlankOrNull(lpDS-&gtszNomeRegra) ) {<br/>        <br/>        jdeStrcpyFillBlankAndTerminate(lpDS-&gtszNomeRegra, lpDS-&gtszNomeRegra, DIM(lpDS-&gtszNomeRegra));<br/>        nNumRegra = I570830_HashLookup( lpRegras-&gthash, lpDS-&gtszNomeRegra );<br/><br/>        if ( nNumRegra &lt 0 ) <br/>        {<br/><br/>            lpDS-&gtcErro = 'S';<br/>            jdeStrcpyAndTerminate(lpDS-&gtszMsgRetorno, _J("Não conseguiu achar a regra !!!"), DIM(lpDS-&gtszMsgRetorno));<br/>            JDB_FreeBhvr( hUser );<br/>            return ER_ERROR;<br/><br/>        }<br/><br/>    } else {<br/><br/>        MathNumericToInt( &lpDS-&gtmnNumRegra, &nNumRegra );<br/><br/>    }<br/><br/>    nNumSelecao = lpRegras-&gtRegras[nNumRegra].nTamanhoSelecao;    <br/><br/>    if ( nNumSelecao &gt 1 )  {<br/><br/>        for (nCont = 0; nCont &lt nNumSelecao; nCont++ )<br/>        {<br/><br/>            jdeFree ( lpRegras-&gtRegras[nNumRegra].lpSelect[nCont].lpValue );<br/><br/>        }                     <br/><br/>        lpRegras-&gtRegras[nNumRegra].nTamanhoSelecao = 0;<br/><br/>    }<br/><br/><br/>   /************************************************************************ <br/>    * Function Clean Up <br/>    ************************************************************************/ <br/>    JDB_FreeBhvr( hUser );<br/>    return ( ER_SUCCESS );<br/><br/>}<br/><br/>/************************************************************************** <br/> *  Business Function:  ModificaCampoSelecao <br/> * <br/> *        Description:  Abre o Cursor para uma regra especifica<br/> * <br/> *         Parameters: <br/> *           LPBHVRCOM           lpBhvrCom    Business Function Communications <br/> *           LPVOID              lpVoid       Void Parameter - DO NOT USE! <br/> *           LPDSD570            lpDS         Parameter Data Structure Pointer   <br/> * <br/> *************************************************************************/ <br/><br/>JDEBFRTN (ID) JDEBFWINAPI BuscaCampoSelecao                (LPBHVRCOM lpBhvrCom, LPVOID lpVoid, LPDSD570830Q lpDS) { <br/><br/>   /************************************************************************ <br/>    *  Variable declarations <br/>    ************************************************************************/ <br/>    HUSER				 hUser							= (HUSER)NULL;<br/>    ID					 idJDBReturn		            = JDEDB_PASSED;    <br/>    dsRegras             *lpRegras                      = NULL; <br/>    int                  nNumRegra                      = 0;<br/>    int                  nNumCampo                      = 0;<br/>    LPNESTEDSELECTSTRUCT lpSelecao                      = NULL;     <br/>   /************************************************************************ <br/>    * Check for NULL pointers <br/>    ************************************************************************/ <br/><br/>   if ((lpBhvrCom == (LPBHVRCOM) NULL) || <br/>       (lpVoid    == (LPVOID)    NULL) || <br/>       (lpDS      == (LPDSD570830Q)	NULL)) <br/>   { <br/>     jdeErrorSet (lpBhvrCom, lpVoid, (ID) 0, _J("4363"), (LPVOID) NULL); <br/>     return ER_ERROR ;<br/>   } <br/> <br/>   /************************************************************************ <br/>    * Main Processing <br/>    ************************************************************************/ <br/>    idJDBReturn = JDB_InitBhvr( lpBhvrCom , &hUser , NULL , JDEDB_COMMIT_AUTO );<br/><br/>    if (idJDBReturn != JDEDB_PASSED) <br/>    {<br/><br/>        lpDS-&gtcErro = 'S';<br/>        jdeStrcpyAndTerminate(lpDS-&gtszMsgRetorno, _J("Não conseguiu inicializar o ambiente !!!"), DIM(lpDS-&gtszMsgRetorno));<br/>        return ER_ERROR;<br/><br/>    }<br/><br/>    lpRegras = jdeRetrieveDataPtr( hUser, lpDS-&gtidRegras );<br/><br/>    if ( lpRegras == NULL ) {<br/><br/>        lpDS-&gtcErro = 'S';<br/>        jdeStrcpyAndTerminate(lpDS-&gtszMsgRetorno, _J("Não conseguiu carregar a regra !!!"), DIM(lpDS-&gtszMsgRetorno));<br/>        JDB_FreeBhvr( hUser );<br/>        return ER_ERROR;<br/><br/>    }<br/><br/><br/>    if ( !jdeIsBlankOrNull(lpDS-&gtszNomeRegra) ) {<br/>        <br/>        jdeStrcpyFillBlankAndTerminate(lpDS-&gtszNomeRegra, lpDS-&gtszNomeRegra, DIM(lpDS-&gtszNomeRegra));<br/>        nNumRegra = I570830_HashLookup( lpRegras-&gthash, lpDS-&gtszNomeRegra );<br/><br/>        if ( nNumRegra &lt 0 ) <br/>        {<br/><br/>            lpDS-&gtcErro = 'S';<br/>            jdeStrcpyAndTerminate(lpDS-&gtszMsgRetorno, _J("Não conseguiu achar a regra !!!"), DIM(lpDS-&gtszMsgRetorno));<br/>            JDB_FreeBhvr( hUser );<br/>            return ER_ERROR;<br/><br/>        }<br/><br/>    } else {<br/><br/>        MathNumericToInt( &lpDS-&gtmnNumRegra, &nNumRegra );<br/><br/>    }<br/><br/>    lpSelecao = lpRegras-&gtRegras[nNumRegra].lpSelect;<br/><br/>    if ( lpSelecao == NULL )<br/>    {<br/><br/>        lpDS-&gtcErro = 'S';<br/>        jdeStrcpyAndTerminate(lpDS-&gtszMsgRetorno, _J("Regra não tem selecao !!!"), DIM(lpDS-&gtszMsgRetorno));<br/>        JDB_FreeBhvr( hUser );<br/>        return ER_ERROR;<br/><br/>    }<br/><br/>	MathNumericToInt( &lpDS-&gtmnNumCampo, &nNumCampo );<br/><br/>	if ( ( nNumCampo &gt lpRegras-&gtRegras[nNumRegra].nTamanhoSelecao ) || ( nNumCampo &lt 0 ) ) {<br/><br/>        lpDS-&gtcErro = 'S';<br/>        jdeStrcpyAndTerminate(lpDS-&gtszMsgRetorno, _J("Campo Invalido"), DIM(lpDS-&gtszMsgRetorno));<br/>        JDB_FreeBhvr( hUser );<br/>        return ER_ERROR;<br/><br/>	}<br/><br/>    jdeStrcpyAndTerminate( lpDS-&gtszTabela, lpSelecao[nNumCampo].Item1.szTable, DIM(lpDS-&gtszTabela) );<br/>    jdeStrcpyAndTerminate( lpDS-&gtszCampo, lpSelecao[nNumCampo].Item1.szDict, DIM(lpDS-&gtszCampo) );<br/><br/>    //jdeStrcpyAndTerminate( lpDS-&gtszValorString, , DIM(lpDS-&gtszValorString) );<br/><br/>    if (lpSelecao[nNumCampo].nValues == 1) {<br/><br/>		if ( lpSelecao[nNumCampo].nCmp == JDEDB_CMP_EQ ) {<br/>          <br/>			jdeStrcpyAndTerminate( lpDS-&gtszOperador, _J("="), DIM(lpDS-&gtszOperador) );<br/><br/>        } else if ( lpSelecao[nNumCampo].nCmp == JDEDB_CMP_NE ) {<br/><br/>			jdeStrcpyAndTerminate( lpDS-&gtszOperador, _J("&lt&gt"), DIM(lpDS-&gtszOperador) );<br/><br/>        } else if ( lpSelecao[nNumCampo].nCmp == JDEDB_CMP_GT ) {<br/><br/>			jdeStrcpyAndTerminate( lpDS-&gtszOperador, _J("&gt"), DIM(lpDS-&gtszOperador) ); <br/><br/>        } else if ( lpSelecao[nNumCampo].nCmp == JDEDB_CMP_LT ) {<br/><br/>			jdeStrcpyAndTerminate( lpDS-&gtszOperador, _J("&lt"), DIM(lpDS-&gtszOperador) ); <br/><br/>        } else if ( lpSelecao[nNumCampo].nCmp == JDEDB_CMP_GE ) {<br/><br/>			jdeStrcpyAndTerminate( lpDS-&gtszOperador, _J("&gt="), DIM(lpDS-&gtszOperador) );<br/><br/>        } else if ( lpSelecao[nNumCampo].nCmp == JDEDB_CMP_LE ) {<br/><br/>			jdeStrcpyAndTerminate( lpDS-&gtszOperador, _J("&lt="), DIM(lpDS-&gtszOperador) );<br/><br/>        }<br/><br/>	} else {<br/><br/>		if ( lpSelecao[nNumCampo].nCmp == JDEDB_CMP_IN ) {<br/><br/>			jdeStrcpyAndTerminate( lpDS-&gtszOperador, _J("="), DIM(lpDS-&gtszOperador) ); <br/><br/>		} else if ( lpSelecao[nNumCampo].nCmp == JDEDB_CMP_NI ) {<br/><br/>			jdeStrcpyAndTerminate( lpDS-&gtszOperador, _J("&lt&gt"), DIM(lpDS-&gtszOperador) ); 			<br/><br/>        }<br/><br/>    }<br/>    <br/>	if ( lpSelecao[nNumCampo].nAndOr == JDEDB_ANDOR_AND ) {<br/><br/>		jdeStrcpyAndTerminate( lpDS-&gtszEouOU, _J("E") , DIM(lpDS-&gtszOperador) );<br/><br/>    } else if ( lpSelecao[nNumCampo].nAndOr == JDEDB_ANDOR_AND ) {<br/><br/>		jdeStrcpyAndTerminate( lpDS-&gtszEouOU, _J("OU") , DIM(lpDS-&gtszOperador) );<br/><br/>    }<br/><br/>    if ( lpSelecao[nNumCampo].nParen == JDEDB_PAREN_OPEN ) {<br/><br/>		lpDS-&gtcParenteseEsquerdo = _J('(');<br/>		IntToMathNumeric( lpSelecao[nNumCampo].parenCount, &lpDS-&gtmnNumParEsquerda );<br/><br/>	} else if ( lpSelecao[nNumCampo].nParen == JDEDB_PAREN_CLOSE ) {<br/><br/>	    lpDS-&gtcParenteseDireito = _J(')');<br/>		IntToMathNumeric( lpSelecao[nNumCampo].parenCount, &lpDS-&gtmnNumParDireita );<br/><br/>	}<br/><br/>    JDB_FreeBhvr( hUser );<br/>    return ER_SUCCESS;<br/><br/>}<br/><br/>/************************************************************************** <br/> *  Business Function:  AdcionaOrdenacaoRegra <br/> * <br/> *        Description:  Abre o Cursor para uma regra especifica<br/> * <br/> *         Parameters: <br/> *           LPBHVRCOM           lpBhvrCom    Business Function Communications <br/> *           LPVOID              lpVoid       Void Parameter - DO NOT USE! <br/> *           LPDSD570            lpDS         Parameter Data Structure Pointer   <br/> * <br/> *************************************************************************/ <br/><br/>JDEBFRTN (ID) JDEBFWINAPI AdcionaOrdenacaoRegra             (LPBHVRCOM lpBhvrCom, LPVOID lpVoid, LPDSD570830R lpDS) {<br/><br/>   /************************************************************************ <br/>    *  Variable declarations <br/>    ************************************************************************/ <br/>    HUSER				 hUser							= (HUSER)NULL;<br/>    ID					 idJDBReturn		            = JDEDB_PASSED;    <br/>    dsRegras             *lpRegras                      = NULL; <br/>    int                  nNumRegra                      = 0;<br/>    short                nNumSelecao                    = 0; <br/><br/>   /************************************************************************ <br/>    * Check for NULL pointers <br/>    ************************************************************************/ <br/>   if ((lpBhvrCom == (LPBHVRCOM) NULL) || <br/>       (lpVoid    == (LPVOID)    NULL) || <br/>       (lpDS      == (LPDSD570830R)	NULL)) <br/>   { <br/>     jdeErrorSet (lpBhvrCom, lpVoid, (ID) 0, _J("4363"), (LPVOID) NULL); <br/>     return ER_ERROR; <br/>   } <br/> <br/>   /************************************************************************ <br/>    * Main Processing <br/>    ************************************************************************/ <br/>    idJDBReturn = JDB_InitBhvr( lpBhvrCom , &hUser , NULL , JDEDB_COMMIT_AUTO );<br/><br/>    if (idJDBReturn != JDEDB_PASSED) <br/>    {<br/><br/>        lpDS-&gtcErro = 'S';<br/>        jdeStrcpyAndTerminate(lpDS-&gtszMsgRetorno, _J("Não conseguiu inicializar o ambiente !!!"), DIM(lpDS-&gtszMsgRetorno));<br/>        return ER_ERROR;<br/><br/>    }<br/><br/>    lpRegras = jdeRetrieveDataPtr( hUser, lpDS-&gtidRegras );<br/><br/>    if ( !jdeIsBlankOrNull(lpDS-&gtszNomeRegra) ) {<br/>        <br/>        jdeStrcpyFillBlankAndTerminate(lpDS-&gtszNomeRegra, lpDS-&gtszNomeRegra, DIM(lpDS-&gtszNomeRegra));<br/>        nNumRegra = I570830_HashLookup( lpRegras-&gthash, lpDS-&gtszNomeRegra );<br/><br/>        if ( nNumRegra &lt 0 ) <br/>        {<br/><br/>            lpDS-&gtcErro = 'S';<br/>            jdeStrcpyAndTerminate(lpDS-&gtszMsgRetorno, _J("Não conseguiu achar a regra !!!"), DIM(lpDS-&gtszMsgRetorno));<br/>            JDB_FreeBhvr( hUser );<br/>            return ER_ERROR;<br/><br/>        }<br/><br/>    } else {<br/><br/>        MathNumericToInt( &lpDS-&gtmnNumRegra, &nNumRegra );<br/><br/>    }<br/><br/>    if ( lpRegras == NULL ) {<br/><br/>        lpDS-&gtcErro = 'S';<br/>        jdeStrcpyAndTerminate(lpDS-&gtszMsgRetorno, _J("Não conseguiu carregar a regra !!!"), DIM(lpDS-&gtszMsgRetorno));<br/>        JDB_FreeBhvr( hUser );<br/>        return ER_ERROR;<br/><br/>    }<br/><br/>    /*if ( lpDS-&gtcReseta == _J('S')) {<br/><br/>        nNumSelecao = lpRegras-&gtRegras[nNumRegra].nTamanhoOrdenacaoOriginal;            <br/><br/>        if ( nNumSelecao &lt lpRegras-&gtRegras[nNumRegra].nTamanhoOrdenacao) {<br/><br/>            lpRegras-&gtRegras[nNumRegra].nTamanhoOrdenacao = nNumSelecao;            <br/>            lpRegras-&gtRegras[nNumRegra].lpSort = jdeReAllocEx(lpRegras-&gtRegras[nNumRegra].lpSort, (nNumSelecao) * sizeof(SORTSTRUCT));            <br/><br/>            if ( lpRegras-&gtRegras[nNumRegra].lpSort == NULL ) {                <br/><br/>                lpDS-&gtcErro = 'S';                <br/>                jdeStrcpyAndTerminate(lpDS-&gtszMsgRetorno, _J("Não conseguiu realocar memoria !!!"), DIM(lpDS-&gtszMsgRetorno));                <br/>                JDB_FreeBhvr( hUser );                    <br/>                return ER_ERROR;            <br/>            }        <br/><br/>        }        <br/><br/>    }*/<br/><br/>    if ( lpDS-&gtcReseta == _J('S')) {<br/><br/>        lpRegras-&gtRegras[nNumRegra].lpSort = jdeReAllocEx(lpRegras-&gtRegras[nNumRegra].lpSort, sizeof(SORTSTRUCT));<br/>        lpRegras-&gtRegras[nNumRegra].nTamanhoOrdenacao = 1;            <br/><br/>    } else {<br/><br/>        nNumSelecao = lpRegras-&gtRegras[nNumRegra].nTamanhoOrdenacao;<br/>        lpRegras-&gtRegras[nNumRegra].lpSort = jdeReAllocEx(lpRegras-&gtRegras[nNumRegra].lpSort, (nNumSelecao+1) * sizeof(SORTSTRUCT));<br/><br/>    }<br/><br/>    <br/>    jdeNIDcpy(lpRegras-&gtRegras[nNumRegra].lpSort[nNumSelecao].Item.szDict, lpDS-&gtszCampo);<br/>    jdeNIDcpy(lpRegras-&gtRegras[nNumRegra].lpSort[nNumSelecao].Item.szTable, lpDS-&gtszTabela);<br/>    lpRegras-&gtRegras[nNumRegra].lpSort[nNumSelecao].Item.idInstance = (ID) 0;   <br/>    lpRegras-&gtRegras[nNumRegra].nTamanhoOrdenacao = nNumSelecao+1;            <br/>    switch (lpDS-&gtcAscendenteDescendente)<br/>    {<br/><br/>      case _J('A'):<br/>		  lpRegras-&gtRegras[nNumRegra].lpSort[nNumSelecao].nSort = JDEDB_SORT_ASC;<br/>		  break;<br/>      case _J('D'):<br/>		  lpRegras-&gtRegras[nNumRegra].lpSort[nNumSelecao].nSort = JDEDB_SORT_DESC;<br/>		  break;<br/>     <br/>    }<br/><br/>    JDB_FreeBhvr( hUser );<br/>    return ER_SUCCESS;<br/>};<br/><br/>/* Internal function comment block */<br/>ID I570830_MontaSelectRegra ( KEY1_F570836A dsChave, HREQUEST hF570836A, LPNESTEDSELECTSTRUCT lpSelecao, short *nTamanhoSelecao, JCHAR *CasoEspecial ) {<br/><br/>    ID					idJDBReturn		            	=  JDEDB_PASSED;<br/>    F570836A            dsRegistroF570836A              = {0};<br/>    short               nSequencia                      = 0;   <br/>    short               nNumItems                       = 0;    <br/><br/>    idJDBReturn = JDB_SelectKeyed(hF570836A, ID_F570836A_PK, &dsChave, 4);<br/><br/>    if (idJDBReturn != JDEDB_PASSED) return ER_ERROR;<br/><br/>    while ( JDB_Fetch(hF570836A, &dsRegistroF570836A, 0) ) {<br/><br/>        if (jdeStrcmp (dsRegistroF570836A.dbk70val, _J("TODOS")) == 0 ||<br/>            jdeStrcmp (dsRegistroF570836A.dbk70val, CasoEspecial) == 0) <br/>        {<br/><br/>            nNumItems = I570830_ContaElementos( dsRegistroF570836A.db55valu2, _J(','));<br/><br/>            jdeNIDcpy( lpSelecao[nSequencia].Item1.szDict , dsRegistroF570836A.dbclh1); // Campo<br/>            jdeNIDcpy( lpSelecao[nSequencia].Item1.szTable , dsRegistroF570836A.dbcmowt); // Tabela<br/>            lpSelecao[nSequencia].Item1.idInstance = 0;<br/>            lpSelecao[nSequencia].lpValue = I570830_CriaValor(dsRegistroF570836A.dbclh1, dsRegistroF570836A.db55valu2); // Valor<br/>            lpSelecao[nSequencia].nValues = nNumItems;<br/><br/>            if ( jdestrcmp( dsRegistroF570836A.dbaor1, _J("E") ) == 0 ) {<br/><br/>                lpSelecao[nSequencia].nAndOr = JDEDB_ANDOR_AND; // Operador Logico E<br/><br/>            } else if (jdestrcmp( dsRegistroF570836A.dbaor1, _J("OU") ) == 0) {<br/><br/>                lpSelecao[nSequencia].nAndOr = JDEDB_ANDOR_OR; // Operador Logico OU<br/><br/>            }<br/><br/>            if (nNumItems == 1) {<br/><br/>                if ( jdestrcmp(dsRegistroF570836A.dbblo, _J("=")) == 0 ) {<br/>            <br/>                    lpSelecao[nSequencia].nCmp = JDEDB_CMP_EQ; // igual<br/><br/>                } else if ( jdestrcmp(dsRegistroF570836A.dbblo, _J("&lt&gt")) == 0 ) {<br/><br/>                    lpSelecao[nSequencia].nCmp = JDEDB_CMP_NE; // diferente<br/><br/>                } else if ( jdestrcmp(dsRegistroF570836A.dbblo, _J("&gt")) == 0 ) {<br/><br/>                    lpSelecao[nSequencia].nCmp = JDEDB_CMP_GT; // maior<br/><br/>                } else if ( jdestrcmp(dsRegistroF570836A.dbblo, _J("&lt")) == 0 ) {<br/><br/>                    lpSelecao[nSequencia].nCmp = JDEDB_CMP_LT; // menor<br/><br/>                } else if ( jdestrcmp(dsRegistroF570836A.dbblo, _J("&gt=")) == 0 ) {<br/><br/>                    lpSelecao[nSequencia].nCmp = JDEDB_CMP_GE; // maior igual<br/><br/>                } else if ( jdestrcmp(dsRegistroF570836A.dbblo, _J("&lt=")) == 0 ) {<br/><br/>                    lpSelecao[nSequencia].nCmp = JDEDB_CMP_LE; // menor igual<br/><br/>                } else if ( jdestrcmp(dsRegistroF570836A.dbblo, _J("*")) == 0 ) {<br/><br/>                    lpSelecao[nSequencia].nCmp = JDEDB_CMP_LK; // like<br/><br/>                }<br/><br/>            } else {<br/><br/>                if ( jdestrcmp(dsRegistroF570836A.dbblo, _J("=")) == 0 ) {<br/><br/>                    lpSelecao[nSequencia].nCmp = JDEDB_CMP_IN; // em<br/><br/>                } else if ( jdestrcmp(dsRegistroF570836A.dbblo, _J("&lt&gt")) == 0 ) {<br/><br/>                    lpSelecao[nSequencia].nCmp = JDEDB_CMP_NI; // em<br/><br/>                }<br/><br/>            }<br/>            <br/>            if ( dsRegistroF570836A.db55pe == _J('(') && dsRegistroF570836A.db55pd != _J(')')) {<br/><br/>                lpSelecao[nSequencia].nParen = JDEDB_PAREN_OPEN; // Abre parentese<br/>                if ( MathZeroTest( &dsRegistroF570836A.db57npe ) != 0) {<br/><br/>                    lpSelecao[nSequencia].parenCount = (unsigned short)atoi(dsRegistroF570836A.db57npe.String);<br/><br/>                }<br/><br/>            }<br/><br/>            if ( dsRegistroF570836A.db55pe != _J('(') && dsRegistroF570836A.db55pd == _J(')')) {<br/><br/>                lpSelecao[nSequencia].nParen = JDEDB_PAREN_CLOSE; // Fecha parentese<br/>                if ( MathZeroTest( &dsRegistroF570836A.db57npd ) != 0) {<br/><br/>                    lpSelecao[nSequencia].parenCount = (unsigned short)atoi(dsRegistroF570836A.db57npd.String);<br/><br/>                }<br/><br/>            }<br/><br/>            if ( dsRegistroF570836A.db55pe == _J('(') && dsRegistroF570836A.db55pd == _J(')')) {<br/><br/>                lpSelecao[nSequencia].nParen = JDEDB_PAREN_NONE; <br/>                lpSelecao[nSequencia].parenCount = (unsigned short)0;<br/><br/>            }<br/><br/>         nSequencia++;<br/><br/>        }        <br/><br/>    }<br/><br/>    *nTamanhoSelecao = nSequencia;<br/><br/>    return ER_SUCCESS;<br/>}<br/><br/>void *I570830_CriaValor (JCHAR *szCampo, JCHAR *szValor) {<br/><br/>    DSDDINFO     *lpItemDados    = (DSDDINFO *)NULL; //Ponteiro para o item no dicionario de dados<br/>    JCHAR        *szValorLocal   = NULL; <br/>    MATH_NUMERIC *mnValorLocal   = NULL; <br/>    JDEDATE      *jdValorLocal   = NULL;<br/>    JCHAR        szValorItem[50] = {0};<br/>    JCHAR        szLista[350]    = {0};<br/>    JCHAR        *szTemp         = NULL;<br/>    MATH_NUMERIC mnTempMath      = {0};<br/>    JDEDATE      jdTempData      = {0};<br/>    int          iItem           = 0;<br/>    int          iNumItems       = 0;<br/>    int          iTamanho        = 0;<br/><br/>    lpItemDados = jdeDDCreate( NULL, szCampo, 0, NULL );<br/><br/>    if ( lpItemDados == NULL ) {<br/><br/>        return NULL;<br/><br/>    }<br/><br/>    iTamanho = lpItemDados-&gtlpGlobalCol-&gtnLength + 1;    <br/>    <br/>    if ( lpItemDados-&gtwStatus == 0 ) {       <br/>        <br/>        jdeStrcpyAndTerminate( szLista, szValor, jdeStrlen( szValor ) + 1);<br/>        iNumItems = I570830_ContaElementos( szLista, _J(',') );<br/><br/>        if ( lpItemDados-&gtlpGlobalCol-&gtidEverestType == EVDT_STRING ) {<br/><br/>            szValorLocal = jdeAlloc( COMMON_POOL, iNumItems * (iTamanho * sizeof(JCHAR)), MEM_ZEROINIT );            <br/><br/>        } else if ( lpItemDados-&gtlpGlobalCol-&gtidEverestType == EVDT_MATH_NUMERIC ) {<br/><br/>            mnValorLocal = jdeAlloc( COMMON_POOL, iNumItems * sizeof(MATH_NUMERIC), MEM_ZEROINIT );            <br/><br/>        } else if ( lpItemDados-&gtlpGlobalCol-&gtidEverestType == EVDT_CHAR ) {<br/><br/>            szValorLocal = jdeAlloc( COMMON_POOL, iNumItems * sizeof(JCHAR), MEM_ZEROINIT );            <br/><br/>        }  else if ( lpItemDados-&gtlpGlobalCol-&gtidEverestType == EVDT_JDEDATE ) {<br/><br/>            jdValorLocal = jdeAlloc( COMMON_POOL, iNumItems * sizeof(JDEDATE), MEM_ZEROINIT );            <br/><br/>        }<br/>        <br/>        szTemp = I570830_SeparaValores( (JCHAR *)szLista, _J(',') );<br/>        jdeStrcpy( szValorItem,  szTemp);<br/><br/>        if (jdestrcmp( szCampo, _J("MCU")) == 0) I570830_StrPadLeft( szValorItem, _J(" "), 12) ;<br/><br/>        jdeFree( szTemp );        <br/><br/>        while ( !jdeIsBlankOrNull(szValorItem) ) {            <br/><br/>		    if ( lpItemDados-&gtlpGlobalCol-&gtidEverestType == EVDT_STRING ) {<br/><br/>                if (iNumItems == 1) {<br/><br/>                    jdeStrncpy(szValorLocal, szValorItem, DIM( szValorItem ) );<br/><br/>                } else {<br/><br/>                    jdeStrcpyFillAndTerminate(szValorLocal + iItem * iTamanho, szValorItem, iTamanho, _J(' '));<br/><br/>                }                <br/><br/>            } else if ( lpItemDados-&gtlpGlobalCol-&gtidEverestType == EVDT_MATH_NUMERIC ) {<br/><br/>                ParseNumericString( &mnTempMath, szValorItem );<br/><br/>                MathCopy( &mnValorLocal[iItem], &mnTempMath);<br/><br/>            } else if ( lpItemDados-&gtlpGlobalCol-&gtidEverestType == EVDT_JDEDATE ) {<br/><br/>                JDEParseDate( szValorItem, NULL, &jdTempData );<br/><br/>                JDEDATECopy( &jdValorLocal[iItem], &jdTempData );                <br/><br/>            } else if ( lpItemDados-&gtlpGlobalCol-&gtidEverestType == EVDT_CHAR ) {<br/> <br/>                memcpy(&szValorLocal[iItem], &szValorItem[0], sizeof(JCHAR));<br/><br/>            }<br/><br/>            if ( !jdeIsBlankOrNull(szLista) )<br/>            {<br/><br/>                szTemp = I570830_SeparaValores( (JCHAR *)szLista, _J(',') );<br/>                jdeStrcpy( szValorItem,  szTemp);<br/>                if (jdestrcmp( szCampo, _J("MCU")) == 0) I570830_StrPadLeft( szValorItem, _J(" "), 12) ;<br/>                jdeFree( szTemp );<br/><br/>            } else {<br/><br/>                jdeStrcpy( szValorItem,  _J(" ") );<br/><br/>            }<br/><br/>            iItem++;<br/><br/>        }<br/><br/>    }<br/>   <br/>    if (( lpItemDados-&gtlpGlobalCol-&gtidEverestType == EVDT_STRING ) || ( lpItemDados-&gtlpGlobalCol-&gtidEverestType == EVDT_CHAR )) {<br/><br/>        jdeDDDestroy(lpItemDados);<br/>        return szValorLocal;<br/><br/>    } else if ( lpItemDados-&gtlpGlobalCol-&gtidEverestType == EVDT_MATH_NUMERIC ) {<br/><br/>        jdeDDDestroy(lpItemDados);<br/>        return mnValorLocal;<br/><br/>    } else if ( lpItemDados-&gtlpGlobalCol-&gtidEverestType == EVDT_JDEDATE ) {<br/><br/>        jdeDDDestroy(lpItemDados);<br/>        return jdValorLocal;<br/><br/>    } else {<br/><br/>        jdeDDDestroy(lpItemDados);<br/>        return NULL;<br/><br/>    }<br/><br/>};<br/><br/><br/>JCHAR *I570830_SeparaValores( JCHAR *szLista, JCHAR cSeparador ) {<br/><br/>  int          iTamanho            = 0;	<br/>  int          iPosicao            = 0;	<br/>  int          iPosicaoSaida       = 0;	<br/>  JCHAR        *szValorSaida       = NULL;	<br/>  JCHAR        szValorEntrada[350] = {0};	<br/>  JCHAR        cToken              = 0;	<br/>  JCHAR        cTokenBranco        = ' ';	<br/><br/>  iTamanho = jdeStrlen( szLista ) + 1;<br/>  jdeStrcpyAndTerminate ( szValorEntrada, szLista, iTamanho);<br/>  szValorSaida = jdeAlloc( COMMON_POOL, sizeof(JCHAR) * 350, MEM_ZEROINIT );<br/><br/>  /* Percorre a String Ate o Primeiro Caracter de Separacao */   <br/>  while ( cToken != cSeparador && iPosicao &lt iTamanho ) {	   <br/><br/>    /* AR - Obtem o Caractere  */	   <br/>    cToken = szLista[iPosicao];	   <br/>    if ( (cToken != cSeparador) /*&& (cToken != ' ') */<br/>          && (cToken != '\0' ) ) {		   <br/><br/>        /* AR - Copia o Caractere */		   <br/>        szValorSaida[iPosicaoSaida] = cToken;		   <br/>        /* AR - Limpa o Caractere da String */		   <br/>        szValorEntrada[iPosicao] = cTokenBranco;		   <br/>        /* AR - Incrementa a Posicao da Saida */		   <br/>        iPosicaoSaida++;	   <br/><br/>    } else {<br/><br/>        /* AR - Limpa o Caractere da String */		   <br/>        szValorEntrada[iPosicao] = cTokenBranco;	   <br/><br/>    }	<br/><br/>    /* AR - Incrementa a Posicao da String */		   <br/>    iPosicao++;  <br/><br/>  } <br/><br/>  /* AR - Elimina os Espacos em Branco */   <br/>  jdeStripTrailingBlanks(szValorEntrada);   <br/>  jdeStripBlanks(szValorEntrada);   <br/>  /* AR - Copia Valor Restante */   <br/>  jdeStrcpy( szLista , (const JCHAR *)szValorEntrada);   <br/><br/>  return szValorSaida;<br/><br/>};<br/><br/>short I570830_ContaElementos( JCHAR *szString, JCHAR cCaracter ) {<br/><br/>    int   iCont    = 0;<br/>    int   iTamanho = 0;<br/>    short iRep     = 0;<br/><br/>    iTamanho = jdeStrlen( szString );<br/><br/>    for ( iCont = 0; iCont &lt= iTamanho; iCont++ ) {<br/>        if ( szString[iCont] == cCaracter ) iRep++;<br/>        if ( szString[iCont] != cCaracter && iCont == iTamanho) iRep++;<br/>    }<br/><br/>    return iRep;<br/>};<br/><br/>void I570830_StrPadRight (JCHAR *lpszString, const JCHAR *szPad, size_t nLen) <br/>{<br/>   int      nCount   = 0;<br/>   int      nAfter   = 0;<br/>   int      nSize    = 0;<br/>   <br/>   nSize = jdeStrlen(lpszString);<br/>   nAfter = (nLen - nSize);<br/>   <br/>   if (nAfter &gt= 0)<br/>   {<br/>      for (nCount = 1; nCount &lt= nAfter; nCount++)<br/>      {<br/>         jdeStrcat ((JCHAR *)lpszString, (JCHAR *)szPad);<br/>      }<br/>   }<br/>   else<br/>   {<br/>      jdeStrncpy((JCHAR *)lpszString, (JCHAR *)lpszString, nLen);<br/>   }<br/><br/>   return;<br/><br/>}<br/><br/>void I570830_StrPadLeft (JCHAR *lpszString, const JCHAR *szPad, size_t nLen) <br/>{<br/>   /*----------------------------------------------------------------------<br/>    *    Variables<br/>    *----------------------------------------------------------------------*/<br/>   JCHAR     szS2[255] = _J("");<br/>   int      nCount   = 0;<br/>   int      nBefore  = 0;<br/>   int      nSize    = 0;<br/>   <br/>   /*----------------------------------------------------------------------<br/>    *    Main<br/>    *----------------------------------------------------------------------*/<br/>   nSize = jdeStrlen(lpszString);<br/>   nBefore = (nLen - nSize);<br/>   <br/>   if (nBefore &gt= 0)<br/>   {<br/>      for (nCount = 1; nCount &lt= nBefore; nCount++)<br/>      {<br/>         jdeStrcat ((JCHAR *)szS2,(JCHAR *)szPad);<br/>      }<br/>      jdeStrcat ((JCHAR *)szS2, (JCHAR *)lpszString);<br/>   }<br/>   else<br/>   {<br/>      jdeStrncpy((JCHAR *)szS2, (JCHAR *)lpszString, nLen);<br/>   }<br/>   <br/>   jdeStrcpy((JCHAR *)lpszString, (JCHAR *)szS2);<br/>   <br/>   /*----------------------------------------------------------------------<br/>    *    Clean Up<br/>    *----------------------------------------------------------------------*/<br/>   return;<br/><br/>}<br/><br/>ID    I570830_MontaParametros( HREQUEST hData, void **dsParametros, JCHAR *szNomeEstrutura) {<br/><br/>    LPDSTMPL        lpDstr	       = NULL; //Data Struct<br/>    LPDSTMPL_DTL    lpDstrDtl      = NULL; //Detalhe data struct<br/>    short           nNumParametros = 0;<br/>    short           nIndex         = 0;<br/>	DBREF			dsDbRef		   = { 0 };	<br/><br/>    lpDstr = jdeRTKAllocFetchDsTmpl ( szNomeEstrutura );		<br/><br/>    if ( lpDstr == NULL || lpDstr-&gtlpDsTmplDtl == NULL || lpDstr-&gtlpDsTmplHdr == NULL ) {<br/><br/>        return ER_ERROR;		<br/><br/>    } else {<br/><br/>        nNumParametros = lpDstr-&gtlpDsTmplHdr-&gtnDtlCount; <br/>        *dsParametros = jdeAlloc( COMMON_POOL, lpDstr-&gtlpDsTmplHdr-&gtulLengthVersData, MEM_ZEROINIT );<br/><br/>        for ( nIndex = 0; nIndex &lt nNumParametros; nIndex++ ) {<br/><br/>            lpDstrDtl = lpDstr-&gtlpDsTmplDtl+(nIndex); //Pega o campo da DSTR indicado pelo Inidce<br/>                <br/>            JDB_GetTableColValue( hData, dsDbRef);<br/><br/>        }<br/><br/>    }<br/><br/>    return ER_SUCCESS;<br/><br/>}<br/><br/>ID I570830_BuscaDataSource( HUSER hUser, JCHAR *szProcesso, JCHAR* szDataSource){<br/><br/>    ID					idJDBReturn		            	=  JDEDB_PASSED;<br/>    HREQUEST		    hReqF570830    	     			= (HREQUEST)NULL;<br/>    SELECTSTRUCT        dsSelecao[1]                    = {0};<br/>    F570830             dsF570830                       = {0};<br/><br/>    idJDBReturn = JDB_OpenTable(hUser, NID_F570830, 0, NULL, (ushort) 0,  (JCHAR *) NULL, &hReqF570830); //Abre o Detalhe das Regras<br/>    <br/>    if (idJDBReturn != JDEDB_PASSED) <br/>    {<br/><br/>        JDB_CloseTable( hReqF570830 );<br/>        return ER_ERROR;<br/><br/>    }<br/><br/>	jdeNIDcpy( dsSelecao[0].Item1.szDict , NID_PDNM ); // Processo<br/>    jdeNIDcpy( dsSelecao[0].Item1.szTable , NID_F570830 );<br/>    dsSelecao[0].Item1.idInstance = 0;<br/>	dsSelecao[0].lpValue = szProcesso;<br/>	dsSelecao[0].nValues = 1;<br/>    dsSelecao[0].nAndOr = JDEDB_ANDOR_AND;<br/>    dsSelecao[0].nCmp = JDEDB_CMP_EQ;<br/><br/>    idJDBReturn = JDB_SetSelection(hReqF570830, dsSelecao, 1, JDEDB_SET_REPLACE);<br/><br/>    if (idJDBReturn != JDEDB_PASSED) {<br/><br/>        JDB_CloseTable( hReqF570830 );<br/>        return ER_ERROR;<br/><br/>    }<br/><br/>    idJDBReturn = JDB_SelectKeyed( hReqF570830, (ID)(0), (void *) NULL, (short)(0) );<br/><br/>    if (idJDBReturn != JDEDB_PASSED) {<br/><br/>        JDB_CloseTable( hReqF570830 );<br/>        return ER_ERROR;<br/><br/>    }<br/><br/>    //while(JDB_Fetch( hReqF570830 , &dsF570830 , 0 )) {<br/>        JDB_Fetch( hReqF570830 , &dsF570830 , 0 );<br/><br/>        if (idJDBReturn != JDEDB_PASSED) {<br/><br/>            JDB_CloseTable( hReqF570830 );<br/>            return ER_ERROR;<br/><br/>        }<br/><br/>        jdeStrcpyAndTerminate( szDataSource, dsF570830.tbobnm, DIM(dsF570830.tbobnm));<br/><br/>    //}<br/>   JDB_CloseTable( hReqF570830 );<br/><br/>    return ER_SUCCESS;<br/>}<br/><br/>int   I570830_HashIndex  (dsHash *hash, JCHAR Chave[41]) {<br/><br/>    char szChave[41] = {'0'};<br/><br/>    int index = 0;<br/><br/>    jdeFromUnicode( szChave, Chave, sizeof(szChave), NULL);<br/><br/>    index = I570830_Hash( szChave ) % hash-&gtTamanho;<br/>  <br/>    while (!jdeIsBlankOrNull(hash-&gtChaves[index]) && jdestrcmp( hash-&gtChaves[index], Chave ) != 0 ) <br/>    {<br/>        index = (index + 1) % hash-&gtTamanho;<br/>    }<br/><br/>    return index;<br/><br/>}<br/><br/>void  I570830_HashInsert (dsHash *hash, JCHAR Chave[41], int Posicao) {<br/><br/>    int index = I570830_HashIndex(hash, Chave);<br/><br/>    jdeStrcpyAndTerminate ( hash-&gtChaves[index], Chave, 41 );<br/>    hash-&gtPosicoes[index] = Posicao;<br/><br/>}<br/><br/>int   I570830_HashLookup (dsHash *hash, JCHAR Chave[41]) {<br/><br/>    int index = I570830_HashIndex(hash, Chave);<br/><br/>    if ( jdestrcmp( hash-&gtChaves[index], Chave ) == 0 )<br/>        return hash-&gtPosicoes[index];<br/>    else <br/>        return -1;<br/>}<br/> <br/><br/>unsigned int I570830_Hash(char szChave[41])<br/>{<br/>    unsigned int hash, i;<br/>    for(hash = i = 0; i &lt 41; ++i)<br/>    {<br/>        hash += szChave[i];<br/>        hash += (hash &lt&lt 10);<br/>        hash ^= (hash &gt&gt 6);<br/>    }<br/>    hash += (hash &lt&lt 3);<br/>    hash ^= (hash &gt&gt 11);<br/>    hash += (hash &lt&lt 15);<br/>    return hash;<br/>}<br/><br/><br/></pre></div></div><div class='section'>EVENTS<div class='objectheader'>C Function: Executa Regra - [AdcionaOrdenacaoRegra]</div><div class='er'><div class='dstrmembers'><B>Data Structure: D570830R - Estrutura de dados da BSFN B570830                          </B><BR>BF cErro [EV01]<BR>BF szMsgRetorno [CF500]<BR>BF szTabela [CVVTABNM]<BR>BF szCampo [CVVDICTA]<BR>BF mnNumRegra [CNTF]<BR>BF idRegras [GENLNG]<BR>BF cReseta [EV01]<BR>BF szNomeRegra [ALPH]<BR>BF cAscendenteDescendente [EV01]<BR></div></div></div><div class='section'>EVENTS<div class='objectheader'>C Function: Executa Regra - [AdicionaCampoSelecao]</div><div class='er'><div class='dstrmembers'><B>Data Structure: D570830J - Estrutura de dados da BSFN B570830                          </B><BR>BF cErro [EV01]<BR>BF szMsgRetorno [CF500]<BR>BF szTabela [CVVTABNM]<BR>BF szCampo [CVVDICTA]<BR>BF szValorString [STR350]<BR>BF szOperador [BLO]<BR>BF szEouOU [AOR1]<BR>BF mnNumRegra [CNTF]<BR>BF idRegras [GENLNG]<BR>BF cParenteseEsquerdo [55PE]<BR>BF cParenteseDireito [55PD]<BR>BF mnNumParEsquerda [57NPE]<BR>BF mnNumParDireita [57NPD]<BR>BF szAppendEOu [AOR1]<BR>BF cReseta [EV01]<BR>BF szNomeRegra [ALPH]<BR></div></div></div><div class='section'>EVENTS<div class='objectheader'>C Function: Executa Regra - [AvancaCursor]</div><div class='er'><div class='dstrmembers'><B>Data Structure: D570830E - Estrutura de dados da BSFN B570830                          </B><BR>BF cErro [EV01]<BR>BF szMsgRetorno [CF500]<BR>BF idCursor [GENLNG]<BR>BF cLock [EV01]<BR></div></div></div><div class='section'>EVENTS<div class='objectheader'>C Function: Executa Regra - [BuscaCampoSelecao]</div><div class='er'><div class='dstrmembers'><B>Data Structure: D570830Q - Estrutura de dados da BSFN B570830                          </B><BR>BF cErro [EV01]<BR>BF szMsgRetorno [CF500]<BR>BF szTabela [CVVTABNM]<BR>BF szCampo [CVVDICTA]<BR>BF szValorString [STR350]<BR>BF szOperador [BLO]<BR>BF szEouOU [AOR1]<BR>BF mnNumRegra [CNTF]<BR>BF idRegras [GENLNG]<BR>BF mnNumCampo [CNTF]<BR>BF cParenteseEsquerdo [55PE]<BR>BF cParenteseDireito [55PD]<BR>BF mnNumParEsquerda [57NPE]<BR>BF mnNumParDireita [57NPD]<BR>BF szNomeRegra [ALPH]<BR></div></div></div><div class='section'>EVENTS<div class='objectheader'>C Function: Executa Regra - [BuscaChar]</div><div class='er'><div class='dstrmembers'><B>Data Structure: D570830N - Estrutura de dados da BSFN B570830                          </B><BR>BF cErro [EV01]<BR>BF szMsgRetorno [CF500]<BR>BF idCursor [GENLNG]<BR>BF szTabela [CVVTABNM]<BR>BF szCampo [CVVDICTA]<BR>BF cRetornoChar [EV01]<BR></div></div></div><div class='section'>EVENTS<div class='objectheader'>C Function: Executa Regra - [BuscaData]</div><div class='er'><div class='dstrmembers'><B>Data Structure: D570830I - Estrutura de dados da BSFN B570830                          </B><BR>BF cErro [EV01]<BR>BF szMsgRetorno [CF500]<BR>BF idCursor [GENLNG]<BR>BF szTabela [CVVTABNM]<BR>BF szCampo [CVVDICTA]<BR>BF jdRetornoData [UPMJ]<BR></div></div></div><div class='section'>EVENTS<div class='objectheader'>C Function: Executa Regra - [BuscaInteger]</div><div class='er'><div class='dstrmembers'><B>Data Structure: D570830H - Estrutura de dados da BSFN B570830                          </B><BR>BF cErro [EV01]<BR>BF szMsgRetorno [CF500]<BR>BF idCursor [GENLNG]<BR>BF szTabela [CVVTABNM]<BR>BF szCampo [CVVDICTA]<BR>BF nRetornoInt [CIP]<BR></div></div></div><div class='section'>EVENTS<div class='objectheader'>C Function: Executa Regra - [BuscaMathNumeric]</div><div class='er'><div class='dstrmembers'><B>Data Structure: D570830F - Estrutura de dados da BSFN B570830                          </B><BR>BF cErro [EV01]<BR>BF szMsgRetorno [CF500]<BR>BF idCursor [GENLNG]<BR>BF szTabela [CVVTABNM]<BR>BF szCampo [CVVDICTA]<BR>BF mnRetornoMath [MATH01]<BR></div></div></div><div class='section'>EVENTS<div class='objectheader'>C Function: Executa Regra - [BuscaString]</div><div class='er'><div class='dstrmembers'><B>Data Structure: D570830G - Estrutura de dados da BSFN B570830                          </B><BR>BF cErro [EV01]<BR>BF szMsgRetorno [CF500]<BR>BF idCursor [GENLNG]<BR>BF szTabela [CVVTABNM]<BR>BF szCampo [CVVDICTA]<BR>BF szRetornoString [STR350]<BR></div></div></div><div class='section'>EVENTS<div class='objectheader'>C Function: Executa Regra - [CriaRegra]</div><div class='er'><div class='dstrmembers'><B>Data Structure: D570830O - Estrutura de dados da BSFN B570830                          </B><BR>BF cErro [EV01]<BR>BF szMsgRetorno [CF500]<BR>BF szNomeRegra [ALPH]<BR>BF idRegras [GENLNG]<BR>BF szDataSource [OMWTBLNM]<BR></div></div></div><div class='section'>EVENTS<div class='objectheader'>C Function: Executa Regra - [ExecutaRegras]</div><div class='er'><div class='dstrmembers'><B>Data Structure: D570830B - Estrutura de dados da BSFN B570830                          </B><BR>BF cErro [EV01]<BR>BF szMsgRetorno [CF500]<BR>BF idRegras [GENLNG]<BR></div></div></div><div class='section'>EVENTS<div class='objectheader'>C Function: Executa Regra - [FechaCursorRegra]</div><div class='er'><div class='dstrmembers'><B>Data Structure: D570830M - Estrutura de dados da BSFN B570830                          </B><BR>BF cErro [EV01]<BR>BF szMsgRetorno [CF500]<BR>BF idCursor [GENLNG]<BR></div></div></div><div class='section'>EVENTS<div class='objectheader'>C Function: Executa Regra - [FinalizaRegras]</div><div class='er'><div class='dstrmembers'><B>Data Structure: D570830C - Estrutura de dados da BSFN B570830                          </B><BR>BF cErro [EV01]<BR>BF szMsgRetorno [CF500]<BR>BF idRegras [GENLNG]<BR>BF mnNumRegras [CNTF]<BR></div></div></div><div class='section'>EVENTS<div class='objectheader'>C Function: Executa Regra - [InicializaRegras]</div><div class='er'><div class='dstrmembers'><B>Data Structure: D570830A - Estrutura de dados da BSFN B570830                          </B><BR>BF szProcesso [55VALU2]<BR>BF cErro [EV01]<BR>BF szMsgRetorno [CF500]<BR>BF mnAnoMesProcessamento [ANMESENT]<BR>BF idRegras [GENLNG]<BR>BF mnNumRegras [CNTF]<BR>BF szCasoEspecial [K70VAL]<BR></div></div></div><div class='section'>EVENTS<div class='objectheader'>C Function: Executa Regra - [ModificaCampoSelecao]</div><div class='er'><div class='dstrmembers'><B>Data Structure: D570830K - Estrutura de dados da BSFN B570830                          </B><BR>BF cErro [EV01]<BR>BF szMsgRetorno [CF500]<BR>BF szTabela [CVVTABNM]<BR>BF szCampo [CVVDICTA]<BR>BF szValorString [STR350]<BR>BF szOperador [BLO]<BR>BF szEouOU [AOR1]<BR>BF mnNumRegra [CNTF]<BR>BF idRegras [GENLNG]<BR>BF mnNumCampo [CNTF]<BR>BF cParenteseEsquerdo [55PE]<BR>BF cParenteseDireito [55PD]<BR>BF mnNumParEsquerda [57NPE]<BR>BF mnNumParDireita [57NPD]<BR>BF szNomeRegra [ALPH]<BR></div></div></div><div class='section'>EVENTS<div class='objectheader'>C Function: Executa Regra - [ResetaSelecaoCursor]</div><div class='er'><div class='dstrmembers'><B>Data Structure: D570830P - Estrutura de dados da BSFN B570830                          </B><BR>BF cErro [EV01]<BR>BF szMsgRetorno [CF500]<BR>BF idRegras [GENLNG]<BR>BF mnNumRegra [CNTF]<BR>BF szNomeRegra [ALPH]<BR></div></div></div></body></html>