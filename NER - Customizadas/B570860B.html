<!DOCTYPE html><html lang = "en"><head><meta charset = "utf-8"><meta name = "viewport" content = "width=device-width, initial-scale=1"><title>JDE Object Browser HTML Extract</title>
<style type='text/css'>body,th{font-family: Courier New, Courier, mono;font-size: 12px; width:auto}
.section{font-family: Arial, Helvetica, sans-serif;font-size: 12px;font-weight: bold;border: thin groove #CC9966;width: 100%;padding-left: 5px;padding-top: 5px;padding-bottom: 5px; padding-right: 5px; box-sizing: border-box }
.objectheader {font-family: Arial, Helvetica, sans-serif;font-size: 12px;font-weight: bold;border: thin groove #CC9966;width:auto;background-color: #FFFFCC;padding-left: 5px;padding-top: 5px;padding-bottom: 5px;padding-right: 5px; box-sizing: border-box }
.details{font-family: Arial, Helvetica, sans-serif;font-size: 11px;font-weight: normal;border: thin groove #CC9966;width:100%;padding-left: 5px;padding-top: 5px;padding-bottom: 5px;padding-right: 5px;box-sizing: border-box }
.er {background-color: #FFFFFF;font-family: Courier New, Courier, mono;font-size: 12px; font-weight: normal; border: thin solid #CCCCCC; width:auto; padding-left: 5px;padding-top: 5px;padding-bottom: 5px; padding-right: 5px; box-sizing: border-box }
.dstrmembers {background-color: #FFFDDD;font-family: Courier New, Courier, mono;font-size: 12px;border: thin groove #CC9966;padding-left: 5px;padding-top: 5px;padding-bottom: 5px;padding-right: 5px; box-sizing: border-box }
.disabled {font-family: Courier New, Courier, mono;font-size: 12px;	font-style: italic; color:#CC9933}
.parameters {font-family: Courier New, Courier, mono;font-size: 12px; color:#3333FF}
.comment {font-family: Courier New, Courier, mono;font-size: 12px;	color: #339933}
.subtable {font-family: Arial, Helvetica, sans-serif;font-size: 11px;font-weight: normal;width:100%}
.lineno {color:#6E6E6E;font-family: Courier New, Courier, mono;font-size: 12px; font-weight: normal;}
.iokey {color:#FF6905;font-family: Courier New, Courier, mono;font-size: 12px; font-weight: normal;}
.logicline {color:#000000;font-family: Courier New, Courier, mono;font-size: 12px; font-weight: normal;}
.versionoverride {background-color: #FFCC99;}
.overrideflags{font-family: Arial, Helvetica, sans-serif;font-size: 11px;font-weight: normal;border: thin groove #CC9966;width:auto;padding-left: 5px;padding-top: 5px;padding-bottom: 5px;padding-right: 5px; background-color: #FFCC99; box-sizing: border-box }
.bsfnprops {font-family: Courier New, Courier, mono;font-size: 12px; color:#E01B4C}
.searchresult {font-family: Courier New, Courier, mono;font-size: 12px; font-weight: bold; background-color:#8BF3A0}
.expand {font-family: Courier New, Courier, mono;font-size: 11px; font-weight: bold; cursor:pointer; border: 1px solid gray; position: relative; left: -3px; display:inline; line-height:8px;}
.expand2 { display:inline; cursor:pointer; font-size: 9px; border: 1px solid gray; position: relative; left: -3px;}
</style>
<script type='text/javascript'>function load(){location.href = '#result';}</script>
<script language='JavaScript' type='text/javascript'>function ExpandCollapse(ElementId){ var ClickedElement = document.getElementById(ElementId); var SectionName = ElementId + ':hide'; var Section = document.getElementById(SectionName); if (ClickedElement.innerHTML == '-') { 	 ClickedElement.innerHTML = '+';	Section.style.display = 'none'; }  else  { 		ClickedElement.innerHTML = '-'; 	Section.style.display = 'inline';}} </script>
<base target = "_parent"></head><body onload='load()'>
<div class ='objectheader'>Business Function: B570860B - Mover Gerencia<BR>Function Type: C</div><div class='section'>EVENTS<div class='objectheader'>C Function: Mover Gerencia - [MoverGerencia]</div><div class='er'><div class='dstrmembers'><B>Data Structure: D570860D - Estrutura de dados BSFN B570860B                            </B><BR>BF mnAnoMes [ANMESENT]<BR>BF szUnidadePai [UNID1]<BR>BF szOrigemPai [CUP]<BR>BF mnNivelPai [NIVP]<BR>BF szUnidade [UNID2]<BR>BF szOrigem [A801]<BR>BF mnNivelExecutivo [NIVC]<BR>BF mnNivelExecutivoPara [NIVC]<BR>BF cErrorCode [ERRC]<BR>BF cExiste [EV01]<BR>BF szMsgErro [DI04]<BR></div><pre><div class='dstrmembers'><B>Header File: b570860b.h</B><BR></div> <br/>/***************************************************************************** <br/> *    Header File:  B570860B.h <br/> * <br/> *    Description:  Mover Gerencia Header File <br/> * <br/> *        History: <br/> *          Date        Programmer  SAR# - Description <br/> *          ----------  ----------  ------------------------------------------- <br/> *   Author 08/05/15    MATEU       Unknown  - Created  <br/> * <br/> * <br/> * Copyright (c) J.D. Edwards World Source Company, 1996 <br/> * <br/> * This unpublished material is proprietary to J.D. Edwards World Source  <br/> * Company.  All rights reserved.  The methods and techniques described  <br/> * herein are considered trade secrets and/or confidential.  Reproduction <br/> * or distribution, in whole or in part, is forbidden except by express <br/> * written permission of J.D. Edwards World Source Company. <br/> ****************************************************************************/ <br/> <br/>#ifndef __B570860B_H<br/>#define __B570860B_H <br/> <br/>/***************************************************************************** <br/> * Table Header Inclusions <br/> ****************************************************************************/ <br/>#include &ltf570860.h&gt<br/>#include &ltf570861.h&gt<br/>#include &ltf570862.h&gt<br/>#include &ltf570865.h&gt<br/>#include &ltf570864.h&gt<br/>#include &ltf570861l.h&gt<br/>#include &ltf570810.h&gt<br/>#include &ltf570811.h&gt<br/>/***************************************************************************** <br/> * External Business Function Header Inclusions <br/> ****************************************************************************/ <br/> <br/>/***************************************************************************** <br/> * Global Definitions <br/> ****************************************************************************/ <br/> <br/>/***************************************************************************** <br/> * Structure Definitions <br/> ****************************************************************************/ <br/> <br/>/***************************************************************************** <br/> * DS Template Type Definitions <br/> ****************************************************************************/ <br/><br/><br/>/**<br/> * TYPEDEF for Data Structure<br/> * D570860D : Estrutura de dados BSFN B570860B<br/> *<br/> * Copyright Oracle USA<br/> *<br/> * This is a JDEdwards EnterpriseOne generated file.<br/> * Do not modify this file.<br/> * Only re-generate with the appropriate tool.<br/> * Generation Date : 07/10/15<br/> */<br/><br/>#ifndef DATASTRUCTURE_D570860D<br/>#define DATASTRUCTURE_D570860D<br/><br/>typedef struct tagDSD570860D<br/>{<br/>  MATH_NUMERIC   mnAnoMes;<br/>  JCHAR          szUnidadePai[4];<br/>  JCHAR          szOrigemPai[9];<br/>  MATH_NUMERIC   mnNivelPai;<br/>  JCHAR          szUnidade[4];<br/>  JCHAR          szOrigem[9];<br/>  MATH_NUMERIC   mnNivelExecutivo;<br/>  MATH_NUMERIC   mnNivelExecutivoPara;<br/>  JCHAR          cErrorCode;<br/>  JCHAR          cExiste;<br/>  JCHAR          szMsgErro[301];<br/>} DSD570860D , *LPDSD570860D;<br/><br/>#define IDERRmnAnoMes_1                           1L<br/>#define IDERRszUnidadePai_2                       2L<br/>#define IDERRszOrigemPai_3                        3L<br/>#define IDERRmnNivelPai_4                         4L<br/>#define IDERRszUnidade_5                          5L<br/>#define IDERRszOrigem_6                           6L<br/>#define IDERRmnNivelExecutivo_7                   7L<br/>#define IDERRmnNivelExecutivoPara_8               8L<br/>#define IDERRcErrorCode_9                         9L<br/>#define IDERRcExiste_10                           10L<br/>#define IDERRszMsgErro_11                         11L<br/><br/>#endif /* DATASTRUCTURE_D570860D */<br/><br/>/***************************************************************************** <br/> * Source Preprocessor Definitions <br/> ****************************************************************************/ <br/>#if defined (JDEBFRTN) <br/>	#undef JDEBFRTN <br/>#endif <br/> <br/>#if defined (WIN32) <br/>	#if defined (WIN32) <br/>		#define JDEBFRTN(r) __declspec(dllexport) r <br/>	#else <br/>		#define JDEBFRTN(r) __declspec(dllimport) r <br/>	#endif <br/>#else <br/>	#define JDEBFRTN(r) r <br/>#endif <br/> <br/>/***************************************************************************** <br/> * Business Function Prototypes <br/> ****************************************************************************/ <br/> JDEBFRTN (ID) JDEBFWINAPI MoverGerencia                    (LPBHVRCOM lpBhvrCom, LPVOID lpVoid, LPDSD570860D lpDS); <br/> <br/> <br/>/***************************************************************************** <br/> * Internal Function Prototypes <br/> ****************************************************************************/ <br/>char I570860B_ExisteExecutivoDestino (LPDSD570860D lpDS, HREQUEST hF570860, HREQUEST hF570861, HREQUEST hF570862, HREQUEST hF570861L, HREQUEST hF570864,  HREQUEST hF570865, HREQUEST hF570810);<br/>ID I570860B_TrocaCabecalho (LPDSD570860D lpDS, HREQUEST hF570860);<br/>ID I570860B_TrocaCabecalhoFilhos (LPDSD570860D lpDS, HREQUEST hF570860);<br/>ID I570860B_TrocaDetalhe (LPDSD570860D lpDS, HREQUEST hF570861);<br/>ID I570860B_TrocaDetalheFilhos (LPDSD570860D lpDS, HREQUEST hF570861);<br/>ID I570860B_TrocaPedidosPlacar (LPDSD570860D lpDS, HREQUEST hF570862);<br/>ID I570860B_TrocaAjustes (LPDSD570860D lpDS, HREQUEST hF570861L);<br/>ID I570860B_TrocaAjustesFilhos (LPDSD570860D lpDS, HREQUEST hF570861L);<br/>ID I570860B_TrocaCarteira (LPDSD570860D lpDS, HREQUEST hF570810);<br/>ID I570860B_TrocaCarteiraFilhos (LPDSD570860D lpDS, HREQUEST hF570810);<br/>ID I570860B_TrocaPedidosExecutados (LPDSD570860D lpDS, HREQUEST hF570811);<br/>ID I570860B_TrocaPedidosMeta (LPDSD570860D lpDS, HREQUEST hF570865);<br/>ID I570860B_TrocaCabecalhoGerencia (LPDSD570860D lpDS, HREQUEST hF570860);<br/>ID I570860B_TrocaDetalheGerencia (LPDSD570860D lpDS, HREQUEST hF570861);<br/>ID I570860B_TrocaAjustesGerencia (LPDSD570860D lpDS, HREQUEST hF570861L);<br/>ID I570860B_TrocaAuxiliarMeta (LPDSD570860D lpDS, HREQUEST hF570864);<br/><br/>#endif    /* __B570860B_H */ <br/> <br/></pre><BR/><pre><div class='dstrmembers'><B>Source File: b570860b.c</B><BR></div>#include &ltjde.h&gt <br/> <br/>#define b570860b_c <br/> <br/> <br/>/***************************************************************************** <br/> *    Source File:  b570860b <br/> * <br/> *    Description:  Mover Gerencia Source File <br/> * <br/> *        History: <br/> *          Date        Programmer  SAR# - Description <br/> *          ----------  ----------  ------------------------------------------- <br/> *   Author 08/05/15    MATEU       Unknown  - Created   <br/> * <br/> * Copyright (c) J.D. Edwards World Source Company, 1996 <br/> * <br/> * This unpublished material is proprietary to J.D. Edwards World Source Company. <br/> * All rights reserved.  The methods and techniques described herein are <br/> * considered trade secrets and/or confidential.  Reproduction or <br/> * distribution, in whole or in part, is forbidden except by express <br/> * written permission of J.D. Edwards World Source Company. <br/> ****************************************************************************/ <br/>/************************************************************************** <br/> * Notes: <br/> * <br/> **************************************************************************/ <br/> <br/>#include &ltb570860b.h&gt <br/> <br/> <br/>/************************************************************************** <br/> *  Business Function:  MoverGerencia <br/> * <br/> *        Description:  Mover Gerencia <br/> *          <br/> *          Substitui um executivo por outro na estrutura de premiações. A função deve substituir o executivo nas tabelas :<br/> *  F570860, F570861, F570862, F570864, F570865, F570861L, F570810, F570811.    <br/> * <br/> *         Parameters: <br/> *           LPBHVRCOM           lpBhvrCom    Business Function Communications <br/> *           LPVOID              lpVoid       Void Parameter - DO NOT USE! <br/> *           LPDSD570            lpDS         Parameter Data Structure Pointer   <br/> * <br/> *************************************************************************/ <br/> <br/>JDEBFRTN (ID) JDEBFWINAPI MoverGerencia (LPBHVRCOM lpBhvrCom, LPVOID lpVoid, LPDSD570860D lpDS)  <br/>{ <br/>   /************************************************************************ <br/>    *  Variable declarations <br/>    ************************************************************************/ <br/>    ID					idJDBReturn			=  JDEDB_PASSED;<br/>    HUSER			    hUser			    = (HUSER)NULL;<br/>    HREQUEST            hF570860            = (HREQUEST)NULL;    <br/>    HREQUEST            hF570861            = (HREQUEST)NULL;<br/>    HREQUEST            hF570862            = (HREQUEST)NULL;<br/>    HREQUEST            hF570861L           = (HREQUEST)NULL;<br/>    HREQUEST            hF570864            = (HREQUEST)NULL;<br/>    HREQUEST            hF570865            = (HREQUEST)NULL;<br/>    HREQUEST            hF570810            = (HREQUEST)NULL;<br/>    HREQUEST            hF570811            = (HREQUEST)NULL;<br/>    char                cAchou              = 'N';<br/><br/>   /************************************************************************ <br/>    * Declare structures <br/>    ************************************************************************/ <br/><br/>   /************************************************************************ <br/>    * Declare pointers <br/>    ************************************************************************/ <br/> <br/>   /************************************************************************ <br/>    * Check for NULL pointers <br/>    ************************************************************************/ <br/>    if ((lpBhvrCom == (LPBHVRCOM) NULL) || <br/>        (lpVoid    == (LPVOID)    NULL) || <br/>        (lpDS      == (LPDSD570860D)	NULL)) <br/>    { <br/>      jdeErrorSet (lpBhvrCom, lpVoid, (ID) 0, _J("4363"), (LPVOID) NULL); <br/>      return ER_ERROR; <br/>    } <br/> <br/>   /************************************************************************ <br/>    * Set pointers <br/>    ************************************************************************/ <br/> <br/>   /************************************************************************ <br/>    * Main Processing <br/>    ************************************************************************/ <br/>    lpDS-&gtcErrorCode = 'N';<br/>    idJDBReturn  = JDB_InitBhvr( lpBhvrCom , &hUser , NULL , JDEDB_COMMIT_MANUAL ); <br/><br/>    idJDBReturn  = JDB_OpenTable(hUser, NID_F570860, 0, NULL, 0, NULL, &hF570860);	<br/>    idJDBReturn  = JDB_OpenTable(hUser, NID_F570861, 0, NULL, 0, NULL, &hF570861);	<br/>    idJDBReturn  = JDB_OpenTable(hUser, NID_F570862, 0, NULL, 0, NULL, &hF570862);	<br/>    idJDBReturn  = JDB_OpenTable(hUser, NID_F570861L, 0, NULL, 0, NULL, &hF570861L);	<br/>    idJDBReturn  = JDB_OpenTable(hUser, NID_F570864, 0, NULL, 0, NULL, &hF570864);	<br/>    idJDBReturn  = JDB_OpenTable(hUser, NID_F570865, 0, NULL, 0, NULL, &hF570865);	<br/>    //idJDBReturn  = JDB_OpenTable(hUser, NID_F570810, 0, NULL, 0, NULL, &hF570810);	<br/>    //idJDBReturn  = JDB_OpenTable(hUser, NID_F570811, 0, NULL, 0, NULL, &hF570811);	<br/><br/>    //Verifica se o registro destino ja existe, se existir aborta tudo e da erro<br/>    cAchou = I570860B_ExisteExecutivoDestino(lpDS, hF570860, hF570861, hF570862, hF570861L, hF570864, hF570865, hF570810);<br/>    if (cAchou == 'S') {<br/><br/>	    lpDS-&gtcErrorCode = 'S';<br/>        lpDS-&gtcExiste = 'S';<br/>	    JDB_CloseTable(hF570860);<br/>	    JDB_CloseTable(hF570861);<br/>	    JDB_CloseTable(hF570862);<br/>	    JDB_CloseTable(hF570861L);<br/>        JDB_CloseTable(hF570864);<br/>        JDB_CloseTable(hF570865);<br/>        JDB_CloseTable(hF570810);<br/>        JDB_CloseTable(hF570811);<br/>        JDB_FreeBhvr(hUser);<br/>	    return ER_ERROR;<br/><br/>    } else {<br/><br/>        //Não Existe o Executivo Para Cadastrado, segue o baile<br/>        lpDS-&gtcExiste = 'N';<br/><br/>    }<br/><br/>    //Deleta os executivo existente e insere o novo na tabela F570860<br/>    idJDBReturn = I570860B_TrocaCabecalho (lpDS, hF570860);<br/>    if (idJDBReturn != JDEDB_PASSED) {<br/><br/>        lpDS-&gtcErrorCode = 'S';<br/>    	JDB_RollbackUser(hUser);<br/>	    JDB_CloseTable(hF570860);<br/>	    JDB_CloseTable(hF570861);<br/>	    JDB_CloseTable(hF570862);<br/>	    JDB_CloseTable(hF570861L);<br/>        JDB_CloseTable(hF570864);<br/>        JDB_CloseTable(hF570865);<br/>        JDB_CloseTable(hF570810);<br/>        JDB_CloseTable(hF570811);<br/>	    JDB_FreeBhvr(hUser);<br/>        return ER_ERROR;<br/><br/>    }<br/><br/>    //Deleta os registros que apontam para o executivo e substitui por novos apontando para o novo executivo na tabela F570860<br/>    idJDBReturn = I570860B_TrocaCabecalhoFilhos (lpDS, hF570860);<br/>    if (idJDBReturn != JDEDB_PASSED) {<br/><br/>        lpDS-&gtcErrorCode = 'S';<br/>    	JDB_RollbackUser(hUser);<br/>	    JDB_CloseTable(hF570860);<br/>	    JDB_CloseTable(hF570861);<br/>	    JDB_CloseTable(hF570862);<br/>	    JDB_CloseTable(hF570861L);<br/>        JDB_CloseTable(hF570864);<br/>        JDB_CloseTable(hF570865);<br/>        JDB_CloseTable(hF570810);<br/>        JDB_CloseTable(hF570811);<br/>	    JDB_FreeBhvr(hUser);<br/>        return ER_ERROR;<br/><br/>    }<br/><br/>    //Deleta os executivo existente e insere o novo na tabela F570860<br/>    idJDBReturn = I570860B_TrocaDetalhe (lpDS, hF570861);<br/>    if (idJDBReturn != JDEDB_PASSED) {<br/><br/>        lpDS-&gtcErrorCode = 'S';<br/>    	JDB_RollbackUser(hUser);<br/>	    JDB_CloseTable(hF570860);<br/>	    JDB_CloseTable(hF570861);<br/>	    JDB_CloseTable(hF570862);<br/>	    JDB_CloseTable(hF570861L);<br/>        JDB_CloseTable(hF570864);<br/>        JDB_CloseTable(hF570865);<br/>        JDB_CloseTable(hF570810);<br/>        JDB_CloseTable(hF570811);<br/>	    JDB_FreeBhvr(hUser);<br/>        return ER_ERROR;<br/><br/>    }<br/><br/>    //Deleta os registros que apontam para o executivo e substitui por novos apontando para o novo executivo na tabela F570861<br/>    idJDBReturn = I570860B_TrocaDetalheFilhos (lpDS, hF570861);<br/>    if (idJDBReturn != JDEDB_PASSED) {<br/><br/>        lpDS-&gtcErrorCode = 'S';<br/>    	JDB_RollbackUser(hUser);<br/>	    JDB_CloseTable(hF570860);<br/>	    JDB_CloseTable(hF570861);<br/>	    JDB_CloseTable(hF570862);<br/>	    JDB_CloseTable(hF570861L);<br/>        JDB_CloseTable(hF570864);<br/>        JDB_CloseTable(hF570865);<br/>        JDB_CloseTable(hF570810);<br/>        JDB_CloseTable(hF570811);<br/>	    JDB_FreeBhvr(hUser);<br/>        return ER_ERROR;<br/><br/>    }<br/><br/>    //Deleta os executivo existente e insere o novo na tabela F570862<br/>    idJDBReturn = I570860B_TrocaPedidosPlacar (lpDS, hF570862);<br/>    if (idJDBReturn != JDEDB_PASSED) {<br/><br/>        lpDS-&gtcErrorCode = 'S';<br/>    	JDB_RollbackUser(hUser);<br/>	    JDB_CloseTable(hF570860);<br/>	    JDB_CloseTable(hF570861);<br/>	    JDB_CloseTable(hF570862);<br/>	    JDB_CloseTable(hF570861L);<br/>        JDB_CloseTable(hF570864);<br/>        JDB_CloseTable(hF570865);<br/>        JDB_CloseTable(hF570810);<br/>        JDB_CloseTable(hF570811);<br/>	    JDB_FreeBhvr(hUser);<br/>        return ER_ERROR;<br/><br/>    }<br/><br/>    //Deleta os executivo existente e insere o novo na tabela F570861L<br/>    idJDBReturn = I570860B_TrocaAjustes (lpDS, hF570861L);<br/>    if (idJDBReturn != JDEDB_PASSED) {<br/><br/>        lpDS-&gtcErrorCode = 'S';<br/>    	JDB_RollbackUser(hUser);<br/>	    JDB_CloseTable(hF570860);<br/>	    JDB_CloseTable(hF570861);<br/>	    JDB_CloseTable(hF570862);<br/>	    JDB_CloseTable(hF570861L);<br/>        JDB_CloseTable(hF570864);<br/>        JDB_CloseTable(hF570865);<br/>        JDB_CloseTable(hF570810);<br/>        JDB_CloseTable(hF570811);<br/>	    JDB_FreeBhvr(hUser);<br/>        return ER_ERROR;<br/><br/>    }<br/><br/>    //Deleta os executivo existente e insere o novo na tabela F570864<br/>    idJDBReturn = I570860B_TrocaAuxiliarMeta (lpDS, hF570864);<br/>    if (idJDBReturn != JDEDB_PASSED) {<br/><br/>        lpDS-&gtcErrorCode = 'S';<br/>    	JDB_RollbackUser(hUser);<br/>	    JDB_CloseTable(hF570860);<br/>	    JDB_CloseTable(hF570861);<br/>	    JDB_CloseTable(hF570862);<br/>	    JDB_CloseTable(hF570861L);<br/>        JDB_CloseTable(hF570864);<br/>        JDB_CloseTable(hF570865);<br/>        JDB_CloseTable(hF570810);<br/>        JDB_CloseTable(hF570811);<br/>	    JDB_FreeBhvr(hUser);<br/>        return ER_ERROR;<br/><br/>    }<br/><br/>    //Deleta os executivo existente e insere o novo na tabela F570865<br/>    idJDBReturn = I570860B_TrocaPedidosMeta (lpDS, hF570865);<br/>    if (idJDBReturn != JDEDB_PASSED) {<br/><br/>        lpDS-&gtcErrorCode = 'S';<br/>    	JDB_RollbackUser(hUser);<br/>	    JDB_CloseTable(hF570860);<br/>	    JDB_CloseTable(hF570861);<br/>	    JDB_CloseTable(hF570862);<br/>	    JDB_CloseTable(hF570861L);<br/>        JDB_CloseTable(hF570864);<br/>        JDB_CloseTable(hF570865);<br/>        JDB_CloseTable(hF570810);<br/>        JDB_CloseTable(hF570811);<br/>	    JDB_FreeBhvr(hUser);<br/>        return ER_ERROR;<br/><br/>    }<br/><br/>    //Deleta os registros que apontam para o executivo e substitui por novos apontando para o novo executivo na tabela F570861L<br/>    idJDBReturn = I570860B_TrocaAjustesFilhos (lpDS, hF570861L);<br/>    if (idJDBReturn != JDEDB_PASSED) {<br/><br/>        lpDS-&gtcErrorCode = 'S';<br/>    	JDB_RollbackUser(hUser);<br/>	    JDB_CloseTable(hF570860);<br/>	    JDB_CloseTable(hF570861);<br/>	    JDB_CloseTable(hF570862);<br/>	    JDB_CloseTable(hF570861L);<br/>        JDB_CloseTable(hF570864);<br/>        JDB_CloseTable(hF570865);<br/>        JDB_CloseTable(hF570810);<br/>        JDB_CloseTable(hF570811);<br/>	    JDB_FreeBhvr(hUser);<br/>        return ER_ERROR;<br/><br/>    }<br/><br/>    //Deleta os executivo existente e insere o novo na tabela F570810<br/>    /*idJDBReturn = I570860B_TrocaCarteira (lpDS, hF570810);<br/>    if (idJDBReturn != JDEDB_PASSED) {<br/><br/>        lpDS-&gtcErrorCode = 'S';<br/>    	JDB_RollbackUser(hUser);<br/>	    JDB_CloseTable(hF570860);<br/>	    JDB_CloseTable(hF570861);<br/>	    JDB_CloseTable(hF570862);<br/>	    JDB_CloseTable(hF570861L);<br/>        JDB_CloseTable(hF570864);<br/>        JDB_CloseTable(hF570865);<br/>        JDB_CloseTable(hF570810);<br/>        JDB_CloseTable(hF570811);<br/>	    JDB_FreeBhvr(hUser);<br/>        return ER_ERROR;<br/><br/>    }<br/><br/>    //Deleta os registros que apontam para o executivo e substitui por novos apontando para o novo executivo na tabela F570810<br/>    idJDBReturn = I570860B_TrocaCarteiraFilhos (lpDS, hF570810);<br/>    if (idJDBReturn != JDEDB_PASSED) {<br/><br/>        lpDS-&gtcErrorCode = 'S';<br/>    	JDB_RollbackUser(hUser);<br/>	    JDB_CloseTable(hF570860);<br/>	    JDB_CloseTable(hF570861);<br/>	    JDB_CloseTable(hF570862);<br/>	    JDB_CloseTable(hF570861L);<br/>        JDB_CloseTable(hF570864);<br/>        JDB_CloseTable(hF570865);<br/>        JDB_CloseTable(hF570810);<br/>        JDB_CloseTable(hF570811);<br/>	    JDB_FreeBhvr(hUser);<br/>        return ER_ERROR;<br/><br/>    }<br/><br/>    //Deleta os executivo existente e insere o novo na tabela F570811<br/>    idJDBReturn = I570860B_TrocaPedidosExecutados (lpDS, hF570811);<br/>    if (idJDBReturn != JDEDB_PASSED) {<br/><br/>        lpDS-&gtcErrorCode = 'S';<br/>    	JDB_RollbackUser(hUser);<br/>	    JDB_CloseTable(hF570860);<br/>	    JDB_CloseTable(hF570861);<br/>	    JDB_CloseTable(hF570862);<br/>	    JDB_CloseTable(hF570861L);<br/>        JDB_CloseTable(hF570864);<br/>        JDB_CloseTable(hF570865);<br/>        JDB_CloseTable(hF570810);<br/>        JDB_CloseTable(hF570811);<br/>	    JDB_FreeBhvr(hUser);<br/>        return ER_ERROR;<br/><br/>    }*/<br/><br/>    if (jdestrcmp((JCHAR*)lpDS-&gtszUnidadePai, (JCHAR*)_J("GER")) != 0) {<br/><br/>        //Deleta os executivo existente na arvore de gerencia e insere o novo na tabela F570860<br/>        idJDBReturn = I570860B_TrocaCabecalhoGerencia (lpDS, hF570860);<br/>        if (idJDBReturn != JDEDB_PASSED) {<br/><br/>            lpDS-&gtcErrorCode = 'S';<br/>    	    JDB_RollbackUser(hUser);<br/>	        JDB_CloseTable(hF570860);<br/>	        JDB_CloseTable(hF570861);<br/>	        JDB_CloseTable(hF570862);<br/>	        JDB_CloseTable(hF570861L);<br/>            JDB_CloseTable(hF570864);<br/>            JDB_CloseTable(hF570865);<br/>            JDB_CloseTable(hF570810);<br/>            JDB_CloseTable(hF570811);<br/>	        JDB_FreeBhvr(hUser);<br/>            return ER_ERROR;<br/><br/>        }<br/><br/>        //Deleta os executivo existente na arvore de gerencia e insere o novo na tabela F570861<br/>        idJDBReturn = I570860B_TrocaDetalheGerencia (lpDS, hF570861);<br/>        if (idJDBReturn != JDEDB_PASSED) {<br/><br/>            lpDS-&gtcErrorCode = 'S';<br/>    	    JDB_RollbackUser(hUser);<br/>	        JDB_CloseTable(hF570860);<br/>	        JDB_CloseTable(hF570861);<br/>	        JDB_CloseTable(hF570862);<br/>	        JDB_CloseTable(hF570861L);<br/>            JDB_CloseTable(hF570864);<br/>            JDB_CloseTable(hF570865);<br/>            JDB_CloseTable(hF570810);<br/>            JDB_CloseTable(hF570811);<br/>	        JDB_FreeBhvr(hUser);<br/>            return ER_ERROR;<br/><br/>        }<br/><br/>        //Deleta os executivo existente na arvore de gerencia e insere o novo na tabela F570861L<br/>        idJDBReturn = I570860B_TrocaAjustesGerencia (lpDS, hF570861L);<br/>        if (idJDBReturn != JDEDB_PASSED) {<br/><br/>            lpDS-&gtcErrorCode = 'S';<br/>    	    JDB_RollbackUser(hUser);<br/>	        JDB_CloseTable(hF570860);<br/>	        JDB_CloseTable(hF570861);<br/>	        JDB_CloseTable(hF570862);<br/>	        JDB_CloseTable(hF570861L);<br/>            JDB_CloseTable(hF570864);<br/>            JDB_CloseTable(hF570865);<br/>            JDB_CloseTable(hF570810);<br/>            JDB_CloseTable(hF570811);<br/>	        JDB_FreeBhvr(hUser);<br/>            return ER_ERROR;<br/><br/>        }            <br/><br/>    }<br/><br/><br/>   /************************************************************************ <br/>    * Function Clean Up <br/>    ************************************************************************/ <br/>   JDB_CommitUser(hUser);<br/>   JDB_CloseTable(hF570860);<br/>   JDB_CloseTable(hF570861);<br/>   JDB_CloseTable(hF570862);<br/>   JDB_CloseTable(hF570861L);<br/>   JDB_CloseTable(hF570864); <br/>   JDB_CloseTable(hF570865);<br/>   //JDB_CloseTable(hF570810);<br/>   //JDB_CloseTable(hF570811);<br/>   JDB_FreeBhvr(hUser); <br/>   return (ER_SUCCESS); <br/><br/>} <br/> <br/>/* Internal function comment block */<br/>/**************************************************************************<br/> *   Function:  Ixxxxxxx_a   // Replace "xxxxxxx" with source file number<br/> *                           // and "a" with the function name<br/> *      Notes:<br/> *<br/> *    Returns:<br/> *<br/> * Parameters:<br/> **************************************************************************/<br/><br/>char I570860B_ExisteExecutivoDestino(LPDSD570860D lpDS, HREQUEST hF570860, HREQUEST hF570861, HREQUEST hF570862, HREQUEST hF570861L, HREQUEST hF570864, HREQUEST hF570865, HREQUEST hF570810) {<br/><br/>    ID			  idJDBReturn    	=  JDEDB_PASSED;<br/>    KEY1_F570860  ChaveF570860Para  = {0};<br/>    KEY1_F570861  ChaveF570861Para  = {0};<br/>    KEY3_F570862  ChaveF570862Para  = {0};<br/>    KEY4_F570861L ChaveF570861LPara = {0};<br/>    KEY1_F570864  ChaveF570864      = {0};<br/>    KEY2_F570865  ChaveF570865      = {0};<br/>    //KEY1_F570810  ChaveF570810      = {0};<br/><br/>    //Verifica se Pai e Filho são diferentes<br/>    if (MathCompare(&lpDS-&gtmnNivelPai, &lpDS-&gtmnNivelExecutivoPara) == 0) {<br/><br/>        jdeStrncpyTerminate(lpDS-&gtszMsgErro, _J("Pai e Filho Iguais !!!"), DIM(lpDS-&gtszMsgErro));<br/>	    return 'S';<br/><br/>    }<br/><br/>    //Cabeçalho Placar<br/>    MathCopy(&ChaveF570860Para.ftanmesent, &lpDS-&gtmnAnoMes);<br/>    jdeStrncpyTerminate(ChaveF570860Para.ftunid1, lpDS-&gtszUnidadePai, DIM(lpDS-&gtszUnidadePai));		<br/>    jdeStrncpyTerminate(ChaveF570860Para.ftcup, lpDS-&gtszOrigemPai, DIM(lpDS-&gtszOrigemPai));		<br/>    MathCopy(&ChaveF570860Para.ftnivp, &lpDS-&gtmnNivelPai);<br/>    jdeStrncpyTerminate(ChaveF570860Para.ftunid2, lpDS-&gtszUnidade, DIM(lpDS-&gtszUnidade));<br/>    jdeStrncpyTerminate(ChaveF570860Para.fta801, lpDS-&gtszOrigem, DIM(lpDS-&gtszOrigem));		<br/>    MathCopy(&ChaveF570860Para.ftnivc, &lpDS-&gtmnNivelExecutivoPara);<br/><br/>    idJDBReturn = JDB_FetchKeyed(hF570860,ID_F570860_PK, &ChaveF570860Para, 7, (void*)NULL, FALSE);		<br/>    if (idJDBReturn == JDEDB_PASSED) {<br/><br/>        jdeStrncpyTerminate(lpDS-&gtszMsgErro, _J("Ja existe executivo no Placar."), DIM(lpDS-&gtszMsgErro));<br/>	    return 'S';<br/><br/>    }<br/><br/>    //Detalhe Placar<br/>    MathCopy(&ChaveF570861Para.ftanmesent, &lpDS-&gtmnAnoMes);<br/>    jdeStrncpyTerminate(ChaveF570861Para.ftunid1, lpDS-&gtszUnidadePai, DIM(lpDS-&gtszUnidadePai));		<br/>    jdeStrncpyTerminate(ChaveF570861Para.ftcup, lpDS-&gtszOrigemPai, DIM(lpDS-&gtszOrigemPai));		<br/>    MathCopy(&ChaveF570861Para.ftnivp, &lpDS-&gtmnNivelPai);<br/>    jdeStrncpyTerminate(ChaveF570861Para.ftunid2, lpDS-&gtszUnidade, DIM(lpDS-&gtszUnidade));<br/>    jdeStrncpyTerminate(ChaveF570861Para.fta801, lpDS-&gtszOrigem, DIM(lpDS-&gtszOrigem));		<br/>    MathCopy(&ChaveF570861Para.ftnivp, &lpDS-&gtmnNivelExecutivoPara);<br/><br/>    idJDBReturn = JDB_FetchKeyed(hF570861,ID_F570861_PK, &ChaveF570861Para, 7, (void*)NULL, FALSE);		<br/>    if (idJDBReturn == JDEDB_PASSED) {<br/><br/>        jdeStrncpyTerminate(lpDS-&gtszMsgErro, _J("Ja existe executivo no Detalhe do Placar."), DIM(lpDS-&gtszMsgErro));<br/>	    return 'S';<br/><br/>    }<br/><br/>    //Pedidos do placar <br/>    MathCopy(&ChaveF570862Para.ftanmesent, &lpDS-&gtmnAnoMes);<br/>    jdeStrncpyTerminate(ChaveF570862Para.ftunid1, lpDS-&gtszUnidade, DIM(lpDS-&gtszUnidade));		<br/>    jdeStrncpyTerminate(ChaveF570862Para.ftcup, lpDS-&gtszOrigem, DIM(lpDS-&gtszOrigem));		<br/>    MathCopy(&ChaveF570862Para.ftnivc, &lpDS-&gtmnNivelExecutivoPara);<br/><br/>    idJDBReturn = JDB_FetchKeyed(hF570862,ID_F570862_ANOMES__UNIDADE__ORIGEM__EXEC, &ChaveF570862Para, 4, (void*)NULL, FALSE);		<br/>    if (idJDBReturn == JDEDB_PASSED) {<br/><br/>        jdeStrncpyTerminate(lpDS-&gtszMsgErro, _J("Ja existe executivo nos pedidos que compõe o placar"), DIM(lpDS-&gtszMsgErro));<br/>	    return 'S';<br/><br/>    }<br/><br/>    //Auxiliar Calculo Meta<br/>    MathCopy(&ChaveF570864.ftanmesent, &lpDS-&gtmnAnoMes);<br/>    jdeStrncpyTerminate(ChaveF570864.ftunid1, lpDS-&gtszUnidade, DIM(lpDS-&gtszUnidade));		<br/>    jdeStrncpyTerminate(ChaveF570864.ftcup, lpDS-&gtszOrigem, DIM(lpDS-&gtszOrigem));		<br/>    MathCopy(&ChaveF570864.ftnivc, &lpDS-&gtmnNivelExecutivoPara);<br/><br/>    idJDBReturn = JDB_FetchKeyed(hF570864, ID_F570864_PK, &ChaveF570864, 4, (void*)NULL, FALSE);		<br/>    if (idJDBReturn == JDEDB_PASSED) {<br/><br/>        jdeStrncpyTerminate(lpDS-&gtszMsgErro, _J("Ja existe executivo na tabela auxiliar da meta."), DIM(lpDS-&gtszMsgErro));<br/>	    return 'S';<br/><br/>    }<br/><br/>    //Ajustes do placar<br/>    MathCopy(&ChaveF570861LPara.ftanmesent, &lpDS-&gtmnAnoMes);<br/>    jdeStrncpyTerminate(ChaveF570861LPara.ftunid1, lpDS-&gtszUnidadePai, DIM(lpDS-&gtszUnidadePai));		<br/>    jdeStrncpyTerminate(ChaveF570861LPara.ftcup, lpDS-&gtszOrigemPai, DIM(lpDS-&gtszOrigemPai));		<br/>    MathCopy(&ChaveF570861LPara.ftnivp, &lpDS-&gtmnNivelPai);<br/>    jdeStrncpyTerminate(ChaveF570861LPara.ftunid2, lpDS-&gtszUnidade, DIM(lpDS-&gtszUnidade));		<br/>    jdeStrncpyTerminate(ChaveF570861LPara.fta801, lpDS-&gtszOrigem, DIM(lpDS-&gtszOrigem));		<br/>    MathCopy(&ChaveF570861LPara.ftnivc, &lpDS-&gtmnNivelExecutivoPara);<br/><br/>    idJDBReturn = JDB_FetchKeyed(hF570861L,ID_F570861L_ANO__UNID__CUP__NIVC, &ChaveF570861LPara, 7, (void*)NULL, FALSE);		<br/>    if (idJDBReturn == JDEDB_PASSED) {<br/><br/>        jdeStrncpyTerminate(lpDS-&gtszMsgErro, _J("Ja existe executivo nos ajustes do placar."), DIM(lpDS-&gtszMsgErro));<br/>        return 'S';<br/><br/>    }<br/><br/>    //Pedidos da Meta<br/>    MathCopy(&ChaveF570865.ftanmesent, &lpDS-&gtmnAnoMes);<br/>    jdeStrncpyTerminate(ChaveF570865.ftunid1, lpDS-&gtszUnidade, DIM(lpDS-&gtszUnidade));		<br/>    jdeStrncpyTerminate(ChaveF570865.ftcup, lpDS-&gtszOrigem, DIM(lpDS-&gtszOrigem));		<br/>    MathCopy(&ChaveF570865.ftnivc, &lpDS-&gtmnNivelExecutivoPara);<br/><br/>    idJDBReturn = JDB_FetchKeyed(hF570865,ID_F570865_PK570865, &ChaveF570865, 4, (void*)NULL, FALSE);		<br/>    if (idJDBReturn == JDEDB_PASSED) {<br/><br/>        jdeStrncpyTerminate(lpDS-&gtszMsgErro, _J("Ja existe executivo nos pedidos que compõem a meta."), DIM(lpDS-&gtszMsgErro));<br/>	    return 'S';<br/><br/>    }<br/>    <br/>    //Carteira de Clientes<br/>    /*MathCopy(&ChaveF570810.peanmesent, &lpDS-&gtmnAnoMes);<br/>    jdeStrncpyTerminate(ChaveF570810.peunid1, lpDS-&gtszUnidade, DIM(lpDS-&gtszUnidade));		<br/>    jdeStrncpyTerminate(ChaveF570810.pecup, lpDS-&gtszOrigem, DIM(lpDS-&gtszOrigem));		<br/>    MathCopy(&ChaveF570810.penivc, &lpDS-&gtmnNivelExecutivoPara);<br/>    MathCopy(&ChaveF570810.penivp, &lpDS-&gtmnNivelPai);<br/><br/>    idJDBReturn = JDB_FetchKeyed(hF570810,ID_F570810_ANOMES_NIVC_NIVP_UNID1__CUP, &ChaveF570810, 5, (void*)NULL, FALSE);		<br/>    if (idJDBReturn == JDEDB_PASSED) {<br/><br/>        jdeStrncpyTerminate(lpDS-&gtszMsgErro, _J("Ja existe executivo na carteira de clientes."), DIM(lpDS-&gtszMsgErro));<br/>	    return 'S';<br/><br/>    }*/<br/><br/>    return 'N';<br/><br/>};<br/><br/>ID I570860B_TrocaCabecalho (LPDSD570860D lpDS, HREQUEST hF570860) {<br/><br/>    ID			  idJDBReturn      = JDEDB_PASSED;<br/>    KEY1_F570860  ChaveF570860     = {0};<br/>    F570860       RegistroF570860  = {0};<br/><br/>    MathCopy(&ChaveF570860.ftanmesent, &lpDS-&gtmnAnoMes);<br/>    jdeStrncpyTerminate(ChaveF570860.ftunid1, lpDS-&gtszUnidadePai, DIM(lpDS-&gtszUnidadePai));		<br/>    jdeStrncpyTerminate(ChaveF570860.ftcup, lpDS-&gtszOrigemPai, DIM(lpDS-&gtszOrigemPai));		<br/>    MathCopy(&ChaveF570860.ftnivp, &lpDS-&gtmnNivelPai);<br/>    jdeStrncpyTerminate(ChaveF570860.ftunid2, lpDS-&gtszUnidade, DIM(lpDS-&gtszUnidade));<br/>    jdeStrncpyTerminate(ChaveF570860.fta801, lpDS-&gtszOrigem, DIM(lpDS-&gtszOrigem));		<br/>    MathCopy(&ChaveF570860.ftnivc, &lpDS-&gtmnNivelExecutivo);<br/><br/>    idJDBReturn = JDB_FetchKeyed(hF570860,ID_F570860_PK, &ChaveF570860, 7, &RegistroF570860, FALSE);		<br/>    if (idJDBReturn == JDEDB_PASSED) {<br/>       <br/>        idJDBReturn = JDB_DeleteTable (hF570860, NID_F570860, ID_F570860_PK, (ID)NULL, &ChaveF570860, 7);   <br/>        if (idJDBReturn == JDEDB_PASSED) {<br/><br/>            MathCopy(&RegistroF570860.ftnivc, &lpDS-&gtmnNivelExecutivoPara);<br/>            idJDBReturn = JDB_InsertTable(hF570860, NID_F570860, (ID)0, &RegistroF570860);<br/>            return idJDBReturn;<br/>            <br/>        } else {<br/><br/>            jdeStrncpyTerminate(lpDS-&gtszMsgErro, _J("Erro alterando Executivo no Placar."), DIM(lpDS-&gtszMsgErro));<br/>            return idJDBReturn;<br/><br/>        }<br/><br/>    } else {<br/><br/>        jdeStrncpyTerminate(lpDS-&gtszMsgErro, _J("Erro alterando Executivo no Placar."), DIM(lpDS-&gtszMsgErro));<br/>        return idJDBReturn;<br/><br/>    }<br/><br/>}<br/><br/>ID I570860B_TrocaCabecalhoFilhos (LPDSD570860D lpDS, HREQUEST hF570860) {<br/><br/>    ID			  idJDBReturn      = JDEDB_PASSED;<br/>    KEY6_F570860  ChaveF570860Pai  = {0};<br/>    KEY1_F570860  ChaveF570860     = {0};<br/>    F570860       RegistroF570860  = {0};<br/><br/>    MathCopy(&ChaveF570860Pai.ftanmesent, &lpDS-&gtmnAnoMes);<br/>    MathCopy(&ChaveF570860Pai.ftnivp, &lpDS-&gtmnNivelExecutivo);<br/>    jdeStrncpyTerminate(ChaveF570860Pai.ftunid2, lpDS-&gtszUnidade, DIM(lpDS-&gtszUnidade));<br/>    jdeStrncpyTerminate(ChaveF570860Pai.fta801, lpDS-&gtszOrigem, DIM(lpDS-&gtszOrigem));		<br/><br/>    idJDBReturn = JDB_SelectKeyed(hF570860,ID_F570860_PAI, &ChaveF570860Pai, 4);		<br/>    if (idJDBReturn == JDEDB_PASSED) {<br/><br/>        while (JDB_Fetch(hF570860, &RegistroF570860, 0) ) {<br/><br/>            MathCopy(&ChaveF570860.ftanmesent, &RegistroF570860.ftanmesent);<br/>            MathCopy(&ChaveF570860.ftnivp, &RegistroF570860.ftnivp);<br/>            MathCopy(&ChaveF570860.ftnivc, &RegistroF570860.ftnivc);<br/>            jdeStrncpyTerminate(ChaveF570860.ftunid2, RegistroF570860.ftunid2, DIM(RegistroF570860.ftunid2));<br/>            jdeStrncpyTerminate(ChaveF570860.fta801, RegistroF570860.fta801, DIM(RegistroF570860.fta801));		<br/>            jdeStrncpyTerminate(ChaveF570860.ftunid1, RegistroF570860.ftunid1, DIM(RegistroF570860.ftunid1));<br/>            jdeStrncpyTerminate(ChaveF570860.ftcup, RegistroF570860.ftcup, DIM(RegistroF570860.ftcup));		<br/>            idJDBReturn = JDB_DeleteTable (hF570860, NID_F570860, ID_F570860_PK, (ID)NULL, &ChaveF570860, 7);   <br/>            if (idJDBReturn == JDEDB_PASSED) {<br/><br/>                MathCopy(&RegistroF570860.ftnivp, &lpDS-&gtmnNivelExecutivoPara);<br/>                idJDBReturn = JDB_InsertTable(hF570860, NID_F570860, (ID)0, &RegistroF570860);<br/><br/>                if (idJDBReturn != JDEDB_PASSED) {<br/><br/>                    jdeStrncpyTerminate(lpDS-&gtszMsgErro, _J("Erro alterando placares filhos do executivo."), DIM(lpDS-&gtszMsgErro));    <br/>                    return idJDBReturn;<br/><br/>                }<br/>                <br/>                <br/>            } else {<br/><br/>                jdeStrncpyTerminate(lpDS-&gtszMsgErro, _J("Erro alterando placares filhos do executivo."), DIM(lpDS-&gtszMsgErro));    <br/>                return idJDBReturn;<br/><br/>            }<br/><br/>        }<br/>       <br/>    } else {<br/><br/>        jdeStrncpyTerminate(lpDS-&gtszMsgErro, _J("Erro alterando placares filhos do executivo."), DIM(lpDS-&gtszMsgErro));    <br/>        return idJDBReturn;<br/><br/>    }<br/><br/>    return JDEDB_PASSED;<br/><br/>}<br/><br/>ID I570860B_TrocaDetalhe (LPDSD570860D lpDS, HREQUEST hF570861) {<br/><br/>    ID			  idJDBReturn      = JDEDB_PASSED;<br/>    KEY1_F570861  ChaveF570861   = {0};<br/>    F570861       RegistroF570861  = {0};<br/><br/>    MathCopy(&ChaveF570861.ftanmesent, &lpDS-&gtmnAnoMes);<br/>    jdeStrncpyTerminate(ChaveF570861.ftunid1, lpDS-&gtszUnidadePai, DIM(lpDS-&gtszUnidadePai));		<br/>    jdeStrncpyTerminate(ChaveF570861.ftcup, lpDS-&gtszOrigemPai, DIM(lpDS-&gtszOrigemPai));		<br/>    MathCopy(&ChaveF570861.ftnivp, &lpDS-&gtmnNivelPai);<br/>    jdeStrncpyTerminate(ChaveF570861.ftunid2, lpDS-&gtszUnidade, DIM(lpDS-&gtszUnidade));<br/>    jdeStrncpyTerminate(ChaveF570861.fta801, lpDS-&gtszOrigem, DIM(lpDS-&gtszOrigem));		<br/>    MathCopy(&ChaveF570861.ftnivc, &lpDS-&gtmnNivelExecutivo);<br/><br/>    idJDBReturn = JDB_SelectKeyed(hF570861, ID_F570861_PK, &ChaveF570861, 7);<br/><br/>    if (idJDBReturn != JDEDB_PASSED) return idJDBReturn;<br/><br/>    while ( JDB_Fetch(hF570861, &RegistroF570861, 0) ) {<br/><br/>        jdeStrncpyTerminate(ChaveF570861.ftcoddes, RegistroF570861.ftcoddes, DIM(RegistroF570861.ftcoddes));		<br/>        idJDBReturn = JDB_DeleteTable (hF570861, NID_F570861, ID_F570861_PK, (ID)NULL, &ChaveF570861, 8);   <br/><br/>        if (idJDBReturn == JDEDB_PASSED) {<br/><br/>            MathCopy(&RegistroF570861.ftnivc, &lpDS-&gtmnNivelExecutivoPara);<br/>            idJDBReturn = JDB_InsertTable(hF570861, NID_F570861, (ID)0, &RegistroF570861);<br/><br/>            if (idJDBReturn != JDEDB_PASSED) {<br/><br/>                jdeStrncpyTerminate(lpDS-&gtszMsgErro, _J("Erro alterando detalhe do placa do executivo."), DIM(lpDS-&gtszMsgErro));    <br/>                return idJDBReturn;<br/><br/>            }<br/><br/>        } else {<br/><br/>            jdeStrncpyTerminate(lpDS-&gtszMsgErro, _J("Erro alterando detalhe do placa do executivo."), DIM(lpDS-&gtszMsgErro));    <br/>            return idJDBReturn;<br/><br/>        }<br/><br/><br/>    }<br/><br/>    return JDEDB_PASSED;<br/><br/>}<br/><br/>ID I570860B_TrocaDetalheFilhos (LPDSD570860D lpDS, HREQUEST hF570861) {<br/><br/>    ID			  idJDBReturn      = JDEDB_PASSED;<br/>    KEY3_F570861  ChaveF570861Pai  = {0};<br/>    KEY1_F570861  ChaveF570861     = {0};<br/>    F570861       RegistroF570861  = {0};<br/><br/>    MathCopy(&ChaveF570861Pai.ftanmesent, &lpDS-&gtmnAnoMes);<br/>    MathCopy(&ChaveF570861Pai.ftnivp, &lpDS-&gtmnNivelExecutivo);<br/>    jdeStrncpyTerminate(ChaveF570861Pai.ftunid2, lpDS-&gtszUnidade, DIM(lpDS-&gtszUnidade));<br/>    jdeStrncpyTerminate(ChaveF570861Pai.fta801, lpDS-&gtszOrigem, DIM(lpDS-&gtszOrigem));		<br/><br/>    idJDBReturn = JDB_SelectKeyed(hF570861, ID_F570861_PAI_FILHO, &ChaveF570861Pai, 4);<br/><br/>    if (idJDBReturn != JDEDB_PASSED) return idJDBReturn;<br/><br/>    while ( JDB_Fetch(hF570861, &RegistroF570861, 0) ) {<br/><br/>        MathCopy(&ChaveF570861.ftanmesent, &RegistroF570861.ftanmesent);<br/>        MathCopy(&ChaveF570861.ftnivp, &RegistroF570861.ftnivp);<br/>        MathCopy(&ChaveF570861.ftnivc, &RegistroF570861.ftnivc);<br/>        jdeStrncpyTerminate(ChaveF570861.ftunid2, RegistroF570861.ftunid2, DIM(RegistroF570861.ftunid2));<br/>        jdeStrncpyTerminate(ChaveF570861.fta801, RegistroF570861.fta801, DIM(RegistroF570861.fta801));		<br/>        jdeStrncpyTerminate(ChaveF570861.ftunid1, RegistroF570861.ftunid1, DIM(RegistroF570861.ftunid1));<br/>        jdeStrncpyTerminate(ChaveF570861.ftcup, RegistroF570861.ftcup, DIM(RegistroF570861.ftcup));		<br/>        jdeStrncpyTerminate(ChaveF570861.ftcoddes, RegistroF570861.ftcoddes, DIM(RegistroF570861.ftcoddes));		<br/><br/>        idJDBReturn = JDB_DeleteTable (hF570861, NID_F570861, ID_F570861_PK, (ID)NULL, &ChaveF570861, 8);   <br/>      <br/>        if (idJDBReturn == JDEDB_PASSED) {<br/><br/>            MathCopy(&RegistroF570861.ftnivp, &lpDS-&gtmnNivelExecutivoPara);		<br/>            idJDBReturn = JDB_InsertTable(hF570861, NID_F570861, (ID)0, &RegistroF570861);<br/><br/>            if (idJDBReturn != JDEDB_PASSED) {<br/><br/>                jdeStrncpyTerminate(lpDS-&gtszMsgErro, _J("Erro alterando detalhes dos placares dos filhos do executivo."), DIM(lpDS-&gtszMsgErro));    <br/>                return idJDBReturn;<br/><br/>            }<br/><br/>        } else {<br/><br/>            jdeStrncpyTerminate(lpDS-&gtszMsgErro, _J("Erro alterando detalhes dos placares dos filhos do executivo."), DIM(lpDS-&gtszMsgErro));    <br/>            return idJDBReturn;<br/><br/>        }<br/><br/><br/>    }<br/><br/>    return JDEDB_PASSED;<br/><br/>}<br/><br/>ID I570860B_TrocaPedidosPlacar (LPDSD570860D lpDS, HREQUEST hF570862) {<br/><br/>    ID			  idJDBReturn         = JDEDB_PASSED;<br/>    KEY3_F570862  ChaveF570862Parcial = {0};<br/>    KEY1_F570862  ChaveF570862        = {0};<br/>    F570862       RegistroF570862     = {0};<br/><br/>    MathCopy(&ChaveF570862Parcial.ftanmesent, &lpDS-&gtmnAnoMes);<br/>    jdeStrncpyTerminate(ChaveF570862Parcial.ftunid1, lpDS-&gtszUnidade, DIM(lpDS-&gtszUnidade));		<br/>    jdeStrncpyTerminate(ChaveF570862Parcial.ftcup, lpDS-&gtszOrigem, DIM(lpDS-&gtszOrigem));		<br/>    MathCopy(&ChaveF570862Parcial.ftnivc, &lpDS-&gtmnNivelExecutivo);<br/><br/>    idJDBReturn = JDB_SelectKeyed(hF570862, ID_F570862_ANOMES__UNIDADE__ORIGEM__EXEC, &ChaveF570862Parcial, 4);<br/><br/>    if (idJDBReturn != JDEDB_PASSED) return idJDBReturn;<br/><br/>    while ( JDB_Fetch(hF570862, &RegistroF570862, 0) ) {<br/><br/>        MathCopy(&RegistroF570862.ftnivc, &lpDS-&gtmnNivelExecutivoPara);<br/>        idJDBReturn = JDB_InsertTable(hF570862, NID_F570862, (ID)0, &RegistroF570862);<br/>        if (idJDBReturn == JDEDB_PASSED) {<br/><br/>            MathCopy(&ChaveF570862.ftanmesent, &RegistroF570862.ftanmesent);<br/>            jdeStrncpyTerminate(ChaveF570862.ftunid1, RegistroF570862.ftunid1, DIM(RegistroF570862.ftunid1));		<br/>            jdeStrncpyTerminate(ChaveF570862.ftcup, RegistroF570862.ftcup, DIM(RegistroF570862.ftcup));		<br/>            jdeStrncpyTerminate(ChaveF570862.ftcoddes, RegistroF570862.ftcoddes, DIM(RegistroF570862.ftcoddes));		<br/>            MathCopy(&ChaveF570862.ftnivc, &lpDS-&gtmnNivelExecutivo);<br/>            MathCopy(&ChaveF570862.ftcodprodu, &RegistroF570862.ftcodprodu);<br/>            MathCopy(&ChaveF570862.ftnrpedido, &RegistroF570862.ftnrpedido);<br/>            MathCopy(&ChaveF570862.ftdoc, &RegistroF570862.ftdoc);<br/><br/>            idJDBReturn = JDB_DeleteTable (hF570862, NID_F570862, ID_F570862_PK, (ID)NULL, &ChaveF570862, 8);   <br/>            if (idJDBReturn != JDEDB_PASSED) {<br/><br/>                jdeStrncpyTerminate(lpDS-&gtszMsgErro, _J("Erro alterando detalhes dos placares dos filhos do executivo."), DIM(lpDS-&gtszMsgErro));    <br/>                return idJDBReturn;<br/><br/>            }<br/><br/>        } else {<br/><br/>            jdeStrncpyTerminate(lpDS-&gtszMsgErro, _J("Erro alterando detalhes dos placares dos filhos do executivo."), DIM(lpDS-&gtszMsgErro));    <br/>            return idJDBReturn;<br/><br/>        }<br/><br/><br/>    }<br/><br/>    return JDEDB_PASSED;<br/>}<br/><br/>ID I570860B_TrocaAjustes (LPDSD570860D lpDS, HREQUEST hF570861L) {<br/><br/>    ID			   idJDBReturn          = JDEDB_PASSED;<br/>    KEY4_F570861L  ChaveF570861LParcial = {0};<br/>    KEY1_F570861L  ChaveF570861L        = {0};<br/>    F570861L       RegistroF570861L     = {0};<br/><br/>    MathCopy(&ChaveF570861LParcial.ftanmesent, &lpDS-&gtmnAnoMes);<br/>    jdeStrncpyTerminate(ChaveF570861LParcial.ftunid1, lpDS-&gtszUnidadePai, DIM(lpDS-&gtszUnidadePai));		<br/>    jdeStrncpyTerminate(ChaveF570861LParcial.ftcup, lpDS-&gtszOrigemPai, DIM(lpDS-&gtszOrigemPai));		<br/>    MathCopy(&ChaveF570861LParcial.ftnivp, &lpDS-&gtmnNivelPai);<br/>    jdeStrncpyTerminate(ChaveF570861LParcial.ftunid2, lpDS-&gtszUnidade, DIM(lpDS-&gtszUnidade));		<br/>    jdeStrncpyTerminate(ChaveF570861LParcial.fta801, lpDS-&gtszOrigem, DIM(lpDS-&gtszOrigem));		<br/>    MathCopy(&ChaveF570861LParcial.ftnivc, &lpDS-&gtmnNivelExecutivo);<br/><br/>    idJDBReturn = JDB_SelectKeyed(hF570861L, ID_F570861L_ANO__UNID__CUP__NIVC, &ChaveF570861LParcial, 7);<br/><br/>    if (idJDBReturn != JDEDB_PASSED) return idJDBReturn;<br/><br/>    while ( JDB_Fetch(hF570861L, &RegistroF570861L, 0) ) {<br/><br/>        MathCopy(&RegistroF570861L.ftnivc, &lpDS-&gtmnNivelExecutivoPara);<br/>        idJDBReturn = JDB_InsertTable(hF570861L, NID_F570861L, (ID)0, &RegistroF570861L);<br/>        if (idJDBReturn == JDEDB_PASSED) {<br/><br/>            MathCopy(&ChaveF570861L.ftanmesent, &RegistroF570861L.ftanmesent);<br/>            jdeStrncpyTerminate(ChaveF570861L.ftunid1, RegistroF570861L.ftunid1, DIM(RegistroF570861L.ftunid1));		<br/>            jdeStrncpyTerminate(ChaveF570861L.ftcup, RegistroF570861L.ftcup, DIM(RegistroF570861L.ftcup));		<br/>            jdeStrncpyTerminate(ChaveF570861L.ftcoddes, RegistroF570861L.ftcoddes, DIM(RegistroF570861L.ftcoddes));		<br/>            MathCopy(&ChaveF570861L.ftnivp, &RegistroF570861L.ftnivp);<br/>            MathCopy(&ChaveF570861L.ftnivc, &lpDS-&gtmnNivelExecutivo);<br/>            jdeStrncpyTerminate(ChaveF570861L.ftunid2, RegistroF570861L.ftunid2, DIM(RegistroF570861L.ftunid2));		<br/>            jdeStrncpyTerminate(ChaveF570861L.fta801, RegistroF570861L.fta801, DIM(RegistroF570861L.fta801));		<br/>            MathCopy(&ChaveF570861L.ftseq, &RegistroF570861L.ftseq);<br/><br/>            idJDBReturn = JDB_DeleteTable (hF570861L, NID_F570861L, ID_F570861L_PK, (ID)NULL, &ChaveF570861L, 9);   <br/><br/>            if (idJDBReturn != JDEDB_PASSED) {<br/><br/>                jdeStrncpyTerminate(lpDS-&gtszMsgErro, _J("Erro alterando ajustes do placar do executivo."), DIM(lpDS-&gtszMsgErro));    <br/>                return idJDBReturn;<br/><br/>            }<br/><br/>        } else {<br/><br/>            jdeStrncpyTerminate(lpDS-&gtszMsgErro, _J("Erro alterando ajustes do placar do executivo."), DIM(lpDS-&gtszMsgErro));    <br/>            return idJDBReturn;<br/><br/>        }<br/><br/><br/>    }<br/><br/>    return JDEDB_PASSED;<br/><br/>}<br/><br/>ID I570860B_TrocaAjustesFilhos (LPDSD570860D lpDS, HREQUEST hF570861L) {<br/><br/>    ID			   idJDBReturn          = JDEDB_PASSED;<br/>    KEY5_F570861L  ChaveF570861LParcial = {0};<br/>    KEY1_F570861L  ChaveF570861L        = {0};<br/>    F570861L       RegistroF570861L     = {0};<br/><br/>    MathCopy(&ChaveF570861LParcial.ftanmesent, &lpDS-&gtmnAnoMes);<br/>    jdeStrncpyTerminate(ChaveF570861LParcial.ftunid2, lpDS-&gtszUnidadePai, DIM(lpDS-&gtszUnidadePai));		<br/>    jdeStrncpyTerminate(ChaveF570861LParcial.fta801, lpDS-&gtszOrigemPai, DIM(lpDS-&gtszOrigemPai));		<br/>    MathCopy(&ChaveF570861LParcial.ftnivp, &lpDS-&gtmnNivelPai);<br/><br/>    idJDBReturn = JDB_SelectKeyed(hF570861L, ID_F570861L_ANO__UNID__CUP__NIVC, &ChaveF570861LParcial, 7);<br/><br/>    if (idJDBReturn != JDEDB_PASSED) return idJDBReturn;<br/><br/>    while ( JDB_Fetch(hF570861L, &RegistroF570861L, 0) ) {<br/><br/>        MathCopy(&RegistroF570861L.ftnivp, &lpDS-&gtmnNivelExecutivoPara);<br/>        idJDBReturn = JDB_InsertTable(hF570861L, NID_F570861L, (ID)0, &RegistroF570861L);<br/>        if (idJDBReturn == JDEDB_PASSED) {<br/><br/>            MathCopy(&ChaveF570861L.ftanmesent, &RegistroF570861L.ftanmesent);<br/>            jdeStrncpyTerminate(ChaveF570861L.ftunid1, RegistroF570861L.ftunid1, DIM(RegistroF570861L.ftunid1));		<br/>            jdeStrncpyTerminate(ChaveF570861L.ftcup, RegistroF570861L.ftcup, DIM(RegistroF570861L.ftcup));		<br/>            jdeStrncpyTerminate(ChaveF570861L.ftcoddes, RegistroF570861L.ftcoddes, DIM(RegistroF570861L.ftcoddes));		<br/>            MathCopy(&ChaveF570861L.ftnivp, &RegistroF570861L.ftnivp);<br/>            MathCopy(&ChaveF570861L.ftnivc, &lpDS-&gtmnNivelExecutivo);<br/>            jdeStrncpyTerminate(ChaveF570861L.ftunid2, RegistroF570861L.ftunid2, DIM(RegistroF570861L.ftunid2));		<br/>            jdeStrncpyTerminate(ChaveF570861L.fta801, RegistroF570861L.fta801, DIM(RegistroF570861L.fta801));		<br/>            MathCopy(&ChaveF570861L.ftseq, &RegistroF570861L.ftseq);<br/><br/><br/>            idJDBReturn = JDB_DeleteTable (hF570861L, NID_F570861L, ID_F570861L_PK, (ID)NULL, &ChaveF570861L, 9);   <br/>            if (idJDBReturn != JDEDB_PASSED) {<br/><br/>                jdeStrncpyTerminate(lpDS-&gtszMsgErro, _J("Erro alterando ajustes dos placares dos filhos do executivo."), DIM(lpDS-&gtszMsgErro));    <br/>                return idJDBReturn;<br/><br/>            }<br/><br/>        } else {<br/><br/>            jdeStrncpyTerminate(lpDS-&gtszMsgErro, _J("Erro alterando ajustes dos placares dos filhos do executivo."), DIM(lpDS-&gtszMsgErro));    <br/>            return idJDBReturn;<br/><br/>        }<br/><br/><br/>    }<br/><br/>    return JDEDB_PASSED;<br/><br/>}<br/><br/><br/>ID I570860B_TrocaPedidosMeta (LPDSD570860D lpDS, HREQUEST hF570865) {<br/><br/>    ID			   idJDBReturn         = JDEDB_PASSED;<br/>    KEY2_F570865   ChaveF570865Parcial = {0};<br/>    KEY1_F570865   ChaveF570865        = {0};<br/>    F570865        RegistroF570865     = {0};<br/><br/>    MathCopy(&ChaveF570865Parcial.ftanmesent, &lpDS-&gtmnAnoMes);<br/>    jdeStrncpyTerminate(ChaveF570865Parcial.ftunid1, lpDS-&gtszUnidadePai, DIM(lpDS-&gtszUnidadePai));		<br/>    jdeStrncpyTerminate(ChaveF570865Parcial.ftcup, lpDS-&gtszOrigemPai, DIM(lpDS-&gtszOrigemPai));		<br/>    MathCopy(&ChaveF570865Parcial.ftnivc, &lpDS-&gtmnNivelExecutivo);<br/><br/>    idJDBReturn = JDB_SelectKeyed(hF570865, ID_F570865_ANO__UNID__ORIG__EXEC, &ChaveF570865Parcial, 4);<br/><br/>    if (idJDBReturn != JDEDB_PASSED) return idJDBReturn;<br/><br/>    while ( JDB_Fetch(hF570865, &RegistroF570865, 0) ) {<br/><br/>        MathCopy(&RegistroF570865.ftnivc, &lpDS-&gtmnNivelExecutivoPara);<br/>        idJDBReturn = JDB_InsertTable(hF570865, NID_F570865, (ID)0, &RegistroF570865);<br/>        if (idJDBReturn == JDEDB_PASSED) {<br/><br/>            MathCopy(&ChaveF570865.ftanmesent, &RegistroF570865.ftanmesent);<br/>            jdeStrncpyTerminate(ChaveF570865.ftunid1, RegistroF570865.ftunid1, DIM(RegistroF570865.ftunid1));		<br/>            jdeStrncpyTerminate(ChaveF570865.ftcoddes, RegistroF570865.ftcoddes, DIM(RegistroF570865.ftcoddes));		<br/>            MathCopy(&ChaveF570865.ftnivc, &lpDS-&gtmnNivelExecutivo);<br/>            MathCopy(&ChaveF570865.ftcodprodu, &RegistroF570865.ftcodprodu);<br/>            MathCopy(&ChaveF570865.ftnrpedido, &RegistroF570865.ftnrpedido);<br/>            MathCopy(&ChaveF570865.ftdoc, &RegistroF570865.ftdoc);<br/><br/>            idJDBReturn = JDB_DeleteTable (hF570865, NID_F570865, ID_F570865_PK570865, (ID)NULL, &ChaveF570865, 8);   <br/><br/>            if (idJDBReturn != JDEDB_PASSED) {<br/><br/>                jdeStrncpyTerminate(lpDS-&gtszMsgErro, _J("Erro alterando pedidos que compõe a meta do executivo."), DIM(lpDS-&gtszMsgErro));    <br/>                return idJDBReturn;<br/><br/>            }<br/><br/>        } else {<br/><br/>            jdeStrncpyTerminate(lpDS-&gtszMsgErro, _J("Erro alterando pedidos que compõe a meta do executivo."), DIM(lpDS-&gtszMsgErro));    <br/>            return idJDBReturn;<br/><br/>        }<br/><br/>    }<br/><br/>    return JDEDB_PASSED;<br/><br/>}<br/><br/>ID I570860B_TrocaCarteira (LPDSD570860D lpDS, HREQUEST hF570810) {<br/><br/>    ID			   idJDBReturn         = JDEDB_PASSED;<br/>    KEY3_F570810   ChaveF570810Parcial = {0};<br/>    KEY1_F570810   ChaveF570810        = {0};<br/>    F570810        RegistroF570810     = {0};<br/><br/>    MathCopy(&ChaveF570810Parcial.peanmesent, &lpDS-&gtmnAnoMes);<br/>    jdeStrncpyTerminate(ChaveF570810Parcial.peunid1, lpDS-&gtszUnidade, DIM(lpDS-&gtszUnidade));		<br/>    jdeStrncpyTerminate(ChaveF570810Parcial.pecup, lpDS-&gtszOrigem, DIM(lpDS-&gtszOrigem));		<br/>    MathCopy(&ChaveF570810Parcial.penivc, &lpDS-&gtmnNivelExecutivo);<br/><br/>    idJDBReturn = JDB_SelectKeyed(hF570810, ID_F570810_ANOMES_NIVELC_UNID1__CUP, &ChaveF570810Parcial, 4);<br/><br/>    if (idJDBReturn != JDEDB_PASSED) return idJDBReturn;<br/><br/>    while ( JDB_Fetch(hF570810, &RegistroF570810, 0) ) {<br/><br/>        MathCopy(&ChaveF570810.peanmesent, &RegistroF570810.peanmesent);<br/>        jdeStrncpyTerminate(ChaveF570810.peunid1, RegistroF570810.peunid1, DIM(RegistroF570810.peunid1));		<br/>        jdeStrncpyTerminate(ChaveF570810.pecup, RegistroF570810.pecup, DIM(RegistroF570810.pecup));		<br/>        MathCopy(&ChaveF570810.penivc, &RegistroF570810.penivc);<br/>        MathCopy(&ChaveF570810.penivp, &RegistroF570810.penivp);<br/><br/>        idJDBReturn = JDB_DeleteTable (hF570810, NID_F570810, ID_F570810_ANOMES_NIVC_NIVP_UNID1__CUP, (ID)NULL, &ChaveF570810, 5);   <br/>        if (idJDBReturn == JDEDB_PASSED) {<br/><br/>            MathCopy(&RegistroF570810.penivc, &lpDS-&gtmnNivelExecutivoPara);<br/>            idJDBReturn = JDB_InsertTable(hF570810, NID_F570810, (ID)0, &RegistroF570810);<br/><br/>            if (idJDBReturn != JDEDB_PASSED) {<br/><br/>                jdeStrncpyTerminate(lpDS-&gtszMsgErro, _J("Erro alterando carteira de clientes do executivo."), DIM(lpDS-&gtszMsgErro));    <br/>                return idJDBReturn;<br/><br/>            }<br/><br/>        } else {<br/><br/>            jdeStrncpyTerminate(lpDS-&gtszMsgErro, _J("Erro alterando carteira de clientes do executivo."), DIM(lpDS-&gtszMsgErro));    <br/>            return idJDBReturn;<br/><br/>        }<br/><br/>    }<br/><br/>    return JDEDB_PASSED;<br/><br/>}<br/><br/>ID I570860B_TrocaCarteiraFilhos (LPDSD570860D lpDS, HREQUEST hF570810) {<br/><br/>    ID			   idJDBReturn         = JDEDB_PASSED;<br/>    KEY2_F570810   ChaveF570810Parcial = {0};<br/>    KEY1_F570810   ChaveF570810        = {0};<br/>    F570810        RegistroF570810     = {0};<br/><br/>    MathCopy(&ChaveF570810Parcial.peanmesent, &lpDS-&gtmnAnoMes);<br/>    jdeStrncpyTerminate(ChaveF570810Parcial.peunid1, lpDS-&gtszUnidade, DIM(lpDS-&gtszUnidade));		<br/>    jdeStrncpyTerminate(ChaveF570810Parcial.pecup, lpDS-&gtszOrigem, DIM(lpDS-&gtszOrigem));		<br/>    MathCopy(&ChaveF570810Parcial.penivp, &lpDS-&gtmnNivelExecutivo);<br/><br/>    idJDBReturn = JDB_SelectKeyed(hF570810, ID_F570810_ANOMES_NIVELP__UNID1__CUP, &ChaveF570810Parcial, 4);<br/><br/>    if (idJDBReturn != JDEDB_PASSED) return idJDBReturn;<br/><br/>    while ( JDB_Fetch(hF570810, &RegistroF570810, 0) ) {<br/><br/>        MathCopy(&ChaveF570810.peanmesent, &RegistroF570810.peanmesent);<br/>        jdeStrncpyTerminate(ChaveF570810.peunid1, RegistroF570810.peunid1, DIM(RegistroF570810.peunid1));		<br/>        jdeStrncpyTerminate(ChaveF570810.pecup, RegistroF570810.pecup, DIM(RegistroF570810.pecup));		<br/>        MathCopy(&ChaveF570810.penivc, &RegistroF570810.penivc);<br/>        MathCopy(&ChaveF570810.penivp, &RegistroF570810.penivp);<br/><br/>        idJDBReturn = JDB_DeleteTable (hF570810, NID_F570810, ID_F570810_ANOMES_NIVC_NIVP_UNID1__CUP, (ID)NULL, &ChaveF570810, 5);   <br/>        if (idJDBReturn == JDEDB_PASSED) {<br/><br/>            MathCopy(&RegistroF570810.penivp, &lpDS-&gtmnNivelExecutivoPara);<br/>            idJDBReturn = JDB_InsertTable(hF570810, NID_F570810, (ID)0, &RegistroF570810);<br/><br/>            if (idJDBReturn != JDEDB_PASSED) {<br/><br/>                jdeStrncpyTerminate(lpDS-&gtszMsgErro, _J("Erro alterando carteira de clientes dos filhos do executivo."), DIM(lpDS-&gtszMsgErro));    <br/>                return idJDBReturn;<br/><br/>            }         <br/><br/>        } else {<br/><br/>            jdeStrncpyTerminate(lpDS-&gtszMsgErro, _J("Erro alterando carteira de clientes dos filhos do executivo."), DIM(lpDS-&gtszMsgErro));    <br/>            return idJDBReturn;<br/><br/>        }<br/><br/>    }<br/><br/>    return JDEDB_PASSED;<br/><br/>};<br/><br/>ID I570860B_TrocaPedidosExecutados (LPDSD570860D lpDS, HREQUEST hF570811) {<br/><br/>    ID			   idJDBReturn         = JDEDB_PASSED;<br/>    KEY6_F570811   ChaveF570811Parcial = {0};<br/>    KEY1_F570811   ChaveF570811        = {0};<br/>    F570811        RegistroF570811     = {0};<br/><br/>    MathCopy(&ChaveF570811Parcial.peanmeemi, &lpDS-&gtmnAnoMes);<br/>    jdeStrncpyTerminate(ChaveF570811Parcial.peunid1, lpDS-&gtszUnidade, DIM(lpDS-&gtszUnidade));		<br/>    jdeStrncpyTerminate(ChaveF570811Parcial.pecup, lpDS-&gtszOrigem, DIM(lpDS-&gtszOrigem));		<br/>    MathCopy(&ChaveF570811Parcial.penivp, &lpDS-&gtmnNivelExecutivo);<br/><br/>    idJDBReturn = JDB_SelectKeyed(hF570811, ID_F570811_ANMEEMI__UNID1__CUP__NIVP, &ChaveF570811Parcial, 4);<br/><br/>    if (idJDBReturn != JDEDB_PASSED) return idJDBReturn;<br/><br/>    while ( JDB_Fetch(hF570811, &RegistroF570811, 0) ) {<br/><br/>        MathCopy(&ChaveF570811.peanmeemi, &RegistroF570811.peanmeemi);<br/>        jdeStrncpyTerminate(ChaveF570811.peunid1, RegistroF570811.peunid1, DIM(RegistroF570811.peunid1));		<br/>        jdeStrncpyTerminate(ChaveF570811.pecup, RegistroF570811.pecup, DIM(RegistroF570811.pecup));		<br/>        MathCopy(&ChaveF570811.pecodprodu, &RegistroF570811.pecodprodu);<br/>        MathCopy(&ChaveF570811.penrpedido, &RegistroF570811.penrpedido);<br/>        MathCopy(&ChaveF570811.pedoc, &RegistroF570811.pedoc);<br/><br/>        idJDBReturn = JDB_DeleteTable (hF570811, NID_F570811, ID_F570811_DEFAULT, (ID)NULL, &ChaveF570811, 6);   <br/>        if (idJDBReturn == JDEDB_PASSED) {<br/><br/>            MathCopy(&RegistroF570811.penivp, &lpDS-&gtmnNivelExecutivoPara);<br/>            idJDBReturn = JDB_InsertTable(hF570811, NID_F570811, (ID)0, &RegistroF570811);<br/><br/>            if (idJDBReturn != JDEDB_PASSED) {<br/><br/>                jdeStrncpyTerminate(lpDS-&gtszMsgErro, _J("Erro alterando pedidos executados do executivo."), DIM(lpDS-&gtszMsgErro));    <br/>                return idJDBReturn;<br/><br/>            }            <br/><br/>        } else {<br/><br/>            jdeStrncpyTerminate(lpDS-&gtszMsgErro, _J("Erro alterando pedidos executados do executivo."), DIM(lpDS-&gtszMsgErro));    <br/>            return idJDBReturn;<br/><br/>        }<br/><br/>    }<br/><br/>    return JDEDB_PASSED;<br/><br/>}<br/><br/>ID I570860B_TrocaCabecalhoGerencia (LPDSD570860D lpDS, HREQUEST hF570860) {<br/><br/>    ID			  idJDBReturn         = JDEDB_PASSED;<br/>    KEY5_F570860  ChaveF570860Parcial = {0};<br/>    KEY1_F570860  ChaveF570860        = {0};<br/>    F570860       RegistroF570860     = {0};<br/><br/>    MathCopy(&ChaveF570860Parcial.ftanmesent, &lpDS-&gtmnAnoMes);<br/>    jdeStrncpyTerminate(ChaveF570860Parcial.ftunid2, (const JCHAR *)_J("GER"), DIM(ChaveF570860Parcial.ftunid2));		<br/>    jdeStrncpyTerminate(ChaveF570860Parcial.ftunid1, lpDS-&gtszUnidade, DIM(lpDS-&gtszUnidade));<br/>    jdeStrncpyTerminate(ChaveF570860Parcial.ftcup, lpDS-&gtszOrigem, DIM(lpDS-&gtszOrigem));		<br/>    MathCopy(&ChaveF570860Parcial.ftnivc, &lpDS-&gtmnNivelExecutivo);<br/><br/><br/>    JDB_ClearSelection(hF570860);<br/>    idJDBReturn = JDB_SelectKeyed(hF570860,ID_F570860_PK___NIVP, &ChaveF570860Parcial, 5);		<br/>    <br/>    if (idJDBReturn == JDEDB_PASSED) {<br/><br/>        while ( JDB_Fetch(hF570860, &RegistroF570860, 0) ) {<br/><br/>            MathCopy(&ChaveF570860.ftanmesent, &RegistroF570860.ftanmesent);<br/>            jdeStrncpyTerminate(ChaveF570860.ftunid1, RegistroF570860.ftunid1, DIM(RegistroF570860.ftunid1));<br/>            jdeStrncpyTerminate(ChaveF570860.ftcup, RegistroF570860.ftcup, DIM(RegistroF570860.ftcup));		<br/>            jdeStrncpyTerminate(ChaveF570860.ftunid2, RegistroF570860.ftunid2, DIM(RegistroF570860.ftunid2));		<br/>            jdeStrncpyTerminate(ChaveF570860.fta801, RegistroF570860.fta801, DIM(RegistroF570860.fta801));		<br/>            MathCopy(&ChaveF570860.ftnivc, &RegistroF570860.ftnivc);<br/>            MathCopy(&ChaveF570860.ftnivp, &RegistroF570860.ftnivp);<br/>            idJDBReturn = JDB_DeleteTable (hF570860, NID_F570860, ID_F570860_PK, (ID)NULL, &ChaveF570860, 7);   <br/>            if (idJDBReturn == JDEDB_PASSED) {<br/><br/>                MathCopy(&RegistroF570860.ftnivc, &lpDS-&gtmnNivelExecutivoPara);<br/>                idJDBReturn = JDB_InsertTable(hF570860, NID_F570860, (ID)0, &RegistroF570860);<br/><br/>                if (idJDBReturn != JDEDB_PASSED) {<br/><br/>                    jdeStrncpyTerminate(lpDS-&gtszMsgErro, _J("Erro alterando arvore de gerencia para o executivo."), DIM(lpDS-&gtszMsgErro));    <br/>                    return idJDBReturn;<br/><br/>                }           <br/><br/>            } else {<br/><br/>                jdeStrncpyTerminate(lpDS-&gtszMsgErro, _J("Erro alterando arvore de gerencia para o executivo."), DIM(lpDS-&gtszMsgErro));    <br/>                return idJDBReturn;<br/><br/>            }<br/><br/>        }<br/><br/>    } else {<br/><br/>        jdeStrncpyTerminate(lpDS-&gtszMsgErro, _J("Erro alterando arvore de gerencia para o executivo."), DIM(lpDS-&gtszMsgErro));    <br/>        return idJDBReturn;<br/><br/>    }<br/><br/>    return JDEDB_PASSED;<br/><br/>}<br/><br/>ID I570860B_TrocaDetalheGerencia (LPDSD570860D lpDS, HREQUEST hF570861) {<br/><br/>    ID			  idJDBReturn         = JDEDB_PASSED;<br/>    KEY5_F570861  ChaveF570861Parcial = {0};<br/>    KEY1_F570861  ChaveF570861        = {0};<br/>    F570861       RegistroF570861     = {0};<br/><br/>    MathCopy(&ChaveF570861Parcial.ftanmesent, &lpDS-&gtmnAnoMes);<br/>    jdeStrncpyTerminate(ChaveF570861Parcial.ftunid2, (const JCHAR*)_J("GER"), DIM(ChaveF570861Parcial.ftunid2));		<br/>    jdeStrncpyTerminate(ChaveF570861Parcial.ftunid1, lpDS-&gtszUnidade, DIM(lpDS-&gtszUnidade));<br/>    jdeStrncpyTerminate(ChaveF570861Parcial.ftcup, lpDS-&gtszOrigem, DIM(lpDS-&gtszOrigem));		<br/>    MathCopy(&ChaveF570861Parcial.ftnivc, &lpDS-&gtmnNivelExecutivo);<br/><br/><br/>    JDB_ClearSelection(hF570861);<br/>    idJDBReturn = JDB_SelectKeyed(hF570861,ID_F570861_PK___NIVP, &ChaveF570861Parcial, 5);		<br/>    <br/>    if (idJDBReturn == JDEDB_PASSED) {<br/><br/>        while ( JDB_Fetch(hF570861, &RegistroF570861, 0) ) {<br/><br/>            MathCopy(&ChaveF570861.ftanmesent, &RegistroF570861.ftanmesent);<br/>            jdeStrncpyTerminate(ChaveF570861.ftunid1, RegistroF570861.ftunid1, DIM(RegistroF570861.ftunid1));<br/>            jdeStrncpyTerminate(ChaveF570861.ftcup, RegistroF570861.ftcup, DIM(RegistroF570861.ftcup));		<br/>            jdeStrncpyTerminate(ChaveF570861.ftunid2, RegistroF570861.ftunid2, DIM(RegistroF570861.ftunid2));		<br/>            jdeStrncpyTerminate(ChaveF570861.fta801, RegistroF570861.fta801, DIM(RegistroF570861.fta801));		<br/>            MathCopy(&ChaveF570861.ftnivc, &RegistroF570861.ftnivc);<br/>            MathCopy(&ChaveF570861.ftnivp, &RegistroF570861.ftnivp);<br/>            jdeStrncpyTerminate(ChaveF570861.ftcoddes, RegistroF570861.ftcoddes, DIM(RegistroF570861.ftcoddes));		<br/><br/>            idJDBReturn = JDB_DeleteTable (hF570861, NID_F570861, ID_F570861_PK, (ID)NULL, &ChaveF570861, 8);   <br/>            if (idJDBReturn == JDEDB_PASSED) {<br/><br/>                MathCopy(&RegistroF570861.ftnivc, &lpDS-&gtmnNivelExecutivoPara);<br/>                idJDBReturn = JDB_InsertTable(hF570861, NID_F570861, (ID)0, &RegistroF570861);<br/><br/>                if (idJDBReturn != JDEDB_PASSED) {<br/><br/>                    jdeStrncpyTerminate(lpDS-&gtszMsgErro, _J("Erro alterando detalhes da arvore de gerencia para o executivo."), DIM(lpDS-&gtszMsgErro));    <br/>                    return idJDBReturn;<br/><br/>                }           <br/><br/>            } else {<br/><br/>                jdeStrncpyTerminate(lpDS-&gtszMsgErro, _J("Erro alterando detalhes da arvore de gerencia para o executivo."), DIM(lpDS-&gtszMsgErro));    <br/>                return idJDBReturn;<br/><br/>            }<br/><br/>        }<br/><br/>    } else {<br/><br/>        jdeStrncpyTerminate(lpDS-&gtszMsgErro, _J("Erro alterando detalhes da arvore de gerencia para o executivo."), DIM(lpDS-&gtszMsgErro));    <br/>        return idJDBReturn;<br/><br/>    }<br/><br/>    return JDEDB_PASSED;<br/><br/>}<br/><br/>ID I570860B_TrocaAjustesGerencia (LPDSD570860D lpDS, HREQUEST hF570861L) {<br/><br/>    ID			   idJDBReturn          = JDEDB_PASSED;<br/>    KEY6_F570861L  ChaveF570861LParcial = {0};<br/>    KEY1_F570861L  ChaveF570861L        = {0};<br/>    F570861L       RegistroF570861L     = {0};<br/><br/>    MathCopy(&ChaveF570861LParcial.ftanmesent, &lpDS-&gtmnAnoMes);<br/>    jdeStrncpyTerminate(ChaveF570861LParcial.ftunid1, lpDS-&gtszUnidadePai, DIM(lpDS-&gtszUnidadePai));		<br/>    jdeStrncpyTerminate(ChaveF570861LParcial.ftcup, lpDS-&gtszOrigemPai, DIM(lpDS-&gtszOrigemPai));		<br/>    jdeStrncpyTerminate(ChaveF570861LParcial.ftunid2, (const JCHAR *)_J("GER"), DIM(ChaveF570861LParcial.ftunid2) );		<br/>    MathCopy(&ChaveF570861LParcial.ftnivc, &lpDS-&gtmnNivelExecutivo);<br/><br/>    idJDBReturn = JDB_SelectKeyed(hF570861L, ID_F570861L_ANO___UNID2__UNID1__CUP__NIVC, &ChaveF570861LParcial, 5);<br/><br/>    if (idJDBReturn != JDEDB_PASSED) return idJDBReturn;<br/><br/>    while ( JDB_Fetch(hF570861L, &RegistroF570861L, 0) ) {<br/><br/>        MathCopy(&RegistroF570861L.ftnivc, &lpDS-&gtmnNivelExecutivoPara);<br/>        idJDBReturn = JDB_InsertTable(hF570861L, NID_F570861L, (ID)0, &RegistroF570861L);<br/>        if (idJDBReturn == JDEDB_PASSED) {<br/><br/>            MathCopy(&ChaveF570861L.ftanmesent, &RegistroF570861L.ftanmesent);<br/>            jdeStrncpyTerminate(ChaveF570861L.ftunid1, RegistroF570861L.ftunid1, DIM(RegistroF570861L.ftunid1));		<br/>            jdeStrncpyTerminate(ChaveF570861L.ftcup, RegistroF570861L.ftcup, DIM(RegistroF570861L.ftcup));		<br/>            jdeStrncpyTerminate(ChaveF570861L.ftcoddes, RegistroF570861L.ftcoddes, DIM(RegistroF570861L.ftcoddes));		<br/>            MathCopy(&ChaveF570861L.ftnivp, &RegistroF570861L.ftnivp);<br/>            MathCopy(&ChaveF570861L.ftnivc, &lpDS-&gtmnNivelExecutivo);<br/>            jdeStrncpyTerminate(ChaveF570861L.ftunid2, RegistroF570861L.ftunid2, DIM(RegistroF570861L.ftunid2));		<br/>            jdeStrncpyTerminate(ChaveF570861L.fta801, RegistroF570861L.fta801, DIM(RegistroF570861L.fta801));		<br/>            MathCopy(&ChaveF570861L.ftseq, &RegistroF570861L.ftseq);<br/><br/><br/>            idJDBReturn = JDB_DeleteTable (hF570861L, NID_F570861L, ID_F570861L_PK, (ID)NULL, &ChaveF570861L, 9);   <br/>            if (idJDBReturn != JDEDB_PASSED) {<br/><br/>                jdeStrncpyTerminate(lpDS-&gtszMsgErro, _J("Erro alterando ajuestes da arvore de gerencia para o executivo."), DIM(lpDS-&gtszMsgErro));    <br/>                return idJDBReturn;<br/><br/>            }<br/><br/>        } else {<br/><br/>            jdeStrncpyTerminate(lpDS-&gtszMsgErro, _J("Erro alterando ajuestes da arvore de gerencia para o executivo."), DIM(lpDS-&gtszMsgErro));    <br/>            return idJDBReturn;<br/><br/>        }<br/><br/><br/>    }<br/><br/>    return JDEDB_PASSED;<br/><br/>}<br/><br/>ID I570860B_TrocaAuxiliarMeta (LPDSD570860D lpDS, HREQUEST hF570864) {<br/><br/>    ID			  idJDBReturn         = JDEDB_PASSED;<br/>    KEY1_F570864  ChaveF570864        = {0};<br/>    KEY1_F570864  ChaveF570864Parcial = {0};<br/>    F570864       RegistroF570864     = {0};<br/><br/>    MathCopy(&ChaveF570864Parcial.ftanmesent, &lpDS-&gtmnAnoMes);<br/>    jdeStrncpyTerminate(ChaveF570864Parcial.ftunid1, lpDS-&gtszUnidade, DIM(lpDS-&gtszUnidade));		<br/>    MathCopy(&ChaveF570864Parcial.ftnivc, &lpDS-&gtmnNivelExecutivo);<br/>    jdeStrncpyTerminate(ChaveF570864Parcial.ftcup, lpDS-&gtszOrigem, DIM(lpDS-&gtszOrigem));		<br/><br/><br/>    idJDBReturn = JDB_SelectKeyed(hF570864, ID_F570864_PK, &ChaveF570864Parcial, 4);<br/><br/>    if (idJDBReturn != JDEDB_PASSED) return idJDBReturn;<br/><br/>    while ( JDB_Fetch(hF570864, &RegistroF570864, 0) ) {<br/><br/>        MathCopy(&RegistroF570864.ftnivc, &lpDS-&gtmnNivelExecutivoPara);<br/>        idJDBReturn = JDB_InsertTable(hF570864, NID_F570864, (ID)0, &RegistroF570864);<br/>        if (idJDBReturn == JDEDB_PASSED) {<br/><br/>            MathCopy(&ChaveF570864.ftanmesent, &RegistroF570864.ftanmesent);<br/>            jdeStrncpyTerminate(ChaveF570864.ftunid1, RegistroF570864.ftunid1, DIM(RegistroF570864.ftunid1));		<br/>            jdeStrncpyTerminate(ChaveF570864.ftcup, RegistroF570864.ftcup, DIM(RegistroF570864.ftcup));		<br/>            jdeStrncpyTerminate(ChaveF570864.ftcoddes, RegistroF570864.ftcoddes, DIM(RegistroF570864.ftcoddes));		<br/>            MathCopy(&ChaveF570864.ftnivc, &lpDS-&gtmnNivelExecutivo);<br/><br/>            idJDBReturn = JDB_DeleteTable (hF570864, NID_F570864, ID_F570864_PK, (ID)NULL, &ChaveF570864, 5);   <br/>            if (idJDBReturn != JDEDB_PASSED) {<br/><br/>                jdeStrncpyTerminate(lpDS-&gtszMsgErro, _J("Erro alterando tabela auxiliar da meta para o executivo."), DIM(lpDS-&gtszMsgErro));    <br/>                return idJDBReturn;<br/><br/>            }<br/><br/>        } else {<br/><br/>            jdeStrncpyTerminate(lpDS-&gtszMsgErro, _J("Erro alterando tabela auxiliar da meta para o executivo."), DIM(lpDS-&gtszMsgErro));    <br/>            return idJDBReturn;<br/><br/>        }<br/><br/><br/>    }<br/><br/>    return JDEDB_PASSED;<br/>}<br/></pre></div></div></body></html>