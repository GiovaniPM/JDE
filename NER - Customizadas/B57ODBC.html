<!DOCTYPE html><html lang = "en"><head><meta charset = "utf-8"><meta name = "viewport" content = "width=device-width, initial-scale=1"><title>JDE Object Browser HTML Extract</title>
<style type='text/css'>body,th{font-family: Courier New, Courier, mono;font-size: 12px; width:auto}
.section{font-family: Arial, Helvetica, sans-serif;font-size: 12px;font-weight: bold;border: thin groove #CC9966;width: 100%;padding-left: 5px;padding-top: 5px;padding-bottom: 5px; padding-right: 5px; box-sizing: border-box }
.objectheader {font-family: Arial, Helvetica, sans-serif;font-size: 12px;font-weight: bold;border: thin groove #CC9966;width:auto;background-color: #FFFFCC;padding-left: 5px;padding-top: 5px;padding-bottom: 5px;padding-right: 5px; box-sizing: border-box }
.details{font-family: Arial, Helvetica, sans-serif;font-size: 11px;font-weight: normal;border: thin groove #CC9966;width:100%;padding-left: 5px;padding-top: 5px;padding-bottom: 5px;padding-right: 5px;box-sizing: border-box }
.er {background-color: #FFFFFF;font-family: Courier New, Courier, mono;font-size: 12px; font-weight: normal; border: thin solid #CCCCCC; width:auto; padding-left: 5px;padding-top: 5px;padding-bottom: 5px; padding-right: 5px; box-sizing: border-box }
.dstrmembers {background-color: #FFFDDD;font-family: Courier New, Courier, mono;font-size: 12px;border: thin groove #CC9966;padding-left: 5px;padding-top: 5px;padding-bottom: 5px;padding-right: 5px; box-sizing: border-box }
.disabled {font-family: Courier New, Courier, mono;font-size: 12px;	font-style: italic; color:#CC9933}
.parameters {font-family: Courier New, Courier, mono;font-size: 12px; color:#3333FF}
.comment {font-family: Courier New, Courier, mono;font-size: 12px;	color: #339933}
.subtable {font-family: Arial, Helvetica, sans-serif;font-size: 11px;font-weight: normal;width:100%}
.lineno {color:#6E6E6E;font-family: Courier New, Courier, mono;font-size: 12px; font-weight: normal;}
.iokey {color:#FF6905;font-family: Courier New, Courier, mono;font-size: 12px; font-weight: normal;}
.logicline {color:#000000;font-family: Courier New, Courier, mono;font-size: 12px; font-weight: normal;}
.versionoverride {background-color: #FFCC99;}
.overrideflags{font-family: Arial, Helvetica, sans-serif;font-size: 11px;font-weight: normal;border: thin groove #CC9966;width:auto;padding-left: 5px;padding-top: 5px;padding-bottom: 5px;padding-right: 5px; background-color: #FFCC99; box-sizing: border-box }
.bsfnprops {font-family: Courier New, Courier, mono;font-size: 12px; color:#E01B4C}
.searchresult {font-family: Courier New, Courier, mono;font-size: 12px; font-weight: bold; background-color:#8BF3A0}
.expand {font-family: Courier New, Courier, mono;font-size: 11px; font-weight: bold; cursor:pointer; border: 1px solid gray; position: relative; left: -3px; display:inline; line-height:8px;}
.expand2 { display:inline; cursor:pointer; font-size: 9px; border: 1px solid gray; position: relative; left: -3px;}
</style>
<script type='text/javascript'>function load(){location.href = '#result';}</script>
<script language='JavaScript' type='text/javascript'>function ExpandCollapse(ElementId){ var ClickedElement = document.getElementById(ElementId); var SectionName = ElementId + ':hide'; var Section = document.getElementById(SectionName); if (ClickedElement.innerHTML == '-') { 	 ClickedElement.innerHTML = '+';	Section.style.display = 'none'; }  else  { 		ClickedElement.innerHTML = '-'; 	Section.style.display = 'inline';}} </script>
<base target = "_parent"></head><body onload='load()'>
<div class ='objectheader'>Business Function: B57ODBC - Função para Trabalhar com ODBC<BR>Function Type: C</div><div class='section'>EVENTS<div class='objectheader'>C Function: Função para Trabalhar com ODBC - [ConectaBanco]</div><div class='er'><div class='dstrmembers'><B>Data Structure: D57ODBC - Estrutura de dados para função B57ODBC - Conexao            </B><BR>BF idStatementHandle [GENLNG]<BR>BF idConnectionHandle [GENLNG]<BR>BF idEnvironmentHandle [GENLNG]<BR>BF szStringConexao [CF500]<BR>BF cCodigoErro [ERRC]<BR></div><pre><div class='dstrmembers'><B>Header File: b57odbc.h</B><BR></div><br/>/*****************************************************************************<br/> *    Header File:  B57ODBC.h<br/> *<br/> *    Description:  Função para Trabalhar com ODBC Header File<br/> *<br/> *        History:<br/> *          Date        Programmer  SAR# - Description<br/> *          ----------  ----------  -------------------------------------------<br/> *   Author 20/01/11                Unknown  - Created  <br/> *<br/> *<br/> * Copyright (c) J.D. Edwards World Source Company, 1996<br/> *<br/> * This unpublished material is proprietary to J.D. Edwards World Source <br/> * Company.  All rights reserved.  The methods and techniques described <br/> * herein are considered trade secrets and/or confidential.  Reproduction<br/> * or distribution, in whole or in part, is forbidden except by express<br/> * written permission of J.D. Edwards World Source Company.<br/> ****************************************************************************/<br/><br/>#ifndef __B57ODBC_H<br/>#define __B57ODBC_H<br/><br/>/*****************************************************************************<br/> * Table Header Inclusions<br/> ****************************************************************************/<br/><br/>/*****************************************************************************<br/> * External Business Function Header Inclusions<br/> ****************************************************************************/<br/><br/>/*****************************************************************************<br/> * Global Definitions<br/> ****************************************************************************/<br/><br/>/*****************************************************************************<br/> * Structure Definitions<br/> ****************************************************************************/<br/><br/>/*****************************************************************************<br/> * DS Template Type Definitions<br/> ****************************************************************************/<br/>/*****************************************<br/> * TYPEDEF for Data Structure<br/> *    Template Name: Estrutura de dados para função B57ODBC<br/> *    Template ID:   D57ODBC<br/> *    Generated:     Thu Jan 20 14:01:10 2011<br/> *<br/> * DO NOT EDIT THE FOLLOWING TYPEDEF<br/> *    To make modifications, use the OneWorld Data Structure<br/> *    Tool to Generate a revised version, and paste from<br/> *    the clipboard.<br/> *<br/> **************************************/<br/><br/>#ifndef DATASTRUCTURE_D57ODBC<br/>#define DATASTRUCTURE_D57ODBC<br/><br/>typedef struct tagDSD57ODBC<br/>{<br/>  ID                idStatementHandle;                   <br/>  ID                idConnectionHandle;                  <br/>  ID                idEnvironmentHandle;                 <br/>  JCHAR              szStringConexao[501];                <br/>  JCHAR              cCodigoErro;                         <br/>} DSD57ODBC, *LPDSD57ODBC;<br/><br/>#define IDERRidStatementHandle_1                  1L<br/>#define IDERRidConnectionHandle_2                 2L<br/>#define IDERRidEnvironmentHandle_3                3L<br/>#define IDERRszStringConexao_5                    5L<br/>#define IDERRcCodigoErro_6                        6L<br/><br/>#endif<br/><br/>/*****************************************<br/> * TYPEDEF for Data Structure<br/> *    Template Name: Estrutura de dados para função B57ODBC - Executa SQL<br/> *    Template ID:   D57ODBC1<br/> *    Generated:     Mon Aug 06 09:54:07 2012<br/> *<br/> * DO NOT EDIT THE FOLLOWING TYPEDEF<br/> *    To make modifications, use the OneWorld Data Structure<br/> *    Tool to Generate a revised version, and paste from<br/> *    the clipboard.<br/> *<br/> **************************************/<br/><br/>#ifndef DATASTRUCTURE_D57ODBC1<br/>#define DATASTRUCTURE_D57ODBC1<br/><br/>typedef struct tagDSD57ODBC1<br/>{<br/>  ID                idStatementHandle;                   <br/>  JCHAR              cCodigoErro;                         <br/>  JCHAR              szComandoSQL[30001];                 <br/>} DSD57ODBC1, *LPDSD57ODBC1;<br/><br/>#define IDERRidStatementHandle_1                  1L<br/>#define IDERRcCodigoErro_6                        6L<br/>#define IDERRszComandoSQL_9                       9L<br/><br/>#endif<br/><br/>/*****************************************<br/> * TYPEDEF for Data Structure<br/> *    Template Name: Estrutura de dados para função B57ODBC - Fecha Conexao<br/> *    Template ID:   D57ODBC2<br/> *    Generated:     Thu Jan 20 14:01:38 2011<br/> *<br/> * DO NOT EDIT THE FOLLOWING TYPEDEF<br/> *    To make modifications, use the OneWorld Data Structure<br/> *    Tool to Generate a revised version, and paste from<br/> *    the clipboard.<br/> *<br/> **************************************/<br/><br/>#ifndef DATASTRUCTURE_D57ODBC2<br/>#define DATASTRUCTURE_D57ODBC2<br/><br/>typedef struct tagDSD57ODBC2<br/>{<br/>  ID                idStatementHandle;                   <br/>  ID                idConnectionHandle;                  <br/>  ID                idEnvironmentHandle;                 <br/>  JCHAR              cCodigoErro;                         <br/>} DSD57ODBC2, *LPDSD57ODBC2;<br/><br/>#define IDERRidStatementHandle_1                  1L<br/>#define IDERRidConnectionHandle_2                 2L<br/>#define IDERRidEnvironmentHandle_3                3L<br/>#define IDERRcCodigoErro_6                        6L<br/><br/>#endif<br/><br/>/*****************************************<br/> * TYPEDEF for Data Structure<br/> *    Template Name: Estrutura de dados para função B57ODBC - Retorna Data<br/> *    Template ID:   D57ODBC3<br/> *    Generated:     Thu Jan 20 14:13:15 2011<br/> *<br/> * DO NOT EDIT THE FOLLOWING TYPEDEF<br/> *    To make modifications, use the OneWorld Data Structure<br/> *    Tool to Generate a revised version, and paste from<br/> *    the clipboard.<br/> *<br/> **************************************/<br/><br/>#ifndef DATASTRUCTURE_D57ODBC3<br/>#define DATASTRUCTURE_D57ODBC3<br/><br/>typedef struct tagDSD57ODBC3<br/>{<br/>  ID                idStatementHandle;                   <br/>  JCHAR              cCodigoErro;                         <br/>  int               nColuna;                             <br/>  JDEDATE           jdValorData;                         <br/>} DSD57ODBC3, *LPDSD57ODBC3;<br/><br/>#define IDERRidStatementHandle_1                  1L<br/>#define IDERRcCodigoErro_6                        6L<br/>#define IDERRnColuna_8                            8L<br/>#define IDERRjdValorData_10                       10L<br/><br/>#endif<br/><br/><br/>/*****************************************<br/> * TYPEDEF for Data Structure<br/> *    Template Name: Estrutura de dados para função B57ODBC - Retorna Numerico<br/> *    Template ID:   D57ODBC4<br/> *    Generated:     Thu Jan 20 14:01:55 2011<br/> *<br/> * DO NOT EDIT THE FOLLOWING TYPEDEF<br/> *    To make modifications, use the OneWorld Data Structure<br/> *    Tool to Generate a revised version, and paste from<br/> *    the clipboard.<br/> *<br/> **************************************/<br/><br/>#ifndef DATASTRUCTURE_D57ODBC4<br/>#define DATASTRUCTURE_D57ODBC4<br/><br/>typedef struct tagDSD57ODBC4<br/>{<br/>  ID                idStatementHandle;                   <br/>  JCHAR              cCodigoErro;                         <br/>  int               nColuna;                             <br/>  MATH_NUMERIC      mnValorNumerico;                     <br/>} DSD57ODBC4, *LPDSD57ODBC4;<br/><br/>#define IDERRidStatementHandle_1                  1L<br/>#define IDERRcCodigoErro_6                        6L<br/>#define IDERRnColuna_8                            8L<br/>#define IDERRmnValorNumerico_10                   10L<br/><br/>#endif<br/><br/>/*****************************************<br/> * TYPEDEF for Data Structure<br/> *    Template Name: Estrutura de dados para função B57ODBC - Retorna String<br/> *    Template ID:   D57ODBC5<br/> *    Generated:     Thu Jan 20 14:14:19 2011<br/> *<br/> * DO NOT EDIT THE FOLLOWING TYPEDEF<br/> *    To make modifications, use the OneWorld Data Structure<br/> *    Tool to Generate a revised version, and paste from<br/> *    the clipboard.<br/> *<br/> **************************************/<br/><br/>#ifndef DATASTRUCTURE_D57ODBC5<br/>#define DATASTRUCTURE_D57ODBC5<br/><br/>typedef struct tagDSD57ODBC5<br/>{<br/>  ID                idStatementHandle;                   <br/>  JCHAR              cCodigoErro;                         <br/>  int               nColuna;                             <br/>  JCHAR              szValorString[201];                  <br/>} DSD57ODBC5, *LPDSD57ODBC5;<br/><br/>#define IDERRidStatementHandle_1                  1L<br/>#define IDERRcCodigoErro_6                        6L<br/>#define IDERRnColuna_8                            8L<br/>#define IDERRszValorString_11                     11L<br/><br/>#endif<br/><br/><br/>/*****************************************<br/> * TYPEDEF for Data Structure<br/> *    Template Name: Estrutura de dados para função B57ODBC - Fech<br/> *    Template ID:   D57ODBC6<br/> *    Generated:     Thu Jan 20 14:02:20 2011<br/> *<br/> * DO NOT EDIT THE FOLLOWING TYPEDEF<br/> *    To make modifications, use the OneWorld Data Structure<br/> *    Tool to Generate a revised version, and paste from<br/> *    the clipboard.<br/> *<br/> **************************************/<br/><br/>#ifndef DATASTRUCTURE_D57ODBC6<br/>#define DATASTRUCTURE_D57ODBC6<br/><br/>typedef struct tagDSD57ODBC6<br/>{<br/>  ID                idStatementHandle;                   <br/>  JCHAR              cCodigoErro;                         <br/>} DSD57ODBC6, *LPDSD57ODBC6;<br/><br/>#define IDERRidStatementHandle_1                  1L<br/>#define IDERRcCodigoErro_6                        6L<br/><br/>#endif<br/><br/>/*****************************************<br/> * TYPEDEF for Data Structure<br/> *    Template Name: Estrutura de dados para função B57ODBC - Retorna Mensagem<br/> *    Template ID:   D57ODBC7<br/> *    Generated:     Thu Jan 20 14:02:28 2011<br/> *<br/> * DO NOT EDIT THE FOLLOWING TYPEDEF<br/> *    To make modifications, use the OneWorld Data Structure<br/> *    Tool to Generate a revised version, and paste from<br/> *    the clipboard.<br/> *<br/> **************************************/<br/><br/>#ifndef DATASTRUCTURE_D57ODBC7<br/>#define DATASTRUCTURE_D57ODBC7<br/><br/>typedef struct tagDSD57ODBC7<br/>{<br/>  ID                idStatementHandle;                   <br/>  JCHAR              cCodigoErro;                         <br/>  JCHAR              szMensagemErro[501];                 <br/>} DSD57ODBC7, *LPDSD57ODBC7;<br/><br/>#define IDERRidStatementHandle_1                  1L<br/>#define IDERRcCodigoErro_6                        6L<br/>#define IDERRszMensagemErro_7                     7L<br/><br/>#endif<br/><br/>/*****************************************<br/> * TYPEDEF for Data Structure<br/> *    Template Name: Estrutura de dados para função B57ODBC - Fecha Cursor<br/> *    Template ID:   D57ODBC8<br/> *    Generated:     Thu Jan 20 14:02:36 2011<br/> *<br/> * DO NOT EDIT THE FOLLOWING TYPEDEF<br/> *    To make modifications, use the OneWorld Data Structure<br/> *    Tool to Generate a revised version, and paste from<br/> *    the clipboard.<br/> *<br/> **************************************/<br/><br/>#ifndef DATASTRUCTURE_D57ODBC8<br/>#define DATASTRUCTURE_D57ODBC8<br/><br/>typedef struct tagDSD57ODBC8<br/>{<br/>  ID                idStatementHandle;                   <br/>  JCHAR              cCodigoErro;                         <br/>} DSD57ODBC8, *LPDSD57ODBC8;<br/><br/>#define IDERRidStatementHandle_1                  1L<br/>#define IDERRcCodigoErro_6                        6L<br/><br/>#endif<br/><br/>/*****************************************<br/> * TYPEDEF for Data Structure<br/> *    Template Name: Estrutura de dados para função B57ODBC - Seta Parametro<br/> *    Template ID:   D57ODBC9<br/> *    Generated:     Wed Jul 18 15:19:16 2012<br/> *<br/> * DO NOT EDIT THE FOLLOWING TYPEDEF<br/> *    To make modifications, use the OneWorld Data Structure<br/> *    Tool to Generate a revised version, and paste from<br/> *    the clipboard.<br/> *<br/> **************************************/<br/><br/>#ifndef DATASTRUCTURE_D57ODBC9<br/>#define DATASTRUCTURE_D57ODBC9<br/><br/>typedef struct tagDSD57ODBC9<br/>{<br/>  ID                idStatementHandle;                   <br/>  JCHAR              cCodigoErro;                         <br/>  JCHAR              szValorString[201];                  <br/>  JCHAR              szTipoParametro[12];                 <br/>  JCHAR              szParametro[49];                     <br/>} DSD57ODBC9, *LPDSD57ODBC9;<br/><br/>#define IDERRidStatementHandle_1                  1L<br/>#define IDERRcCodigoErro_6                        6L<br/>#define IDERRszValorString_11                     11L<br/>#define IDERRszTipoParametro_12                   12L<br/>#define IDERRszParametro_13                       13L<br/><br/>#endif<br/><br/>/*****************************************************************************<br/> * Source Preprocessor Definitions<br/> ****************************************************************************/<br/>#if defined (JDEBFRTN)<br/>	#undef JDEBFRTN<br/>#endif<br/><br/>#if defined (WIN32)<br/>	#if defined (WIN32)<br/>		#define JDEBFRTN(r) __declspec(dllexport) r<br/>	#else<br/>		#define JDEBFRTN(r) __declspec(dllimport) r<br/>	#endif<br/>#else<br/>	#define JDEBFRTN(r) r<br/>#endif<br/><br/>/*****************************************************************************<br/> * Business Function Prototypes<br/> ****************************************************************************/<br/>JDEBFRTN (ID) JDEBFWINAPI ConectaBanco                     (LPBHVRCOM lpBhvrCom, LPVOID lpVoid, LPDSD57ODBC lpDS);<br/>JDEBFRTN (ID) JDEBFWINAPI ExecutaSQL                       (LPBHVRCOM lpBhvrCom, LPVOID lpVoid, LPDSD57ODBC1 lpDS);<br/>JDEBFRTN (ID) JDEBFWINAPI FechaConexao                     (LPBHVRCOM lpBhvrCom, LPVOID lpVoid, LPDSD57ODBC2 lpDS);<br/>JDEBFRTN (ID) JDEBFWINAPI FechaCursor                      (LPBHVRCOM lpBhvrCom, LPVOID lpVoid, LPDSD57ODBC8 lpDS);<br/>JDEBFRTN (ID) JDEBFWINAPI Fetch                            (LPBHVRCOM lpBhvrCom, LPVOID lpVoid, LPDSD57ODBC6 lpDS);<br/>JDEBFRTN (ID) JDEBFWINAPI RetornaData                      (LPBHVRCOM lpBhvrCom, LPVOID lpVoid, LPDSD57ODBC3 lpDS);<br/>JDEBFRTN (ID) JDEBFWINAPI RetornaMSG                       (LPBHVRCOM lpBhvrCom, LPVOID lpVoid, LPDSD57ODBC7 lpDS);<br/>JDEBFRTN (ID) JDEBFWINAPI RetornaNumerico                  (LPBHVRCOM lpBhvrCom, LPVOID lpVoid, LPDSD57ODBC4 lpDS);<br/>JDEBFRTN (ID) JDEBFWINAPI RetornaString                    (LPBHVRCOM lpBhvrCom, LPVOID lpVoid, LPDSD57ODBC5 lpDS);<br/>JDEBFRTN (ID) JDEBFWINAPI SetaParametro                    (LPBHVRCOM lpBhvrCom, LPVOID lpVoid, LPDSD57ODBC9 lpDS);<br/><br/>/*****************************************************************************<br/> * Internal Function Prototypes<br/> ****************************************************************************/<br/>void I57ODBC_LogErros (SQLHANDLE      hHandle, SQLSMALLINT    hType, RETCODE        RetCode); <br/><br/>#endif    /* __B57ODBC_H */<br/><br/></pre><BR/><pre><div class='dstrmembers'><B>Source File: b57odbc.c</B><BR></div>#include &ltjde.h&gt<br/><br/>#define b57odbc_c<br/><br/><br/>/*****************************************************************************<br/> *    Source File:  b57odbc<br/> *<br/> *    Description:  Função para Trabalhar com ODBC Source File<br/> *<br/> *        History:<br/> *          Date        Programmer  SAR# - Description<br/> *          ----------  ----------  -------------------------------------------<br/> *   Author 20/01/11                Unknown  - Created  <br/> *<br/> * Copyright (c) J.D. Edwards World Source Company, 1996<br/> *<br/> * This unpublished material is proprietary to J.D. Edwards World Source Company.<br/> * All rights reserved.  The methods and techniques described herein are<br/> * considered trade secrets and/or confidential.  Reproduction or<br/> * distribution, in whole or in part, is forbidden except by express<br/> * written permission of J.D. Edwards World Source Company.<br/> ****************************************************************************/<br/>/**************************************************************************<br/> * Notes:<br/> *<br/> **************************************************************************/<br/><br/>#include &ltb57odbc.h&gt<br/><br/><br/>/**************************************************************************<br/> *  Business Function:  ConectaBanco<br/> *<br/> *        Description:  Efetua Conexao ODBC<br/> *<br/> *         Parameters:<br/> *           LPBHVRCOM           lpBhvrCom    Business Function Communications<br/> *           LPVOID              lpVoid       Void Parameter - DO NOT USE!<br/> *           LPDSD57ODBC         lpDS         Parameter Data Structure Pointer  <br/> *<br/> *************************************************************************/<br/><br/>JDEBFRTN (ID) JDEBFWINAPI ConectaBanco (LPBHVRCOM lpBhvrCom, LPVOID lpVoid, LPDSD57ODBC lpDS)  <br/>{<br/>   /************************************************************************<br/>    *  Variable declarations<br/>    ************************************************************************/<br/>    int       rcode;<br/>	//<br/>	JCHAR      szBaseDados[300]       = {_J('\0')};<br/>	JCHAR      *szDriver;<br/>    SQLHENV   EnvironmentHandle    = _J('\0'); <br/>    SQLHSTMT  StatementHandle      = _J('\0');<br/>    SQLHDBC   ConnectionHandle;<br/>	HUSER     hUser                = (HUSER) NULL;<br/>	JDEDB_RESULT  nJDBReturn;<br/>	/*short teste = 0;*/<br/>	//<br/>   /************************************************************************<br/>    * Check for NULL pointers<br/>    ************************************************************************/<br/>    if ((lpBhvrCom == (LPBHVRCOM) NULL) ||<br/>       (lpVoid    == (LPVOID)    NULL) ||<br/>       (lpDS      == (LPDSD57ODBC )	NULL))<br/>    {<br/>      jdeErrorSet (lpBhvrCom, lpVoid, (ID) 0, _J("4363"), (LPVOID) NULL);<br/>      return ER_ERROR;<br/>    }<br/>   /************************************************************************<br/>    * Main Processing<br/>    ************************************************************************/<br/>    rcode = JDB_InitBhvr(lpBhvrCom, &hUser, NULL, JDEDB_COMMIT_AUTO);<br/>	//Seta Host<br/>	if (IsStringBlank (lpDS-&gtszStringConexao))<br/>	{  <br/>		//sprintf(szBaseDados,"Driver={SQL Server};Server=CANSWEB08;Database=AGCONETDB;Uid=usr_aol;Pwd=gk29*4b;");<br/>	}<br/>	else<br/>	{<br/>      jdeStrncpy(szBaseDados,(const JCHAR *)lpDS-&gtszStringConexao,DIM(szBaseDados));<br/>	};<br/>	/* Pega um Enrinoment Handle pro ODBC */<br/>    rcode = SQLAllocHandle(SQL_HANDLE_ENV, SQL_NULL_HANDLE, &EnvironmentHandle);<br/>    // <br/>    /* Atributos ODBC  */<br/>    rcode =SQLSetEnvAttr(EnvironmentHandle,SQL_ATTR_ODBC_VERSION,(SQLPOINTER *)SQL_OV_ODBC3 ,0);<br/>	//<br/>    //* Pega um Handle de Conexao */<br/>    rcode =SQLAllocHandle(SQL_HANDLE_DBC, EnvironmentHandle, &ConnectionHandle);<br/>    /* Cria a Conexao */<br/>	/*teste = jdeStrlen(szBaseDados); */ <br/>	rcode = SQLDriverConnect(ConnectionHandle, <br/>							 NULL, <br/>		                     (SQLWCHAR *) szBaseDados, <br/>							 (short) (jdeStrlen(szBaseDados)+1), <br/>							 NULL, <br/>							 300, <br/>							 NULL, <br/>							 SQL_DRIVER_NOPROMPT);<br/>	/*rcode = SQLDriverConnect(ConnectionHandle, <br/>							 lpBhvrCom-&gthDlg, <br/>		                     NULL, <br/>							 300, <br/>							 NULL, <br/>							 300, <br/>							 NULL,<br/>							 SQL_DRIVER_PROMPT);*/<br/>    //<br/>	if (rcode != SQL_SUCCESS) <br/>	{ <br/>		I57ODBC_LogErros(ConnectionHandle, SQL_HANDLE_DBC,(RETCODE) rcode); <br/>	}<br/>	else <br/>	{<br/>		rcode =SQLAllocHandle(SQL_HANDLE_STMT, ConnectionHandle, &StatementHandle);<br/>		//<br/>	    lpDS-&gtidStatementHandle   = jdeStoreDataPtr(hUser, StatementHandle);<br/>		lpDS-&gtidConnectionHandle  = jdeStoreDataPtr(hUser, ConnectionHandle);<br/>	    lpDS-&gtidEnvironmentHandle = jdeStoreDataPtr(hUser, EnvironmentHandle);<br/>		//<br/>	}<br/>   /************************************************************************<br/>    * Function Clean Up<br/>    ************************************************************************/<br/><br/>   return (ER_SUCCESS);<br/>}<br/><br/><br/>/**************************************************************************<br/> *  Business Function:  ExecutaSQL<br/> *<br/> *        Description:  Executa Comando SQL<br/> *<br/> *         Parameters:<br/> *           LPBHVRCOM           lpBhvrCom    Business Function Communications<br/> *           LPVOID              lpVoid       Void Parameter - DO NOT USE!<br/> *           LPDSD57ODBC1        lpDS         Parameter Data Structure Pointer  <br/> *<br/> *************************************************************************/<br/><br/>JDEBFRTN (ID) JDEBFWINAPI ExecutaSQL (LPBHVRCOM lpBhvrCom, LPVOID lpVoid, LPDSD57ODBC1 lpDS)  <br/>{<br/>   /************************************************************************<br/>    *  Variable declarations<br/>    ************************************************************************/<br/>	int rcode                      = 0;<br/>	//<br/>	HUSER     hUser                = (HUSER) NULL;<br/>    SQLHSTMT  StatementHandle      = _J('\0');<br/>   /************************************************************************<br/>    * Check for NULL pointers<br/>    ************************************************************************/<br/>    if ((lpBhvrCom == (LPBHVRCOM) NULL) ||<br/>       (lpVoid    == (LPVOID)    NULL) ||<br/>       (lpDS      == (LPDSD57ODBC1 )	NULL))<br/>    {<br/>      jdeErrorSet (lpBhvrCom, lpVoid, (ID) 0, _J("4363"), (LPVOID) NULL);<br/>      return ER_ERROR;<br/>    }<br/>   /************************************************************************<br/>    * Main Processing<br/>    ************************************************************************/<br/>	//<br/>    rcode = JDB_InitBhvr(lpBhvrCom, &hUser, NULL, JDEDB_COMMIT_AUTO);<br/>	//<br/>	StatementHandle =(SQLHSTMT *) jdeRetrieveDataPtr(hUser, lpDS-&gtidStatementHandle);<br/>	//<br/>    rcode =SQLExecDirect(StatementHandle,<br/>                        (SQLWCHAR *) lpDS-&gtszComandoSQL,<br/>                        (SQLINTEGER) sizeof(lpDS-&gtszComandoSQL));<br/>	//<br/>   /************************************************************************<br/>    * Function Clean Up<br/>    ************************************************************************/<br/><br/>   return (ER_SUCCESS);<br/>}<br/><br/><br/>/**************************************************************************<br/> *  Business Function:  FechaConexao<br/> *<br/> *        Description:  Fecha Conexao ODBC<br/> *<br/> *         Parameters:<br/> *           LPBHVRCOM           lpBhvrCom    Business Function Communications<br/> *           LPVOID              lpVoid       Void Parameter - DO NOT USE!<br/> *           LPDSD57ODBC2        lpDS         Parameter Data Structure Pointer  <br/> *<br/> *************************************************************************/<br/><br/>JDEBFRTN (ID) JDEBFWINAPI FechaConexao (LPBHVRCOM lpBhvrCom, LPVOID lpVoid, LPDSD57ODBC2 lpDS)  <br/>{<br/>   /************************************************************************<br/>    *  Variable declarations<br/>    ************************************************************************/<br/>    SQLHENV   EnvironmentHandle    = (_J('\0')); <br/>    SQLHSTMT  StatementHandle      = (_J('\0'));<br/>    SQLHDBC   ConnectionHandle;<br/>    HUSER hUser;<br/>   /************************************************************************<br/>    * Check for NULL pointers<br/>    ************************************************************************/<br/>    if ((lpBhvrCom == (LPBHVRCOM) NULL) ||<br/>       (lpVoid    == (LPVOID)    NULL) ||<br/>       (lpDS      == (LPDSD57ODBC2 )	NULL))<br/>    {<br/>      jdeErrorSet (lpBhvrCom, lpVoid, (ID) 0, _J("4363"), (LPVOID) NULL);<br/>      return ER_ERROR;<br/>    }<br/>   /************************************************************************<br/>    * Main Processing<br/>    ************************************************************************/<br/>    JDB_InitBhvr(lpBhvrCom, &hUser, NULL, JDEDB_COMMIT_AUTO);<br/>	//Remove os Handle da Memoria<br/>	StatementHandle =(SQLHSTMT *) jdeRemoveDataPtr(hUser,lpDS-&gtidStatementHandle);<br/>	ConnectionHandle =(SQLHSTMT *) jdeRemoveDataPtr(hUser,lpDS-&gtidConnectionHandle);<br/>	EnvironmentHandle =(SQLHSTMT *) jdeRemoveDataPtr(hUser,lpDS-&gtidEnvironmentHandle);<br/>	//Disconecto do ODBC<br/>    SQLFreeHandle(SQL_HANDLE_STMT,StatementHandle);<br/>    SQLDisconnect(ConnectionHandle);<br/>    SQLFreeHandle(SQL_HANDLE_DBC,ConnectionHandle);<br/>    SQLFreeHandle(SQL_HANDLE_ENV,EnvironmentHandle);<br/>	//Volto Zero em tudo<br/>	lpDS-&gtidStatementHandle=0;<br/>	lpDS-&gtidConnectionHandle=0;<br/>	lpDS-&gtidEnvironmentHandle=0;<br/>   /************************************************************************<br/>    * Function Clean Up<br/>    ************************************************************************/<br/><br/>   return (ER_SUCCESS);<br/>}<br/><br/><br/>/**************************************************************************<br/> *  Business Function:  FechaCursor<br/> *<br/> *        Description:  Fecha Cursor ODBC<br/> *<br/> *         Parameters:<br/> *           LPBHVRCOM           lpBhvrCom    Business Function Communications<br/> *           LPVOID              lpVoid       Void Parameter - DO NOT USE!<br/> *           LPDSD57ODBC8        lpDS         Parameter Data Structure Pointer  <br/> *<br/> *************************************************************************/<br/><br/>JDEBFRTN (ID) JDEBFWINAPI FechaCursor (LPBHVRCOM lpBhvrCom, LPVOID lpVoid, LPDSD57ODBC8 lpDS)  <br/>{<br/>   /************************************************************************<br/>    *  Variable declarations<br/>    ************************************************************************/<br/>    SQLHSTMT   StatementHandle      = _J('\0');<br/>    HUSER      hUser;<br/>   /************************************************************************<br/>    * Check for NULL pointers<br/>    ************************************************************************/<br/>    if ((lpBhvrCom == (LPBHVRCOM) NULL) ||<br/>        (lpVoid    == (LPVOID)    NULL) ||<br/>        (lpDS      == (LPDSD57ODBC8)	NULL))<br/>    {<br/>      jdeErrorSet (lpBhvrCom, lpVoid, (ID) 0, _J("4363"), (LPVOID) NULL);<br/>      return ER_ERROR;<br/>    }<br/><br/>   /************************************************************************<br/>    * Main Processing<br/>    ************************************************************************/<br/>    JDB_InitBhvr(lpBhvrCom, &hUser, NULL, JDEDB_COMMIT_AUTO);<br/>	//<br/>	StatementHandle =(SQLHSTMT *) jdeRetrieveDataPtr(hUser, lpDS-&gtidStatementHandle);<br/>    //<br/>    SQLCloseCursor(StatementHandle);<br/>   /************************************************************************<br/>    * Function Clean Up<br/>    ************************************************************************/<br/>    return (ER_SUCCESS);<br/>}<br/><br/><br/>/**************************************************************************<br/> *  Business Function:  Fetch<br/> *<br/> *        Description:  Executa Fetch<br/> *<br/> *         Parameters:<br/> *           LPBHVRCOM           lpBhvrCom    Business Function Communications<br/> *           LPVOID              lpVoid       Void Parameter - DO NOT USE!<br/> *           LPDSD57ODBC6        lpDS         Parameter Data Structure Pointer  <br/> *<br/> *************************************************************************/<br/><br/>JDEBFRTN (ID) JDEBFWINAPI Fetch (LPBHVRCOM lpBhvrCom, LPVOID lpVoid, LPDSD57ODBC6 lpDS)  <br/>{<br/>   /************************************************************************<br/>    *  Variable declarations<br/>    ************************************************************************/<br/>    SQLHSTMT  StatementHandle      = (_J('\0'));<br/>    HUSER     hUser;<br/>   /************************************************************************<br/>    * Check for NULL pointers<br/>    ************************************************************************/<br/>    if ((lpBhvrCom == (LPBHVRCOM) NULL) ||<br/>       (lpVoid    == (LPVOID)    NULL) ||<br/>       (lpDS      == (LPDSD57ODBC6 )	NULL))<br/>    {<br/>      jdeErrorSet (lpBhvrCom, lpVoid, (ID) 0, _J("4363"), (LPVOID) NULL);<br/>      return ER_ERROR;<br/>    }<br/>   /************************************************************************<br/>    * Main Processing<br/>    ************************************************************************/<br/>    JDB_InitBhvr(lpBhvrCom, &hUser, NULL, JDEDB_COMMIT_AUTO);<br/>	//<br/>	StatementHandle =(SQLHSTMT *) jdeRetrieveDataPtr(hUser, lpDS-&gtidStatementHandle);<br/>	//<br/>    lpDS-&gtcCodigoErro = (JCHAR)SQLFetch(StatementHandle);  <br/>   /************************************************************************<br/>    * Function Clean Up<br/>    ************************************************************************/<br/><br/>   return (ER_SUCCESS);<br/>}<br/><br/><br/>/**************************************************************************<br/> *  Business Function:  RetornaData<br/> *<br/> *        Description:  Retorna Coluna Do Tipo Data<br/> *<br/> *         Parameters:<br/> *           LPBHVRCOM           lpBhvrCom    Business Function Communications<br/> *           LPVOID              lpVoid       Void Parameter - DO NOT USE!<br/> *           LPDSD57ODBC3        lpDS         Parameter Data Structure Pointer  <br/> *<br/> *************************************************************************/<br/><br/>JDEBFRTN (ID) JDEBFWINAPI RetornaData (LPBHVRCOM lpBhvrCom, LPVOID lpVoid, LPDSD57ODBC3 lpDS)  <br/>{<br/>   /************************************************************************<br/>    *  Variable declarations<br/>    ************************************************************************/<br/>	int                  rcode                = 0;<br/>    SQLHSTMT             StatementHandle      = (_J('\0'));<br/>    SQL_TIMESTAMP_STRUCT jdValorData          = {0};	<br/>    HUSER                hUser;<br/>   /************************************************************************<br/>    * Check for NULL pointers<br/>    ************************************************************************/<br/>    if ((lpBhvrCom == (LPBHVRCOM) NULL) ||<br/>       (lpVoid    == (LPVOID)    NULL) ||<br/>       (lpDS      == (LPDSD57ODBC3)	NULL))<br/>    {<br/>      jdeErrorSet (lpBhvrCom, lpVoid, (ID) 0, _J("4363"), (LPVOID) NULL);<br/>      return ER_ERROR;<br/>    }<br/>   /************************************************************************<br/>    * Main Processing<br/>    ************************************************************************/<br/>    JDB_InitBhvr(lpBhvrCom, &hUser, NULL, JDEDB_COMMIT_AUTO);<br/>	//<br/>	StatementHandle =(SQLHSTMT *) jdeRetrieveDataPtr(hUser, lpDS-&gtidStatementHandle);<br/>    //<br/>	rcode = SQLGetData(StatementHandle, <br/>		               (unsigned short)lpDS-&gtnColuna,<br/>					   SQL_C_TYPE_TIMESTAMP, <br/>					   &jdValorData, <br/>					   0, <br/>					   NULL);<br/>	//<br/>	lpDS-&gtjdValorData.nYear = jdValorData.year;<br/>	lpDS-&gtjdValorData.nMonth = jdValorData.month;<br/>	lpDS-&gtjdValorData.nDay = jdValorData.day;<br/>	//<br/>   /************************************************************************<br/>    * Function Clean Up<br/>    ************************************************************************/<br/><br/>   return (ER_SUCCESS);<br/>}<br/><br/><br/>/**************************************************************************<br/> *  Business Function:  RetornaMSG<br/> *<br/> *        Description:  Retorna Mensagem de Erro<br/> *<br/> *         Parameters:<br/> *           LPBHVRCOM           lpBhvrCom    Business Function Communications<br/> *           LPVOID              lpVoid       Void Parameter - DO NOT USE!<br/> *           LPDSD57ODBC7        lpDS         Parameter Data Structure Pointer  <br/> *<br/> *************************************************************************/<br/><br/>JDEBFRTN (ID) JDEBFWINAPI RetornaMSG (LPBHVRCOM lpBhvrCom, LPVOID lpVoid, LPDSD57ODBC7 lpDS)  <br/>{<br/>   /************************************************************************<br/>    *  Variable declarations<br/>    ************************************************************************/<br/>    SQLHSTMT   StatementHandle      = _J('\0');<br/>    HUSER      hUser;<br/>	//<br/>	SQLCHAR       SqlState[6], Msg[SQL_MAX_MESSAGE_LENGTH];<br/>	SQLINTEGER    NativeError;<br/> 	SQLSMALLINT   MsgLen;<br/>    //<br/>   /************************************************************************<br/>    * Check for NULL pointers<br/>    ************************************************************************/<br/>    if ((lpBhvrCom == (LPBHVRCOM) NULL) ||<br/>       (lpVoid    == (LPVOID)    NULL) ||<br/>       (lpDS      == (LPDSD57ODBC7)	NULL))<br/>    {<br/>      jdeErrorSet (lpBhvrCom, lpVoid, (ID) 0, _J("4363"), (LPVOID) NULL);<br/>      return ER_ERROR;<br/>    }<br/>   /************************************************************************<br/>    * Main Processing<br/>    ************************************************************************/<br/>    JDB_InitBhvr(lpBhvrCom, &hUser, NULL, JDEDB_COMMIT_AUTO);<br/>	//<br/>	StatementHandle =(SQLHSTMT *) jdeRetrieveDataPtr(hUser, lpDS-&gtidStatementHandle);<br/>    //<br/>    SQLGetDiagRec(SQL_HANDLE_STMT, <br/>	              StatementHandle, <br/>	 		      1, <br/>	 		      (SQLWCHAR *)SqlState, <br/>			      &NativeError, <br/>			      (SQLWCHAR *)Msg, <br/>			      sizeof(Msg), <br/>				  &MsgLen);<br/>   /************************************************************************<br/>    * Function Clean Up<br/>    ************************************************************************/<br/><br/>    return (ER_SUCCESS);<br/>}<br/><br/><br/>/**************************************************************************<br/> *  Business Function:  RetornaNumerico<br/> *<br/> *        Description:  Retorna Coluna Do Tipo Numerico<br/> *<br/> *         Parameters:<br/> *           LPBHVRCOM           lpBhvrCom    Business Function Communications<br/> *           LPVOID              lpVoid       Void Parameter - DO NOT USE!<br/> *           LPDSD57ODBC4        lpDS         Parameter Data Structure Pointer  <br/> *<br/> *************************************************************************/<br/><br/>JDEBFRTN (ID) JDEBFWINAPI RetornaNumerico (LPBHVRCOM lpBhvrCom, LPVOID lpVoid, LPDSD57ODBC4 lpDS)  <br/>{<br/>   /************************************************************************<br/>    *  Variable declarations<br/>    ************************************************************************/<br/>	int        rcode                = 0;<br/>    SQLHSTMT   StatementHandle      = (_J('\0'));<br/>    SQLDOUBLE  dValorNumerico      = 0;<br/>    HUSER      hUser;<br/><br/>   /************************************************************************<br/>    * Check for NULL pointers<br/>    ************************************************************************/<br/>    if ((lpBhvrCom == (LPBHVRCOM) NULL) ||<br/>       (lpVoid    == (LPVOID)    NULL) ||<br/>       (lpDS      == (LPDSD57ODBC4)	NULL))<br/>    {<br/>      jdeErrorSet (lpBhvrCom, lpVoid, (ID) 0, _J("4363"), (LPVOID) NULL);<br/>      return ER_ERROR;<br/>    }<br/>   /************************************************************************<br/>    * Main Processing<br/>    ************************************************************************/<br/>    JDB_InitBhvr(lpBhvrCom, &hUser, NULL, JDEDB_COMMIT_AUTO);<br/>	//<br/>	StatementHandle =(SQLHSTMT *) jdeRetrieveDataPtr(hUser, lpDS-&gtidStatementHandle);<br/>    //<br/>	rcode = SQLGetData(StatementHandle, <br/>		               (unsigned short)lpDS-&gtnColuna, <br/>					   SQL_C_DOUBLE, <br/>					   &dValorNumerico, <br/>					   0, <br/>					   NULL);<br/>	//<br/>	DoubleToMathNumeric (dValorNumerico,&lpDS-&gtmnValorNumerico);	<br/>	//<br/>   /************************************************************************<br/>    * Function Clean Up<br/>    ************************************************************************/<br/><br/>   return (ER_SUCCESS);<br/>}<br/><br/><br/>/**************************************************************************<br/> *  Business Function:  RetornaString<br/> *<br/> *        Description:  Retorna Coluna Do Tipo String<br/> *<br/> *         Parameters:<br/> *           LPBHVRCOM           lpBhvrCom    Business Function Communications<br/> *           LPVOID              lpVoid       Void Parameter - DO NOT USE!<br/> *           LPDSD57ODBC5        lpDS         Parameter Data Structure Pointer  <br/> *<br/> *************************************************************************/<br/><br/>JDEBFRTN (ID) JDEBFWINAPI RetornaString (LPBHVRCOM lpBhvrCom, LPVOID lpVoid, LPDSD57ODBC5 lpDS)  <br/>{<br/>   /************************************************************************<br/>    *  Variable declarations<br/>    ************************************************************************/<br/>	int        rcode                = 0;<br/>    SQLHSTMT   StatementHandle      = _J('\0');<br/>	SQLCHAR    szValorString[1000];<br/>    HUSER      hUser;<br/><br/>   /************************************************************************<br/>    * Check for NULL pointers<br/>    ************************************************************************/<br/>    if ((lpBhvrCom == (LPBHVRCOM) NULL) ||<br/>       (lpVoid    == (LPVOID)    NULL) ||<br/>       (lpDS      == (LPDSD57ODBC5)	NULL))<br/>    {<br/>      jdeErrorSet (lpBhvrCom, lpVoid, (ID) 0, _J("4363"), (LPVOID) NULL);<br/>      return ER_ERROR;<br/>    }<br/>   /************************************************************************<br/>    * Main Processing<br/>    ************************************************************************/<br/>    JDB_InitBhvr(lpBhvrCom, &hUser, NULL, JDEDB_COMMIT_AUTO);<br/>	//<br/>	StatementHandle =(SQLHSTMT *) jdeRetrieveDataPtr(hUser, lpDS-&gtidStatementHandle);<br/>    //<br/>	rcode = SQLGetData(StatementHandle, <br/>		               (unsigned short)lpDS-&gtnColuna, <br/>					   SQL_C_CHAR, <br/>					   &szValorString, <br/>					   1000, <br/>					   NULL);<br/>    //<br/>	jdeStrcpy (lpDS-&gtszValorString, (const JCHAR *) szValorString);<br/>   /************************************************************************<br/>    * Function Clean Up<br/>    ************************************************************************/<br/><br/>    return (ER_SUCCESS);<br/>}<br/><br/>/**************************************************************************<br/> *  Business Function:  SetaParametro<br/> *<br/> *        Description:  Seta Parametro SQL<br/> *<br/> *         Parameters:<br/> *           LPBHVRCOM           lpBhvrCom    Business Function Communications<br/> *           LPVOID              lpVoid       Void Parameter - DO NOT USE!<br/> *           LPDSD57ODBC9        lpDS         Parameter Data Structure Pointer  <br/> *<br/> *************************************************************************/<br/><br/>JDEBFRTN (ID) JDEBFWINAPI SetaParametro (LPBHVRCOM lpBhvrCom, LPVOID lpVoid, LPDSD57ODBC9 lpDS)  <br/>{<br/>   /************************************************************************<br/>    *  Variable declarations<br/>    ************************************************************************/<br/>	int        rcode                = 0;<br/>    SQLHSTMT   StatementHandle      = _J('\0');<br/>	SQLCHAR    szValorString[1000];<br/>    HUSER      hUser;<br/><br/>   /************************************************************************<br/>    * Check for NULL pointers<br/>    ************************************************************************/<br/>    if ((lpBhvrCom == (LPBHVRCOM) NULL) ||<br/>       (lpVoid    == (LPVOID)    NULL) ||<br/>       (lpDS      == (LPDSD57ODBC9)	NULL))<br/>    {<br/>      jdeErrorSet (lpBhvrCom, lpVoid, (ID) 0, _J("4363"), (LPVOID) NULL);<br/>      return ER_ERROR;<br/>    }<br/>   /************************************************************************<br/>    * Main Processing<br/>    ************************************************************************/<br/>    JDB_InitBhvr(lpBhvrCom, &hUser, NULL, JDEDB_COMMIT_AUTO);<br/>	//<br/>	StatementHandle =(SQLHSTMT *) jdeRetrieveDataPtr(hUser, lpDS-&gtidStatementHandle);<br/>    //<br/>	/*SQLBindParameter(hstmt1, 1, SQL_PARAM_INPUT, SQL_C_CHAR, SQL_CHAR, 10, 0,<br/>                  SalesPerson, sizeof(SalesPerson), &SalesPersonLenOrInd);<br/>	SQLBindParameter(hstmt1, 2, SQL_PARAM_INPUT, SQL_C_ULONG, SQL_INTEGER, 10, 0,<br/>                 &CustID, 0, &CustIDInd);*/<br/>    //<br/>	jdeStrcpy (lpDS-&gtszValorString, (const JCHAR *) szValorString);<br/>	//<br/>   /************************************************************************<br/>    * Function Clean Up<br/>    ************************************************************************/<br/>	//<br/>    return (ER_SUCCESS);<br/>}<br/><br/><br/>/* Internal function comment block */<br/>/**************************************************************************<br/> *   Function:  Ixxxxxxx_a   // Replace "xxxxxxx" with source file number<br/> *                           // and "a" with the function name<br/> *      Notes:<br/> *<br/> *    Returns:<br/> *<br/> * Parameters:<br/> **************************************************************************/<br/><br/>void I57ODBC_LogErros (SQLHANDLE      hHandle,     <br/>                             SQLSMALLINT    hType,   <br/>                             RETCODE        RetCode) <br/>{ <br/>    SQLSMALLINT iRec = 0; <br/>    SQLINTEGER  iError; <br/>    SQLWCHAR     szMessage[3000]; <br/>    SQLWCHAR     szState[SQL_SQLSTATE_SIZE+1]; <br/> 	SQLSMALLINT   MsgLen;<br/> <br/> <br/>    if (RetCode == SQL_INVALID_HANDLE) <br/>    { <br/>		jdeWriteLogEntry(JDELOG,_J("B57ODBC"), __FILE__, __LINE__, 0, _J("Invalid handle!"));<br/>        return; <br/>    } <br/> <br/>    while (SQLGetDiagRec(hType, <br/>                         hHandle, <br/>                         ++iRec, <br/>                         szState, <br/>                         &iError, <br/>                         szMessage, <br/>                         (SQLSMALLINT)(sizeof(szMessage) / sizeof(SQLCHAR)), <br/>                         &MsgLen) == SQL_SUCCESS) <br/>    { <br/>		jdeWriteLogEntry(JDELOG,_J("B57ODBC"), __FILE__, __LINE__, 0, szMessage);<br/>    } <br/> <br/>} <br/><br/><br/></pre></div></div><div class='section'>EVENTS<div class='objectheader'>C Function: Função para Trabalhar com ODBC - [ExecutaSQL]</div><div class='er'><div class='dstrmembers'><B>Data Structure: D57ODBC1 - Estrutura de dados para função B57ODBC - Executa SQL        </B><BR>BF idStatementHandle [GENLNG]<BR>BF cCodigoErro [ERRC]<BR>BF szComandoSQL [CMTS]<BR></div></div></div><div class='section'>EVENTS<div class='objectheader'>C Function: Função para Trabalhar com ODBC - [FechaConexao]</div><div class='er'><div class='dstrmembers'><B>Data Structure: D57ODBC2 - Estrutura de dados para função B57ODBC - Fecha Conexao      </B><BR>BF idStatementHandle [GENLNG]<BR>BF idConnectionHandle [GENLNG]<BR>BF idEnvironmentHandle [GENLNG]<BR>BF cCodigoErro [ERRC]<BR></div></div></div><div class='section'>EVENTS<div class='objectheader'>C Function: Função para Trabalhar com ODBC - [FechaCursor]</div><div class='er'><div class='dstrmembers'><B>Data Structure: D57ODBC8 - Estrutura de dados para função B57ODBC - Fecha Cursor       </B><BR>BF idStatementHandle [GENLNG]<BR>BF cCodigoErro [ERRC]<BR></div></div></div><div class='section'>EVENTS<div class='objectheader'>C Function: Função para Trabalhar com ODBC - [Fetch]</div><div class='er'><div class='dstrmembers'><B>Data Structure: D57ODBC6 - Estrutura de dados para função B57ODBC - Fech               </B><BR>BF idStatementHandle [GENLNG]<BR>BF cCodigoErro [ERRC]<BR></div></div></div><div class='section'>EVENTS<div class='objectheader'>C Function: Função para Trabalhar com ODBC - [RetornaData]</div><div class='er'><div class='dstrmembers'><B>Data Structure: D57ODBC3 - Estrutura de dados para função B57ODBC - Retorna Data       </B><BR>BF idStatementHandle [GENLNG]<BR>BF cCodigoErro [ERRC]<BR>BF nColuna [CIP]<BR>BF jdValorData [UPMJ]<BR></div></div></div><div class='section'>EVENTS<div class='objectheader'>C Function: Função para Trabalhar com ODBC - [RetornaMSG]</div><div class='er'><div class='dstrmembers'><B>Data Structure: D57ODBC7 - Estrutura de dados para função B57ODBC - Retorna Mensagem   </B><BR>BF idStatementHandle [GENLNG]<BR>BF cCodigoErro [ERRC]<BR>BF szMensagemErro [SGTXT]<BR></div></div></div><div class='section'>EVENTS<div class='objectheader'>C Function: Função para Trabalhar com ODBC - [RetornaNumerico]</div><div class='er'><div class='dstrmembers'><B>Data Structure: D57ODBC4 - Estrutura de dados para função B57ODBC - Retorna Numerico   </B><BR>BF idStatementHandle [GENLNG]<BR>BF cCodigoErro [ERRC]<BR>BF nColuna [CIP]<BR>BF mnValorNumerico [AA]<BR></div></div></div><div class='section'>EVENTS<div class='objectheader'>C Function: Função para Trabalhar com ODBC - [RetornaString]</div><div class='er'><div class='dstrmembers'><B>Data Structure: D57ODBC5 - Estrutura de dados para função B57ODBC - Retorna String     </B><BR>BF idStatementHandle [GENLNG]<BR>BF cCodigoErro [ERRC]<BR>BF nColuna [CIP]<BR>BF szValorString [D200]<BR></div></div></div><div class='section'>EVENTS<div class='objectheader'>C Function: Função para Trabalhar com ODBC - [SetaParametro]</div><div class='er'><div class='dstrmembers'><B>Data Structure: D57ODBC9 - Estrutura de dados para função B57ODBC - Seta Parametro     </B><BR>BF idStatementHandle [GENLNG]<BR>BF cCodigoErro [ERRC]<BR>BF szValorString [D200]<BR>BF szTipoParametro [OBND]<BR>BF szParametro [PF]<BR></div></div></div></body></html>