<!DOCTYPE html><html lang = "en"><head><meta charset = "utf-8"><meta name = "viewport" content = "width=device-width, initial-scale=1"><title>JDE Object Browser HTML Extract</title>
<style type='text/css'>body,th{font-family: Courier New, Courier, mono;font-size: 12px; width:auto}
.section{font-family: Arial, Helvetica, sans-serif;font-size: 12px;font-weight: bold;border: thin groove #CC9966;width: 100%;padding-left: 5px;padding-top: 5px;padding-bottom: 5px; padding-right: 5px; box-sizing: border-box }
.objectheader {font-family: Arial, Helvetica, sans-serif;font-size: 12px;font-weight: bold;border: thin groove #CC9966;width:auto;background-color: #FFFFCC;padding-left: 5px;padding-top: 5px;padding-bottom: 5px;padding-right: 5px; box-sizing: border-box }
.details{font-family: Arial, Helvetica, sans-serif;font-size: 11px;font-weight: normal;border: thin groove #CC9966;width:100%;padding-left: 5px;padding-top: 5px;padding-bottom: 5px;padding-right: 5px;box-sizing: border-box }
.er {background-color: #FFFFFF;font-family: Courier New, Courier, mono;font-size: 12px; font-weight: normal; border: thin solid #CCCCCC; width:auto; padding-left: 5px;padding-top: 5px;padding-bottom: 5px; padding-right: 5px; box-sizing: border-box }
.dstrmembers {background-color: #FFFDDD;font-family: Courier New, Courier, mono;font-size: 12px;border: thin groove #CC9966;padding-left: 5px;padding-top: 5px;padding-bottom: 5px;padding-right: 5px; box-sizing: border-box }
.disabled {font-family: Courier New, Courier, mono;font-size: 12px;	font-style: italic; color:#CC9933}
.parameters {font-family: Courier New, Courier, mono;font-size: 12px; color:#3333FF}
.comment {font-family: Courier New, Courier, mono;font-size: 12px;	color: #339933}
.subtable {font-family: Arial, Helvetica, sans-serif;font-size: 11px;font-weight: normal;width:100%}
.lineno {color:#6E6E6E;font-family: Courier New, Courier, mono;font-size: 12px; font-weight: normal;}
.iokey {color:#FF6905;font-family: Courier New, Courier, mono;font-size: 12px; font-weight: normal;}
.logicline {color:#000000;font-family: Courier New, Courier, mono;font-size: 12px; font-weight: normal;}
.versionoverride {background-color: #FFCC99;}
.overrideflags{font-family: Arial, Helvetica, sans-serif;font-size: 11px;font-weight: normal;border: thin groove #CC9966;width:auto;padding-left: 5px;padding-top: 5px;padding-bottom: 5px;padding-right: 5px; background-color: #FFCC99; box-sizing: border-box }
.bsfnprops {font-family: Courier New, Courier, mono;font-size: 12px; color:#E01B4C}
.searchresult {font-family: Courier New, Courier, mono;font-size: 12px; font-weight: bold; background-color:#8BF3A0}
.expand {font-family: Courier New, Courier, mono;font-size: 11px; font-weight: bold; cursor:pointer; border: 1px solid gray; position: relative; left: -3px; display:inline; line-height:8px;}
.expand2 { display:inline; cursor:pointer; font-size: 9px; border: 1px solid gray; position: relative; left: -3px;}
</style>
<script type='text/javascript'>function load(){location.href = '#result';}</script>
<script language='JavaScript' type='text/javascript'>function ExpandCollapse(ElementId){ var ClickedElement = document.getElementById(ElementId); var SectionName = ElementId + ':hide'; var Section = document.getElementById(SectionName); if (ClickedElement.innerHTML == '-') { 	 ClickedElement.innerHTML = '+';	Section.style.display = 'none'; }  else  { 		ClickedElement.innerHTML = '-'; 	Section.style.display = 'inline';}} </script>
<base target = "_parent"></head><body onload='load()'>
<div class ='objectheader'>Business Function: N5509CIA - Valida Intercompany<BR>Function Type: NER</div><div class='section'>EVENTS<div class='objectheader'>NER: ValidaIntercompany <BR>Event GUID: 3919b2a1-310f-11d2-a2df-006097cecff6</div><div class='er'><div class='dstrmembers'><B>Data Structure: D5509CIA - Parametros para N5509CIA (valida Intercompany)              </B><BR>BF szBatchType [ICUT]<BR>BF mnBatchNumber [ICU]<BR>BF mnNumberofAxle [AXLE]<BR></div>----------------------------------------</BR>Event Level Variables</BR>----------------------------------------</BR>evt_SYS [SY]<br>evt_DocType [DCT]<br>evt_DocTemp [DCT]<br>evt_TipoTeste [A]<br>evt_Controle1 [A]<br>evt_Company [CO]<br>evt_ContaBanco [GLBA]<br>evt_CompanyGL [CO]<br>evt_DocNum [DOC]<br>evt_DocTempNum [DOC]<br>evt_Tem53 [A]<br>evt_pagcod [PYID]<br>evt_CompanyKey [CO]<br>evt_ContaGL [ANI]<br>evt_CompanyCalc [CO]<br>evt_TotCompTemp [AA]<br>evt_TotComp53 [AA]<br>evt_TotCompanies [AA]<br>evt_ValCompany [AA]<br>evt_CompBase [CO]<br>evt_gdMCUF03B11 [MCU]<br>evt_gdCOMCU [CO]<br>evt_gdCO3 [CO]<br>evt_gdOBJF0911 [OBJ]<br>evt_gdCOCASHCO [CO]<br>evt_gdITEM [ITEM]<br>evt_gdCOF0012 [CO]<br>evt_gdMCUF0012 [MCU]<br>evt_AdditionFlag [A]<br>evt_ObjectAccountIni [OBJ]<br>evt_ObjectAccountFim [OBJ]<br>evt_SubsidiaryIni [SUB]<br>evt_SubsidiaryFim [SUB]<br>evt_DocumentType [DCT]<br>evt_ObjectAccountF0911 [OBJ]<br>evt_SubsidiaryF0911 [SUB]<br>evt_LedgerTypeF0911 [LT]<br>evt_SEMDocumentType_DCT [DCT]<br>evt_TemLivroAA_EV01 [EV01]<br>evt_udc_55 [SY]<br>evt_udc_AC [RT]<br>evt_udc_SPHD [SPHD]<br>evt_ValorAprovador [AA]<br>evt_ValorLimite [AA]<br>evt_ValorLancado [AA]<br>evt_CompanyMCU [CO]<br>evt_CRespAux [MCU]<br>evt_CiaFiscalCompany [RP01]<br>evt_CiaFiscalCompanyGL [RP01]<br>----------------------------------------</BR><span class='comment'>  // Objetivo:</span><span class='comment'><br>  //</span><span class='comment'><br>  //   Validar lote</span><span class='comment'><br>  // Cada lote selecionado da tela de aprovação de lotes (P0011).</span><span class='comment'><br>  //   Cada lote sendo</span><span class='comment'><br>  // aprovado deverá obedecer alguns critérios a seguir descritos.</span><span class='comment'><br>  //   Dependendo do</span><span class='comment'><br>  // tipo do lote, o lançamento intercompany poderá ou não ser permitido.  Em</span><span class='comment'><br>  // alguns casos, o mesmo tipo de lote poderá permitir intercompany para alguns</span><span class='comment'><br>  // documentos e para outros não.</span><span class='comment'><br>  //   Para cada tipo de lote existe um sistema</span><span class='comment'><br>  // associado.  A saber: 03, 04 ou 09.</span><span class='comment'><br>  //   Sendo que esta rotina processa</span><span class='comment'><br>  // independentemente a validação de cada um destes sistemas.</span><span class='comment'><br>  //   Dentro de cada</span><span class='comment'><br>  // validação de sistema existe uma divisão de acordo com o tipo de lote e</span><span class='comment'><br>  // documento, permitindo testar ou a proibição de intercompany ou a consistência</span><span class='comment'><br>  // se a empresa 53 está num dos lados do lançamento.</span><span class='comment'><br>  // tipo de lote, este poderá permitir lançamentos</span><span class='comment'><br>  // ISSUE 7759 - BUG - Dá erro de Intercompany, em dctos que não constam no SETUP</span><span class='comment'><br>  //</span><span class='comment'><br>  // *****************************************************************************</span><span class='comment'><br>  // Identificação do caminho de acordo com o tipo de lote</span><span class='comment'><br>  // *****************************************************************************</span><span class='comment'><br>  //</span><span class='comment'><br>  // Pega Cash Company da F0012</span><span class='comment'><br>  // Carrega status de saída OK = 0</span><br>  BF mnNumberofAxle [AXLE] = "0"<span class='comment'><br>  // Através do Batch Type passado como parâmetro encontramos</span><span class='comment'><br>  // na tabela F5509CIA o correspondente System Code</span><span class='comment'><br>  // intercompany</span><br> <div id='3919b2a1-310f-11d2-a2df-006097cecff6:41' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5509CIA.Open<div id='3919b2a1-310f-11d2-a2df-006097cecff6:41:hide' style='display: inline;'><br>       </div><br> <div id='3919b2a1-310f-11d2-a2df-006097cecff6:42' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5509CIA.Select  [Index 1: Chave]<div id='3919b2a1-310f-11d2-a2df-006097cecff6:42:hide' style='display: inline;'><br>       <span class='iokey'>BF szBatchType [ICUT] = TK Batch Type [ICUT]</span></div><br> <div id='3919b2a1-310f-11d2-a2df-006097cecff6:43' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5509CIA.FetchNext  [Index 1: Chave]<div id='3919b2a1-310f-11d2-a2df-006097cecff6:43:hide' style='display: inline;'><br>       VA evt_SYS [SY] &#60;- TK Product Code [SY]<br>       VA evt_AdditionFlag [A] &#60;- TK Add (Y/N) [A]</div><br> <div id='3919b2a1-310f-11d2-a2df-006097cecff6:44' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If SV File_IO_Status is not equal to CO SUCCESS<div id='3919b2a1-310f-11d2-a2df-006097cecff6:44:hide' style='display: inline;'><span class='comment'><br>       // Sem erro: Não encontrou forma de avaliação para este tipo de lote, mudou para</span><span class='comment'><br>       // sem erro</span><br>       BF mnNumberofAxle [AXLE] = "0"</div><br> <div id='3919b2a1-310f-11d2-a2df-006097cecff6:48' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='3919b2a1-310f-11d2-a2df-006097cecff6:48:hide' style='display: inline;'><br>      <div id='3919b2a1-310f-11d2-a2df-006097cecff6:49' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>While SV File_IO_Status is equal to CO SUCCESS<div id='3919b2a1-310f-11d2-a2df-006097cecff6:49:hide' style='display: inline;'><span class='comment'><br>            //</span><span class='comment'><br>            // Validação do Contas a Pagar e Contas a Receber</span><span class='comment'><br>            //</span><br>            VA evt_SYS [SY] = rtrim([VA evt_SYS [SY]], &#60;Blank&#62;)<br>           <div id='3919b2a1-310f-11d2-a2df-006097cecff6:54' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_SYS [SY] is equal to "04"<br>            Or VA evt_SYS [SY] is equal to "03"<div id='3919b2a1-310f-11d2-a2df-006097cecff6:54:hide' style='display: inline;'><br>                <div id='3919b2a1-310f-11d2-a2df-006097cecff6:55' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_SYS [SY] is equal to "04"<div id='3919b2a1-310f-11d2-a2df-006097cecff6:55:hide' style='display: inline;'><br>                     <div id='3919b2a1-310f-11d2-a2df-006097cecff6:56' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F0411.Open<div id='3919b2a1-310f-11d2-a2df-006097cecff6:56:hide' style='display: inline;'><br>                           </div><br>                     <div id='3919b2a1-310f-11d2-a2df-006097cecff6:57' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F0413.Open<div id='3919b2a1-310f-11d2-a2df-006097cecff6:57:hide' style='display: inline;'><br>                           </div><br>                     <div id='3919b2a1-310f-11d2-a2df-006097cecff6:58' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F0414.Open<div id='3919b2a1-310f-11d2-a2df-006097cecff6:58:hide' style='display: inline;'><br>                           </div></div><br>                <div id='3919b2a1-310f-11d2-a2df-006097cecff6:59' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='3919b2a1-310f-11d2-a2df-006097cecff6:59:hide' style='display: inline;'><br>                     <div id='3919b2a1-310f-11d2-a2df-006097cecff6:61' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F03B11.Open<div id='3919b2a1-310f-11d2-a2df-006097cecff6:61:hide' style='display: inline;'><br>                           </div><br>                     <div id='3919b2a1-310f-11d2-a2df-006097cecff6:62' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F03B13.Open<div id='3919b2a1-310f-11d2-a2df-006097cecff6:62:hide' style='display: inline;'><br>                           </div></div><br>                 End If<br>                <div id='3919b2a1-310f-11d2-a2df-006097cecff6:64' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F0901.Open<div id='3919b2a1-310f-11d2-a2df-006097cecff6:64:hide' style='display: inline;'><br>                      </div><br>                <div id='3919b2a1-310f-11d2-a2df-006097cecff6:65' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F0911.Open<div id='3919b2a1-310f-11d2-a2df-006097cecff6:65:hide' style='display: inline;'><br>                      </div><br>                <div id='3919b2a1-310f-11d2-a2df-006097cecff6:66' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_SYS [SY] is equal to "04"<div id='3919b2a1-310f-11d2-a2df-006097cecff6:66:hide' style='display: inline;'><span class='comment'><br>                      // Encontrar o primeiro registro do lote no F0411</span><br>                     <div id='3919b2a1-310f-11d2-a2df-006097cecff6:68' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F0411.Select  [Index 3: Batch Type, Number, + A]<div id='3919b2a1-310f-11d2-a2df-006097cecff6:68:hide' style='display: inline;'><br>                           <span class='iokey'>BF mnBatchNumber [ICU] = TK Batch Number [ICU]</span><br>                           <span class='iokey'>BF szBatchType [ICUT] = TK Batch Type [ICUT]</span></div><span class='comment'><br>                      // Recuperar o valor do DocType do registro encontrado</span><br>                     <div id='3919b2a1-310f-11d2-a2df-006097cecff6:70' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F0411.FetchNext  [Index 3: Batch Type, Number, + A]<div id='3919b2a1-310f-11d2-a2df-006097cecff6:70:hide' style='display: inline;'><br>                           VA evt_CompanyKey [CO] &#60;- TK Document Company [KCO]<br>                           VA evt_DocNum [DOC] &#60;- TK Document (Voucher, Invoice, etc.) [DOC]<br>                           VA evt_DocType [DCT] &#60;- TK Document Type [DCT]<br>                           VA evt_Company [CO] &#60;- TK Company [CO]<br>                           VA evt_ContaBanco [GLBA] &#60;- TK G/L Bank Account [GLBA]</div></div><br>                <div id='3919b2a1-310f-11d2-a2df-006097cecff6:71' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='3919b2a1-310f-11d2-a2df-006097cecff6:71:hide' style='display: inline;'><span class='comment'><br>                      // Encontrar o primeiro registro do lote no F03B11</span><br>                     <div id='3919b2a1-310f-11d2-a2df-006097cecff6:73' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F03B11.Select  [Index 1: Doc Number, Doc Type, +A]<div id='3919b2a1-310f-11d2-a2df-006097cecff6:73:hide' style='display: inline;'><br>                           <span class='iokey'>BF szBatchType [ICUT] = TK Batch Type [ICUT]</span><br>                           <span class='iokey'>BF mnBatchNumber [ICU] = TK Batch Number [ICU]</span></div><span class='comment'><br>                      // Recuperar o valor do DocType do registro encontrado</span><br>                     <div id='3919b2a1-310f-11d2-a2df-006097cecff6:75' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F03B11.FetchNext  [Index 1: Doc Number, Doc Type, +A]<div id='3919b2a1-310f-11d2-a2df-006097cecff6:75:hide' style='display: inline;'><br>                           VA evt_DocNum [DOC] &#60;- TK Document (Voucher, Invoice, etc.) [DOC]<br>                           VA evt_DocType [DCT] &#60;- TK Document Type [DCT]<br>                           VA evt_CompanyKey [CO] &#60;- TK Document Company [KCO]<br>                           VA evt_Company [CO] &#60;- TK Company [CO]<br>                           VA evt_ContaBanco [GLBA] &#60;- TK G/L Bank Account [GLBA]<br>                           VA evt_gdMCUF03B11 [MCU] &#60;- TK Business Unit [MCU]</div></div><br>                 End If<br>                <div id='3919b2a1-310f-11d2-a2df-006097cecff6:78' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If SV File_IO_Status is equal to CO SUCCESS<div id='3919b2a1-310f-11d2-a2df-006097cecff6:78:hide' style='display: inline;'><span class='comment'><br>                      // Variável para controlar se podemos seguir processando uma validação ou se já</span><span class='comment'><br>                      // falhou ou ainda se já terminou, inicialmente a variável inicia com 1,</span><span class='comment'><br>                      // indicando que até que se prove</span><span class='comment'><br>                      // em contrário que NÃO TEM ERRO</span><br>                      VA evt_Controle1 [A] = "1"<br>                     <div id='3919b2a1-310f-11d2-a2df-006097cecff6:85' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>While VA evt_Controle1 [A] is equal to "1"<div id='3919b2a1-310f-11d2-a2df-006097cecff6:85:hide' style='display: inline;'><br>                          <div id='3919b2a1-310f-11d2-a2df-006097cecff6:86' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If BF szBatchType [ICUT] is equal to "IB"<div id='3919b2a1-310f-11d2-a2df-006097cecff6:86:hide' style='display: inline;'><span class='comment'><br>                                // sópara não dar a mensagem abixo na compilação do pacote</span><span class='comment'><br>                                // warning: local variable is initialized but not referenced</span><br>                                VA evt_gdCOMCU [CO] = &#60;NULL&#62;<br>                                VA evt_gdCO3 [CO] = &#60;NULL&#62;<span class='comment'><br>                                //</span><br>                                VA evt_CompanyMCU [CO] = &#60;NULL&#62;<br>                               <div id='3919b2a1-310f-11d2-a2df-006097cecff6:101' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F0006.FetchSingle  [Index 1: Cost Center]<div id='3919b2a1-310f-11d2-a2df-006097cecff6:101:hide' style='display: inline;'><br>                                     <span class='iokey'>VA evt_gdMCUF03B11 [MCU] = TK Business Unit [MCU]</span><br>                                     VA evt_CompanyMCU [CO] &#60;- TK Company [CO]</div><br>                               <div id='3919b2a1-310f-11d2-a2df-006097cecff6:102' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_Company [CO] is not equal to VA evt_CompanyMCU [CO]<div id='3919b2a1-310f-11d2-a2df-006097cecff6:102:hide' style='display: inline;'><span class='comment'><br>                                     // Erro -6: Apropriação em empresas diferentes</span><br>                                     BF mnNumberofAxle [AXLE] = "-6"<br>                                     VA evt_Controle1 [A] = "0"</div><br>                                End If</div><br>                           End If<br>                           VA evt_TipoTeste [A] = "0"<span class='comment'><br>                           // Se não houve erro, processa a validação do registro</span><br>                          <div id='3919b2a1-310f-11d2-a2df-006097cecff6:111' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_Controle1 [A] is equal to "1"<div id='3919b2a1-310f-11d2-a2df-006097cecff6:111:hide' style='display: inline;'><span class='comment'><br>                                // 0 - Sem Intercompany</span><span class='comment'><br>                                // Busca o registro do F5509 para o tipo de lote e doctype do registro do F0411</span><span class='comment'><br>                                // carregado</span><br>                               <div id='3919b2a1-310f-11d2-a2df-006097cecff6:115' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5509CIA.Select  [Index 1: Chave]<div id='3919b2a1-310f-11d2-a2df-006097cecff6:115:hide' style='display: inline;'><br>                                     <span class='iokey'>BF szBatchType [ICUT] = TK Batch Type [ICUT]</span><br>                                     <span class='iokey'>VA evt_DocType [DCT] = TK Document Type [DCT]</span></div><span class='comment'><br>                                // Recupera a indicação do algoritmo indicado para avaliar o registro</span><br>                               <div id='3919b2a1-310f-11d2-a2df-006097cecff6:117' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5509CIA.FetchNext  [Index 1: Chave]<div id='3919b2a1-310f-11d2-a2df-006097cecff6:117:hide' style='display: inline;'><br>                                     VA evt_TipoTeste [A] &#60;- TK Add (Y/N) [A]</div><span class='comment'><br>                                // Se não encontrou o registro para documento específico</span><br>                               <div id='3919b2a1-310f-11d2-a2df-006097cecff6:119' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If SV File_IO_Status is not equal to CO SUCCESS<div id='3919b2a1-310f-11d2-a2df-006097cecff6:119:hide' style='display: inline;'><span class='comment'><br>                                     // Procura tipo de lote com documento genérico</span><br>                                     VA evt_DocTemp [DCT] = &#60;Blank&#62;<br>                                    <div id='3919b2a1-310f-11d2-a2df-006097cecff6:122' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5509CIA.Select  [Index 1: Chave]<div id='3919b2a1-310f-11d2-a2df-006097cecff6:122:hide' style='display: inline;'><br>                                          <span class='iokey'>BF szBatchType [ICUT] = TK Batch Type [ICUT]</span><br>                                          <span class='iokey'>VA evt_DocTemp [DCT] = TK Document Type [DCT]</span></div><span class='comment'><br>                                     // Recupera a indicação do algoritmo indicado para avaliar o registro</span><br>                                    <div id='3919b2a1-310f-11d2-a2df-006097cecff6:124' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5509CIA.FetchNext  [Index 1: Chave]<div id='3919b2a1-310f-11d2-a2df-006097cecff6:124:hide' style='display: inline;'><br>                                          VA evt_TipoTeste [A] &#60;- TK Add (Y/N) [A]</div><span class='comment'><br>                                     // Se não encontrou o registro para documento genérico</span><br>                                    <div id='3919b2a1-310f-11d2-a2df-006097cecff6:126' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If SV File_IO_Status is not equal to CO SUCCESS<div id='3919b2a1-310f-11d2-a2df-006097cecff6:126:hide' style='display: inline;'><span class='comment'><br>                                          // Erro -2: Não encontrou forma de validação cadastrada para este tipo de</span><span class='comment'><br>                                          // lote/documento</span><br>                                          BF mnNumberofAxle [AXLE] = "-2"<br>                                          VA evt_Controle1 [A] = "0"</div><br>                                     End If</div><br>                                End If<br>                                VA evt_DocTemp [DCT] = VA evt_DocType [DCT]<span class='comment'><br>                                //</span><span class='comment'><br>                                // ****   acessa a HUB cia</span><span class='comment'><br>                                // Pega Cash Company da F0012</span><br>                                VA evt_gdITEM [ITEM] = "ICH"<br>                                VA evt_gdCOF0012 [CO] = VA evt_Company [CO]<br>                               <div id='3919b2a1-310f-11d2-a2df-006097cecff6:139' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F0012.FetchSingle  [Index 1: ITEM NUMBER,COMPANY]<div id='3919b2a1-310f-11d2-a2df-006097cecff6:139:hide' style='display: inline;'><br>                                     <span class='iokey'>VA evt_gdITEM [ITEM] = TK Item Number [ITEM]</span><br>                                     <span class='iokey'>VA evt_gdCOF0012 [CO] = TK Company [CO]</span><br>                                     VA evt_gdMCUF0012 [MCU] &#60;- TK Business Unit [MCU]</div><br>                               <div id='3919b2a1-310f-11d2-a2df-006097cecff6:140' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If SV File_IO_Status is not equal to CO SUCCESS<div id='3919b2a1-310f-11d2-a2df-006097cecff6:140:hide' style='display: inline;'><br>                                     VA evt_gdCOCASHCO [CO] = "00999"</div><br>                               <div id='3919b2a1-310f-11d2-a2df-006097cecff6:142' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='3919b2a1-310f-11d2-a2df-006097cecff6:142:hide' style='display: inline;'><br>                                     VA evt_gdCOCASHCO [CO] = concat("00", substr([VA evt_gdMCUF0012 [MCU]], "9", "3"))</div><br>                                End If<span class='comment'><br>                                //</span><span class='comment'><br>                                //</span><br>                               <div id='3919b2a1-310f-11d2-a2df-006097cecff6:148' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F0911.Select  [Index 12: Batch Type, Number, +]<div id='3919b2a1-310f-11d2-a2df-006097cecff6:148:hide' style='display: inline;'><br>                                     <span class='iokey'>VA evt_CompanyKey [CO] = TK Document Company [KCO]</span><br>                                     <span class='iokey'>VA evt_DocType [DCT] = TK Document Type [DCT]</span><br>                                     <span class='iokey'>VA evt_DocNum [DOC] = TK Document (Voucher, Invoice, etc.) [DOC]</span><br>                                     <span class='iokey'>BF mnBatchNumber [ICU] = TK Batch Number [ICU]</span><br>                                     <span class='iokey'>BF szBatchType [ICUT] = TK Batch Type [ICUT]</span></div><br>                               <div id='3919b2a1-310f-11d2-a2df-006097cecff6:149' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F0911.FetchNext  [Index 12: Batch Type, Number, +]<div id='3919b2a1-310f-11d2-a2df-006097cecff6:149:hide' style='display: inline;'><br>                                     VA evt_CompanyGL [CO] &#60;- TK Company [CO]<br>                                     VA evt_ContaGL [ANI] &#60;- TK Account Number - Input (Mode Unknown) [ANI]<br>                                     VA evt_gdOBJF0911 [OBJ] &#60;- TK Object Account [OBJ]</div><br>                               <div id='3919b2a1-310f-11d2-a2df-006097cecff6:150' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If SV File_IO_Status is not equal to CO SUCCESS<div id='3919b2a1-310f-11d2-a2df-006097cecff6:150:hide' style='display: inline;'><br>                                     VA evt_Controle1 [A] = "0"</div><br>                               <div id='3919b2a1-310f-11d2-a2df-006097cecff6:155' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='3919b2a1-310f-11d2-a2df-006097cecff6:155:hide' style='display: inline;'><br>                                    <div id='3919b2a1-310f-11d2-a2df-006097cecff6:156' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>While SV File_IO_Status is equal to CO SUCCESS<br>                                     And VA evt_Controle1 [A] is equal to "1"<div id='3919b2a1-310f-11d2-a2df-006097cecff6:156:hide' style='display: inline;'><br>                                          VA evt_CompanyCalc [CO] = concat("00", substr(ltrim(rtrim([VA evt_ContaGL [ANI]], &#60;Blank&#62;), &#60;Blank&#62;), "0", "3"))<br>                                         <div id='3919b2a1-310f-11d2-a2df-006097cecff6:159' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_Company [CO] is not equal to VA evt_CompanyCalc [CO]<br>                                          And VA evt_Controle1 [A] is equal to "1"<div id='3919b2a1-310f-11d2-a2df-006097cecff6:159:hide' style='display: inline;'><br>                                              <div id='3919b2a1-310f-11d2-a2df-006097cecff6:160' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_TipoTeste [A] is equal to "1"<br>                                               And VA evt_CompanyCalc [CO] is equal to VA evt_gdCOCASHCO [CO]<div id='3919b2a1-310f-11d2-a2df-006097cecff6:160:hide' style='display: inline;'></div><br>                                              <div id='3919b2a1-310f-11d2-a2df-006097cecff6:161' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='3919b2a1-310f-11d2-a2df-006097cecff6:161:hide' style='display: inline;'><br>                                                   <div id='3919b2a1-310f-11d2-a2df-006097cecff6:162' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If BF szBatchType [ICUT] is equal to "IB"<br>                                                    And VA evt_CompanyCalc [CO] is equal to VA evt_gdCOCASHCO [CO]<br>                                                    And VA evt_gdOBJF0911 [OBJ] is equal to ("110292","110293","110294","110295","110296","110297")<div id='3919b2a1-310f-11d2-a2df-006097cecff6:162:hide' style='display: inline;'></div><br>                                                   <div id='3919b2a1-310f-11d2-a2df-006097cecff6:164' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='3919b2a1-310f-11d2-a2df-006097cecff6:164:hide' style='display: inline;'><span class='comment'><br>                                                         // Erro -6: Apropriação em empresas diferentes</span><br>                                                         BF mnNumberofAxle [AXLE] = "-6"<br>                                                         VA evt_Controle1 [A] = "0"</div><br>                                                    End If</div><br>                                               End If</div><br>                                          End If<br>                                         <div id='3919b2a1-310f-11d2-a2df-006097cecff6:172' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F0911.FetchNext  [Index 12: Batch Type, Number, +]<div id='3919b2a1-310f-11d2-a2df-006097cecff6:172:hide' style='display: inline;'><br>                                               VA evt_CompanyGL [CO] &#60;- TK Company [CO]<br>                                               VA evt_ContaGL [ANI] &#60;- TK Account Number - Input (Mode Unknown) [ANI]<br>                                               VA evt_gdOBJF0911 [OBJ] &#60;- TK Object Account [OBJ]</div></div><br>                                     End While</div><br>                                End If</div><br>                           End If<span class='comment'><br>                           // Se não houve erro</span><br>                          <div id='3919b2a1-310f-11d2-a2df-006097cecff6:177' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_Controle1 [A] is equal to "1"<div id='3919b2a1-310f-11d2-a2df-006097cecff6:177:hide' style='display: inline;'><br>                               <div id='3919b2a1-310f-11d2-a2df-006097cecff6:178' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_SYS [SY] is equal to "04"<div id='3919b2a1-310f-11d2-a2df-006097cecff6:178:hide' style='display: inline;'><span class='comment'><br>                                     // Procura a próxima linha de  Documento</span><br>                                    <div id='3919b2a1-310f-11d2-a2df-006097cecff6:180' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F0411.FetchNext  [Index 3: Batch Type, Number, + A]<div id='3919b2a1-310f-11d2-a2df-006097cecff6:180:hide' style='display: inline;'><br>                                          VA evt_CompanyKey [CO] &#60;- TK Document Company [KCO]<br>                                          VA evt_DocNum [DOC] &#60;- TK Document (Voucher, Invoice, etc.) [DOC]<br>                                          VA evt_DocType [DCT] &#60;- TK Document Type [DCT]<br>                                          VA evt_Company [CO] &#60;- TK Company [CO]<br>                                          VA evt_ContaBanco [GLBA] &#60;- TK G/L Bank Account [GLBA]</div></div><br>                               <div id='3919b2a1-310f-11d2-a2df-006097cecff6:181' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='3919b2a1-310f-11d2-a2df-006097cecff6:181:hide' style='display: inline;'><span class='comment'><br>                                     // Procura a próxima linha de  Documento</span><br>                                    <div id='3919b2a1-310f-11d2-a2df-006097cecff6:183' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F03B11.FetchNext  [Index 1: Doc Number, Doc Type, +A]<div id='3919b2a1-310f-11d2-a2df-006097cecff6:183:hide' style='display: inline;'><br>                                          VA evt_DocNum [DOC] &#60;- TK Document (Voucher, Invoice, etc.) [DOC]<br>                                          VA evt_DocType [DCT] &#60;- TK Document Type [DCT]<br>                                          VA evt_CompanyKey [CO] &#60;- TK Document Company [KCO]<br>                                          VA evt_Company [CO] &#60;- TK Company [CO]<br>                                          VA evt_ContaBanco [GLBA] &#60;- TK G/L Bank Account [GLBA]<br>                                          VA evt_gdMCUF03B11 [MCU] &#60;- TK Business Unit [MCU]</div></div><br>                                End If<br>                               <div id='3919b2a1-310f-11d2-a2df-006097cecff6:185' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If SV File_IO_Status is not equal to CO SUCCESS<div id='3919b2a1-310f-11d2-a2df-006097cecff6:185:hide' style='display: inline;'><br>                                     VA evt_Controle1 [A] = "0"</div><br>                                End If</div><br>                           End If</div><br>                      End While</div><br>                <div id='3919b2a1-310f-11d2-a2df-006097cecff6:191' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='3919b2a1-310f-11d2-a2df-006097cecff6:191:hide' style='display: inline;'><br>                     <div id='3919b2a1-310f-11d2-a2df-006097cecff6:192' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_SYS [SY] is equal to "04"<div id='3919b2a1-310f-11d2-a2df-006097cecff6:192:hide' style='display: inline;'><span class='comment'><br>                           // Encontrar o primeiro registro do lote no F0413</span><br>                          <div id='3919b2a1-310f-11d2-a2df-006097cecff6:194' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F0413.Select  [Index 2: Batch Type, Number, +]<div id='3919b2a1-310f-11d2-a2df-006097cecff6:194:hide' style='display: inline;'><br>                                <span class='iokey'>BF mnBatchNumber [ICU] = TK Batch Number [ICU]</span><br>                                <span class='iokey'>BF szBatchType [ICUT] = TK Batch Type [ICUT]</span></div><span class='comment'><br>                           // Recuperar o valor do DocType do registro encontrado</span><br>                          <div id='3919b2a1-310f-11d2-a2df-006097cecff6:196' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F0413.FetchNext  [Index 2: Batch Type, Number, +]<div id='3919b2a1-310f-11d2-a2df-006097cecff6:196:hide' style='display: inline;'><br>                                VA evt_pagcod [PYID] &#60;- TK Payment ID (Internal) [PYID]<br>                                VA evt_DocType [DCT] &#60;- TK Document Type - Matching [DCTM]<br>                                VA evt_DocNum [DOC] &#60;- TK Document - Matching(Payment or Item) [DOCM]<br>                                VA evt_ContaBanco [GLBA] &#60;- TK G/L Bank Account [GLBA]</div><br>                          <div id='3919b2a1-310f-11d2-a2df-006097cecff6:197' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If SV File_IO_Status is equal to CO SUCCESS<div id='3919b2a1-310f-11d2-a2df-006097cecff6:197:hide' style='display: inline;'><span class='comment'><br>                                // Variável para controlar se podemos seguir processando uma validação ou se já</span><span class='comment'><br>                                // falhou ou ainda se já terminou, inicialmente a variável inicia com 1,</span><span class='comment'><br>                                // indicando que até que se prove</span><span class='comment'><br>                                // em contrário que NÃO TEM ERRO</span><br>                                VA evt_Controle1 [A] = "1"<br>                               <div id='3919b2a1-310f-11d2-a2df-006097cecff6:203' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>While VA evt_Controle1 [A] is equal to "1"<div id='3919b2a1-310f-11d2-a2df-006097cecff6:203:hide' style='display: inline;'><span class='comment'><br>                                     // Busca o registro do F5509 para o tipo de lote e doctype do registro do F0411</span><span class='comment'><br>                                     // carregado</span><br>                                    <div id='3919b2a1-310f-11d2-a2df-006097cecff6:206' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5509CIA.Select  [Index 1: Chave]<div id='3919b2a1-310f-11d2-a2df-006097cecff6:206:hide' style='display: inline;'><br>                                          <span class='iokey'>BF szBatchType [ICUT] = TK Batch Type [ICUT]</span><br>                                          <span class='iokey'>VA evt_DocType [DCT] = TK Document Type [DCT]</span></div><span class='comment'><br>                                     // Recupera a indicação do algoritmo indicado para avaliar o registro</span><br>                                    <div id='3919b2a1-310f-11d2-a2df-006097cecff6:208' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5509CIA.FetchNext  [Index 1: Chave]<div id='3919b2a1-310f-11d2-a2df-006097cecff6:208:hide' style='display: inline;'><br>                                          VA evt_TipoTeste [A] &#60;- TK Add (Y/N) [A]</div><span class='comment'><br>                                     // Se não encontrou o registro para documento específico</span><br>                                    <div id='3919b2a1-310f-11d2-a2df-006097cecff6:210' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If SV File_IO_Status is not equal to CO SUCCESS<div id='3919b2a1-310f-11d2-a2df-006097cecff6:210:hide' style='display: inline;'><span class='comment'><br>                                          // Procura tipo de lote com documento genérico</span><br>                                          VA evt_DocTemp [DCT] = &#60;Blank&#62;<br>                                         <div id='3919b2a1-310f-11d2-a2df-006097cecff6:213' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5509CIA.Select  [Index 1: Chave]<div id='3919b2a1-310f-11d2-a2df-006097cecff6:213:hide' style='display: inline;'><br>                                               <span class='iokey'>BF szBatchType [ICUT] = TK Batch Type [ICUT]</span><br>                                               <span class='iokey'>VA evt_DocTemp [DCT] = TK Document Type [DCT]</span></div><span class='comment'><br>                                          // Recupera a indicação do algoritmo indicado para avaliar o registro</span><br>                                         <div id='3919b2a1-310f-11d2-a2df-006097cecff6:215' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5509CIA.FetchNext  [Index 1: Chave]<div id='3919b2a1-310f-11d2-a2df-006097cecff6:215:hide' style='display: inline;'><br>                                               VA evt_TipoTeste [A] &#60;- TK Add (Y/N) [A]</div><span class='comment'><br>                                          // Se não encontrou o registro para documento genérico</span><br>                                         <div id='3919b2a1-310f-11d2-a2df-006097cecff6:217' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If SV File_IO_Status is not equal to CO SUCCESS<div id='3919b2a1-310f-11d2-a2df-006097cecff6:217:hide' style='display: inline;'><span class='comment'><br>                                               // Erro -2: Não encontrou forma de validação cadastrada para este tipo de</span><span class='comment'><br>                                               // lote/documento</span><br>                                               BF mnNumberofAxle [AXLE] = "-2"<br>                                               VA evt_Controle1 [A] = "0"</div><br>                                          End If</div><br>                                     End If<span class='comment'><br>                                     // Se não houve erro, processa a validação do registro</span><br>                                    <div id='3919b2a1-310f-11d2-a2df-006097cecff6:225' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_Controle1 [A] is equal to "1"<div id='3919b2a1-310f-11d2-a2df-006097cecff6:225:hide' style='display: inline;'><span class='comment'><br>                                          // Verifica se validará:</span><span class='comment'><br>                                          // 1- Com Intercompany</span><span class='comment'><br>                                          // 0 - Sem Intercompany</span><br>                                         <div id='3919b2a1-310f-11d2-a2df-006097cecff6:229' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_TipoTeste [A] is equal to "1"<div id='3919b2a1-310f-11d2-a2df-006097cecff6:229:hide' style='display: inline;'><span class='comment'><br>                                               // 1 - Com Intercompany</span><span class='comment'><br>                                               // Procura o Bank Account no Plano de Contas</span><br>                                              <div id='3919b2a1-310f-11d2-a2df-006097cecff6:232' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F0901.Select  [Index 3: Account Id]<div id='3919b2a1-310f-11d2-a2df-006097cecff6:232:hide' style='display: inline;'><br>                                                    <span class='iokey'>VA evt_ContaBanco [GLBA] = TK Account ID [AID]</span></div><span class='comment'><br>                                               // Carrega a companhia</span><br>                                              <div id='3919b2a1-310f-11d2-a2df-006097cecff6:234' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F0901.FetchNext  [Index 3: Account Id]<div id='3919b2a1-310f-11d2-a2df-006097cecff6:234:hide' style='display: inline;'><br>                                                    VA evt_CompanyGL [CO] &#60;- TK Company [CO]</div><span class='comment'><br>                                               // Se não encontrou o bank account</span><br>                                              <div id='3919b2a1-310f-11d2-a2df-006097cecff6:236' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If SV File_IO_Status is not equal to CO SUCCESS<div id='3919b2a1-310f-11d2-a2df-006097cecff6:236:hide' style='display: inline;'><span class='comment'><br>                                                    // Erro -3: Não encontrou Bank Account em um lançamento de liquidação</span><br>                                                    BF mnNumberofAxle [AXLE] = "-3"<br>                                                    VA evt_Controle1 [A] = "0"</div><br>                                              <div id='3919b2a1-310f-11d2-a2df-006097cecff6:240' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='3919b2a1-310f-11d2-a2df-006097cecff6:240:hide' style='display: inline;'><br>                                                   <div id='3919b2a1-310f-11d2-a2df-006097cecff6:241' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F0414.Select  [Index 1: Payment ID, Line]<div id='3919b2a1-310f-11d2-a2df-006097cecff6:241:hide' style='display: inline;'><br>                                                         <span class='iokey'>VA evt_pagcod [PYID] = TK Payment ID (Internal) [PYID]</span></div><br>                                                   <div id='3919b2a1-310f-11d2-a2df-006097cecff6:242' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F0414.FetchNext  [Index 1: Payment ID, Line]<div id='3919b2a1-310f-11d2-a2df-006097cecff6:242:hide' style='display: inline;'><br>                                                         VA evt_Company [CO] &#60;- TK Company [CO]</div><br>                                                   <div id='3919b2a1-310f-11d2-a2df-006097cecff6:243' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>While VA evt_Controle1 [A] is equal to "1"<br>                                                    And SV File_IO_Status is equal to CO SUCCESS<div id='3919b2a1-310f-11d2-a2df-006097cecff6:243:hide' style='display: inline;'><span class='comment'><br>                                                         //</span><span class='comment'><br>                                                         //</span><span class='comment'><br>                                                         // **** acessa HUB da cia</span><span class='comment'><br>                                                         // Pega Cash Company da F0012</span><br>                                                         VA evt_gdITEM [ITEM] = "ICH"<br>                                                         VA evt_gdCOF0012 [CO] = VA evt_Company [CO]<br>                                                        <div id='3919b2a1-310f-11d2-a2df-006097cecff6:250' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F0012.FetchSingle  [Index 1: ITEM NUMBER,COMPANY]<div id='3919b2a1-310f-11d2-a2df-006097cecff6:250:hide' style='display: inline;'><br>                                                              <span class='iokey'>VA evt_gdITEM [ITEM] = TK Item Number [ITEM]</span><br>                                                              <span class='iokey'>VA evt_gdCOF0012 [CO] = TK Company [CO]</span><br>                                                              VA evt_gdMCUF0012 [MCU] &#60;- TK Business Unit [MCU]</div><br>                                                        <div id='3919b2a1-310f-11d2-a2df-006097cecff6:251' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If SV File_IO_Status is not equal to CO SUCCESS<div id='3919b2a1-310f-11d2-a2df-006097cecff6:251:hide' style='display: inline;'><br>                                                              VA evt_gdCOCASHCO [CO] = "00999"</div><br>                                                        <div id='3919b2a1-310f-11d2-a2df-006097cecff6:253' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='3919b2a1-310f-11d2-a2df-006097cecff6:253:hide' style='display: inline;'><br>                                                              VA evt_gdCOCASHCO [CO] = concat("00", substr([VA evt_gdMCUF0012 [MCU]], "9", "3"))</div><br>                                                         End If<br>                                                        <div id='3919b2a1-310f-11d2-a2df-006097cecff6:256' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If BF szBatchType [ICUT] is equal to "M"<div id='3919b2a1-310f-11d2-a2df-006097cecff6:256:hide' style='display: inline;'><br>                                                              VA evt_CRespAux [MCU] = lpad(substr([VA evt_Company [CO]], "2", "3"), &#60;Blank&#62;, "12")<br>                                                             <div id='3919b2a1-310f-11d2-a2df-006097cecff6:258' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F0006.FetchSingle  [Index 1: Cost Center]<div id='3919b2a1-310f-11d2-a2df-006097cecff6:258:hide' style='display: inline;'><br>                                                                   <span class='iokey'>VA evt_CRespAux [MCU] = TK Business Unit [MCU]</span><br>                                                                   VA evt_CiaFiscalCompany [RP01] &#60;- TK Division [RP01]</div><br>                                                              VA evt_CRespAux [MCU] = lpad(substr([VA evt_CompanyGL [CO]], "2", "3"), &#60;Blank&#62;, "12")<br>                                                             <div id='3919b2a1-310f-11d2-a2df-006097cecff6:260' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F0006.FetchSingle  [Index 1: Cost Center]<div id='3919b2a1-310f-11d2-a2df-006097cecff6:260:hide' style='display: inline;'><br>                                                                   <span class='iokey'>VA evt_CRespAux [MCU] = TK Business Unit [MCU]</span><br>                                                                   VA evt_CiaFiscalCompanyGL [RP01] &#60;- TK Division [RP01]</div><br>                                                             <div id='3919b2a1-310f-11d2-a2df-006097cecff6:261' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_Company [CO] is not equal to VA evt_CompanyGL [CO]<br>                                                              And VA evt_Company [CO] is not equal to VA evt_gdCOCASHCO [CO]<br>                                                              And VA evt_CompanyGL [CO] is not equal to VA evt_gdCOCASHCO [CO]<br>                                                              And VA evt_CiaFiscalCompany [RP01] is not equal to VA evt_CiaFiscalCompanyGL [RP01]<div id='3919b2a1-310f-11d2-a2df-006097cecff6:261:hide' style='display: inline;'><span class='comment'><br>                                                                   // Erro -4: Lanç.Intercompany de liq. que não está sendo feito contra a 053</span><br>                                                                   BF mnNumberofAxle [AXLE] = "-4"<br>                                                                   VA evt_Controle1 [A] = "0"</div><br>                                                              End If</div><br>                                                        <div id='3919b2a1-310f-11d2-a2df-006097cecff6:266' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='3919b2a1-310f-11d2-a2df-006097cecff6:266:hide' style='display: inline;'><br>                                                             <div id='3919b2a1-310f-11d2-a2df-006097cecff6:267' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_Company [CO] is not equal to VA evt_CompanyGL [CO]<br>                                                              And VA evt_Company [CO] is not equal to VA evt_gdCOCASHCO [CO]<br>                                                              And VA evt_CompanyGL [CO] is not equal to VA evt_gdCOCASHCO [CO]<div id='3919b2a1-310f-11d2-a2df-006097cecff6:267:hide' style='display: inline;'><span class='comment'><br>                                                                   // Erro -4: Lanç.Intercompany de liq. que não está sendo feito contra a 053</span><br>                                                                   BF mnNumberofAxle [AXLE] = "-4"<br>                                                                   VA evt_Controle1 [A] = "0"</div><br>                                                              End If</div><br>                                                         End If<br>                                                        <div id='3919b2a1-310f-11d2-a2df-006097cecff6:273' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F0414.FetchNext  [Index 1: Payment ID, Line]<div id='3919b2a1-310f-11d2-a2df-006097cecff6:273:hide' style='display: inline;'><br>                                                              VA evt_Company [CO] &#60;- TK Company [CO]</div></div><br>                                                    End While</div><br>                                               End If</div><br>                                         <div id='3919b2a1-310f-11d2-a2df-006097cecff6:276' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='3919b2a1-310f-11d2-a2df-006097cecff6:276:hide' style='display: inline;'><span class='comment'><br>                                               // 0 - Sem Intercompany</span><span class='comment'><br>                                               // Procura o Bank Account no Plano de Contas</span><br>                                              <div id='3919b2a1-310f-11d2-a2df-006097cecff6:279' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F0901.Select  [Index 3: Account Id]<div id='3919b2a1-310f-11d2-a2df-006097cecff6:279:hide' style='display: inline;'><br>                                                    <span class='iokey'>VA evt_ContaBanco [GLBA] = TK Account ID [AID]</span></div><span class='comment'><br>                                               // Carrega a companhia</span><br>                                              <div id='3919b2a1-310f-11d2-a2df-006097cecff6:281' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F0901.FetchNext  [Index 3: Account Id]<div id='3919b2a1-310f-11d2-a2df-006097cecff6:281:hide' style='display: inline;'><br>                                                    VA evt_CompanyGL [CO] &#60;- TK Company [CO]</div><span class='comment'><br>                                               // Se não encontrou o bank account</span><br>                                              <div id='3919b2a1-310f-11d2-a2df-006097cecff6:283' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If SV File_IO_Status is not equal to CO SUCCESS<div id='3919b2a1-310f-11d2-a2df-006097cecff6:283:hide' style='display: inline;'><span class='comment'><br>                                                    // Erro -3: Não encontrou Bank Account em um lançamento de liquidação</span><br>                                                    BF mnNumberofAxle [AXLE] = "-3"<br>                                                    VA evt_Controle1 [A] = "0"</div><br>                                              <div id='3919b2a1-310f-11d2-a2df-006097cecff6:287' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='3919b2a1-310f-11d2-a2df-006097cecff6:287:hide' style='display: inline;'><br>                                                   <div id='3919b2a1-310f-11d2-a2df-006097cecff6:288' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F0414.Select  [Index 1: Payment ID, Line]<div id='3919b2a1-310f-11d2-a2df-006097cecff6:288:hide' style='display: inline;'><br>                                                         <span class='iokey'>VA evt_pagcod [PYID] = TK Payment ID (Internal) [PYID]</span></div><br>                                                   <div id='3919b2a1-310f-11d2-a2df-006097cecff6:289' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F0414.FetchNext  [Index 1: Payment ID, Line]<div id='3919b2a1-310f-11d2-a2df-006097cecff6:289:hide' style='display: inline;'><br>                                                         VA evt_Company [CO] &#60;- TK Company [CO]</div><br>                                                   <div id='3919b2a1-310f-11d2-a2df-006097cecff6:290' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>While VA evt_Controle1 [A] is equal to "1"<br>                                                    And SV File_IO_Status is equal to CO SUCCESS<div id='3919b2a1-310f-11d2-a2df-006097cecff6:290:hide' style='display: inline;'><br>                                                        <div id='3919b2a1-310f-11d2-a2df-006097cecff6:291' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_Company [CO] is not equal to VA evt_CompanyGL [CO]<div id='3919b2a1-310f-11d2-a2df-006097cecff6:291:hide' style='display: inline;'><span class='comment'><br>                                                              // Erro -9: Lançamento de liquidação que não pode ter intercompany</span><br>                                                              BF mnNumberofAxle [AXLE] = "-9"<br>                                                              VA evt_Controle1 [A] = "0"</div><br>                                                         End If<br>                                                        <div id='3919b2a1-310f-11d2-a2df-006097cecff6:296' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F0414.FetchNext  [Index 1: Payment ID, Line]<div id='3919b2a1-310f-11d2-a2df-006097cecff6:296:hide' style='display: inline;'><br>                                                              VA evt_Company [CO] &#60;- TK Company [CO]</div></div><br>                                                    End While</div><br>                                               End If</div><br>                                          End If</div><br>                                     End If<span class='comment'><br>                                     // Se não houve erro</span><br>                                    <div id='3919b2a1-310f-11d2-a2df-006097cecff6:302' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_Controle1 [A] is equal to "1"<div id='3919b2a1-310f-11d2-a2df-006097cecff6:302:hide' style='display: inline;'><span class='comment'><br>                                          // Procura a próxima linha de  Documento</span><br>                                         <div id='3919b2a1-310f-11d2-a2df-006097cecff6:304' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F0413.FetchNext  [Index 2: Batch Type, Number, +]<div id='3919b2a1-310f-11d2-a2df-006097cecff6:304:hide' style='display: inline;'><br>                                               VA evt_pagcod [PYID] &#60;- TK Payment ID (Internal) [PYID]<br>                                               VA evt_DocType [DCT] &#60;- TK Document Type - Matching [DCTM]<br>                                               VA evt_DocNum [DOC] &#60;- TK Document - Matching(Payment or Item) [DOCM]<br>                                               VA evt_ContaBanco [GLBA] &#60;- TK G/L Bank Account [GLBA]</div><br>                                         <div id='3919b2a1-310f-11d2-a2df-006097cecff6:305' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If SV File_IO_Status is not equal to CO SUCCESS<div id='3919b2a1-310f-11d2-a2df-006097cecff6:305:hide' style='display: inline;'><br>                                               VA evt_Controle1 [A] = "0"</div><br>                                          End If</div><br>                                     End If</div><br>                                End While</div><br>                           End If</div><br>                     <div id='3919b2a1-310f-11d2-a2df-006097cecff6:311' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='3919b2a1-310f-11d2-a2df-006097cecff6:311:hide' style='display: inline;'><span class='comment'><br>                           // Encontrar o primeiro registro do lote no F0413</span><br>                          <div id='3919b2a1-310f-11d2-a2df-006097cecff6:314' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F03B13.Select  [Index 3: Batch Type,Number,+]<div id='3919b2a1-310f-11d2-a2df-006097cecff6:314:hide' style='display: inline;'><br>                                <span class='iokey'>BF szBatchType [ICUT] = TK Batch Type [ICUT]</span><br>                                <span class='iokey'>BF mnBatchNumber [ICU] = TK Batch Number [ICU]</span></div><span class='comment'><br>                           // Recuperar o valor do DocType do registro encontrado</span><br>                          <div id='3919b2a1-310f-11d2-a2df-006097cecff6:316' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F03B13.FetchNext  [Index 3: Batch Type,Number,+]<div id='3919b2a1-310f-11d2-a2df-006097cecff6:316:hide' style='display: inline;'><br>                                VA evt_Company [CO] &#60;- TK Company [CO]<br>                                VA evt_ContaBanco [GLBA] &#60;- TK G/L Bank Account [GLBA]<br>                                VA evt_DocNum [DOC] &#60;- TK Document Number - JE [DOCG]<br>                                VA evt_DocType [DCT] &#60;- TK Document Type - JE [DCTG]</div><br>                          <div id='3919b2a1-310f-11d2-a2df-006097cecff6:317' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If SV File_IO_Status is equal to CO SUCCESS<div id='3919b2a1-310f-11d2-a2df-006097cecff6:317:hide' style='display: inline;'><br>                               <div id='3919b2a1-310f-11d2-a2df-006097cecff6:318' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>MDDebug(MD_DEBUG.MDDebug)<div id='3919b2a1-310f-11d2-a2df-006097cecff6:318:hide' style='display: inline;'><span class='parameters'><br>                                     "ENTREI X" -&#62; szComment [DSC1]<br>                                     UNDEFINED &#60;&#62; szString_1 [DSC1]<br>                                     UNDEFINED &#60;&#62; szString_2 [DSC1]<br>                                     UNDEFINED &#60;&#62; szString_3 [DSC1]<br>                                     UNDEFINED &#60;&#62; szString_4 [DSC1]<br>                                     UNDEFINED &#60;&#62; szString_5 [DSC1]<br>                                     BF mnBatchNumber [ICU] -&#62; mnMathNumeric_1 [ITM]<br>                                     UNDEFINED &#60;&#62; mnMathNumeric_2 [ITM]<br>                                     UNDEFINED &#60;&#62; mnMathNumeric_3 [ITM]<br>                                     UNDEFINED &#60;&#62; mnMathNumeric_4 [ITM]<br>                                     UNDEFINED &#60;&#62; mnMathNumeric_5 [ITM]<br>                                     UNDEFINED &#60;&#62; cCharacter_1 [PRTA]<br>                                     UNDEFINED &#60;&#62; cCharacter_2 [PRTA]<br>                                     UNDEFINED &#60;&#62; cCharacter_3 [PRTA]<br>                                     UNDEFINED &#60;&#62; cCharacter_4 [PRTA]<br>                                     UNDEFINED &#60;&#62; cCharacter_5 [PRTA]<br>                                     UNDEFINED &#60;&#62; jdDate_1 [EFFT]<br>                                     UNDEFINED &#60;&#62; jdDate_2 [EFFT]<br>                                     UNDEFINED &#60;&#62; jdDate_3 [EFFT]<br>                                     UNDEFINED &#60;&#62; jdDate_4 [EFFT]<br>                                     UNDEFINED &#60;&#62; jdDate_5 [EFFT]<br>                                     UNDEFINED &#60;&#62; idLongInt_1 [GENLNG]<br>                                     UNDEFINED &#60;&#62; idLongInt_2 [GENLNG]<br>                                     UNDEFINED &#60;&#62; nInteger01 [INT01]<br>                                     UNDEFINED &#60;&#62; nInteger02 [INT01]<br>                                     UNDEFINED &#60;&#62; nInteger03 [INT01]</span></div><span class='comment'><br>                                // Variável para controlar se podemos seguir processando uma validação ou se já</span><span class='comment'><br>                                // falhou ou ainda se já terminou, inicialmente a variável inicia com 1,</span><span class='comment'><br>                                // indicando que até que se prove</span><span class='comment'><br>                                // em contrário que NÃO TEM ERRO</span><br>                                VA evt_Controle1 [A] = "1"<br>                               <div id='3919b2a1-310f-11d2-a2df-006097cecff6:324' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>While VA evt_Controle1 [A] is equal to "1"<div id='3919b2a1-310f-11d2-a2df-006097cecff6:324:hide' style='display: inline;'><span class='comment'><br>                                     //</span><span class='comment'><br>                                     // ****  HUB da cia</span><span class='comment'><br>                                     //</span><span class='comment'><br>                                     // Pega Cash Company da F0012</span><br>                                     VA evt_gdITEM [ITEM] = "ICH"<br>                                     VA evt_gdCOF0012 [CO] = VA evt_Company [CO]<br>                                    <div id='3919b2a1-310f-11d2-a2df-006097cecff6:331' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F0012.FetchSingle  [Index 1: ITEM NUMBER,COMPANY]<div id='3919b2a1-310f-11d2-a2df-006097cecff6:331:hide' style='display: inline;'><br>                                          <span class='iokey'>VA evt_gdITEM [ITEM] = TK Item Number [ITEM]</span><br>                                          <span class='iokey'>VA evt_gdCOF0012 [CO] = TK Company [CO]</span><br>                                          VA evt_gdMCUF0012 [MCU] &#60;- TK Business Unit [MCU]</div><br>                                    <div id='3919b2a1-310f-11d2-a2df-006097cecff6:332' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If SV File_IO_Status is not equal to CO SUCCESS<div id='3919b2a1-310f-11d2-a2df-006097cecff6:332:hide' style='display: inline;'><br>                                          VA evt_gdCOCASHCO [CO] = "00999"</div><br>                                    <div id='3919b2a1-310f-11d2-a2df-006097cecff6:334' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='3919b2a1-310f-11d2-a2df-006097cecff6:334:hide' style='display: inline;'><br>                                          VA evt_gdCOCASHCO [CO] = concat("00", substr([VA evt_gdMCUF0012 [MCU]], "9", "3"))</div><br>                                     End If<span class='comment'><br>                                     //</span><span class='comment'><br>                                     //</span><span class='comment'><br>                                     // Busca o registro do F5509 para o tipo de lote e doctype do registro do F0411</span><span class='comment'><br>                                     // carregado</span><br>                                    <div id='3919b2a1-310f-11d2-a2df-006097cecff6:342' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5509CIA.Select  [Index 1: Chave]<div id='3919b2a1-310f-11d2-a2df-006097cecff6:342:hide' style='display: inline;'><br>                                          <span class='iokey'>BF szBatchType [ICUT] = TK Batch Type [ICUT]</span><br>                                          <span class='iokey'>VA evt_DocType [DCT] = TK Document Type [DCT]</span></div><span class='comment'><br>                                     // Recupera a indicação do algoritmo indicado para avaliar o registro</span><br>                                    <div id='3919b2a1-310f-11d2-a2df-006097cecff6:344' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5509CIA.FetchNext  [Index 1: Chave]<div id='3919b2a1-310f-11d2-a2df-006097cecff6:344:hide' style='display: inline;'><br>                                          VA evt_TipoTeste [A] &#60;- TK Add (Y/N) [A]</div><span class='comment'><br>                                     // Se não encontrou o registro para documento específico</span><br>                                    <div id='3919b2a1-310f-11d2-a2df-006097cecff6:346' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If SV File_IO_Status is not equal to CO SUCCESS<div id='3919b2a1-310f-11d2-a2df-006097cecff6:346:hide' style='display: inline;'><span class='comment'><br>                                          // Procura tipo de lote com documento genérico</span><br>                                          VA evt_DocTemp [DCT] = &#60;Blank&#62;<br>                                         <div id='3919b2a1-310f-11d2-a2df-006097cecff6:349' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5509CIA.Select  [Index 1: Chave]<div id='3919b2a1-310f-11d2-a2df-006097cecff6:349:hide' style='display: inline;'><br>                                               <span class='iokey'>BF szBatchType [ICUT] = TK Batch Type [ICUT]</span><br>                                               <span class='iokey'>VA evt_DocTemp [DCT] = TK Document Type [DCT]</span></div><span class='comment'><br>                                          // Recupera a indicação do algoritmo indicado para avaliar o registro</span><br>                                         <div id='3919b2a1-310f-11d2-a2df-006097cecff6:351' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5509CIA.FetchNext  [Index 1: Chave]<div id='3919b2a1-310f-11d2-a2df-006097cecff6:351:hide' style='display: inline;'><br>                                               VA evt_TipoTeste [A] &#60;- TK Add (Y/N) [A]</div><span class='comment'><br>                                          // Se não encontrou o registro para documento genérico</span><br>                                         <div id='3919b2a1-310f-11d2-a2df-006097cecff6:353' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If SV File_IO_Status is not equal to CO SUCCESS<div id='3919b2a1-310f-11d2-a2df-006097cecff6:353:hide' style='display: inline;'><span class='comment'><br>                                               // Erro -2: Não encontrou forma de validação cadastrada para este tipo de</span><span class='comment'><br>                                               // lote/documento</span><br>                                               BF mnNumberofAxle [AXLE] = "-2"<br>                                               VA evt_Controle1 [A] = "0"</div><br>                                          End If</div><br>                                     End If<span class='comment'><br>                                     // Se não houve erro, processa a validação do registro</span><br>                                    <div id='3919b2a1-310f-11d2-a2df-006097cecff6:361' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_Controle1 [A] is equal to "1"<div id='3919b2a1-310f-11d2-a2df-006097cecff6:361:hide' style='display: inline;'><span class='comment'><br>                                          // Verifica se validará:</span><span class='comment'><br>                                          // 1- Com Intercompany</span><span class='comment'><br>                                          // 0 - Sem Intercompany</span><br>                                         <div id='3919b2a1-310f-11d2-a2df-006097cecff6:365' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_TipoTeste [A] is equal to "1"<div id='3919b2a1-310f-11d2-a2df-006097cecff6:365:hide' style='display: inline;'><span class='comment'><br>                                               // 1 - Com Intercompany</span><span class='comment'><br>                                               // Procura o Bank Account no Plano de Contas</span><br>                                              <div id='3919b2a1-310f-11d2-a2df-006097cecff6:368' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F0901.Select  [Index 3: Account Id]<div id='3919b2a1-310f-11d2-a2df-006097cecff6:368:hide' style='display: inline;'><br>                                                    <span class='iokey'>VA evt_ContaBanco [GLBA] = TK Account ID [AID]</span></div><span class='comment'><br>                                               // Carrega a companhia</span><br>                                              <div id='3919b2a1-310f-11d2-a2df-006097cecff6:370' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F0901.FetchNext  [Index 3: Account Id]<div id='3919b2a1-310f-11d2-a2df-006097cecff6:370:hide' style='display: inline;'><br>                                                    VA evt_CompanyGL [CO] &#60;- TK Company [CO]</div><span class='comment'><br>                                               // Se não encontrou o bank account</span><br>                                              <div id='3919b2a1-310f-11d2-a2df-006097cecff6:372' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If SV File_IO_Status is not equal to CO SUCCESS<div id='3919b2a1-310f-11d2-a2df-006097cecff6:372:hide' style='display: inline;'><span class='comment'><br>                                                    // Erro -3: Não encontrou Bank Account em um lançamento de liquidação</span><br>                                                    BF mnNumberofAxle [AXLE] = "-3"<br>                                                    VA evt_Controle1 [A] = "0"</div><br>                                              <div id='3919b2a1-310f-11d2-a2df-006097cecff6:376' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='3919b2a1-310f-11d2-a2df-006097cecff6:376:hide' style='display: inline;'><br>                                                   <div id='3919b2a1-310f-11d2-a2df-006097cecff6:377' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_Company [CO] is not equal to VA evt_CompanyGL [CO]<br>                                                    And VA evt_Company [CO] is not equal to VA evt_gdCOCASHCO [CO]<br>                                                    And VA evt_CompanyGL [CO] is not equal to VA evt_gdCOCASHCO [CO]<div id='3919b2a1-310f-11d2-a2df-006097cecff6:377:hide' style='display: inline;'><span class='comment'><br>                                                         // Erro -4: Lançamento Intercompany de liquidação que não está sendo feito contr</span><span class='comment'><br>                                                         // a 53</span><br>                                                         BF mnNumberofAxle [AXLE] = "-4"<br>                                                         VA evt_Controle1 [A] = "0"</div><br>                                                    End If</div><br>                                               End If</div><br>                                         <div id='3919b2a1-310f-11d2-a2df-006097cecff6:384' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='3919b2a1-310f-11d2-a2df-006097cecff6:384:hide' style='display: inline;'><span class='comment'><br>                                               // 0 - Sem Intercompany</span><span class='comment'><br>                                               // Procura o Bank Account no Plano de Contas</span><br>                                              <div id='3919b2a1-310f-11d2-a2df-006097cecff6:387' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F0901.Select  [Index 3: Account Id]<div id='3919b2a1-310f-11d2-a2df-006097cecff6:387:hide' style='display: inline;'><br>                                                    <span class='iokey'>VA evt_ContaBanco [GLBA] = TK Account ID [AID]</span></div><span class='comment'><br>                                               // Carrega a companhia</span><br>                                              <div id='3919b2a1-310f-11d2-a2df-006097cecff6:389' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F0901.FetchNext  [Index 3: Account Id]<div id='3919b2a1-310f-11d2-a2df-006097cecff6:389:hide' style='display: inline;'><br>                                                    VA evt_CompanyGL [CO] &#60;- TK Company [CO]</div><span class='comment'><br>                                               // Se não encontrou o bank account</span><br>                                              <div id='3919b2a1-310f-11d2-a2df-006097cecff6:391' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If SV File_IO_Status is not equal to CO SUCCESS<div id='3919b2a1-310f-11d2-a2df-006097cecff6:391:hide' style='display: inline;'><span class='comment'><br>                                                    // Erro -3: Não encontrou Bank Account em um lançamento de liquidação</span><br>                                                    BF mnNumberofAxle [AXLE] = "-3"<br>                                                    VA evt_Controle1 [A] = "0"</div><br>                                              <div id='3919b2a1-310f-11d2-a2df-006097cecff6:395' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='3919b2a1-310f-11d2-a2df-006097cecff6:395:hide' style='display: inline;'><br>                                                   <div id='3919b2a1-310f-11d2-a2df-006097cecff6:396' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_Company [CO] is not equal to VA evt_CompanyGL [CO]<div id='3919b2a1-310f-11d2-a2df-006097cecff6:396:hide' style='display: inline;'><span class='comment'><br>                                                         // Erro -9: Lançamento de liquidação que não pode ter intercompany</span><br>                                                         BF mnNumberofAxle [AXLE] = "-9"<br>                                                         VA evt_Controle1 [A] = "0"</div><br>                                                    End If</div><br>                                               End If</div><br>                                          End If</div><br>                                     End If<span class='comment'><br>                                     // Se não houve erro</span><br>                                    <div id='3919b2a1-310f-11d2-a2df-006097cecff6:405' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_Controle1 [A] is equal to "1"<div id='3919b2a1-310f-11d2-a2df-006097cecff6:405:hide' style='display: inline;'><span class='comment'><br>                                          // Procura a próxima linha de  Documento</span><br>                                         <div id='3919b2a1-310f-11d2-a2df-006097cecff6:407' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F03B13.FetchNext  [Index 1: Payment ID]<div id='3919b2a1-310f-11d2-a2df-006097cecff6:407:hide' style='display: inline;'><br>                                               VA evt_Company [CO] &#60;- TK Company [CO]<br>                                               VA evt_ContaBanco [GLBA] &#60;- TK G/L Bank Account [GLBA]<br>                                               VA evt_DocNum [DOC] &#60;- TK Document Number - JE [DOCG]<br>                                               VA evt_DocType [DCT] &#60;- TK Document Type - JE [DCTG]</div><br>                                         <div id='3919b2a1-310f-11d2-a2df-006097cecff6:408' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If SV File_IO_Status is not equal to CO SUCCESS<div id='3919b2a1-310f-11d2-a2df-006097cecff6:408:hide' style='display: inline;'><br>                                               VA evt_Controle1 [A] = "0"</div><br>                                          End If</div><br>                                     End If</div><br>                                End While</div><br>                           End If</div><br>                      End If</div><br>                 End If<br>                <div id='3919b2a1-310f-11d2-a2df-006097cecff6:416' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_SYS [SY] is equal to "04"<div id='3919b2a1-310f-11d2-a2df-006097cecff6:416:hide' style='display: inline;'><br>                     <div id='3919b2a1-310f-11d2-a2df-006097cecff6:417' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F0411.Close<div id='3919b2a1-310f-11d2-a2df-006097cecff6:417:hide' style='display: inline;'><br>                           </div><br>                     <div id='3919b2a1-310f-11d2-a2df-006097cecff6:418' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F0413.Close<div id='3919b2a1-310f-11d2-a2df-006097cecff6:418:hide' style='display: inline;'><br>                           </div><br>                     <div id='3919b2a1-310f-11d2-a2df-006097cecff6:419' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F0414.Close<div id='3919b2a1-310f-11d2-a2df-006097cecff6:419:hide' style='display: inline;'><br>                           </div></div><br>                <div id='3919b2a1-310f-11d2-a2df-006097cecff6:420' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='3919b2a1-310f-11d2-a2df-006097cecff6:420:hide' style='display: inline;'><br>                     <div id='3919b2a1-310f-11d2-a2df-006097cecff6:421' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F0311.Close<div id='3919b2a1-310f-11d2-a2df-006097cecff6:421:hide' style='display: inline;'><br>                           </div><br>                     <div id='3919b2a1-310f-11d2-a2df-006097cecff6:422' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F03B13.Close<div id='3919b2a1-310f-11d2-a2df-006097cecff6:422:hide' style='display: inline;'><br>                           </div></div><br>                 End If<br>                <div id='3919b2a1-310f-11d2-a2df-006097cecff6:424' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F0901.Close<div id='3919b2a1-310f-11d2-a2df-006097cecff6:424:hide' style='display: inline;'><br>                      </div><br>                <div id='3919b2a1-310f-11d2-a2df-006097cecff6:425' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F0911.Close<div id='3919b2a1-310f-11d2-a2df-006097cecff6:425:hide' style='display: inline;'><br>                      </div></div><br>            End If<br>           <div id='3919b2a1-310f-11d2-a2df-006097cecff6:427' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_SYS [SY] is equal to "09"<div id='3919b2a1-310f-11d2-a2df-006097cecff6:427:hide' style='display: inline;'><br>                <div id='3919b2a1-310f-11d2-a2df-006097cecff6:428' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_AdditionFlag [A] is equal to "X"<div id='3919b2a1-310f-11d2-a2df-006097cecff6:428:hide' style='display: inline;'></div><br>                <div id='3919b2a1-310f-11d2-a2df-006097cecff6:429' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='3919b2a1-310f-11d2-a2df-006097cecff6:429:hide' style='display: inline;'><span class='comment'><br>                      //</span><span class='comment'><br>                      // Validação da Contabilidade</span><span class='comment'><br>                      //</span><br>                     <div id='3919b2a1-310f-11d2-a2df-006097cecff6:433' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F0911.Open<div id='3919b2a1-310f-11d2-a2df-006097cecff6:433:hide' style='display: inline;'><br>                           </div><span class='comment'><br>                      // Encontrar o primeiro registro do lote no F0911</span><br>                     <div id='3919b2a1-310f-11d2-a2df-006097cecff6:435' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F0911.Select  [Index 1: Doc Type, Number, +]<div id='3919b2a1-310f-11d2-a2df-006097cecff6:435:hide' style='display: inline;'><br>                           <span class='iokey'>BF mnBatchNumber [ICU] = TK Batch Number [ICU]</span><br>                           <span class='iokey'>BF szBatchType [ICUT] = TK Batch Type [ICUT]</span></div><span class='comment'><br>                      // Acha a regra de validação do registro</span><span class='comment'><br>                      // Variável para controlar se podemos seguir processando uma validação ou se já</span><span class='comment'><br>                      // falhou ou ainda se já terminou, inicialmente a variável inicia com 1,</span><span class='comment'><br>                      // indicando que até que se prove</span><span class='comment'><br>                      // em contrário que NÃO TEM ERRO</span><br>                      VA evt_Controle1 [A] = "1"<span class='comment'><br>                      // carregado</span><br>                      VA evt_DocTemp [DCT] = &#60;Blank&#62;<br>                      VA evt_DocTempNum [DOC] = "0"<span class='comment'><br>                      // --------------------------------------------------------------</span><span class='comment'><br>                      // ISSUE 7759 - BUG - guarda campo LT (livro)</span><br>                     <div id='3919b2a1-310f-11d2-a2df-006097cecff6:448' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F0911.FetchNext  [Index 1: Doc Type, Number, +]<div id='3919b2a1-310f-11d2-a2df-006097cecff6:448:hide' style='display: inline;'><br>                           VA evt_DocTemp [DCT] &#60;- TK Document Type [DCT]<br>                           VA evt_DocTempNum [DOC] &#60;- TK Document (Voucher, Invoice, etc.) [DOC]<br>                           VA evt_Company [CO] &#60;- TK Company [CO]<br>                           VA evt_LedgerTypeF0911 [LT] &#60;- TK Ledger Types [LT]<br>                           VA evt_ValCompany [AA] &#60;- TK Amount [AA]</div><span class='comment'><br>                      // --------------------------------------------------------------</span><span class='comment'><br>                      // Enquanto não terminar a varredura do lote selecionado</span><br>                     <div id='3919b2a1-310f-11d2-a2df-006097cecff6:451' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>While SV File_IO_Status is equal to CO SUCCESS<br>                      And BF mnNumberofAxle [AXLE] is equal to "0"<div id='3919b2a1-310f-11d2-a2df-006097cecff6:451:hide' style='display: inline;'><br>                           VA evt_CompanyCalc [CO] = VA evt_Company [CO]<br>                           VA evt_TotComp53 [AA] = 0<br>                           VA evt_TotCompanies [AA] = 0<br>                           VA evt_DocType [DCT] = VA evt_DocTemp [DCT]<br>                           VA evt_DocNum [DOC] = VA evt_DocTempNum [DOC]<br>                           VA evt_Tem53 [A] = "0"<span class='comment'><br>                           // Busca o registro do F5509 para o tipo de lote e doctype do registro do F0911</span><br>                          <div id='3919b2a1-310f-11d2-a2df-006097cecff6:459' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5509CIA.Select  [Index 1: Chave]<div id='3919b2a1-310f-11d2-a2df-006097cecff6:459:hide' style='display: inline;'><br>                                <span class='iokey'>BF szBatchType [ICUT] = TK Batch Type [ICUT]</span><br>                                <span class='iokey'>VA evt_DocTemp [DCT] = TK Document Type [DCT]</span></div><span class='comment'><br>                           // Recupera a indicação do algoritmo indicado para avaliar o registro</span><br>                          <div id='3919b2a1-310f-11d2-a2df-006097cecff6:461' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5509CIA.FetchNext  [Index 1: Chave]<div id='3919b2a1-310f-11d2-a2df-006097cecff6:461:hide' style='display: inline;'><br>                                VA evt_TipoTeste [A] &#60;- TK Add (Y/N) [A]</div><br>                          <div id='3919b2a1-310f-11d2-a2df-006097cecff6:462' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If SV File_IO_Status is not equal to CO SUCCESS<div id='3919b2a1-310f-11d2-a2df-006097cecff6:462:hide' style='display: inline;'><span class='comment'><br>                                // --------------------------------------------------------------</span><span class='comment'><br>                                // ISSUE 7759 - BUG - Pesquisa SETUP para TODOS dctos</span><br>                                VA evt_SEMDocumentType_DCT [DCT] = "  "<br>                               <div id='3919b2a1-310f-11d2-a2df-006097cecff6:467' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5509CIA.Select  [Index 1: Chave]<div id='3919b2a1-310f-11d2-a2df-006097cecff6:467:hide' style='display: inline;'><br>                                     <span class='iokey'>BF szBatchType [ICUT] = TK Batch Type [ICUT]</span><br>                                     <span class='iokey'>VA evt_SEMDocumentType_DCT [DCT] &#62;= TK Document Type [DCT]</span></div><span class='comment'><br>                                // --------------------------------------------------------------</span><br>                               <div id='3919b2a1-310f-11d2-a2df-006097cecff6:469' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5509CIA.FetchNext  [Index 1: Chave]<div id='3919b2a1-310f-11d2-a2df-006097cecff6:469:hide' style='display: inline;'><br>                                     VA evt_TipoTeste [A] &#60;- TK Add (Y/N) [A]</div><span class='comment'><br>                                // --------------------------------------------------------------</span><span class='comment'><br>                                // ISSUE 7759 - BUG - Permite Intercompany  qdo.não consta no SETUP</span><br>                               <div id='3919b2a1-310f-11d2-a2df-006097cecff6:472' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If SV File_IO_Status is not equal to CO SUCCESS<div id='3919b2a1-310f-11d2-a2df-006097cecff6:472:hide' style='display: inline;'><br>                                     VA evt_TipoTeste [A] = "1"</div><br>                                End If<span class='comment'><br>                                // --------------------------------------------------------------</span></div><br>                           End If<span class='comment'><br>                           // qdo. não existe SETUP, também deve verificar intercompany</span><span class='comment'><br>                           // com mais de 1 cia diferente da 53</span><span class='comment'><br>                           //</span><span class='comment'><br>                           // Enquanto mesmo dcto</span><br>                          <div id='3919b2a1-310f-11d2-a2df-006097cecff6:481' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>While VA evt_DocType [DCT] is equal to VA evt_DocTemp [DCT]<br>                           And SV File_IO_Status is equal to CO SUCCESS<br>                           And VA evt_DocNum [DOC] is equal to VA evt_DocTempNum [DOC]<div id='3919b2a1-310f-11d2-a2df-006097cecff6:481:hide' style='display: inline;'><span class='comment'><br>                                // --------------------------------------------------------------</span><br>                                VA evt_TotCompTemp [AA] = 0<br>                                VA evt_CompBase [CO] = VA evt_Company [CO]<span class='comment'><br>                                // Enquanto for o mesmo documento pivot</span><span class='comment'><br>                                // --------------------------------------------------------------</span><span class='comment'><br>                                // ISSUE 7759 - BUG - inicializa Flag tem lçto Livro AA</span><br>                                VA evt_TemLivroAA_EV01 [EV01] = "N"<span class='comment'><br>                                // --------------------------------------------------------------</span><span class='comment'><br>                                // Enquanto mesma cia</span><br>                               <div id='3919b2a1-310f-11d2-a2df-006097cecff6:491' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>While VA evt_DocType [DCT] is equal to VA evt_DocTemp [DCT]<br>                                And SV File_IO_Status is equal to CO SUCCESS<br>                                And VA evt_DocNum [DOC] is equal to VA evt_DocTempNum [DOC]<br>                                And VA evt_CompBase [CO] is equal to VA evt_Company [CO]<div id='3919b2a1-310f-11d2-a2df-006097cecff6:491:hide' style='display: inline;'><span class='comment'><br>                                     // --------------------------------------------------------------</span><span class='comment'><br>                                     // ISSUE 7759 - BUG - liga Flag se tiver algum lçto c/livro = AA</span><br>                                    <div id='3919b2a1-310f-11d2-a2df-006097cecff6:494' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_LedgerTypeF0911 [LT] is equal to "AA"<div id='3919b2a1-310f-11d2-a2df-006097cecff6:494:hide' style='display: inline;'><br>                                          VA evt_TemLivroAA_EV01 [EV01] = "S"</div><br>                                     End If<span class='comment'><br>                                     // --------------------------------------------------------------</span><br>                                     VA evt_TotCompTemp [AA] = [VA evt_TotCompTemp [AA]]+[VA evt_ValCompany [AA]]<br>                                    <div id='3919b2a1-310f-11d2-a2df-006097cecff6:499' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_Company [CO] is equal to VA evt_gdCOCASHCO [CO]<div id='3919b2a1-310f-11d2-a2df-006097cecff6:499:hide' style='display: inline;'><br>                                          VA evt_TotComp53 [AA] = [VA evt_TotComp53 [AA]]+[VA evt_ValCompany [AA]]</div><br>                                    <div id='3919b2a1-310f-11d2-a2df-006097cecff6:501' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='3919b2a1-310f-11d2-a2df-006097cecff6:501:hide' style='display: inline;'><br>                                          VA evt_TotCompanies [AA] = [VA evt_TotCompanies [AA]]+[VA evt_ValCompany [AA]]</div><br>                                     End If<span class='comment'><br>                                     // Próximo registro do lote</span><span class='comment'><br>                                     // --------------------------------------------------------------</span><span class='comment'><br>                                     // ISSUE 7759 - BUG - guarda campo LT (livro)</span><br>                                    <div id='3919b2a1-310f-11d2-a2df-006097cecff6:508' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F0911.FetchNext  [Index 1: Doc Type, Number, +]<div id='3919b2a1-310f-11d2-a2df-006097cecff6:508:hide' style='display: inline;'><br>                                          VA evt_DocTemp [DCT] &#60;- TK Document Type [DCT]<br>                                          VA evt_DocTempNum [DOC] &#60;- TK Document (Voucher, Invoice, etc.) [DOC]<br>                                          VA evt_Company [CO] &#60;- TK Company [CO]<br>                                          VA evt_LedgerTypeF0911 [LT] &#60;- TK Ledger Types [LT]<br>                                          VA evt_ValCompany [AA] &#60;- TK Amount [AA]</div><span class='comment'><br>                                     // --------------------------------------------------------------</span></div><br>                                End While<span class='comment'><br>                                // ============= 8249 - BUG - Marília - IF com variável errada</span><br>                               <div id='3919b2a1-310f-11d2-a2df-006097cecff6:515' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_TotComp53 [AA] is not equal to "0"<div id='3919b2a1-310f-11d2-a2df-006097cecff6:515:hide' style='display: inline;'><br>                                     VA evt_Tem53 [A] = "1"</div><br>                                End If<span class='comment'><br>                                // ============= 8249 - BUG - Marília - IF com variável errada</span></div><br>                           End While<span class='comment'><br>                           // Valida a regra segundo os critérios acima especificados</span><br>                          <div id='3919b2a1-310f-11d2-a2df-006097cecff6:521' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_TipoTeste [A] is equal to "1"<div id='3919b2a1-310f-11d2-a2df-006097cecff6:521:hide' style='display: inline;'><span class='comment'><br>                                // 1 - Com Intercompany</span><br>                                VA evt_TotComp53 [AA] = -1*[VA evt_TotComp53 [AA]]<br>                               <div id='3919b2a1-310f-11d2-a2df-006097cecff6:524' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_Tem53 [A] is equal to "1"<br>                                And VA evt_TotComp53 [AA] is not equal to VA evt_TotCompanies [AA]<div id='3919b2a1-310f-11d2-a2df-006097cecff6:524:hide' style='display: inline;'><span class='comment'><br>                                     // Erro -8: Intercompany com mais de uma companhia diferente da 53</span><br>                                     BF mnNumberofAxle [AXLE] = "-8"</div><br>                                End If</div><br>                          <div id='3919b2a1-310f-11d2-a2df-006097cecff6:528' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='3919b2a1-310f-11d2-a2df-006097cecff6:528:hide' style='display: inline;'><span class='comment'><br>                                // --------------------------------------------------------------</span><span class='comment'><br>                                // ISSUE 7759 - BUG - Não permitir Intercompany qdo. livro AA em dcto JE do SETU</span><br>                               <div id='3919b2a1-310f-11d2-a2df-006097cecff6:531' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_DocTemp [DCT] is equal to "JE"<div id='3919b2a1-310f-11d2-a2df-006097cecff6:531:hide' style='display: inline;'><br>                                    <div id='3919b2a1-310f-11d2-a2df-006097cecff6:532' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_TemLivroAA_EV01 [EV01] is equal to "S"<div id='3919b2a1-310f-11d2-a2df-006097cecff6:532:hide' style='display: inline;'><span class='comment'><br>                                          // 0 - Sem Intercompany</span><br>                                         <div id='3919b2a1-310f-11d2-a2df-006097cecff6:534' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_Tem53 [A] is equal to "1"<div id='3919b2a1-310f-11d2-a2df-006097cecff6:534:hide' style='display: inline;'><span class='comment'><br>                                               // Erro -9: Intercompany em documento que não admite intercompany</span><br>                                               BF mnNumberofAxle [AXLE] = "-9"</div><br>                                          End If</div><br>                                     End If</div><br>                               <div id='3919b2a1-310f-11d2-a2df-006097cecff6:539' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='3919b2a1-310f-11d2-a2df-006097cecff6:539:hide' style='display: inline;'><span class='comment'><br>                                     // --------------------------------------------------------------</span><span class='comment'><br>                                     // 0 - Sem Intercompany</span><br>                                    <div id='3919b2a1-310f-11d2-a2df-006097cecff6:542' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_Tem53 [A] is equal to "1"<div id='3919b2a1-310f-11d2-a2df-006097cecff6:542:hide' style='display: inline;'><span class='comment'><br>                                          // Erro -9: Intercompany em documento que não admite intercompany</span><br>                                          BF mnNumberofAxle [AXLE] = "-9"</div><br>                                     End If</div><br>                                End If</div><br>                           End If</div><br>                      End While</div><br>                 End If<br>                <div id='3919b2a1-310f-11d2-a2df-006097cecff6:550' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F0911.Close<div id='3919b2a1-310f-11d2-a2df-006097cecff6:550:hide' style='display: inline;'><br>                      </div></div><br>            End If<span class='comment'><br>            // Validação para não permitir em lotes contábeis determinados DCT-OBJ e SUB</span><br>           <div id='3919b2a1-310f-11d2-a2df-006097cecff6:553' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_SYS [SY] is equal to "09"<br>            And BF mnNumberofAxle [AXLE] is equal to "0"<div id='3919b2a1-310f-11d2-a2df-006097cecff6:553:hide' style='display: inline;'><br>                 VA evt_AdditionFlag [A] = "X"<br>                <div id='3919b2a1-310f-11d2-a2df-006097cecff6:555' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5509CIA.Select  [Index 1: Chave]<div id='3919b2a1-310f-11d2-a2df-006097cecff6:555:hide' style='display: inline;'><br>                      <span class='iokey'>BF szBatchType [ICUT] = TK Batch Type [ICUT]</span><br>                      <span class='iokey'>VA evt_AdditionFlag [A] = TK Add (Y/N) [A]</span></div><br>                <div id='3919b2a1-310f-11d2-a2df-006097cecff6:556' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5509CIA.FetchNext  [Index 1: Chave]<div id='3919b2a1-310f-11d2-a2df-006097cecff6:556:hide' style='display: inline;'><br>                      VA evt_DocumentType [DCT] &#60;- TK Document Type [DCT]<br>                      VA evt_ObjectAccountIni [OBJ] &#60;- TK Object Account [OBJ]<br>                      VA evt_ObjectAccountFim [OBJ] &#60;- TK Depreciation Expense - Object [XOBJ]<br>                      VA evt_SubsidiaryIni [SUB] &#60;- TK Subsidiary [SUB]<br>                      VA evt_SubsidiaryFim [SUB] &#60;- TK Depreciation Expense - Subsidiary [XSUB]</div><br>                <div id='3919b2a1-310f-11d2-a2df-006097cecff6:557' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>While SV File_IO_Status is equal to CO SUCCESS<br>                 And BF mnNumberofAxle [AXLE] is equal to "0"<div id='3919b2a1-310f-11d2-a2df-006097cecff6:557:hide' style='display: inline;'><br>                     <div id='3919b2a1-310f-11d2-a2df-006097cecff6:558' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_DocumentType [DCT] is not equal to &#60;Blank&#62;<br>                      And VA evt_DocumentType [DCT] is not equal to &#60;NULL&#62;<div id='3919b2a1-310f-11d2-a2df-006097cecff6:558:hide' style='display: inline;'><br>                          <div id='3919b2a1-310f-11d2-a2df-006097cecff6:559' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_ObjectAccountIni [OBJ] is not equal to &#60;Blank&#62;<br>                           And VA evt_ObjectAccountIni [OBJ] is not equal to &#60;NULL&#62;<br>                           And VA evt_ObjectAccountFim [OBJ] is not equal to &#60;Blank&#62;<br>                           And VA evt_ObjectAccountFim [OBJ] is not equal to &#60;NULL&#62;<div id='3919b2a1-310f-11d2-a2df-006097cecff6:559:hide' style='display: inline;'><br>                                VA evt_LedgerTypeF0911 [LT] = "A%"<br>                               <div id='3919b2a1-310f-11d2-a2df-006097cecff6:561' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F0911.Select  [Index 1: Doc Type, Number, +]<div id='3919b2a1-310f-11d2-a2df-006097cecff6:561:hide' style='display: inline;'><br>                                     <span class='iokey'>BF mnBatchNumber [ICU] = TK Batch Number [ICU]</span><br>                                     <span class='iokey'>BF szBatchType [ICUT] = TK Batch Type [ICUT]</span><br>                                     <span class='iokey'>VA evt_LedgerTypeF0911 [LT] Is Like TK Ledger Types [LT]</span></div><br>                               <div id='3919b2a1-310f-11d2-a2df-006097cecff6:562' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F0911.FetchNext  [Index 1: Doc Type, Number, +]<div id='3919b2a1-310f-11d2-a2df-006097cecff6:562:hide' style='display: inline;'><br>                                     VA evt_DocTemp [DCT] &#60;- TK Document Type [DCT]<br>                                     VA evt_ObjectAccountF0911 [OBJ] &#60;- TK Object Account [OBJ]<br>                                     VA evt_SubsidiaryF0911 [SUB] &#60;- TK Subsidiary [SUB]<br>                                     VA evt_LedgerTypeF0911 [LT] &#60;- TK Ledger Types [LT]</div><br>                               <div id='3919b2a1-310f-11d2-a2df-006097cecff6:563' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>While SV File_IO_Status is equal to CO SUCCESS<br>                                And BF mnNumberofAxle [AXLE] is equal to "0"<div id='3919b2a1-310f-11d2-a2df-006097cecff6:563:hide' style='display: inline;'><br>                                    <div id='3919b2a1-310f-11d2-a2df-006097cecff6:564' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_LedgerTypeF0911 [LT] is equal to ("AA","AR")<div id='3919b2a1-310f-11d2-a2df-006097cecff6:564:hide' style='display: inline;'><br>                                         <div id='3919b2a1-310f-11d2-a2df-006097cecff6:565' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_DocumentType [DCT] is equal to VA evt_DocTemp [DCT]<br>                                          And VA evt_ObjectAccountF0911 [OBJ] is greater than or equal to VA evt_ObjectAccountIni [OBJ]<br>                                          And VA evt_ObjectAccountF0911 [OBJ] is less than or equal to VA evt_ObjectAccountFim [OBJ]<div id='3919b2a1-310f-11d2-a2df-006097cecff6:565:hide' style='display: inline;'><br>                                              <div id='3919b2a1-310f-11d2-a2df-006097cecff6:566' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_SubsidiaryIni [SUB] is not equal to &#60;Blank&#62;<br>                                               And VA evt_SubsidiaryIni [SUB] is not equal to &#60;NULL&#62;<br>                                               And VA evt_SubsidiaryFim [SUB] is not equal to &#60;Blank&#62;<br>                                               And VA evt_SubsidiaryFim [SUB] is not equal to &#60;NULL&#62;<div id='3919b2a1-310f-11d2-a2df-006097cecff6:566:hide' style='display: inline;'><br>                                                   <div id='3919b2a1-310f-11d2-a2df-006097cecff6:567' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_SubsidiaryF0911 [SUB] is greater than or equal to VA evt_SubsidiaryIni [SUB]<br>                                                    And VA evt_SubsidiaryF0911 [SUB] is less than or equal to VA evt_SubsidiaryFim [SUB]<div id='3919b2a1-310f-11d2-a2df-006097cecff6:567:hide' style='display: inline;'><span class='comment'><br>                                                         // Erro - x - Lote possui dct-obj e sub não permite</span><br>                                                         BF mnNumberofAxle [AXLE] = "-1"</div><br>                                                    End If</div><br>                                              <div id='3919b2a1-310f-11d2-a2df-006097cecff6:571' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='3919b2a1-310f-11d2-a2df-006097cecff6:571:hide' style='display: inline;'><span class='comment'><br>                                                    // Erro - x - Lote possui dct-obj  não permite</span><br>                                                    BF mnNumberofAxle [AXLE] = "-1"</div><br>                                               End If</div><br>                                          End If</div><br>                                     End If<br>                                    <div id='3919b2a1-310f-11d2-a2df-006097cecff6:577' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F0911.FetchNext  [Index 1: Doc Type, Number, +]<div id='3919b2a1-310f-11d2-a2df-006097cecff6:577:hide' style='display: inline;'><br>                                          VA evt_DocTemp [DCT] &#60;- TK Document Type [DCT]<br>                                          VA evt_ObjectAccountF0911 [OBJ] &#60;- TK Object Account [OBJ]<br>                                          VA evt_SubsidiaryF0911 [SUB] &#60;- TK Subsidiary [SUB]<br>                                          VA evt_LedgerTypeF0911 [LT] &#60;- TK Ledger Types [LT]</div></div><br>                                End While</div><br>                           End If</div><br>                      End If<br>                     <div id='3919b2a1-310f-11d2-a2df-006097cecff6:581' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5509CIA.FetchNext  [Index 1: Chave]<div id='3919b2a1-310f-11d2-a2df-006097cecff6:581:hide' style='display: inline;'><br>                           VA evt_DocumentType [DCT] &#60;- TK Document Type [DCT]<br>                           VA evt_ObjectAccountIni [OBJ] &#60;- TK Object Account [OBJ]<br>                           VA evt_ObjectAccountFim [OBJ] &#60;- TK Depreciation Expense - Object [XOBJ]<br>                           VA evt_SubsidiaryIni [SUB] &#60;- TK Subsidiary [SUB]<br>                           VA evt_SubsidiaryFim [SUB] &#60;- TK Depreciation Expense - Subsidiary [XSUB]</div></div><br>                 End While</div><br>            End If<span class='comment'><br>            // Validação para não permitir em lotes contábeis Valores fora do Limite</span><br>           <div id='3919b2a1-310f-11d2-a2df-006097cecff6:585' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_SYS [SY] is equal to "09"<br>            And BF mnNumberofAxle [AXLE] is equal to "0"<div id='3919b2a1-310f-11d2-a2df-006097cecff6:585:hide' style='display: inline;'><span class='comment'><br>                 // Verifica se o usuário tem alçada para aprovar o lote</span><br>                 VA evt_udc_55 [SY] = "55"<br>                 VA evt_udc_AC [RT] = "AC"<br>                <div id='3919b2a1-310f-11d2-a2df-006097cecff6:589' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F0005.FetchSingle  [Index 1: System, Type, Code]<div id='3919b2a1-310f-11d2-a2df-006097cecff6:589:hide' style='display: inline;'><br>                      <span class='iokey'>VA evt_udc_55 [SY] = TK Product Code [SY]</span><br>                      <span class='iokey'>VA evt_udc_AC [RT] = TK User Defined Codes [RT]</span><br>                      <span class='iokey'>SL UserID = TK User Defined Code [KY]</span><br>                      VA evt_udc_SPHD [SPHD] &#60;- TK Special Handling Code - User Def Codes [SPHD]</div><br>                <div id='3919b2a1-310f-11d2-a2df-006097cecff6:590' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If SV File_IO_Status is equal to CO SUCCESS<div id='3919b2a1-310f-11d2-a2df-006097cecff6:590:hide' style='display: inline;'><br>                     <div id='3919b2a1-310f-11d2-a2df-006097cecff6:591' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>ConvertStringToMathNumeric(B0000580.ConvertStringToMathNumeric)<div id='3919b2a1-310f-11d2-a2df-006097cecff6:591:hide' style='display: inline;'><span class='parameters'><br>                           VA evt_udc_SPHD [SPHD] -&#62; szInputString [AA15]<br>                           VA evt_ValorAprovador [AA] &#60;- mnOutputMathNumeric [MATH01]<br>                           VA evt_Controle1 [A] &#60;- cReturnedErrorCode [ERR]</span></div><br>                      VA evt_ValorAprovador [AA] = abs([VA evt_ValorAprovador [AA]])</div><br>                <div id='3919b2a1-310f-11d2-a2df-006097cecff6:593' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='3919b2a1-310f-11d2-a2df-006097cecff6:593:hide' style='display: inline;'><span class='comment'><br>                      // O Usuário não é um Aprovador</span><br>                      VA evt_ValorAprovador [AA] = "0"</div><br>                 End If<span class='comment'><br>                 // Verifica se deve validar os Valores dos Lançamentos (AdditionFlag=W)</span><br>                 VA evt_AdditionFlag [A] = "W"<br>                <div id='3919b2a1-310f-11d2-a2df-006097cecff6:599' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5509CIA.Select  [Index 1: Chave]<div id='3919b2a1-310f-11d2-a2df-006097cecff6:599:hide' style='display: inline;'><br>                      <span class='iokey'>BF szBatchType [ICUT] = TK Batch Type [ICUT]</span><br>                      <span class='iokey'>VA evt_AdditionFlag [A] = TK Add (Y/N) [A]</span></div><br>                <div id='3919b2a1-310f-11d2-a2df-006097cecff6:600' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5509CIA.FetchNext  [Index 1: Chave]<div id='3919b2a1-310f-11d2-a2df-006097cecff6:600:hide' style='display: inline;'><br>                      VA evt_DocumentType [DCT] &#60;- TK Document Type [DCT]<br>                      VA evt_ObjectAccountIni [OBJ] &#60;- TK Object Account [OBJ]<br>                      VA evt_ObjectAccountFim [OBJ] &#60;- TK Depreciation Expense - Object [XOBJ]<br>                      VA evt_SubsidiaryIni [SUB] &#60;- TK Subsidiary [SUB]<br>                      VA evt_SubsidiaryFim [SUB] &#60;- TK Depreciation Expense - Subsidiary [XSUB]<br>                      VA evt_ValorLimite [AA] &#60;- TK Amount [AA]</div><br>                <div id='3919b2a1-310f-11d2-a2df-006097cecff6:601' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>While SV File_IO_Status is equal to CO SUCCESS<br>                 And BF mnNumberofAxle [AXLE] is equal to "0"<div id='3919b2a1-310f-11d2-a2df-006097cecff6:601:hide' style='display: inline;'><br>                      VA evt_ValorLimite [AA] = abs([VA evt_ValorLimite [AA]])<br>                      VA evt_LedgerTypeF0911 [LT] = "A%"<br>                     <div id='3919b2a1-310f-11d2-a2df-006097cecff6:604' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F0911.Select  [Index 1: Doc Type, Number, +]<div id='3919b2a1-310f-11d2-a2df-006097cecff6:604:hide' style='display: inline;'><br>                           <span class='iokey'>BF mnBatchNumber [ICU] = TK Batch Number [ICU]</span><br>                           <span class='iokey'>BF szBatchType [ICUT] = TK Batch Type [ICUT]</span><br>                           <span class='iokey'>VA evt_LedgerTypeF0911 [LT] Is Like TK Ledger Types [LT]</span></div><br>                     <div id='3919b2a1-310f-11d2-a2df-006097cecff6:605' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F0911.FetchNext  [Index 1: Doc Type, Number, +]<div id='3919b2a1-310f-11d2-a2df-006097cecff6:605:hide' style='display: inline;'><br>                           VA evt_DocTemp [DCT] &#60;- TK Document Type [DCT]<br>                           VA evt_ObjectAccountF0911 [OBJ] &#60;- TK Object Account [OBJ]<br>                           VA evt_SubsidiaryF0911 [SUB] &#60;- TK Subsidiary [SUB]<br>                           VA evt_LedgerTypeF0911 [LT] &#60;- TK Ledger Types [LT]<br>                           VA evt_ValorLancado [AA] &#60;- TK Amount [AA]</div><br>                     <div id='3919b2a1-310f-11d2-a2df-006097cecff6:606' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>While SV File_IO_Status is equal to CO SUCCESS<br>                      And BF mnNumberofAxle [AXLE] is equal to "0"<div id='3919b2a1-310f-11d2-a2df-006097cecff6:606:hide' style='display: inline;'><br>                          <div id='3919b2a1-310f-11d2-a2df-006097cecff6:607' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_LedgerTypeF0911 [LT] is equal to ("AA","AR")<div id='3919b2a1-310f-11d2-a2df-006097cecff6:607:hide' style='display: inline;'><br>                               <div id='3919b2a1-310f-11d2-a2df-006097cecff6:608' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_DocumentType [DCT] is equal to &#60;Blank&#62;<br>                                Or VA evt_DocumentType [DCT] is equal to VA evt_DocTemp [DCT]<div id='3919b2a1-310f-11d2-a2df-006097cecff6:608:hide' style='display: inline;'><br>                                    <div id='3919b2a1-310f-11d2-a2df-006097cecff6:609' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_ObjectAccountIni [OBJ] is equal to &#60;Blank&#62;<br>                                     Or VA evt_ObjectAccountIni [OBJ] is less than or equal to VA evt_ObjectAccountF0911 [OBJ]<div id='3919b2a1-310f-11d2-a2df-006097cecff6:609:hide' style='display: inline;'><br>                                         <div id='3919b2a1-310f-11d2-a2df-006097cecff6:610' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_ObjectAccountFim [OBJ] is equal to &#60;Blank&#62;<br>                                          Or VA evt_ObjectAccountFim [OBJ] is greater than or equal to VA evt_ObjectAccountF0911 [OBJ]<div id='3919b2a1-310f-11d2-a2df-006097cecff6:610:hide' style='display: inline;'><br>                                              <div id='3919b2a1-310f-11d2-a2df-006097cecff6:611' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_SubsidiaryIni [SUB] is equal to &#60;Blank&#62;<br>                                               Or VA evt_SubsidiaryIni [SUB] is less than or equal to VA evt_SubsidiaryF0911 [SUB]<div id='3919b2a1-310f-11d2-a2df-006097cecff6:611:hide' style='display: inline;'><br>                                                   <div id='3919b2a1-310f-11d2-a2df-006097cecff6:612' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_SubsidiaryFim [SUB] is equal to &#60;Blank&#62;<br>                                                    Or VA evt_SubsidiaryFim [SUB] is greater than or equal to VA evt_SubsidiaryF0911 [SUB]<div id='3919b2a1-310f-11d2-a2df-006097cecff6:612:hide' style='display: inline;'><br>                                                         VA evt_ValorLancado [AA] = abs([VA evt_ValorLancado [AA]])<br>                                                        <div id='3919b2a1-310f-11d2-a2df-006097cecff6:614' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_ValorLancado [AA] is greater than VA evt_ValorLimite [AA]<div id='3919b2a1-310f-11d2-a2df-006097cecff6:614:hide' style='display: inline;'><span class='comment'><br>                                                              // O Lote possui Valor Lançado maior que o Valor Máximo sem Aprovador</span><br>                                                             <div id='3919b2a1-310f-11d2-a2df-006097cecff6:616' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_ValorLancado [AA] is greater than VA evt_ValorAprovador [AA]<div id='3919b2a1-310f-11d2-a2df-006097cecff6:616:hide' style='display: inline;'><span class='comment'><br>                                                                   // Erro - Lote possui Valor Lançado maior que o Valor do Aprovador</span><br>                                                                   BF mnNumberofAxle [AXLE] = "-7"</div><br>                                                              End If</div><br>                                                         End If</div><br>                                                    End If</div><br>                                               End If</div><br>                                          End If</div><br>                                     End If</div><br>                                End If</div><br>                           End If<br>                          <div id='3919b2a1-310f-11d2-a2df-006097cecff6:627' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F0911.FetchNext  [Index 1: Doc Type, Number, +]<div id='3919b2a1-310f-11d2-a2df-006097cecff6:627:hide' style='display: inline;'><br>                                VA evt_DocTemp [DCT] &#60;- TK Document Type [DCT]<br>                                VA evt_ObjectAccountF0911 [OBJ] &#60;- TK Object Account [OBJ]<br>                                VA evt_SubsidiaryF0911 [SUB] &#60;- TK Subsidiary [SUB]<br>                                VA evt_LedgerTypeF0911 [LT] &#60;- TK Ledger Types [LT]<br>                                VA evt_ValorLancado [AA] &#60;- TK Amount [AA]</div></div><br>                      End While<br>                     <div id='3919b2a1-310f-11d2-a2df-006097cecff6:629' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5509CIA.FetchNext  [Index 1: Chave]<div id='3919b2a1-310f-11d2-a2df-006097cecff6:629:hide' style='display: inline;'><br>                           VA evt_DocumentType [DCT] &#60;- TK Document Type [DCT]<br>                           VA evt_ObjectAccountIni [OBJ] &#60;- TK Object Account [OBJ]<br>                           VA evt_ObjectAccountFim [OBJ] &#60;- TK Depreciation Expense - Object [XOBJ]<br>                           VA evt_SubsidiaryIni [SUB] &#60;- TK Subsidiary [SUB]<br>                           VA evt_SubsidiaryFim [SUB] &#60;- TK Depreciation Expense - Subsidiary [XSUB]<br>                           VA evt_ValorLimite [AA] &#60;- TK Amount [AA]</div></div><br>                 End While</div><br>            End If<br>           <div id='3919b2a1-310f-11d2-a2df-006097cecff6:632' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5509CIA.FetchNext  [Index 1: Chave]<div id='3919b2a1-310f-11d2-a2df-006097cecff6:632:hide' style='display: inline;'><br>                 VA evt_SYS [SY] &#60;- TK Product Code [SY]<br>                 VA evt_AdditionFlag [A] &#60;- TK Add (Y/N) [A]</div></div><br>       End While</div><br>  End If<br> <div id='3919b2a1-310f-11d2-a2df-006097cecff6:635' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5509CIA.Close<div id='3919b2a1-310f-11d2-a2df-006097cecff6:635:hide' style='display: inline;'><br>       </div></div></div></body></html>