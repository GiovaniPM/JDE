<!DOCTYPE html><html lang = "en"><head><meta charset = "utf-8"><meta name = "viewport" content = "width=device-width, initial-scale=1"><title>JDE Object Browser HTML Extract</title>
<style type='text/css'>body,th{font-family: Courier New, Courier, mono;font-size: 12px; width:auto}
.section{font-family: Arial, Helvetica, sans-serif;font-size: 12px;font-weight: bold;border: thin groove #CC9966;width: 100%;padding-left: 5px;padding-top: 5px;padding-bottom: 5px; padding-right: 5px; box-sizing: border-box }
.objectheader {font-family: Arial, Helvetica, sans-serif;font-size: 12px;font-weight: bold;border: thin groove #CC9966;width:auto;background-color: #FFFFCC;padding-left: 5px;padding-top: 5px;padding-bottom: 5px;padding-right: 5px; box-sizing: border-box }
.details{font-family: Arial, Helvetica, sans-serif;font-size: 11px;font-weight: normal;border: thin groove #CC9966;width:100%;padding-left: 5px;padding-top: 5px;padding-bottom: 5px;padding-right: 5px;box-sizing: border-box }
.er {background-color: #FFFFFF;font-family: Courier New, Courier, mono;font-size: 12px; font-weight: normal; border: thin solid #CCCCCC; width:auto; padding-left: 5px;padding-top: 5px;padding-bottom: 5px; padding-right: 5px; box-sizing: border-box }
.dstrmembers {background-color: #FFFDDD;font-family: Courier New, Courier, mono;font-size: 12px;border: thin groove #CC9966;padding-left: 5px;padding-top: 5px;padding-bottom: 5px;padding-right: 5px; box-sizing: border-box }
.disabled {font-family: Courier New, Courier, mono;font-size: 12px;	font-style: italic; color:#CC9933}
.parameters {font-family: Courier New, Courier, mono;font-size: 12px; color:#3333FF}
.comment {font-family: Courier New, Courier, mono;font-size: 12px;	color: #339933}
.subtable {font-family: Arial, Helvetica, sans-serif;font-size: 11px;font-weight: normal;width:100%}
.lineno {color:#6E6E6E;font-family: Courier New, Courier, mono;font-size: 12px; font-weight: normal;}
.iokey {color:#FF6905;font-family: Courier New, Courier, mono;font-size: 12px; font-weight: normal;}
.logicline {color:#000000;font-family: Courier New, Courier, mono;font-size: 12px; font-weight: normal;}
.versionoverride {background-color: #FFCC99;}
.overrideflags{font-family: Arial, Helvetica, sans-serif;font-size: 11px;font-weight: normal;border: thin groove #CC9966;width:auto;padding-left: 5px;padding-top: 5px;padding-bottom: 5px;padding-right: 5px; background-color: #FFCC99; box-sizing: border-box }
.bsfnprops {font-family: Courier New, Courier, mono;font-size: 12px; color:#E01B4C}
.searchresult {font-family: Courier New, Courier, mono;font-size: 12px; font-weight: bold; background-color:#8BF3A0}
.expand {font-family: Courier New, Courier, mono;font-size: 11px; font-weight: bold; cursor:pointer; border: 1px solid gray; position: relative; left: -3px; display:inline; line-height:8px;}
.expand2 { display:inline; cursor:pointer; font-size: 9px; border: 1px solid gray; position: relative; left: -3px;}
</style>
<script type='text/javascript'>function load(){location.href = '#result';}</script>
<script language='JavaScript' type='text/javascript'>function ExpandCollapse(ElementId){ var ClickedElement = document.getElementById(ElementId); var SectionName = ElementId + ':hide'; var Section = document.getElementById(SectionName); if (ClickedElement.innerHTML == '-') { 	 ClickedElement.innerHTML = '+';	Section.style.display = 'none'; }  else  { 		ClickedElement.innerHTML = '-'; 	Section.style.display = 'inline';}} </script>
<base target = "_parent"></head><body onload='load()'>
<div class ='objectheader'>Business Function: N5576B02 - Convert and Format Datas<BR>Function Type: NER</div><div class='section'>EVENTS<div class='objectheader'>NER: CalculaTempoTranscorrido <BR>Event GUID: 15a99cc1-64ad-4b90-9fb3-802bf9a023fc</div><div class='er'><div class='dstrmembers'><B>Data Structure: D5576B02A - Calcula Tempo Transcorrido                                  </B><BR>BF TimeDateStart [TDSTR]<BR>BF szTempoTranscorrido [AA08]<BR>BF mnTempoTranscorrido [UPMT]<BR></div>----------------------------------------</BR>Event Level Variables</BR>----------------------------------------</BR>evt_TimeDateEnd [TDSTR]<br>evt_mnDays [IA03]<br>evt_mnHours [IA03]<br>evt_mnMins [IA03]<br>evt_mnSecs [IA03]<br>----------------------------------------</BR><span class='comment'>  // Parâmetros:</span><span class='comment'><br>  // BF TimeDateStart - DataHora Inicial (UTime)</span><span class='comment'><br>  // BF szTempoTranscorrido - TempoTranscorrido (Char8)</span><span class='comment'><br>  // BF mnTempoTranscorrido - TempoTranscorrido (Time)</span><span class='comment'><br>  //</span><br> <div id='15a99cc1-64ad-4b90-9fb3-802bf9a023fc:6' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If BF TimeDateStart [TDSTR] is equal to Null UTime<div id='15a99cc1-64ad-4b90-9fb3-802bf9a023fc:6:hide' style='display: inline;'><span class='comment'><br>       // Get da DataHora Inicial (UTime)</span><br>      <div id='15a99cc1-64ad-4b90-9fb3-802bf9a023fc:8' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>GetSystemTimeOW(B76B0004.GetSystemTimeOW)<div id='15a99cc1-64ad-4b90-9fb3-802bf9a023fc:8:hide' style='display: inline;'><span class='parameters'><br>            BF mnTempoTranscorrido [UPMT] &#60;- mnTimeOfDay [TDAY]</span></div><br>      <div id='15a99cc1-64ad-4b90-9fb3-802bf9a023fc:9' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>GetSystemUTime(B0130100.GetSystemUTime)<div id='15a99cc1-64ad-4b90-9fb3-802bf9a023fc:9:hide' style='display: inline;'><span class='parameters'><br>            BF TimeDateStart [TDSTR] &#60;- UTime [TDSTR]</span></div></div><br> <div id='15a99cc1-64ad-4b90-9fb3-802bf9a023fc:10' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='15a99cc1-64ad-4b90-9fb3-802bf9a023fc:10:hide' style='display: inline;'><span class='comment'><br>       // Get da DataHora Final (UTime)</span><br>      <div id='15a99cc1-64ad-4b90-9fb3-802bf9a023fc:12' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>GetSystemUTime(B0130100.GetSystemUTime)<div id='15a99cc1-64ad-4b90-9fb3-802bf9a023fc:12:hide' style='display: inline;'><span class='parameters'><br>            VA evt_TimeDateEnd [TDSTR] &#60;- UTime [TDSTR]</span></div><span class='comment'><br>       //</span><span class='comment'><br>       // Calcula o Tempo Transcorrido em Dias, Horas, Minutos e Segundos</span><br>      <div id='15a99cc1-64ad-4b90-9fb3-802bf9a023fc:15' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>GetTimeBetween(B9500200.GetTimeBetween)<div id='15a99cc1-64ad-4b90-9fb3-802bf9a023fc:15:hide' style='display: inline;'><span class='parameters'><br>            BF TimeDateStart [TDSTR] -&#62; jdeStartUTime [GENUTIME]<br>            VA evt_TimeDateEnd [TDSTR] -&#62; jdeEndUTime [GENUTIME]<br>            VA evt_mnDays [IA03] &#60;- nDays [MN09A]<br>            VA evt_mnHours [IA03] &#60;- nHours [MN09A]<br>            VA evt_mnMins [IA03] &#60;- nMinutes [MN09A]<br>            VA evt_mnSecs [IA03] &#60;- nSeconds [MN09A]</span></div><span class='comment'><br>       //</span><span class='comment'><br>       // Transforma os Dias em Horas</span><br>       VA evt_mnDays [IA03] = [VA evt_mnDays [IA03]]*24<span class='comment'><br>       //</span><span class='comment'><br>       // Acumula os Dias (em horas) nas Horas</span><br>       VA evt_mnHours [IA03] = [VA evt_mnHours [IA03]]+[VA evt_mnDays [IA03]]<span class='comment'><br>       //</span><span class='comment'><br>       // Desloca as Horas quatro casas para a esquerda</span><br>       BF mnTempoTranscorrido [UPMT] = [VA evt_mnHours [IA03]]*10000<span class='comment'><br>       //</span><span class='comment'><br>       // Desloca os Minutos duas casas para a esquerda</span><br>       VA evt_mnMins [IA03] = [VA evt_mnMins [IA03]]*100<span class='comment'><br>       //</span><span class='comment'><br>       // Acumula as Horas com os Minutos</span><br>       BF mnTempoTranscorrido [UPMT] = [BF mnTempoTranscorrido [UPMT]]+[VA evt_mnMins [IA03]]<span class='comment'><br>       //</span><span class='comment'><br>       // Acumula as Horas e os Minutos com os Segundos</span><br>       BF mnTempoTranscorrido [UPMT] = [BF mnTempoTranscorrido [UPMT]]+[VA evt_mnSecs [IA03]]<span class='comment'><br>       //</span></div><br>  End If<span class='comment'><br>  //</span><span class='comment'><br>  // Formata em HH:MM:SS no BF szTempoTranscorrido</span><br> <div id='15a99cc1-64ad-4b90-9fb3-802bf9a023fc:38' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>ConvertandFormatDatas(N5576B02.ConvertandFormatDatas)<div id='15a99cc1-64ad-4b90-9fb3-802bf9a023fc:38:hide' style='display: inline;'><span class='parameters'><br>       BF szTempoTranscorrido [AA08] &#60;- szStringOut [DS02]<br>       "H" -&#62; cTypeIn [ER001]<br>       BF mnTempoTranscorrido [UPMT] -&#62; mnNumberIn [MN29D9]</span></div><span class='comment'><br>  //</span></div></div><div class='section'>EVENTS<div class='objectheader'>NER: ConvertandFormatDatas <BR>Event GUID: c78771af-690b-40ad-93fe-fb6e61073e1c</div><div class='er'><div class='dstrmembers'><B>Data Structure: D76B0006 - Data Structure used to format data into Magnectic fil - 42  </B><BR>BF szStringIn [DS01]<BR>BF szStringOut [DS02]<BR>BF mnNumDecimals [ITM]<BR>BF mnSize [ITM]<BR>BF jdDateIn [BRADLJ]<BR>BF cTypeIn [ER001]<BR>BF mnNumberIn [MN29D9]<BR></div>----------------------------------------</BR>Event Level Variables</BR>----------------------------------------</BR>evt_n0 [IA01]<br>evt_n1 [IA01]<br>evt_n4 [IA01]<br>evt_cPonto [AA01]<br>evt_cSubstrDate [AA04]<br>evt_cFormatDate [AA10]<br>evt_cPipe [AA01]<br>evt_szNumberOut [DS02]<br>evt_iSize [INT01]<br>evt_Amount_MN29D9 [MN29D9]<br>evt_sApostrofe [BFSD]<br>evt_sCaracter [BFSD]<br>evt_sCCidilha [BFSD]<br>evt_scCidilha [BFSD]<br>evt_i2 [INT01]<br>evt_i6 [INT01]<br>evt_i4 [INT01]<br>evt_i0 [INT01]<br>evt_i3 [INT01]<br>evt_i5 [INT01]<br>evt_i8 [INT01]<br>evt_i11 [INT01]<br>evt_i14 [INT01]<br>evt_i17 [INT01]<br>evt_i1 [INT01]<br>evt_i7 [INT01]<br>evt_i10 [INT01]<br>evt_i13 [INT01]<br>evt_i16 [INT01]<br>evt_i9 [INT01]<br>evt_i12 [INT01]<br>evt_i15 [INT01]<br>evt_n8 [IA01]<br>evt_n19 [IA02]<br>evt_sBarra [BFSD]<br>evt_sPonto [BFSD]<br>evt_sTraco [BFSD]<br>evt_sPipe [BFSD]<br>evt_sZero [BFSD]<br>evt_cZero [AA01]<br>evt_cAspas [AA01]<br>evt_sVirgula [BFSD]<br>evt_cVirgula [AA01]<br>evt_cBlank [AA01]<br>evt_BF_iSize [INT01]<br>evt_BF_iNumDec [INT01]<br>evt_sBarraInv [BFSD]<br>evt_szSubString1 [DS02]<br>evt_szSubString2 [DS02]<br>evt_iStart [INT01]<br>evt_sDigDec [BFSD]<br>----------------------------------------</BR><span class='comment'>  //</span><span class='comment'><br>  // #############################################################################</span><span class='comment'><br>  //</span><span class='comment'><br>  // Tipos de Formatações:</span><span class='comment'><br>  //</span><span class='comment'><br>  // Data</span><span class='comment'><br>  //  B=retorna a Data no formato DD/MM/AAAA (tam&#62;8) ou DD/MM/AA</span><span class='comment'><br>  //  T=retorna a Data no formato AAAA-MM-DD</span><span class='comment'><br>  //  D=retorna a Data no formato AAAAMMDD (CTRY,FY,PN,day)</span><span class='comment'><br>  //  E=retorna a Data no formato DDMMAAAA</span><span class='comment'><br>  //</span><span class='comment'><br>  // Hora</span><span class='comment'><br>  //  G=retorna a DataHora no formato UTC: AAAA-MM-DDThh:mm:ss-TZD</span><span class='comment'><br>  //  H=retorna a Hora(numérico) no formato HH:MM:SS</span><span class='comment'><br>  //</span><span class='comment'><br>  // Numérico/Valor</span><span class='comment'><br>  // F=Formata um Valor, com ponto nos milhares, vírgula para separar as decimais,</span><span class='comment'><br>  //            com um tamanho determinado, alinhado à direita e brancos à esquerd</span><span class='comment'><br>  //  M=retorna o String somente com números e caracteres e zeros à esquerda</span><span class='comment'><br>  //  N=retorna o String somente com números, zeros à esquerda e decimal alinhada</span><span class='comment'><br>  //  V=retorna o String com o Valor com "," e tamanho variável (zero, volta Null)</span><span class='comment'><br>  //  W=retorna o String com o Valor com "." e tamanho variável (zero, volta Null)</span><span class='comment'><br>  //  Z=retorna o String com o Valor com "," e tamanho variável (zero, volta "0")</span><span class='comment'><br>  //  P=retorna o String com o Valor com "." e tamanho variável (zero, volta "0")</span><span class='comment'><br>  //</span><span class='comment'><br>  // Alfanumérico/String</span><span class='comment'><br>  //  S=retorna o String somente com números e caracteres e brancos à direita</span><span class='comment'><br>  //  C=retorna o String com upper, trim e sem acentos e cedilha (A-Z e 0-9)</span><span class='comment'><br>  //  L=retorna o String sem caracteres especiais (convertidos)</span><span class='comment'><br>  //  I=retorna o String só com caracteres imprimíveis - |&#62;!,"&#62;´,sem &#60;TAB&#62;,&#60;CR/LF&#62;</span><span class='comment'><br>  //</span><span class='comment'><br>  // #############################################################################</span><span class='comment'><br>  //</span><span class='comment'><br>  // Recebe:</span><span class='comment'><br>  // Valor a ser Formatado</span><span class='comment'><br>  // Casas Decimais do Valor a ser Formatado (0-4)</span><span class='comment'><br>  // Tamanho do String a ser retornado (brancos à esquerda)</span><span class='comment'><br>  //</span><span class='comment'><br>  // Retorna:</span><span class='comment'><br>  // String Formatado</span><span class='comment'><br>  //</span><span class='comment'><br>  // Parâmetros:</span><span class='comment'><br>  // BF szStringIn                   [DS01]          C80 &#62; string de entrada</span><span class='comment'><br>  // BF szStringOut                [DS02]          C80 &#60; string de retorno</span><span class='comment'><br>  // BF mnNumDecimals    [ITM]               N8   &#62; nº casas decimais</span><span class='comment'><br>  // BF mnSize                       [ITM]               N8   &#62; tam(0=var)/h(G)</span><span class='comment'><br>  // BF jdDateIn	                 [BRADLJ]      N6   &#62; data entrada</span><span class='comment'><br>  // BF cTypeIn	                  [ER001]         C1   &#62; tipo/formato saída</span><span class='comment'><br>  // BF mnNumberIn	       [MN29D9]      N29,9 &#62; nro/vlr/h(H)/TZD(G)</span><span class='comment'><br>  // #############################################################################</span><span class='comment'><br>  //</span><br>  VA evt_cAspas [AA01] = """<br>  VA evt_cBlank [AA01] = &#60;Blank&#62;<br>  VA evt_cPonto [AA01] = "."<br>  VA evt_cPipe [AA01] = "|"<br>  VA evt_cVirgula [AA01] = ","<br>  VA evt_cZero [AA01] = "0"<br>  VA evt_sApostrofe [BFSD] = "'"<br>  VA evt_sBarra [BFSD] = "/"<br>  VA evt_sBarraInv [BFSD] = concat("\\", &#60;NULL&#62;)<br>  VA evt_sCCidilha [BFSD] = "Ç"<br>  VA evt_scCidilha [BFSD] = "ç"<br>  VA evt_sPipe [BFSD] = "|"<br>  VA evt_sPonto [BFSD] = "."<br>  VA evt_sTraco [BFSD] = "-"<br>  VA evt_sVirgula [BFSD] = ","<br>  VA evt_sZero [BFSD] = "0"<br>  VA evt_i0 [INT01] = "0"<br>  VA evt_i1 [INT01] = "1"<br>  VA evt_i2 [INT01] = "2"<br>  VA evt_i3 [INT01] = "3"<br>  VA evt_i4 [INT01] = "4"<br>  VA evt_i5 [INT01] = "5"<br>  VA evt_i6 [INT01] = "6"<br>  VA evt_i7 [INT01] = "7"<br>  VA evt_i8 [INT01] = "8"<br>  VA evt_i9 [INT01] = "9"<br>  VA evt_i10 [INT01] = "10"<br>  VA evt_i11 [INT01] = "11"<br>  VA evt_i13 [INT01] = "13"<br>  VA evt_i12 [INT01] = "12"<br>  VA evt_i14 [INT01] = "14"<br>  VA evt_i15 [INT01] = "15"<br>  VA evt_i16 [INT01] = "16"<br>  VA evt_i17 [INT01] = "17"<br>  VA evt_n0 [IA01] = "0"<br>  VA evt_n1 [IA01] = "1"<br>  VA evt_n4 [IA01] = "4"<br>  VA evt_n8 [IA01] = "8"<br>  VA evt_n19 [IA02] = "19"<span class='comment'><br>  //</span><br>  VA evt_BF_iSize [INT01] = [BF mnSize [ITM]]<br>  VA evt_BF_iNumDec [INT01] = [BF mnNumDecimals [ITM]]<span class='comment'><br>  //</span><br> <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:95' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If BF cTypeIn [ER001] is equal to ("B","D","E","G","H","T")<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:95:hide' style='display: inline;'><span class='comment'><br>       //</span><span class='comment'><br>       // Opções para Formatação de Data/Hora</span><span class='comment'><br>       //</span><br>      <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:99' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If BF cTypeIn [ER001] is equal to ("B","E")<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:99:hide' style='display: inline;'><span class='comment'><br>            //</span><br>           <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:101' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>FormatDataIntoMagneticFileLayout(B76B0002.FormatDataIntoMagneticFileLayout)<span class='bsfnprops'>[Include in Transaction]</span><div id='c78771af-690b-40ad-93fe-fb6e61073e1c:101:hide' style='display: inline;'><span class='parameters'><br>                 BF szStringOut [DS02] &#60;- szStringOut [DS02]<br>                 VA evt_n8 [IA01] -&#62; mnSize [ITM]<br>                 BF jdDateIn [BRADLJ] -&#62; jdDateIn [BRADLJ]<br>                 "D" -&#62; cTypeIn [ER001]</span></div><span class='comment'><br>            //</span><br>            VA evt_cFormatDate [AA10] = substr([BF szStringOut [DS02]], [VA evt_i6 [INT01]], [VA evt_i2 [INT01]])<br>           <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:104' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If BF cTypeIn [ER001] is equal to "E"<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:104:hide' style='display: inline;'><br>                 VA evt_cSubstrDate [AA04] = substr([BF szStringOut [DS02]], [VA evt_i4 [INT01]], [VA evt_i2 [INT01]])<br>                 VA evt_cFormatDate [AA10] = concat([VA evt_cFormatDate [AA10]], [VA evt_cSubstrDate [AA04]])<br>                 VA evt_cSubstrDate [AA04] = substr([BF szStringOut [DS02]], [VA evt_i0 [INT01]], [VA evt_i4 [INT01]])</div><br>           <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:108' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:108:hide' style='display: inline;'><br>                 VA evt_cFormatDate [AA10] = concat([VA evt_cFormatDate [AA10]], [VA evt_sBarra [BFSD]])<br>                 VA evt_cSubstrDate [AA04] = substr([BF szStringOut [DS02]], [VA evt_i4 [INT01]], [VA evt_i2 [INT01]])<br>                 VA evt_cFormatDate [AA10] = concat([VA evt_cFormatDate [AA10]], [VA evt_cSubstrDate [AA04]])<br>                 VA evt_cFormatDate [AA10] = concat([VA evt_cFormatDate [AA10]], [VA evt_sBarra [BFSD]])<br>                <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:113' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_BF_iSize [INT01] is greater than or equal to VA evt_i1 [INT01]<br>                 And VA evt_BF_iSize [INT01] is less than or equal to VA evt_i8 [INT01]<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:113:hide' style='display: inline;'><br>                      VA evt_cSubstrDate [AA04] = substr([BF szStringOut [DS02]], [VA evt_i2 [INT01]], [VA evt_i2 [INT01]])</div><br>                <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:115' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:115:hide' style='display: inline;'><br>                      VA evt_cSubstrDate [AA04] = substr([BF szStringOut [DS02]], [VA evt_i0 [INT01]], [VA evt_i4 [INT01]])</div><br>                 End If</div><br>            End If<br>            VA evt_cFormatDate [AA10] = concat([VA evt_cFormatDate [AA10]], [VA evt_cSubstrDate [AA04]])<span class='comment'><br>            //</span><br>            BF szStringOut [DS02] = VA evt_cFormatDate [AA10]<span class='comment'><br>            //</span></div><br>      <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:123' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:123:hide' style='display: inline;'><br>           <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:124' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If BF cTypeIn [ER001] is equal to ("D","G","T")<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:124:hide' style='display: inline;'><span class='comment'><br>                 //</span><br>                <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:126' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>FormatDataIntoMagneticFileLayout(B76B0002.FormatDataIntoMagneticFileLayout)<span class='bsfnprops'>[Include in Transaction]</span><div id='c78771af-690b-40ad-93fe-fb6e61073e1c:126:hide' style='display: inline;'><span class='parameters'><br>                      UNDEFINED -&#62; szStringIn [DS01]<br>                      BF szStringOut [DS02] &#60;- szStringOut [DS02]<br>                      UNDEFINED -&#62; mnNumDecimals [ITM]<br>                      UNDEFINED -&#62; mnSize [ITM]<br>                      BF jdDateIn [BRADLJ] -&#62; jdDateIn [BRADLJ]<br>                      "D" -&#62; cTypeIn [ER001]<br>                      UNDEFINED -&#62; mnNumberIn [MN29D9]</span></div><span class='comment'><br>                 //</span><br>                <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:128' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If BF cTypeIn [ER001] is equal to ("G","T")<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:128:hide' style='display: inline;'><br>                      VA evt_cFormatDate [AA10] = substr([BF szStringOut [DS02]], [VA evt_i0 [INT01]], [VA evt_i4 [INT01]])<br>                      VA evt_cFormatDate [AA10] = concat([VA evt_cFormatDate [AA10]], [VA evt_sTraco [BFSD]])<br>                      VA evt_cSubstrDate [AA04] = substr([BF szStringOut [DS02]], [VA evt_i4 [INT01]], [VA evt_i2 [INT01]])<br>                      VA evt_cFormatDate [AA10] = concat([VA evt_cFormatDate [AA10]], [VA evt_cSubstrDate [AA04]])<br>                      VA evt_cFormatDate [AA10] = concat([VA evt_cFormatDate [AA10]], [VA evt_sTraco [BFSD]])<br>                      VA evt_cSubstrDate [AA04] = substr([BF szStringOut [DS02]], [VA evt_i6 [INT01]], [VA evt_i2 [INT01]])<br>                      VA evt_cFormatDate [AA10] = concat([VA evt_cFormatDate [AA10]], [VA evt_cSubstrDate [AA04]])<span class='comment'><br>                      //</span><br>                     <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:137' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If BF cTypeIn [ER001] is equal to "G"<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:137:hide' style='display: inline;'><br>                          <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:138' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>FormatMNtoTime(B9800188.FormatMNtoTime)<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:138:hide' style='display: inline;'><span class='parameters'><br>                                BF mnSize [ITM] -&#62; mnTime [UPMT]<br>                                BF szStringOut [DS02] &#60;- szTime [TIME]<br>                                VA evt_cZero [AA01] -&#62; cFormatMode [EV01]</span></div><br>                           BF szStringOut [DS02] = concat("T", [BF szStringOut [DS02]])<br>                           BF szStringOut [DS02] = concat([VA evt_cFormatDate [AA10]], [BF szStringOut [DS02]])<br>                          <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:141' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If BF mnNumberIn [MN29D9] is less than VA evt_n0 [IA01]<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:141:hide' style='display: inline;'><br>                                BF szStringOut [DS02] = concat([BF szStringOut [DS02]], "-")</div><br>                          <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:143' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:143:hide' style='display: inline;'><br>                                BF szStringOut [DS02] = concat([BF szStringOut [DS02]], "+")</div><br>                           End If<br>                           VA evt_Amount_MN29D9 [MN29D9] = abs([BF mnNumberIn [MN29D9]])<br>                           VA evt_Amount_MN29D9 [MN29D9] = [VA evt_Amount_MN29D9 [MN29D9]]*10000<br>                          <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:148' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>FormatMNtoTime(B9800188.FormatMNtoTime)<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:148:hide' style='display: inline;'><span class='parameters'><br>                                VA evt_Amount_MN29D9 [MN29D9] -&#62; mnTime [UPMT]<br>                                VA evt_cFormatDate [AA10] &#60;- szTime [TIME]<br>                                VA evt_cZero [AA01] -&#62; cFormatMode [EV01]</span></div><br>                           VA evt_cFormatDate [AA10] = substr([VA evt_cFormatDate [AA10]], [VA evt_i0 [INT01]], [VA evt_i5 [INT01]])<br>                           BF szStringOut [DS02] = concat([BF szStringOut [DS02]], [VA evt_cFormatDate [AA10]])</div><br>                     <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:151' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:151:hide' style='display: inline;'><br>                           BF szStringOut [DS02] = VA evt_cFormatDate [AA10]</div><br>                      End If<span class='comment'><br>                      //</span><span class='comment'><br>                      //</span></div><br>                 End If</div><br>           <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:157' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:157:hide' style='display: inline;'><br>                <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:158' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If BF cTypeIn [ER001] is equal to "H"<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:158:hide' style='display: inline;'><span class='comment'><br>                      //</span><br>                     <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:160' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>FormatMNtoTime(B9800188.FormatMNtoTime)<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:160:hide' style='display: inline;'><span class='parameters'><br>                           BF mnNumberIn [MN29D9] -&#62; mnTime [UPMT]<br>                           BF szStringOut [DS02] &#60;- szTime [TIME]<br>                           VA evt_cZero [AA01] -&#62; cFormatMode [EV01]</span></div><span class='comment'><br>                      //</span></div><br>                 End If</div><br>            End If</div><br>       End If</div><br> <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:165' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:165:hide' style='display: inline;'><br>      <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:166' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If BF cTypeIn [ER001] is equal to ("F","N","P","V","W","Z")<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:166:hide' style='display: inline;'><span class='comment'><br>            //</span><span class='comment'><br>            // Opções para Formatação de Numéricos/Valores</span><span class='comment'><br>            //</span><br>           <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:170' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If BF cTypeIn [ER001] is equal to "F"<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:170:hide' style='display: inline;'><span class='comment'><br>                 //</span><br>                <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:172' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_BF_iNumDec [INT01] is greater than VA evt_i4 [INT01]<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:172:hide' style='display: inline;'><br>                      VA evt_BF_iNumDec [INT01] = VA evt_i4 [INT01]<br>                      BF mnNumDecimals [ITM] = VA evt_n4 [IA01]</div><br>                <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:175' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:175:hide' style='display: inline;'><br>                     <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:176' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_BF_iNumDec [INT01] is less than VA evt_i0 [INT01]<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:176:hide' style='display: inline;'><br>                           VA evt_BF_iNumDec [INT01] = VA evt_i0 [INT01]<br>                           BF mnNumDecimals [ITM] = VA evt_n0 [IA01]</div><br>                      End If</div><br>                 End If<span class='comment'><br>                 //</span><br>                <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:182' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If BF mnNumberIn [MN29D9] is equal to VA evt_n0 [IA01]<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:182:hide' style='display: inline;'><br>                     <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:183' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_BF_iNumDec [INT01] is equal to VA evt_i2 [INT01]<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:183:hide' style='display: inline;'><br>                           BF szStringOut [DS02] = ",00"</div><br>                     <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:185' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:185:hide' style='display: inline;'><br>                          <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:186' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_BF_iNumDec [INT01] is equal to VA evt_i0 [INT01]<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:186:hide' style='display: inline;'><br>                                BF szStringOut [DS02] = &#60;NULL&#62;</div><br>                          <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:188' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:188:hide' style='display: inline;'><br>                               <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:189' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_BF_iNumDec [INT01] is equal to VA evt_i4 [INT01]<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:189:hide' style='display: inline;'><br>                                     BF szStringOut [DS02] = ",0000"</div><br>                               <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:191' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:191:hide' style='display: inline;'><br>                                     BF szStringOut [DS02] = ",000"</div><br>                                End If</div><br>                           End If</div><br>                      End If</div><br>                <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:196' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:196:hide' style='display: inline;'><span class='comment'><br>                      //</span><span class='comment'><br>                      // Formata em um numérico de tamanho 19 e com 4 casas decimais</span><span class='comment'><br>                      // ex.: de 0,1 para 0000000000000001000</span><br>                     <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:200' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>FormatDataIntoMagneticFileLayout(B76B0002.FormatDataIntoMagneticFileLayout)<span class='bsfnprops'>[Include in Transaction]</span><div id='c78771af-690b-40ad-93fe-fb6e61073e1c:200:hide' style='display: inline;'><span class='parameters'><br>                           VA evt_szNumberOut [DS02] &#60;- szStringOut [DS02]<br>                           VA evt_n4 [IA01] -&#62; mnNumDecimals [ITM]<br>                           VA evt_n19 [IA02] -&#62; mnSize [ITM]<br>                           "N" -&#62; cTypeIn [ER001]<br>                           BF mnNumberIn [MN29D9] -&#62; mnNumberIn [MN29D9]</span></div><span class='comment'><br>                      //</span><span class='comment'><br>                      // coloca os pontos e a vírgula</span><span class='comment'><br>                      // de 0000000000000001000 para 000.000.000.000.000,1000</span><br>                      VA evt_szSubString1 [DS02] = substr([VA evt_szNumberOut [DS02]], [VA evt_i0 [INT01]], [VA evt_i3 [INT01]])<br>                      BF szStringOut [DS02] = concat([VA evt_szSubString1 [DS02]], [VA evt_cPonto [AA01]])<span class='comment'><br>                      //</span><br>                      VA evt_szSubString1 [DS02] = substr([VA evt_szNumberOut [DS02]], [VA evt_i3 [INT01]], [VA evt_i3 [INT01]])<br>                      BF szStringOut [DS02] = concat([BF szStringOut [DS02]], [VA evt_szSubString1 [DS02]])<br>                      BF szStringOut [DS02] = concat([BF szStringOut [DS02]], [VA evt_cPonto [AA01]])<span class='comment'><br>                      //</span><br>                      VA evt_szSubString1 [DS02] = substr([VA evt_szNumberOut [DS02]], [VA evt_i6 [INT01]], [VA evt_i3 [INT01]])<br>                      BF szStringOut [DS02] = concat([BF szStringOut [DS02]], [VA evt_szSubString1 [DS02]])<br>                      BF szStringOut [DS02] = concat([BF szStringOut [DS02]], [VA evt_cPonto [AA01]])<span class='comment'><br>                      //</span><br>                      VA evt_szSubString1 [DS02] = substr([VA evt_szNumberOut [DS02]], [VA evt_i9 [INT01]], [VA evt_i3 [INT01]])<br>                      BF szStringOut [DS02] = concat([BF szStringOut [DS02]], [VA evt_szSubString1 [DS02]])<br>                      BF szStringOut [DS02] = concat([BF szStringOut [DS02]], [VA evt_cPonto [AA01]])<span class='comment'><br>                      //</span><br>                      VA evt_szSubString1 [DS02] = substr([VA evt_szNumberOut [DS02]], [VA evt_i12 [INT01]], [VA evt_i3 [INT01]])<br>                      BF szStringOut [DS02] = concat([BF szStringOut [DS02]], [VA evt_szSubString1 [DS02]])<br>                      BF szStringOut [DS02] = concat([BF szStringOut [DS02]], [VA evt_cVirgula [AA01]])<span class='comment'><br>                      //</span><br>                      VA evt_szSubString1 [DS02] = substr([VA evt_szNumberOut [DS02]], [VA evt_i15 [INT01]], [VA evt_i4 [INT01]])<br>                      BF szStringOut [DS02] = concat([BF szStringOut [DS02]], [VA evt_szSubString1 [DS02]])<span class='comment'><br>                      //</span><span class='comment'><br>                      // retira as casa decimais excedentes a direita</span><br>                     <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:227' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_BF_iNumDec [INT01] is equal to VA evt_i0 [INT01]<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:227:hide' style='display: inline;'><br>                           VA evt_iSize [INT01] = VA evt_n19 [IA02]</div><br>                     <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:229' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:229:hide' style='display: inline;'><br>                           VA evt_iSize [INT01] = 20+[BF mnNumDecimals [ITM]]</div><br>                      End If<br>                      BF szStringOut [DS02] = substr([BF szStringOut [DS02]], [VA evt_i0 [INT01]], [VA evt_iSize [INT01]])<span class='comment'><br>                      //</span><span class='comment'><br>                      // retira os zeros e pontos excedentes a esquerda</span><span class='comment'><br>                      // de 000.000.000.000.000,1000 para .000.000.000.000,1000</span><br>                      BF szStringOut [DS02] = ltrim([BF szStringOut [DS02]], [VA evt_cZero [AA01]])<span class='comment'><br>                      // de .000.000.000.000,1000 para 000.000.000.000,1000</span><br>                      BF szStringOut [DS02] = ltrim([BF szStringOut [DS02]], [VA evt_cPonto [AA01]])<span class='comment'><br>                      //</span><span class='comment'><br>                      // de 000.000.000.000,1000 para .000.000.000,1000</span><br>                      BF szStringOut [DS02] = ltrim([BF szStringOut [DS02]], [VA evt_cZero [AA01]])<span class='comment'><br>                      // de .000.000.000,1000 para 000.000.000,1000</span><br>                      BF szStringOut [DS02] = ltrim([BF szStringOut [DS02]], [VA evt_cPonto [AA01]])<span class='comment'><br>                      //</span><span class='comment'><br>                      // de 000.000.000,1000 para .000.000,1000</span><br>                      BF szStringOut [DS02] = ltrim([BF szStringOut [DS02]], [VA evt_cZero [AA01]])<span class='comment'><br>                      // de .000.000,1000 para 000.000,1000</span><br>                      BF szStringOut [DS02] = ltrim([BF szStringOut [DS02]], [VA evt_cPonto [AA01]])<span class='comment'><br>                      //</span><span class='comment'><br>                      // de 000.000,1000 para .000,1000</span><br>                      BF szStringOut [DS02] = ltrim([BF szStringOut [DS02]], [VA evt_cZero [AA01]])<span class='comment'><br>                      // de .000,1000 para 000,1000</span><br>                      BF szStringOut [DS02] = ltrim([BF szStringOut [DS02]], [VA evt_cPonto [AA01]])<span class='comment'><br>                      //</span><span class='comment'><br>                      // de 000,1000 para ,1000</span><br>                      BF szStringOut [DS02] = ltrim([BF szStringOut [DS02]], [VA evt_cZero [AA01]])</div><br>                 End If<span class='comment'><br>                 //</span><br>                 VA evt_Amount_MN29D9 [MN29D9] = abs([BF mnNumberIn [MN29D9]])<br>                <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:260' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_Amount_MN29D9 [MN29D9] is less than VA evt_n1 [IA01]<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:260:hide' style='display: inline;'><br>                      BF szStringOut [DS02] = concat([VA evt_sZero [BFSD]], [BF szStringOut [DS02]])</div><br>                 End If<span class='comment'><br>                 //</span><br>                 BF szStringOut [DS02] = lpad([BF szStringOut [DS02]], [VA evt_cBlank [AA01]], [VA evt_BF_iSize [INT01]])<span class='comment'><br>                 //</span></div><br>           <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:266' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:266:hide' style='display: inline;'><br>                 VA evt_Amount_MN29D9 [MN29D9] = round([BF mnNumberIn [MN29D9]], [VA evt_BF_iNumDec [INT01]])<span class='comment'><br>                 //</span><br>                <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:269' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_Amount_MN29D9 [MN29D9] is equal to VA evt_n0 [IA01]<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:269:hide' style='display: inline;'><br>                     <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:270' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If BF cTypeIn [ER001] is equal to ("V","W")<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:270:hide' style='display: inline;'><br>                           BF szStringOut [DS02] = &#60;NULL&#62;</div><br>                     <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:272' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:272:hide' style='display: inline;'><br>                          <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:273' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If BF cTypeIn [ER001] is equal to "N"<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:273:hide' style='display: inline;'><br>                                BF szStringOut [DS02] = VA evt_sZero [BFSD]<br>                                BF szStringOut [DS02] = rpad([BF szStringOut [DS02]], [VA evt_sZero [BFSD]], [BF mnSize [ITM]])</div><br>                          <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:276' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:276:hide' style='display: inline;'><br>                               <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:277' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If BF mnNumDecimals [ITM] is equal to VA evt_n0 [IA01]<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:277:hide' style='display: inline;'><br>                                     BF szStringOut [DS02] = VA evt_sZero [BFSD]</div><br>                               <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:279' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:279:hide' style='display: inline;'><br>                                    <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:280' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If BF cTypeIn [ER001] is equal to "P"<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:280:hide' style='display: inline;'><br>                                          BF szStringOut [DS02] = VA evt_sPonto [BFSD]</div><br>                                    <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:282' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:282:hide' style='display: inline;'><br>                                          BF szStringOut [DS02] = VA evt_sVirgula [BFSD]</div><br>                                     End If<br>                                     BF szStringOut [DS02] = concat([VA evt_sZero [BFSD]], [BF szStringOut [DS02]])<br>                                     BF mnSize [ITM] = [BF mnNumDecimals [ITM]]+[VA evt_i2 [INT01]]<br>                                     BF szStringOut [DS02] = rpad([BF szStringOut [DS02]], [VA evt_sZero [BFSD]], [BF mnSize [ITM]])</div><br>                                End If</div><br>                           End If</div><br>                      End If</div><br>                <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:291' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:291:hide' style='display: inline;'><br>                     <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:292' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If BF cTypeIn [ER001] is equal to "N"<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:292:hide' style='display: inline;'><br>                          <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:293' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_BF_iSize [INT01] is less than VA evt_BF_iNumDec [INT01]<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:293:hide' style='display: inline;'><br>                                VA evt_BF_iSize [INT01] = VA evt_i12 [INT01]<br>                                BF mnSize [ITM] = "12"</div><br>                           End If</div><br>                     <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:297' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:297:hide' style='display: inline;'><br>                          <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:298' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_BF_iSize [INT01] is equal to VA evt_i0 [INT01]<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:298:hide' style='display: inline;'><br>                                VA evt_BF_iSize [INT01] = VA evt_i17 [INT01]<br>                                BF mnSize [ITM] = "17"</div><br>                           End If</div><br>                      End If<span class='comment'><br>                      //</span><span class='comment'><br>                      // formata para alinhar as casas decimais</span><br>                     <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:305' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>FormatDataIntoMagneticFileLayout(B76B0002.FormatDataIntoMagneticFileLayout)<span class='bsfnprops'>[Include in Transaction]</span><div id='c78771af-690b-40ad-93fe-fb6e61073e1c:305:hide' style='display: inline;'><span class='parameters'><br>                           BF szStringOut [DS02] &#60;- szStringOut [DS02]<br>                           BF mnNumDecimals [ITM] -&#62; mnNumDecimals [ITM]<br>                           BF mnSize [ITM] -&#62; mnSize [ITM]<br>                           "N" -&#62; cTypeIn [ER001]<br>                           VA evt_Amount_MN29D9 [MN29D9] -&#62; mnNumberIn [MN29D9]</span></div><span class='comment'><br>                      //</span><br>                     <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:307' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If BF cTypeIn [ER001] is not equal to "N"<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:307:hide' style='display: inline;'><br>                          <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:308' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If BF cTypeIn [ER001] is equal to ("P","W")<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:308:hide' style='display: inline;'><br>                                VA evt_sDigDec [BFSD] = VA evt_sPonto [BFSD]</div><br>                          <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:310' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:310:hide' style='display: inline;'><br>                                VA evt_sDigDec [BFSD] = VA evt_sVirgula [BFSD]</div><br>                           End If<br>                           VA evt_iSize [INT01] = [VA evt_BF_iSize [INT01]]-[VA evt_BF_iNumDec [INT01]]<br>                           VA evt_szNumberOut [DS02] = substr([BF szStringOut [DS02]], [VA evt_i0 [INT01]], [VA evt_iSize [INT01]])<br>                           VA evt_szNumberOut [DS02] = concat([VA evt_szNumberOut [DS02]], [VA evt_sDigDec [BFSD]])<br>                           VA evt_cFormatDate [AA10] = substr([BF szStringOut [DS02]], [VA evt_iSize [INT01]], [VA evt_BF_iNumDec [INT01]])<br>                           VA evt_szNumberOut [DS02] = concat([VA evt_szNumberOut [DS02]], [VA evt_cFormatDate [AA10]])<span class='comment'><br>                           //</span><br>                           BF szStringOut [DS02] = ltrim([VA evt_szNumberOut [DS02]], [VA evt_cZero [AA01]])<span class='comment'><br>                           //</span><br>                           VA evt_Amount_MN29D9 [MN29D9] = abs([VA evt_Amount_MN29D9 [MN29D9]])<br>                          <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:322' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_Amount_MN29D9 [MN29D9] is less than VA evt_n1 [IA01]<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:322:hide' style='display: inline;'><br>                                BF szStringOut [DS02] = concat([VA evt_sZero [BFSD]], [BF szStringOut [DS02]])</div><br>                           End If<br>                          <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:325' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If BF mnNumberIn [MN29D9] is less than VA evt_n0 [IA01]<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:325:hide' style='display: inline;'><br>                                BF szStringOut [DS02] = concat([VA evt_sTraco [BFSD]], [BF szStringOut [DS02]])</div><br>                           End If</div><br>                      End If</div><br>                 End If<br>                 BF szStringOut [DS02] = rtrim([BF szStringOut [DS02]], [VA evt_cPonto [AA01]])<br>                 BF szStringOut [DS02] = rtrim([BF szStringOut [DS02]], [VA evt_cVirgula [AA01]])</div><br>            End If</div><br>      <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:333' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:333:hide' style='display: inline;'><span class='comment'><br>            //</span><span class='comment'><br>            // Opções para Formatação de Alfanuméricos/Strings</span><span class='comment'><br>            //</span><br>           <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:337' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If BF cTypeIn [ER001] is equal to "M"<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:337:hide' style='display: inline;'><span class='comment'><br>                 //</span><br>                <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:339' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>FormatDataIntoMagneticFileLayout(B76B0002.FormatDataIntoMagneticFileLayout)<span class='bsfnprops'>[Include in Transaction]</span><div id='c78771af-690b-40ad-93fe-fb6e61073e1c:339:hide' style='display: inline;'><span class='parameters'><br>                      BF szStringIn [DS01] -&#62; szStringIn [DS01]<br>                      BF szStringOut [DS02] &#60;- szStringOut [DS02]<br>                      UNDEFINED -&#62; mnNumDecimals [ITM]<br>                      BF mnSize [ITM] -&#62; mnSize [ITM]<br>                      UNDEFINED -&#62; jdDateIn [BRADLJ]<br>                      BF cTypeIn [ER001] -&#62; cTypeIn [ER001]<br>                      UNDEFINED -&#62; mnNumberIn [MN29D9]</span></div><span class='comment'><br>                 //</span></div><br>           <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:341' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:341:hide' style='display: inline;'><br>                 BF szStringOut [DS02] = rtrim([BF szStringIn [DS01]], [VA evt_cBlank [AA01]])<span class='comment'><br>                 //</span><span class='comment'><br>                 // Para o  Tipo=I, mantém os brancos à esquerda</span><br>                <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:345' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If BF cTypeIn [ER001] is not equal to "I"<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:345:hide' style='display: inline;'><br>                      BF szStringOut [DS02] = ltrim([BF szStringIn [DS01]], [VA evt_cBlank [AA01]])</div><br>                 End If<span class='comment'><br>                 //</span><span class='comment'><br>                 // tamanho/comprimento do string</span><br>                 VA evt_i10 [INT01] = length([BF szStringOut [DS02]])<br>                 VA evt_i10 [INT01] = [VA evt_i10 [INT01]]-[VA evt_i1 [INT01]]<span class='comment'><br>                 //</span><span class='comment'><br>                 // ponteiro de varredura do string</span><br>                 VA evt_i11 [INT01] = VA evt_i0 [INT01]<span class='comment'><br>                 // ponteiro do caracter a ser mantido/substituido/suprimido</span><br>                 VA evt_i12 [INT01] = VA evt_i0 [INT01]<span class='comment'><br>                 //</span><br>                <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:358' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If BF cTypeIn [ER001] is equal to "S"<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:358:hide' style='display: inline;'><span class='comment'><br>                      //</span><span class='comment'><br>                      // VA evt_cVirgula será usado como o dígito anterior</span><span class='comment'><br>                      // Inicia com Blank, pois se o primeiro dígito for inválido, já despreza</span><br>                      VA evt_cVirgula [AA01] = VA evt_cBlank [AA01]<span class='comment'><br>                      //</span><br>                     <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:364' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>While VA evt_i11 [INT01] is less than or equal to VA evt_i10 [INT01]<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:364:hide' style='display: inline;'><span class='comment'><br>                           //</span><br>                           VA evt_cPonto [AA01] = substr([BF szStringOut [DS02]], [VA evt_i11 [INT01]], [VA evt_i1 [INT01]])<span class='comment'><br>                           //</span><br>                          <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:368' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_cPonto [AA01] is equal to "A"-"Z"<br>                           Or VA evt_cPonto [AA01] is equal to "a"-"z"<br>                           Or VA evt_cPonto [AA01] is equal to "0"-"9"<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:368:hide' style='display: inline;'><span class='comment'><br>                                // caracter valido</span><br>                                VA evt_i12 [INT01] = [VA evt_i12 [INT01]]+[VA evt_i1 [INT01]]<br>                                VA evt_cVirgula [AA01] = VA evt_cPonto [AA01]</div><br>                          <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:372' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:372:hide' style='display: inline;'><span class='comment'><br>                                // suprimir blank excedente</span><br>                               <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:374' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_cVirgula [AA01] is equal to VA evt_cBlank [AA01]<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:374:hide' style='display: inline;'><br>                                     VA evt_cPonto [AA01] = VA evt_cPipe [AA01]</div><br>                               <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:376' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:376:hide' style='display: inline;'><span class='comment'><br>                                     // substituir caracter inválido por blank</span><br>                                     VA evt_cPonto [AA01] = VA evt_cBlank [AA01]<br>                                     VA evt_cVirgula [AA01] = VA evt_cPonto [AA01]</div><br>                                End If</div><br>                           End If<span class='comment'><br>                           //</span><br>                          <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:383' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_i11 [INT01] is equal to VA evt_i12 [INT01]<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:383:hide' style='display: inline;'><br>                               <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:384' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_cPonto [AA01] is equal to VA evt_cPipe [AA01]<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:384:hide' style='display: inline;'><span class='comment'><br>                                     // suprimir caracter</span><br>                                     VA evt_szSubString1 [DS02] = substr([BF szStringOut [DS02]], [VA evt_i0 [INT01]], [VA evt_i12 [INT01]])<span class='comment'><br>                                     //</span><br>                                     VA evt_iStart [INT01] = [VA evt_i12 [INT01]]+[VA evt_i1 [INT01]]<br>                                     VA evt_iSize [INT01] = [VA evt_i10 [INT01]]-[VA evt_i12 [INT01]]<br>                                     VA evt_szSubString2 [DS02] = substr([BF szStringOut [DS02]], [VA evt_iStart [INT01]], [VA evt_iSize [INT01]])<span class='comment'><br>                                     //</span><br>                                     BF szStringOut [DS02] = concat([VA evt_szSubString1 [DS02]], [VA evt_szSubString2 [DS02]])<span class='comment'><br>                                     //</span><br>                                     VA evt_i10 [INT01] = [VA evt_i10 [INT01]]-[VA evt_i1 [INT01]]</div><br>                               <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:395' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:395:hide' style='display: inline;'><span class='comment'><br>                                     // substituir caracter</span><br>                                     VA evt_szSubString1 [DS02] = substr([BF szStringOut [DS02]], [VA evt_i0 [INT01]], [VA evt_i12 [INT01]])<span class='comment'><br>                                     //</span><br>                                     VA evt_iStart [INT01] = [VA evt_i12 [INT01]]+[VA evt_i1 [INT01]]<br>                                     VA evt_iSize [INT01] = [VA evt_i10 [INT01]]-[VA evt_i12 [INT01]]<br>                                     VA evt_szSubString2 [DS02] = substr([BF szStringOut [DS02]], [VA evt_iStart [INT01]], [VA evt_iSize [INT01]])<span class='comment'><br>                                     //</span><span class='comment'><br>                                     // no VA evt_cPonto vem o novo caracter para substituir o caracter inválido</span><br>                                     BF szStringOut [DS02] = concat([VA evt_szSubString1 [DS02]], [VA evt_cPonto [AA01]])<br>                                     BF szStringOut [DS02] = concat([BF szStringOut [DS02]], [VA evt_szSubString2 [DS02]])<span class='comment'><br>                                     //</span><br>                                     VA evt_i11 [INT01] = [VA evt_i11 [INT01]]+[VA evt_i1 [INT01]]<br>                                     VA evt_i12 [INT01] = VA evt_i11 [INT01]</div><br>                                End If</div><br>                          <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:410' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:410:hide' style='display: inline;'><span class='comment'><br>                                // caracter valido</span><br>                                VA evt_i11 [INT01] = [VA evt_i11 [INT01]]+[VA evt_i1 [INT01]]</div><br>                           End If</div><br>                      End While</div><br>                <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:415' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:415:hide' style='display: inline;'><br>                     <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:416' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If BF cTypeIn [ER001] is equal to "C"<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:416:hide' style='display: inline;'><span class='comment'><br>                           //</span><br>                           BF szStringOut [DS02] = upper([BF szStringIn [DS01]])<span class='comment'><br>                           //</span><br>                          <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:420' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>While VA evt_i11 [INT01] is less than or equal to VA evt_i10 [INT01]<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:420:hide' style='display: inline;'><span class='comment'><br>                                //</span><br>                                VA evt_cPonto [AA01] = substr([BF szStringOut [DS02]], [VA evt_i11 [INT01]], [VA evt_i1 [INT01]])<span class='comment'><br>                                //</span><br>                               <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:424' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_cPonto [AA01] is equal to "A"-"Z"<br>                                Or VA evt_cPonto [AA01] is equal to "0"-"9"<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:424:hide' style='display: inline;'><span class='comment'><br>                                     // caracter valido</span><br>                                     VA evt_i12 [INT01] = [VA evt_i12 [INT01]]+[VA evt_i1 [INT01]]</div><br>                               <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:427' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:427:hide' style='display: inline;'><span class='comment'><br>                                     // tb converte acentos minúsculos que o upper não faz</span><br>                                     VA evt_sCaracter [BFSD] = substr([BF szStringOut [DS02]], [VA evt_i11 [INT01]], [VA evt_i1 [INT01]])<br>                                    <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:430' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_sCaracter [BFSD] is equal to VA evt_sCCidilha [BFSD]<br>                                     Or VA evt_sCaracter [BFSD] is equal to VA evt_scCidilha [BFSD]<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:430:hide' style='display: inline;'><br>                                          VA evt_cPonto [AA01] = "C"</div><br>                                    <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:432' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:432:hide' style='display: inline;'><br>                                         <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:433' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_cPonto [AA01] is equal to ("Á","À","Â","Ä","Ã")<br>                                          Or VA evt_cPonto [AA01] is equal to ("ª","á","à","â","ä","ã")<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:433:hide' style='display: inline;'><br>                                               VA evt_cPonto [AA01] = "A"</div><br>                                         <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:435' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:435:hide' style='display: inline;'><br>                                              <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:436' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_cPonto [AA01] is equal to ("É","È","Ê","Ë")<br>                                               Or VA evt_cPonto [AA01] is equal to ("é","è","ê","ë")<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:436:hide' style='display: inline;'><br>                                                    VA evt_cPonto [AA01] = "E"</div><br>                                              <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:438' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:438:hide' style='display: inline;'><br>                                                   <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:439' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_cPonto [AA01] is equal to ("Í","Ì","Î","Ï")<br>                                                    Or VA evt_cPonto [AA01] is equal to ("í","ì","î","ï")<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:439:hide' style='display: inline;'><br>                                                         VA evt_cPonto [AA01] = "I"</div><br>                                                   <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:441' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:441:hide' style='display: inline;'><br>                                                        <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:442' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_cPonto [AA01] is equal to ("Ó","Ò","Ô","Ö","Õ")<br>                                                         Or VA evt_cPonto [AA01] is equal to ("º","ó","ò","ô","ö","õ")<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:442:hide' style='display: inline;'><br>                                                              VA evt_cPonto [AA01] = "O"</div><br>                                                        <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:444' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:444:hide' style='display: inline;'><br>                                                             <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:445' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_cPonto [AA01] is equal to ("Ú","Ù","Û","Ü")<br>                                                              Or VA evt_cPonto [AA01] is equal to ("ú","ù","û","ü")<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:445:hide' style='display: inline;'><br>                                                                   VA evt_cPonto [AA01] = "U"</div><br>                                                             <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:447' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:447:hide' style='display: inline;'><br>                                                                  <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:448' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_cPonto [AA01] is equal to VA evt_cPipe [AA01]<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:448:hide' style='display: inline;'><br>                                                                        VA evt_cPonto [AA01] = "!"</div><br>                                                                  <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:450' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:450:hide' style='display: inline;'><br>                                                                        VA evt_cPonto [AA01] = VA evt_cPipe [AA01]</div><br>                                                                   End If</div><br>                                                              End If</div><br>                                                         End If</div><br>                                                    End If</div><br>                                               End If</div><br>                                          End If</div><br>                                     End If</div><br>                                End If<span class='comment'><br>                                //</span><br>                               <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:461' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_i11 [INT01] is equal to VA evt_i12 [INT01]<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:461:hide' style='display: inline;'><br>                                    <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:462' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_cPonto [AA01] is equal to VA evt_cPipe [AA01]<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:462:hide' style='display: inline;'><span class='comment'><br>                                          // suprimir caracter</span><br>                                          VA evt_szSubString1 [DS02] = substr([BF szStringOut [DS02]], [VA evt_i0 [INT01]], [VA evt_i12 [INT01]])<span class='comment'><br>                                          //</span><br>                                          VA evt_iStart [INT01] = [VA evt_i12 [INT01]]+[VA evt_i1 [INT01]]<br>                                          VA evt_iSize [INT01] = [VA evt_i10 [INT01]]-[VA evt_i12 [INT01]]<br>                                          VA evt_szSubString2 [DS02] = substr([BF szStringOut [DS02]], [VA evt_iStart [INT01]], [VA evt_iSize [INT01]])<span class='comment'><br>                                          //</span><br>                                          BF szStringOut [DS02] = concat([VA evt_szSubString1 [DS02]], [VA evt_szSubString2 [DS02]])<span class='comment'><br>                                          //</span><br>                                          VA evt_i10 [INT01] = [VA evt_i10 [INT01]]-[VA evt_i1 [INT01]]</div><br>                                    <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:473' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:473:hide' style='display: inline;'><span class='comment'><br>                                          // substituir caracter</span><br>                                          VA evt_szSubString1 [DS02] = substr([BF szStringOut [DS02]], [VA evt_i0 [INT01]], [VA evt_i12 [INT01]])<span class='comment'><br>                                          //</span><br>                                          VA evt_iStart [INT01] = [VA evt_i12 [INT01]]+[VA evt_i1 [INT01]]<br>                                          VA evt_iSize [INT01] = [VA evt_i10 [INT01]]-[VA evt_i12 [INT01]]<br>                                          VA evt_szSubString2 [DS02] = substr([BF szStringOut [DS02]], [VA evt_iStart [INT01]], [VA evt_iSize [INT01]])<span class='comment'><br>                                          //</span><span class='comment'><br>                                          // no VA evt_cPonto vem o novo caracter para substituir o caracter inválido</span><br>                                          BF szStringOut [DS02] = concat([VA evt_szSubString1 [DS02]], [VA evt_cPonto [AA01]])<br>                                          BF szStringOut [DS02] = concat([BF szStringOut [DS02]], [VA evt_szSubString2 [DS02]])<span class='comment'><br>                                          //</span><br>                                          VA evt_i11 [INT01] = [VA evt_i11 [INT01]]+[VA evt_i1 [INT01]]<br>                                          VA evt_i12 [INT01] = VA evt_i11 [INT01]</div><br>                                     End If</div><br>                               <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:488' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:488:hide' style='display: inline;'><span class='comment'><br>                                     // caracter valido</span><br>                                     VA evt_i11 [INT01] = [VA evt_i11 [INT01]]+[VA evt_i1 [INT01]]</div><br>                                End If</div><br>                           End While</div><br>                     <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:493' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:493:hide' style='display: inline;'><br>                          <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:494' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If BF cTypeIn [ER001] is equal to "L"<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:494:hide' style='display: inline;'><span class='comment'><br>                                //</span><br>                               <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:496' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>While VA evt_i11 [INT01] is less than or equal to VA evt_i10 [INT01]<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:496:hide' style='display: inline;'><span class='comment'><br>                                     //</span><br>                                     VA evt_cPonto [AA01] = substr([BF szStringOut [DS02]], [VA evt_i11 [INT01]], [VA evt_i1 [INT01]])<br>                                     VA evt_sCaracter [BFSD] = substr([BF szStringOut [DS02]], [VA evt_i11 [INT01]], [VA evt_i1 [INT01]])<span class='comment'><br>                                     //</span><br>                                    <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:501' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_cPonto [AA01] is equal to &#60;Blank&#62;-"~"<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:501:hide' style='display: inline;'><br>                                         <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:502' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_cPonto [AA01] is equal to VA evt_cPipe [AA01]<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:502:hide' style='display: inline;'><br>                                               VA evt_cPonto [AA01] = "!"</div><br>                                         <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:504' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:504:hide' style='display: inline;'><br>                                              <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:505' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_cPonto [AA01] is equal to "&"<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:505:hide' style='display: inline;'><br>                                                    VA evt_cPonto [AA01] = "e"</div><br>                                              <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:507' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:507:hide' style='display: inline;'><br>                                                   <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:508' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_cPonto [AA01] is equal to ("[","{","&#60;")<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:508:hide' style='display: inline;'><br>                                                         VA evt_cPonto [AA01] = "("</div><br>                                                   <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:510' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:510:hide' style='display: inline;'><br>                                                        <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:511' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_cPonto [AA01] is equal to ("]","}","&#62;")<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:511:hide' style='display: inline;'><br>                                                              VA evt_cPonto [AA01] = ")"</div><br>                                                        <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:513' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:513:hide' style='display: inline;'><br>                                                             <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:514' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_cPonto [AA01] is equal to ";"<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:514:hide' style='display: inline;'><br>                                                                   VA evt_cPonto [AA01] = ","</div><br>                                                             <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:516' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:516:hide' style='display: inline;'><br>                                                                  <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:517' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_sCaracter [BFSD] is equal to VA evt_sBarra [BFSD]<br>                                                                   Or VA evt_sCaracter [BFSD] is equal to VA evt_sBarraInv [BFSD]<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:517:hide' style='display: inline;'><br>                                                                        VA evt_cPonto [AA01] = "-"</div><br>                                                                  <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:519' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:519:hide' style='display: inline;'><br>                                                                       <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:520' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_cPonto [AA01] is equal to "?"<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:520:hide' style='display: inline;'><span class='comment'><br>                                                                             // suprimir caracter</span><br>                                                                             VA evt_cPonto [AA01] = VA evt_cPipe [AA01]</div><br>                                                                       <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:523' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:523:hide' style='display: inline;'><br>                                                                            <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:524' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_cPonto [AA01] is equal to "`"<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:524:hide' style='display: inline;'><br>                                                                                  VA evt_cPonto [AA01] = VA evt_sApostrofe [BFSD]</div><br>                                                                            <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:526' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:526:hide' style='display: inline;'><br>                                                                                 <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:527' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_cPonto [AA01] is equal to ("^","~")<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:527:hide' style='display: inline;'><br>                                                                                       VA evt_cPonto [AA01] = "-"</div><br>                                                                                 <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:529' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:529:hide' style='display: inline;'><span class='comment'><br>                                                                                       // caracter valido</span><br>                                                                                       VA evt_i12 [INT01] = [VA evt_i12 [INT01]]+[VA evt_i1 [INT01]]</div><br>                                                                                  End If</div><br>                                                                             End If</div><br>                                                                        End If</div><br>                                                                   End If</div><br>                                                              End If</div><br>                                                         End If</div><br>                                                    End If</div><br>                                               End If</div><br>                                          End If</div><br>                                    <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:541' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:541:hide' style='display: inline;'><br>                                          VA evt_sCaracter [BFSD] = substr([BF szStringOut [DS02]], [VA evt_i11 [INT01]], [VA evt_i1 [INT01]])<br>                                         <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:543' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_sCaracter [BFSD] is equal to VA evt_sCCidilha [BFSD]<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:543:hide' style='display: inline;'><br>                                               VA evt_cPonto [AA01] = "C"</div><br>                                         <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:545' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:545:hide' style='display: inline;'><br>                                              <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:546' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_cPonto [AA01] is equal to ("Á","À","Â","Ä","Ã")<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:546:hide' style='display: inline;'><br>                                                    VA evt_cPonto [AA01] = "A"</div><br>                                              <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:548' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:548:hide' style='display: inline;'><br>                                                   <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:549' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_cPonto [AA01] is equal to ("É","È","Ê","Ë")<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:549:hide' style='display: inline;'><br>                                                         VA evt_cPonto [AA01] = "E"</div><br>                                                   <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:551' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:551:hide' style='display: inline;'><br>                                                        <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:552' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_cPonto [AA01] is equal to ("Í","Ì","Î","Ï")<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:552:hide' style='display: inline;'><br>                                                              VA evt_cPonto [AA01] = "I"</div><br>                                                        <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:554' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:554:hide' style='display: inline;'><br>                                                             <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:555' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_cPonto [AA01] is equal to ("Ó","Ò","Ô","Ö","Õ")<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:555:hide' style='display: inline;'><br>                                                                   VA evt_cPonto [AA01] = "O"</div><br>                                                             <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:557' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:557:hide' style='display: inline;'><br>                                                                  <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:558' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_cPonto [AA01] is equal to ("Ú","Ù","Û","Ü")<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:558:hide' style='display: inline;'><br>                                                                        VA evt_cPonto [AA01] = "U"</div><br>                                                                  <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:560' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:560:hide' style='display: inline;'><br>                                                                       <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:561' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_sCaracter [BFSD] is equal to VA evt_scCidilha [BFSD]<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:561:hide' style='display: inline;'><br>                                                                             VA evt_cPonto [AA01] = "c"</div><br>                                                                       <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:563' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:563:hide' style='display: inline;'><br>                                                                            <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:564' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_cPonto [AA01] is equal to ("ª","á","à","â","ä","ã")<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:564:hide' style='display: inline;'><br>                                                                                  VA evt_cPonto [AA01] = "a"</div><br>                                                                            <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:566' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:566:hide' style='display: inline;'><br>                                                                                 <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:567' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_cPonto [AA01] is equal to ("é","è","ê","ë")<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:567:hide' style='display: inline;'><br>                                                                                       VA evt_cPonto [AA01] = "e"</div><br>                                                                                 <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:569' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:569:hide' style='display: inline;'><br>                                                                                      <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:570' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_cPonto [AA01] is equal to ("í","ì","î","ï")<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:570:hide' style='display: inline;'><br>                                                                                            VA evt_cPonto [AA01] = "i"</div><br>                                                                                      <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:572' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:572:hide' style='display: inline;'><br>                                                                                           <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:573' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_cPonto [AA01] is equal to ("º","ó","ò","ô","ö","õ")<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:573:hide' style='display: inline;'><br>                                                                                                 VA evt_cPonto [AA01] = "o"</div><br>                                                                                           <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:575' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:575:hide' style='display: inline;'><br>                                                                                                <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:576' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_cPonto [AA01] is equal to ("ú","ù","û","ü")<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:576:hide' style='display: inline;'><br>                                                                                                      VA evt_cPonto [AA01] = "u"</div><br>                                                                                                <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:578' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:578:hide' style='display: inline;'><span class='comment'><br>                                                                                                      // suprimir caracter</span><br>                                                                                                      VA evt_cPonto [AA01] = VA evt_cPipe [AA01]</div><br>                                                                                                 End If</div><br>                                                                                            End If</div><br>                                                                                       End If</div><br>                                                                                  End If</div><br>                                                                             End If</div><br>                                                                        End If</div><br>                                                                   End If</div><br>                                                              End If</div><br>                                                         End If</div><br>                                                    End If</div><br>                                               End If</div><br>                                          End If</div><br>                                     End If<span class='comment'><br>                                     //</span><br>                                    <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:595' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_i11 [INT01] is equal to VA evt_i12 [INT01]<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:595:hide' style='display: inline;'><br>                                         <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:596' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_cPonto [AA01] is equal to VA evt_cPipe [AA01]<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:596:hide' style='display: inline;'><span class='comment'><br>                                               // suprimir caracter</span><br>                                               VA evt_szSubString1 [DS02] = substr([BF szStringOut [DS02]], [VA evt_i0 [INT01]], [VA evt_i12 [INT01]])<span class='comment'><br>                                               //</span><br>                                               VA evt_iStart [INT01] = [VA evt_i12 [INT01]]+[VA evt_i1 [INT01]]<br>                                               VA evt_iSize [INT01] = [VA evt_i10 [INT01]]-[VA evt_i12 [INT01]]<br>                                               VA evt_szSubString2 [DS02] = substr([BF szStringOut [DS02]], [VA evt_iStart [INT01]], [VA evt_iSize [INT01]])<span class='comment'><br>                                               //</span><br>                                               BF szStringOut [DS02] = concat([VA evt_szSubString1 [DS02]], [VA evt_szSubString2 [DS02]])<span class='comment'><br>                                               //</span><br>                                               VA evt_i10 [INT01] = [VA evt_i10 [INT01]]-[VA evt_i1 [INT01]]</div><br>                                         <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:607' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:607:hide' style='display: inline;'><span class='comment'><br>                                               // substituir caracter</span><br>                                               VA evt_szSubString1 [DS02] = substr([BF szStringOut [DS02]], [VA evt_i0 [INT01]], [VA evt_i12 [INT01]])<span class='comment'><br>                                               //</span><br>                                               VA evt_iStart [INT01] = [VA evt_i12 [INT01]]+[VA evt_i1 [INT01]]<br>                                               VA evt_iSize [INT01] = [VA evt_i10 [INT01]]-[VA evt_i12 [INT01]]<br>                                               VA evt_szSubString2 [DS02] = substr([BF szStringOut [DS02]], [VA evt_iStart [INT01]], [VA evt_iSize [INT01]])<span class='comment'><br>                                               //</span><span class='comment'><br>                                               // no VA evt_cPonto vem o novo caracter para substituir o caracter inválido</span><br>                                               BF szStringOut [DS02] = concat([VA evt_szSubString1 [DS02]], [VA evt_cPonto [AA01]])<br>                                               BF szStringOut [DS02] = concat([BF szStringOut [DS02]], [VA evt_szSubString2 [DS02]])<span class='comment'><br>                                               //</span><br>                                               VA evt_i11 [INT01] = [VA evt_i11 [INT01]]+[VA evt_i1 [INT01]]<br>                                               VA evt_i12 [INT01] = VA evt_i11 [INT01]</div><br>                                          End If</div><br>                                    <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:622' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:622:hide' style='display: inline;'><span class='comment'><br>                                          // caracter valido</span><br>                                          VA evt_i11 [INT01] = [VA evt_i11 [INT01]]+[VA evt_i1 [INT01]]</div><br>                                     End If</div><br>                                End While</div><br>                          <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:627' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:627:hide' style='display: inline;'><br>                               <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:628' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If BF cTypeIn [ER001] is equal to "I"<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:628:hide' style='display: inline;'><span class='comment'><br>                                     //</span><br>                                    <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:630' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>While VA evt_i11 [INT01] is less than or equal to VA evt_i10 [INT01]<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:630:hide' style='display: inline;'><span class='comment'><br>                                          //</span><br>                                          VA evt_cPonto [AA01] = substr([BF szStringOut [DS02]], [VA evt_i11 [INT01]], [VA evt_i1 [INT01]])<span class='comment'><br>                                          //</span><br>                                         <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:634' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_cPonto [AA01] is equal to &#60;Blank&#62;-"~"<br>                                          Or VA evt_cPonto [AA01] is equal to ("Á","À","Â","Ä","Ã","Ç","É","È","Ê","Ë","Í","Ì","Î","Ï","Ó","Ò","Ô","Ö","Õ","Ú","Ù","Û","Ü")<br>                                          Or VA evt_cPonto [AA01] is equal to ("ª","á","à","â","ä","ã","ç","é","è","ê","ë","í","ì","î","ï","º","ó","ò","ô","ö","õ","ú","ù","û","ü")<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:634:hide' style='display: inline;'><br>                                              <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:635' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_cPonto [AA01] is equal to VA evt_cPipe [AA01]<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:635:hide' style='display: inline;'><br>                                                    VA evt_cPonto [AA01] = "!"</div><br>                                              <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:637' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:637:hide' style='display: inline;'><br>                                                   <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:638' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_cPonto [AA01] is equal to VA evt_cAspas [AA01]<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:638:hide' style='display: inline;'><br>                                                         VA evt_cPonto [AA01] = [VA evt_sApostrofe [BFSD]]</div><br>                                                   <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:640' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:640:hide' style='display: inline;'><span class='comment'><br>                                                         // caracter valido</span><br>                                                         VA evt_i12 [INT01] = [VA evt_i12 [INT01]]+[VA evt_i1 [INT01]]</div><br>                                                    End If</div><br>                                               End If</div><br>                                         <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:645' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:645:hide' style='display: inline;'><br>                                               VA evt_cPonto [AA01] = VA evt_cPipe [AA01]</div><br>                                          End If<span class='comment'><br>                                          //</span><br>                                         <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:649' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_i11 [INT01] is equal to VA evt_i12 [INT01]<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:649:hide' style='display: inline;'><span class='comment'><br>                                               // caracter invalido ou substituido</span><br>                                               VA evt_szSubString1 [DS02] = substr([BF szStringOut [DS02]], [VA evt_i0 [INT01]], [VA evt_i12 [INT01]])<span class='comment'><br>                                               //</span><br>                                               VA evt_iStart [INT01] = [VA evt_i12 [INT01]]+[VA evt_i1 [INT01]]<br>                                               VA evt_iSize [INT01] = [VA evt_i10 [INT01]]-[VA evt_i12 [INT01]]<span class='comment'><br>                                               //</span><br>                                               VA evt_szSubString2 [DS02] = substr([BF szStringOut [DS02]], [VA evt_iStart [INT01]], [VA evt_iSize [INT01]])<span class='comment'><br>                                               //</span><br>                                              <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:658' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_cPonto [AA01] is equal to VA evt_cPipe [AA01]<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:658:hide' style='display: inline;'><span class='comment'><br>                                                    // suprimir caracter invalido</span><br>                                                    VA evt_i10 [INT01] = [VA evt_i10 [INT01]]-[VA evt_i1 [INT01]]</div><br>                                              <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:661' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:661:hide' style='display: inline;'><span class='comment'><br>                                                    // substituir caracter</span><span class='comment'><br>                                                    // no VA evt_cPonto vem o novo caracter para substituir o caracter inválido</span><br>                                                    VA evt_szSubString1 [DS02] = concat([VA evt_szSubString1 [DS02]], [VA evt_cPonto [AA01]])<span class='comment'><br>                                                    //</span><br>                                                    VA evt_i11 [INT01] = [VA evt_i11 [INT01]]+[VA evt_i1 [INT01]]<br>                                                    VA evt_i12 [INT01] = VA evt_i11 [INT01]</div><br>                                               End If<span class='comment'><br>                                               //</span><br>                                               BF szStringOut [DS02] = concat([VA evt_szSubString1 [DS02]], [VA evt_szSubString2 [DS02]])<span class='comment'><br>                                               //</span></div><br>                                         <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:672' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:672:hide' style='display: inline;'><span class='comment'><br>                                               // caracter valido</span><br>                                               VA evt_i11 [INT01] = [VA evt_i11 [INT01]]+[VA evt_i1 [INT01]]</div><br>                                          End If</div><br>                                     End While</div><br>                                End If</div><br>                           End If</div><br>                      End If</div><br>                 End If<br>                <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:681' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_BF_iSize [INT01] is equal to VA evt_i0 [INT01]<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:681:hide' style='display: inline;'><br>                     <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:682' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If BF cTypeIn [ER001] is not equal to "I"<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:682:hide' style='display: inline;'><br>                           BF szStringOut [DS02] = ltrim([BF szStringOut [DS02]], [VA evt_cBlank [AA01]])</div><br>                      End If<br>                      BF szStringOut [DS02] = rtrim([BF szStringOut [DS02]], [VA evt_cBlank [AA01]])</div><br>                <div id='c78771af-690b-40ad-93fe-fb6e61073e1c:686' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='c78771af-690b-40ad-93fe-fb6e61073e1c:686:hide' style='display: inline;'><br>                      BF szStringOut [DS02] = rpad([BF szStringOut [DS02]], [VA evt_cBlank [AA01]], [VA evt_BF_iSize [INT01]])<br>                      BF szStringOut [DS02] = substr([BF szStringOut [DS02]], [VA evt_i0 [INT01]], [VA evt_BF_iSize [INT01]])</div><br>                 End If</div><br>            End If</div><br>       End If</div><br>  End If<span class='comment'><br>  //</span><br>  BF mnSize [ITM] = [VA evt_BF_iSize [INT01]]<br>  BF mnNumDecimals [ITM] = [VA evt_BF_iNumDec [INT01]]<span class='comment'><br>  //</span></div></div><div class='section'>EVENTS<div class='objectheader'>NER: ConverteFormataDados <BR>Event GUID: bcbe61c8-1bb8-46be-aa88-a97297f61e16</div><div class='er'><div class='dstrmembers'><B>Data Structure: D5576B02 - Converte e Formata Dados                                    </B><BR>BF cFormat [EV01]<BR>BF mnNumberIn [MN29D9]<BR>BF jdDateIn [BRADLJ]<BR>BF szStringIn [TXVC]<BR>BF mnSizeOut [ITM]<BR>BF mnDecOut [ITM]<BR>BF szStringOut [TXVC]<BR></div>----------------------------------------</BR>Event Level Variables</BR>----------------------------------------</BR>evt_mnLength_ITM [ITM]<br>evt_cBlank_AA01 [AA01]<br>evt_szString_DS01 [DS01]<br>evt_mnPosInic_ITM [ITM]<br>evt_mnSize_ITM [ITM]<br>evt_mnQtdBlks_ITM [ITM]<br>evt_mnLenDS01_ITM [ITM]<br>evt_mnNumAux_ITM [ITM]<br>evt_szBlanks_DS01 [DS01]<br>----------------------------------------</BR><span class='comment'>  //</span><br> <div id='bcbe61c8-1bb8-46be-aa88-a97297f61e16:2' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If BF cFormat [EV01] is equal to ("C","I","L","M","S")<div id='bcbe61c8-1bb8-46be-aa88-a97297f61e16:2:hide' style='display: inline;'><span class='comment'><br>       //</span><span class='comment'><br>       // Tratar strings maiores de 80 posições (até 30.000 posições)</span><span class='comment'><br>       //</span><br>       VA evt_mnPosInic_ITM [ITM] = "0"<br>       VA evt_mnSize_ITM [ITM] = "80"<br>       VA evt_cBlank_AA01 [AA01] = &#60;Blank&#62;<span class='comment'><br>       //</span><br>       BF szStringOut [TXVC] = rtrim([BF szStringIn [TXVC]], [VA evt_cBlank_AA01 [AA01]])<br>       VA evt_mnLength_ITM [ITM] = length([BF szStringOut [TXVC]])<span class='comment'><br>       //</span><br>      <div id='bcbe61c8-1bb8-46be-aa88-a97297f61e16:13' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_mnLength_ITM [ITM] is less than or equal to VA evt_mnSize_ITM [ITM]<br>       Or BF mnSizeOut [ITM] is less than or equal to VA evt_mnSize_ITM [ITM]<br>       And BF mnSizeOut [ITM] is not equal to "0"<div id='bcbe61c8-1bb8-46be-aa88-a97297f61e16:13:hide' style='display: inline;'><span class='comment'><br>            // Se StringIn menor ou igual a 80 posições, usa direto a própria N5576B02</span><span class='comment'><br>            //</span><br>           <div id='bcbe61c8-1bb8-46be-aa88-a97297f61e16:16' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_mnLength_ITM [ITM] is greater than VA evt_mnSize_ITM [ITM]<br>            And BF cFormat [EV01] is not equal to "I"<div id='bcbe61c8-1bb8-46be-aa88-a97297f61e16:16:hide' style='display: inline;'><br>                 BF szStringOut [TXVC] = ltrim([BF szStringIn [TXVC]], [VA evt_cBlank_AA01 [AA01]])</div><br>           <div id='bcbe61c8-1bb8-46be-aa88-a97297f61e16:18' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='bcbe61c8-1bb8-46be-aa88-a97297f61e16:18:hide' style='display: inline;'><br>                 BF szStringOut [TXVC] = BF szStringIn [TXVC]</div><br>            End If<span class='comment'><br>            //</span><br>           <div id='bcbe61c8-1bb8-46be-aa88-a97297f61e16:22' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>ConvertandFormatDatas(N5576B02.ConvertandFormatDatas)<div id='bcbe61c8-1bb8-46be-aa88-a97297f61e16:22:hide' style='display: inline;'><span class='parameters'><br>                 BF szStringOut [TXVC] -&#62; szStringIn [DS01]<br>                 BF szStringOut [TXVC] &#60;- szStringOut [DS02]<br>                 BF mnSizeOut [ITM] -&#62; mnSize [ITM]<br>                 BF cFormat [EV01] -&#62; cTypeIn [ER001]</span></div><span class='comment'><br>            //</span></div><br>      <div id='bcbe61c8-1bb8-46be-aa88-a97297f61e16:24' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='bcbe61c8-1bb8-46be-aa88-a97297f61e16:24:hide' style='display: inline;'><span class='comment'><br>            //</span><br>            BF szStringOut [TXVC] = &#60;NULL&#62;<span class='comment'><br>            //</span><span class='comment'><br>            // Pega o primeiro substring</span><br>            VA evt_szString_DS01 [DS01] = substr([BF szStringIn [TXVC]], [VA evt_mnPosInic_ITM [ITM]], [VA evt_mnSize_ITM [ITM]])<span class='comment'><br>            //</span><br>           <div id='bcbe61c8-1bb8-46be-aa88-a97297f61e16:31' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>While VA evt_mnPosInic_ITM [ITM] is less than VA evt_mnLength_ITM [ITM]<div id='bcbe61c8-1bb8-46be-aa88-a97297f61e16:31:hide' style='display: inline;'><span class='comment'><br>                 //</span><span class='comment'><br>                 // Verifica a quantidade de brancos no final do substring (DS01)</span><br>                 VA evt_mnNumAux_ITM [ITM] = length([VA evt_szString_DS01 [DS01]])<br>                 VA evt_szString_DS01 [DS01] = rtrim([VA evt_szString_DS01 [DS01]], [VA evt_cBlank_AA01 [AA01]])<br>                 VA evt_mnLenDS01_ITM [ITM] = length([VA evt_szString_DS01 [DS01]])<span class='comment'><br>                 // Inicializa a mnQtdBlks com a quantidade de brancos no final do substring</span><br>                 VA evt_mnQtdBlks_ITM [ITM] = [VA evt_mnNumAux_ITM [ITM]]-[VA evt_mnLenDS01_ITM [ITM]]<span class='comment'><br>                 //</span><br>                <div id='bcbe61c8-1bb8-46be-aa88-a97297f61e16:40' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>ConvertandFormatDatas(N5576B02.ConvertandFormatDatas)<div id='bcbe61c8-1bb8-46be-aa88-a97297f61e16:40:hide' style='display: inline;'><span class='parameters'><br>                      VA evt_szString_DS01 [DS01] -&#62; szStringIn [DS01]<br>                      VA evt_szString_DS01 [DS01] &#60;- szStringOut [DS02]<br>                      BF cFormat [EV01] -&#62; cTypeIn [ER001]</span></div><span class='comment'><br>                 //</span><br>                 BF szStringOut [TXVC] = concat([BF szStringOut [TXVC]], [VA evt_szString_DS01 [DS01]])<span class='comment'><br>                 //</span><span class='comment'><br>                 // Avança para o próximo substring (DS01)</span><br>                 VA evt_mnPosInic_ITM [ITM] = [VA evt_mnPosInic_ITM [ITM]]+[VA evt_mnSize_ITM [ITM]]<br>                 VA evt_szString_DS01 [DS01] = substr([BF szStringIn [TXVC]], [VA evt_mnPosInic_ITM [ITM]], [VA evt_mnSize_ITM [ITM]])<span class='comment'><br>                 //</span><span class='comment'><br>                 // Verifica a quantidade de brancos no início do próximo substring (DS01)</span><br>                 VA evt_mnNumAux_ITM [ITM] = length([VA evt_szString_DS01 [DS01]])<br>                 VA evt_szString_DS01 [DS01] = ltrim([VA evt_szString_DS01 [DS01]], [VA evt_cBlank_AA01 [AA01]])<br>                 VA evt_mnLenDS01_ITM [ITM] = length([VA evt_szString_DS01 [DS01]])<br>                 VA evt_mnNumAux_ITM [ITM] = [VA evt_mnNumAux_ITM [ITM]]-[VA evt_mnLenDS01_ITM [ITM]]<span class='comment'><br>                 // Acumula na mnQtdBlks a quantidade de brancos do início e fim do substring</span><br>                 VA evt_mnQtdBlks_ITM [ITM] = [VA evt_mnQtdBlks_ITM [ITM]]+[VA evt_mnNumAux_ITM [ITM]]<span class='comment'><br>                 //</span><br>                 VA evt_mnNumAux_ITM [ITM] = "0"<br>                <div id='bcbe61c8-1bb8-46be-aa88-a97297f61e16:57' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_mnQtdBlks_ITM [ITM] is greater than VA evt_mnNumAux_ITM [ITM]<div id='bcbe61c8-1bb8-46be-aa88-a97297f61e16:57:hide' style='display: inline;'><span class='comment'><br>                      // Existe brancos na quebra dos substrings</span><br>                     <div id='bcbe61c8-1bb8-46be-aa88-a97297f61e16:59' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If BF cFormat [EV01] is equal to "S"<div id='bcbe61c8-1bb8-46be-aa88-a97297f61e16:59:hide' style='display: inline;'><span class='comment'><br>                           // O Formato S elimina os brancos duplos, logo, só concatena um branco</span><br>                           VA evt_szBlanks_DS01 [DS01] = &#60;Blank&#62;</div><br>                     <div id='bcbe61c8-1bb8-46be-aa88-a97297f61e16:62' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='bcbe61c8-1bb8-46be-aa88-a97297f61e16:62:hide' style='display: inline;'><br>                           VA evt_szBlanks_DS01 [DS01] = &#60;NULL&#62;<br>                           VA evt_szBlanks_DS01 [DS01] = rpad([VA evt_szBlanks_DS01 [DS01]], [VA evt_cBlank_AA01 [AA01]], [VA evt_mnQtdBlks_ITM [ITM]])</div><br>                      End If<span class='comment'><br>                      //</span><br>                      BF szStringOut [TXVC] = concat([BF szStringOut [TXVC]], [VA evt_szBlanks_DS01 [DS01]])<span class='comment'><br>                      //</span></div><br>                 End If<span class='comment'><br>                 //</span></div><br>            End While<span class='comment'><br>            //</span><span class='comment'><br>            // Ajusta o tamanho da Saída</span><br>            VA evt_mnSize_ITM [ITM] = "0"<br>           <div id='bcbe61c8-1bb8-46be-aa88-a97297f61e16:75' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If BF mnSizeOut [ITM] is equal to VA evt_mnSize_ITM [ITM]<div id='bcbe61c8-1bb8-46be-aa88-a97297f61e16:75:hide' style='display: inline;'><br>                 BF szStringOut [TXVC] = rtrim([BF szStringOut [TXVC]], [VA evt_cBlank_AA01 [AA01]])</div><br>           <div id='bcbe61c8-1bb8-46be-aa88-a97297f61e16:77' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='bcbe61c8-1bb8-46be-aa88-a97297f61e16:77:hide' style='display: inline;'><br>                 VA evt_mnLength_ITM [ITM] = length([BF szStringOut [TXVC]])<br>                <div id='bcbe61c8-1bb8-46be-aa88-a97297f61e16:79' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If BF mnSizeOut [ITM] is greater than VA evt_mnLength_ITM [ITM]<div id='bcbe61c8-1bb8-46be-aa88-a97297f61e16:79:hide' style='display: inline;'><br>                      BF szStringOut [TXVC] = rpad([BF szStringOut [TXVC]], [VA evt_cBlank_AA01 [AA01]], [BF mnSizeOut [ITM]])</div><br>                <div id='bcbe61c8-1bb8-46be-aa88-a97297f61e16:81' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='bcbe61c8-1bb8-46be-aa88-a97297f61e16:81:hide' style='display: inline;'><br>                     <div id='bcbe61c8-1bb8-46be-aa88-a97297f61e16:82' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If BF mnSizeOut [ITM] is less than VA evt_mnLength_ITM [ITM]<div id='bcbe61c8-1bb8-46be-aa88-a97297f61e16:82:hide' style='display: inline;'><br>                           BF szStringOut [TXVC] = substr([BF szStringOut [TXVC]], [VA evt_mnSize_ITM [ITM]], [BF mnSizeOut [ITM]])</div><br>                      End If</div><br>                 End If</div><br>            End If</div><br>       End If</div><br> <div id='bcbe61c8-1bb8-46be-aa88-a97297f61e16:88' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='bcbe61c8-1bb8-46be-aa88-a97297f61e16:88:hide' style='display: inline;'><span class='comment'><br>       // Se Format não String (Num/Dat/Hor), usa direto a própria N5576B02</span><br>      <div id='bcbe61c8-1bb8-46be-aa88-a97297f61e16:90' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>ConvertandFormatDatas(N5576B02.ConvertandFormatDatas)<div id='bcbe61c8-1bb8-46be-aa88-a97297f61e16:90:hide' style='display: inline;'><span class='parameters'><br>            BF szStringIn [TXVC] -&#62; szStringIn [DS01]<br>            BF szStringOut [TXVC] &#60;- szStringOut [DS02]<br>            BF mnDecOut [ITM] -&#62; mnNumDecimals [ITM]<br>            BF mnSizeOut [ITM] -&#62; mnSize [ITM]<br>            BF jdDateIn [BRADLJ] -&#62; jdDateIn [BRADLJ]<br>            BF cFormat [EV01] -&#62; cTypeIn [ER001]<br>            BF mnNumberIn [MN29D9] -&#62; mnNumberIn [MN29D9]</span></div></div><br>  End If<span class='comment'><br>  //</span></div></div><div class='section'>EVENTS<div class='objectheader'>NER: ConvertePeriodoInicioFimEmDatas <BR>Event GUID: 174052c5-88d7-4bb7-b27b-19bc7286d203</div><div class='er'><div class='dstrmembers'><B>Data Structure: D5576B02B - Converte Periodo Inicio e Fim em Datas                      </B><BR>BF mnCentury [CTRY]<BR>BF mnYear [FYEAR]<BR>BF mnFrPeriod [FRPE]<BR>BF mnToPeriod [TPN]<BR>BF jdBegDate [DTBG]<BR>BF jdEndDate [DTEN]<BR></div>----------------------------------------</BR>Event Level Variables</BR>----------------------------------------</BR>evt_mnNroAux [UKID]<br>evt_szData [AA08]<br>----------------------------------------</BR><span class='comment'>  // Converte Período "de - até" em Datas de Início e Fim</span><span class='comment'><br>  // Observações do Funcionamento:</span><span class='comment'><br>  // Século: opcional</span><span class='comment'><br>  // Ano: deve informar com 2 ou 4 dígitos</span><span class='comment'><br>  // Período De, se não informado não retorna da Data de Início</span><span class='comment'><br>  // Período Até, se não informado não retorna da Data de Fim</span><span class='comment'><br>  //</span><br>  VA evt_mnNroAux [UKID] = "99"<br> <div id='174052c5-88d7-4bb7-b27b-19bc7286d203:9' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If BF mnYear [FYEAR] is greater than VA evt_mnNroAux [UKID]<div id='174052c5-88d7-4bb7-b27b-19bc7286d203:9:hide' style='display: inline;'><span class='comment'><br>       // Ano com 4 dígitos</span></div><br> <div id='174052c5-88d7-4bb7-b27b-19bc7286d203:11' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='174052c5-88d7-4bb7-b27b-19bc7286d203:11:hide' style='display: inline;'><span class='comment'><br>       // Ano com 2 dígitos</span><br>       VA evt_mnNroAux [UKID] = "0"<br>      <div id='174052c5-88d7-4bb7-b27b-19bc7286d203:14' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If BF mnCentury [CTRY] is equal to VA evt_mnNroAux [UKID]<div id='174052c5-88d7-4bb7-b27b-19bc7286d203:14:hide' style='display: inline;'><span class='comment'><br>            // Século não informado, então assume cfe o Ano</span><br>            VA evt_mnNroAux [UKID] = "40"<br>           <div id='174052c5-88d7-4bb7-b27b-19bc7286d203:17' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If BF mnYear [FYEAR] is greater than VA evt_mnNroAux [UKID]<div id='174052c5-88d7-4bb7-b27b-19bc7286d203:17:hide' style='display: inline;'><span class='comment'><br>                 // Antes de 2000</span><br>                 BF mnCentury [CTRY] = "19"</div><br>           <div id='174052c5-88d7-4bb7-b27b-19bc7286d203:20' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='174052c5-88d7-4bb7-b27b-19bc7286d203:20:hide' style='display: inline;'><span class='comment'><br>                 // A partir de 2000</span><br>                 BF mnCentury [CTRY] = "20"</div><br>            End If</div><br>       End If<span class='comment'><br>       // Inclui Século no Ano</span><br>       VA evt_mnNroAux [UKID] = "100"<br>       VA evt_mnNroAux [UKID] = [BF mnCentury [CTRY]]*[VA evt_mnNroAux [UKID]]<br>       BF mnYear [FYEAR] = [VA evt_mnNroAux [UKID]]+[BF mnYear [FYEAR]]</div><br>  End If<span class='comment'><br>  //</span><br>  VA evt_mnNroAux [UKID] = "0"<br> <div id='174052c5-88d7-4bb7-b27b-19bc7286d203:32' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If BF mnFrPeriod [FRPE] is equal to VA evt_mnNroAux [UKID]<div id='174052c5-88d7-4bb7-b27b-19bc7286d203:32:hide' style='display: inline;'><br>       BF jdBegDate [DTBG] = &#60;NULL&#62;</div><br> <div id='174052c5-88d7-4bb7-b27b-19bc7286d203:34' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='174052c5-88d7-4bb7-b27b-19bc7286d203:34:hide' style='display: inline;'><br>       VA evt_szData [AA08] = lpad([BF mnFrPeriod [FRPE]], "0", "2")<br>       VA evt_szData [AA08] = concat([BF mnYear [FYEAR]], [VA evt_szData [AA08]])<br>       VA evt_szData [AA08] = concat([VA evt_szData [AA08]], "01")<br>      <div id='174052c5-88d7-4bb7-b27b-19bc7286d203:38' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>ConvertStringToDateUsingMask(B74I0010.ConvertStringToDateUsingMask)<div id='174052c5-88d7-4bb7-b27b-19bc7286d203:38:hide' style='display: inline;'><span class='parameters'><br>            BF jdBegDate [DTBG] &#60;- ConvertedDate [DRQJ]<br>            VA evt_szData [AA08] -&#62; StringToConvert [VC10A]<br>            "EOA" -&#62; FormatMask [VC09A]</span></div></div><br>  End If<span class='comment'><br>  //</span><br> <div id='174052c5-88d7-4bb7-b27b-19bc7286d203:41' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If BF mnToPeriod [TPN] is equal to VA evt_mnNroAux [UKID]<div id='174052c5-88d7-4bb7-b27b-19bc7286d203:41:hide' style='display: inline;'><br>       BF jdEndDate [DTEN] = &#60;NULL&#62;</div><br> <div id='174052c5-88d7-4bb7-b27b-19bc7286d203:43' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='174052c5-88d7-4bb7-b27b-19bc7286d203:43:hide' style='display: inline;'><br>       VA evt_szData [AA08] = lpad([BF mnToPeriod [TPN]], "0", "2")<br>       VA evt_szData [AA08] = concat([BF mnYear [FYEAR]], [VA evt_szData [AA08]])<br>       VA evt_szData [AA08] = concat([VA evt_szData [AA08]], "01")<br>      <div id='174052c5-88d7-4bb7-b27b-19bc7286d203:47' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>ConvertStringToDateUsingMask(B74I0010.ConvertStringToDateUsingMask)<div id='174052c5-88d7-4bb7-b27b-19bc7286d203:47:hide' style='display: inline;'><span class='parameters'><br>            BF jdEndDate [DTEN] &#60;- ConvertedDate [DRQJ]<br>            VA evt_szData [AA08] -&#62; StringToConvert [VC10A]<br>            "EOA" -&#62; FormatMask [VC09A]</span></div><br>       BF jdEndDate [DTEN] = last_day([BF jdEndDate [DTEN]])</div><br>  End If<span class='comment'><br>  //</span></div></div></body></html>