<!DOCTYPE html><html lang = "en"><head><meta charset = "utf-8"><meta name = "viewport" content = "width=device-width, initial-scale=1"><title>JDE Object Browser HTML Extract</title>
<style type='text/css'>body,th{font-family: Courier New, Courier, mono;font-size: 12px; width:auto}
.section{font-family: Arial, Helvetica, sans-serif;font-size: 12px;font-weight: bold;border: thin groove #CC9966;width: 100%;padding-left: 5px;padding-top: 5px;padding-bottom: 5px; padding-right: 5px; box-sizing: border-box }
.objectheader {font-family: Arial, Helvetica, sans-serif;font-size: 12px;font-weight: bold;border: thin groove #CC9966;width:auto;background-color: #FFFFCC;padding-left: 5px;padding-top: 5px;padding-bottom: 5px;padding-right: 5px; box-sizing: border-box }
.details{font-family: Arial, Helvetica, sans-serif;font-size: 11px;font-weight: normal;border: thin groove #CC9966;width:100%;padding-left: 5px;padding-top: 5px;padding-bottom: 5px;padding-right: 5px;box-sizing: border-box }
.er {background-color: #FFFFFF;font-family: Courier New, Courier, mono;font-size: 12px; font-weight: normal; border: thin solid #CCCCCC; width:auto; padding-left: 5px;padding-top: 5px;padding-bottom: 5px; padding-right: 5px; box-sizing: border-box }
.dstrmembers {background-color: #FFFDDD;font-family: Courier New, Courier, mono;font-size: 12px;border: thin groove #CC9966;padding-left: 5px;padding-top: 5px;padding-bottom: 5px;padding-right: 5px; box-sizing: border-box }
.disabled {font-family: Courier New, Courier, mono;font-size: 12px;	font-style: italic; color:#CC9933}
.parameters {font-family: Courier New, Courier, mono;font-size: 12px; color:#3333FF}
.comment {font-family: Courier New, Courier, mono;font-size: 12px;	color: #339933}
.subtable {font-family: Arial, Helvetica, sans-serif;font-size: 11px;font-weight: normal;width:100%}
.lineno {color:#6E6E6E;font-family: Courier New, Courier, mono;font-size: 12px; font-weight: normal;}
.iokey {color:#FF6905;font-family: Courier New, Courier, mono;font-size: 12px; font-weight: normal;}
.logicline {color:#000000;font-family: Courier New, Courier, mono;font-size: 12px; font-weight: normal;}
.versionoverride {background-color: #FFCC99;}
.overrideflags{font-family: Arial, Helvetica, sans-serif;font-size: 11px;font-weight: normal;border: thin groove #CC9966;width:auto;padding-left: 5px;padding-top: 5px;padding-bottom: 5px;padding-right: 5px; background-color: #FFCC99; box-sizing: border-box }
.bsfnprops {font-family: Courier New, Courier, mono;font-size: 12px; color:#E01B4C}
.searchresult {font-family: Courier New, Courier, mono;font-size: 12px; font-weight: bold; background-color:#8BF3A0}
.expand {font-family: Courier New, Courier, mono;font-size: 11px; font-weight: bold; cursor:pointer; border: 1px solid gray; position: relative; left: -3px; display:inline; line-height:8px;}
.expand2 { display:inline; cursor:pointer; font-size: 9px; border: 1px solid gray; position: relative; left: -3px;}
</style>
<script type='text/javascript'>function load(){location.href = '#result';}</script>
<script language='JavaScript' type='text/javascript'>function ExpandCollapse(ElementId){ var ClickedElement = document.getElementById(ElementId); var SectionName = ElementId + ':hide'; var Section = document.getElementById(SectionName); if (ClickedElement.innerHTML == '-') { 	 ClickedElement.innerHTML = '+';	Section.style.display = 'none'; }  else  { 		ClickedElement.innerHTML = '-'; 	Section.style.display = 'inline';}} </script>
<base target = "_parent"></head><body onload='load()'>
<div class ='objectheader'>Business Function: N5576B09 - Calcula e Grava o PIS, a COFINS e as Retenções<BR>Function Type: NER</div><div class='section'>EVENTS<div class='objectheader'>NER: AcumulaGravaImpostosHeader <BR>Event GUID: 2aef6aeb-50bb-400d-a605-e9341550b3ca</div><div class='er'><div class='dstrmembers'><B>Data Structure: D5576B10 - Calcula e Grava o PIS, a COFINS e as Retenções              </B><BR>BF cTransactionCode [EV01]<BR>BF cErrorCode [ERRC]<BR>BF mnNotaFiscalNumber [BNNF]<BR>BF szNotaFiscalSeries [BSER]<BR>BF mnNextNumber001 [N001]<BR>BF szDocumentType [DCT]<BR>BF szBrazilTaxType [55BRTX]<BR>BF mnBrazilTaxBasis_Acm [55BRTXB]<BR>BF mnBrazilTaxAmount_Acm [55BRTXA]<BR></div>----------------------------------------</BR>Event Level Variables</BR>----------------------------------------</BR>evt_BrazilTaxBasis_55BRTXB [55BRTXB]<br>evt_BrazilTaxAmount_55BRTXA [55BRTXA]<br>evt_WorkStationId [JOBN]<br>evt_ProgramId [PID]<br>evt_TimeLastUpdated [UPMT]<br>evt_FutureUseMathNumeric1 [N1FU]<br>evt_FutureUseMathNumeric9 [55N9FU]<br>evt_FutureUseMathNumeric1_Acm [N1FU]<br>evt_FutureUseMathNumeric9_Acm [55N9FU]<br>evt_mnZero [55BRTXA]<br>evt_FutureUseMathNumeric10 [55N10FU]<br>evt_FutureUseMathNumeric10_Acm [55N10FU]<br>----------------------------------------</BR><span class='comment'>  //</span><br> <div id='2aef6aeb-50bb-400d-a605-e9341550b3ca:2' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>GetAuditInfo(B9800100.GetAuditInfo)<div id='2aef6aeb-50bb-400d-a605-e9341550b3ca:2:hide' style='display: inline;'><span class='parameters'><br>       UNDEFINED &#60;&#62; szUserName [USER]<br>       UNDEFINED &#60;&#62; jdDate [DTE]<br>       VA evt_TimeLastUpdated [UPMT] &#60;- mnTime [TME0]<br>       VA evt_WorkStationId [JOBN] &#60;- szWorkstation_UserId [JOBN]</span></div><br>  VA evt_ProgramId [PID] = "N5576B09"<span class='comment'><br>  //</span><span class='comment'><br>  // PIS</span><br>  BF mnBrazilTaxBasis_Acm [55BRTXB] = 0<br>  BF mnBrazilTaxAmount_Acm [55BRTXA] = 0<br>  BF szBrazilTaxType [55BRTX] = "05"<br> <div id='2aef6aeb-50bb-400d-a605-e9341550b3ca:9' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5576B11.Select  [Index 1: Nota Fiscal Number, +]<div id='2aef6aeb-50bb-400d-a605-e9341550b3ca:9:hide' style='display: inline;'><br>       <span class='iokey'>BF mnNotaFiscalNumber [BNNF] = TK Nota Fiscal Number [BNNF]</span><br>       <span class='iokey'>BF szNotaFiscalSeries [BSER] = TK Nota Fiscal Series [BSER]</span><br>       <span class='iokey'>BF mnNextNumber001 [N001] = TK Next Number Range 1 [N001]</span><br>       <span class='iokey'>BF szDocumentType [DCT] = TK Document Type [DCT]</span><br>       <span class='iokey'>BF szBrazilTaxType [55BRTX] = TK Tax Type - Brazil [55BRTX]</span></div><br> <div id='2aef6aeb-50bb-400d-a605-e9341550b3ca:10' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5576B11.FetchNext  [Index 1: Nota Fiscal Number, +]<div id='2aef6aeb-50bb-400d-a605-e9341550b3ca:10:hide' style='display: inline;'><br>       VA evt_BrazilTaxBasis_55BRTXB [55BRTXB] &#60;- TK Tax Basis - Brazil [55BRTXB]<br>       VA evt_BrazilTaxAmount_55BRTXA [55BRTXA] &#60;- TK Tax Amount - Brazil [55BRTXA]</div><br> <div id='2aef6aeb-50bb-400d-a605-e9341550b3ca:11' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>While SV File_IO_Status is equal to CO SUCCESS<div id='2aef6aeb-50bb-400d-a605-e9341550b3ca:11:hide' style='display: inline;'><br>       BF mnBrazilTaxBasis_Acm [55BRTXB] = [BF mnBrazilTaxBasis_Acm [55BRTXB]]+[VA evt_BrazilTaxBasis_55BRTXB [55BRTXB]]<br>       BF mnBrazilTaxAmount_Acm [55BRTXA] = [BF mnBrazilTaxAmount_Acm [55BRTXA]]+[VA evt_BrazilTaxAmount_55BRTXA [55BRTXA]]<br>      <div id='2aef6aeb-50bb-400d-a605-e9341550b3ca:14' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5576B11.FetchNext  [Index 1: Nota Fiscal Number, +]<div id='2aef6aeb-50bb-400d-a605-e9341550b3ca:14:hide' style='display: inline;'><br>            VA evt_BrazilTaxBasis_55BRTXB [55BRTXB] &#60;- TK Tax Basis - Brazil [55BRTXB]<br>            VA evt_BrazilTaxAmount_55BRTXA [55BRTXA] &#60;- TK Tax Amount - Brazil [55BRTXA]</div></div><br>  End While<br> <div id='2aef6aeb-50bb-400d-a605-e9341550b3ca:16' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5576B01.FetchSingle  [Index 1: Nota Fiscal Number, +]<div id='2aef6aeb-50bb-400d-a605-e9341550b3ca:16:hide' style='display: inline;'><br>       <span class='iokey'>BF mnNotaFiscalNumber [BNNF] = TK Nota Fiscal Number [BNNF]</span><br>       <span class='iokey'>BF szNotaFiscalSeries [BSER] = TK Nota Fiscal Series [BSER]</span><br>       <span class='iokey'>BF mnNextNumber001 [N001] = TK Next Number Range 1 [N001]</span><br>       <span class='iokey'>BF szDocumentType [DCT] = TK Document Type [DCT]</span><br>       <span class='iokey'>BF szBrazilTaxType [55BRTX] = TK Tax Type - Brazil [55BRTX]</span></div><br> <div id='2aef6aeb-50bb-400d-a605-e9341550b3ca:17' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If BF mnBrazilTaxBasis_Acm [55BRTXB] is not equal to VA evt_mnZero [55BRTXA]<br>  Or BF mnBrazilTaxAmount_Acm [55BRTXA] is not equal to VA evt_mnZero [55BRTXA]<div id='2aef6aeb-50bb-400d-a605-e9341550b3ca:17:hide' style='display: inline;'><br>      <div id='2aef6aeb-50bb-400d-a605-e9341550b3ca:18' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If SV File_IO_Status is equal to CO SUCCESS<div id='2aef6aeb-50bb-400d-a605-e9341550b3ca:18:hide' style='display: inline;'><br>           <div id='2aef6aeb-50bb-400d-a605-e9341550b3ca:19' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5576B01.Update  [Index 1: Nota Fiscal Number, +]<div id='2aef6aeb-50bb-400d-a605-e9341550b3ca:19:hide' style='display: inline;'><br>                 <span class='iokey'>BF mnNotaFiscalNumber [BNNF] = TK Nota Fiscal Number [BNNF]</span><br>                 <span class='iokey'>BF szNotaFiscalSeries [BSER] = TK Nota Fiscal Series [BSER]</span><br>                 <span class='iokey'>BF mnNextNumber001 [N001] = TK Next Number Range 1 [N001]</span><br>                 <span class='iokey'>BF szDocumentType [DCT] = TK Document Type [DCT]</span><br>                 <span class='iokey'>BF szBrazilTaxType [55BRTX] = TK Tax Type - Brazil [55BRTX]</span><br>                 BF mnBrazilTaxBasis_Acm [55BRTXB] -&#62; TK Tax Basis - Brazil [55BRTXB]<br>                 BF mnBrazilTaxAmount_Acm [55BRTXA] -&#62; TK Tax Amount - Brazil [55BRTXA]<br>                 SL UserID -&#62; TK Transaction Originator [TORG]<br>                 SL UserID -&#62; TK User ID [USER]<br>                 VA evt_ProgramId [PID] -&#62; TK Program ID [PID]<br>                 VA evt_WorkStationId [JOBN] -&#62; TK Work Station ID [JOBN]<br>                 SL DateToday -&#62; TK Date - Updated [UPMJ]<br>                 VA evt_TimeLastUpdated [UPMT] -&#62; TK Time - Last Updated [UPMT]</div></div><br>      <div id='2aef6aeb-50bb-400d-a605-e9341550b3ca:20' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='2aef6aeb-50bb-400d-a605-e9341550b3ca:20:hide' style='display: inline;'><br>           <div id='2aef6aeb-50bb-400d-a605-e9341550b3ca:21' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5576B01.Insert  [Index 1: Nota Fiscal Number, +]<div id='2aef6aeb-50bb-400d-a605-e9341550b3ca:21:hide' style='display: inline;'><br>                 BF mnNotaFiscalNumber [BNNF] -&#62; TK Nota Fiscal Number [BNNF]<br>                 BF szNotaFiscalSeries [BSER] -&#62; TK Nota Fiscal Series [BSER]<br>                 BF mnNextNumber001 [N001] -&#62; TK Next Number Range 1 [N001]<br>                 BF szDocumentType [DCT] -&#62; TK Document Type [DCT]<br>                 BF szBrazilTaxType [55BRTX] -&#62; TK Tax Type - Brazil [55BRTX]<br>                 BF mnBrazilTaxBasis_Acm [55BRTXB] -&#62; TK Tax Basis - Brazil [55BRTXB]<br>                 BF mnBrazilTaxAmount_Acm [55BRTXA] -&#62; TK Tax Amount - Brazil [55BRTXA]<br>                 SL UserID -&#62; TK Transaction Originator [TORG]<br>                 SL UserID -&#62; TK User ID [USER]<br>                 VA evt_ProgramId [PID] -&#62; TK Program ID [PID]<br>                 VA evt_WorkStationId [JOBN] -&#62; TK Work Station ID [JOBN]<br>                 SL DateToday -&#62; TK Date - Updated [UPMJ]<br>                 VA evt_TimeLastUpdated [UPMT] -&#62; TK Time - Last Updated [UPMT]</div></div><br>       End If</div><br> <div id='2aef6aeb-50bb-400d-a605-e9341550b3ca:23' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='2aef6aeb-50bb-400d-a605-e9341550b3ca:23:hide' style='display: inline;'><br>      <div id='2aef6aeb-50bb-400d-a605-e9341550b3ca:24' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If SV File_IO_Status is equal to CO SUCCESS<div id='2aef6aeb-50bb-400d-a605-e9341550b3ca:24:hide' style='display: inline;'><br>           <div id='2aef6aeb-50bb-400d-a605-e9341550b3ca:25' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5576B01.Delete  [Index 1: Nota Fiscal Number, +]<div id='2aef6aeb-50bb-400d-a605-e9341550b3ca:25:hide' style='display: inline;'><br>                 <span class='iokey'>BF mnNotaFiscalNumber [BNNF] = TK Nota Fiscal Number [BNNF]</span><br>                 <span class='iokey'>BF szNotaFiscalSeries [BSER] = TK Nota Fiscal Series [BSER]</span><br>                 <span class='iokey'>BF mnNextNumber001 [N001] = TK Next Number Range 1 [N001]</span><br>                 <span class='iokey'>BF szDocumentType [DCT] = TK Document Type [DCT]</span><br>                 <span class='iokey'>BF szBrazilTaxType [55BRTX] = TK Tax Type - Brazil [55BRTX]</span></div></div><br>       End If</div><br>  End If<span class='comment'><br>  //</span><span class='comment'><br>  // COFINS</span><br>  BF mnBrazilTaxBasis_Acm [55BRTXB] = 0<br>  BF mnBrazilTaxAmount_Acm [55BRTXA] = 0<br>  BF szBrazilTaxType [55BRTX] = "06"<br> <div id='2aef6aeb-50bb-400d-a605-e9341550b3ca:33' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5576B11.Select  [Index 1: Nota Fiscal Number, +]<div id='2aef6aeb-50bb-400d-a605-e9341550b3ca:33:hide' style='display: inline;'><br>       <span class='iokey'>BF mnNotaFiscalNumber [BNNF] = TK Nota Fiscal Number [BNNF]</span><br>       <span class='iokey'>BF szNotaFiscalSeries [BSER] = TK Nota Fiscal Series [BSER]</span><br>       <span class='iokey'>BF mnNextNumber001 [N001] = TK Next Number Range 1 [N001]</span><br>       <span class='iokey'>BF szDocumentType [DCT] = TK Document Type [DCT]</span><br>       <span class='iokey'>BF szBrazilTaxType [55BRTX] = TK Tax Type - Brazil [55BRTX]</span></div><br> <div id='2aef6aeb-50bb-400d-a605-e9341550b3ca:34' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5576B11.FetchNext  [Index 1: Nota Fiscal Number, +]<div id='2aef6aeb-50bb-400d-a605-e9341550b3ca:34:hide' style='display: inline;'><br>       VA evt_BrazilTaxBasis_55BRTXB [55BRTXB] &#60;- TK Tax Basis - Brazil [55BRTXB]<br>       VA evt_BrazilTaxAmount_55BRTXA [55BRTXA] &#60;- TK Tax Amount - Brazil [55BRTXA]</div><br> <div id='2aef6aeb-50bb-400d-a605-e9341550b3ca:35' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>While SV File_IO_Status is equal to CO SUCCESS<div id='2aef6aeb-50bb-400d-a605-e9341550b3ca:35:hide' style='display: inline;'><br>       BF mnBrazilTaxBasis_Acm [55BRTXB] = [BF mnBrazilTaxBasis_Acm [55BRTXB]]+[VA evt_BrazilTaxBasis_55BRTXB [55BRTXB]]<br>       BF mnBrazilTaxAmount_Acm [55BRTXA] = [BF mnBrazilTaxAmount_Acm [55BRTXA]]+[VA evt_BrazilTaxAmount_55BRTXA [55BRTXA]]<br>      <div id='2aef6aeb-50bb-400d-a605-e9341550b3ca:38' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5576B11.FetchNext  [Index 1: Nota Fiscal Number, +]<div id='2aef6aeb-50bb-400d-a605-e9341550b3ca:38:hide' style='display: inline;'><br>            VA evt_BrazilTaxBasis_55BRTXB [55BRTXB] &#60;- TK Tax Basis - Brazil [55BRTXB]<br>            VA evt_BrazilTaxAmount_55BRTXA [55BRTXA] &#60;- TK Tax Amount - Brazil [55BRTXA]</div></div><br>  End While<br> <div id='2aef6aeb-50bb-400d-a605-e9341550b3ca:40' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5576B01.FetchSingle  [Index 1: Nota Fiscal Number, +]<div id='2aef6aeb-50bb-400d-a605-e9341550b3ca:40:hide' style='display: inline;'><br>       <span class='iokey'>BF mnNotaFiscalNumber [BNNF] = TK Nota Fiscal Number [BNNF]</span><br>       <span class='iokey'>BF szNotaFiscalSeries [BSER] = TK Nota Fiscal Series [BSER]</span><br>       <span class='iokey'>BF mnNextNumber001 [N001] = TK Next Number Range 1 [N001]</span><br>       <span class='iokey'>BF szDocumentType [DCT] = TK Document Type [DCT]</span><br>       <span class='iokey'>BF szBrazilTaxType [55BRTX] = TK Tax Type - Brazil [55BRTX]</span></div><br> <div id='2aef6aeb-50bb-400d-a605-e9341550b3ca:41' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If BF mnBrazilTaxBasis_Acm [55BRTXB] is not equal to VA evt_mnZero [55BRTXA]<br>  Or BF mnBrazilTaxAmount_Acm [55BRTXA] is not equal to VA evt_mnZero [55BRTXA]<div id='2aef6aeb-50bb-400d-a605-e9341550b3ca:41:hide' style='display: inline;'><br>      <div id='2aef6aeb-50bb-400d-a605-e9341550b3ca:42' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If SV File_IO_Status is equal to CO SUCCESS<div id='2aef6aeb-50bb-400d-a605-e9341550b3ca:42:hide' style='display: inline;'><br>           <div id='2aef6aeb-50bb-400d-a605-e9341550b3ca:43' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5576B01.Update  [Index 1: Nota Fiscal Number, +]<div id='2aef6aeb-50bb-400d-a605-e9341550b3ca:43:hide' style='display: inline;'><br>                 <span class='iokey'>BF mnNotaFiscalNumber [BNNF] = TK Nota Fiscal Number [BNNF]</span><br>                 <span class='iokey'>BF szNotaFiscalSeries [BSER] = TK Nota Fiscal Series [BSER]</span><br>                 <span class='iokey'>BF mnNextNumber001 [N001] = TK Next Number Range 1 [N001]</span><br>                 <span class='iokey'>BF szDocumentType [DCT] = TK Document Type [DCT]</span><br>                 <span class='iokey'>BF szBrazilTaxType [55BRTX] = TK Tax Type - Brazil [55BRTX]</span><br>                 BF mnBrazilTaxBasis_Acm [55BRTXB] -&#62; TK Tax Basis - Brazil [55BRTXB]<br>                 BF mnBrazilTaxAmount_Acm [55BRTXA] -&#62; TK Tax Amount - Brazil [55BRTXA]<br>                 SL UserID -&#62; TK Transaction Originator [TORG]<br>                 SL UserID -&#62; TK User ID [USER]<br>                 VA evt_ProgramId [PID] -&#62; TK Program ID [PID]<br>                 VA evt_WorkStationId [JOBN] -&#62; TK Work Station ID [JOBN]<br>                 SL DateToday -&#62; TK Date - Updated [UPMJ]<br>                 VA evt_TimeLastUpdated [UPMT] -&#62; TK Time - Last Updated [UPMT]</div></div><br>      <div id='2aef6aeb-50bb-400d-a605-e9341550b3ca:44' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='2aef6aeb-50bb-400d-a605-e9341550b3ca:44:hide' style='display: inline;'><br>           <div id='2aef6aeb-50bb-400d-a605-e9341550b3ca:45' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5576B01.Insert  [Index 1: Nota Fiscal Number, +]<div id='2aef6aeb-50bb-400d-a605-e9341550b3ca:45:hide' style='display: inline;'><br>                 BF mnNotaFiscalNumber [BNNF] -&#62; TK Nota Fiscal Number [BNNF]<br>                 BF szNotaFiscalSeries [BSER] -&#62; TK Nota Fiscal Series [BSER]<br>                 BF mnNextNumber001 [N001] -&#62; TK Next Number Range 1 [N001]<br>                 BF szDocumentType [DCT] -&#62; TK Document Type [DCT]<br>                 BF szBrazilTaxType [55BRTX] -&#62; TK Tax Type - Brazil [55BRTX]<br>                 BF mnBrazilTaxBasis_Acm [55BRTXB] -&#62; TK Tax Basis - Brazil [55BRTXB]<br>                 BF mnBrazilTaxAmount_Acm [55BRTXA] -&#62; TK Tax Amount - Brazil [55BRTXA]<br>                 SL UserID -&#62; TK Transaction Originator [TORG]<br>                 SL UserID -&#62; TK User ID [USER]<br>                 VA evt_ProgramId [PID] -&#62; TK Program ID [PID]<br>                 VA evt_WorkStationId [JOBN] -&#62; TK Work Station ID [JOBN]<br>                 SL DateToday -&#62; TK Date - Updated [UPMJ]<br>                 VA evt_TimeLastUpdated [UPMT] -&#62; TK Time - Last Updated [UPMT]</div></div><br>       End If</div><br> <div id='2aef6aeb-50bb-400d-a605-e9341550b3ca:47' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='2aef6aeb-50bb-400d-a605-e9341550b3ca:47:hide' style='display: inline;'><br>      <div id='2aef6aeb-50bb-400d-a605-e9341550b3ca:48' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If SV File_IO_Status is equal to CO SUCCESS<div id='2aef6aeb-50bb-400d-a605-e9341550b3ca:48:hide' style='display: inline;'><br>           <div id='2aef6aeb-50bb-400d-a605-e9341550b3ca:49' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5576B01.Delete  [Index 1: Nota Fiscal Number, +]<div id='2aef6aeb-50bb-400d-a605-e9341550b3ca:49:hide' style='display: inline;'><br>                 <span class='iokey'>BF mnNotaFiscalNumber [BNNF] = TK Nota Fiscal Number [BNNF]</span><br>                 <span class='iokey'>BF szNotaFiscalSeries [BSER] = TK Nota Fiscal Series [BSER]</span><br>                 <span class='iokey'>BF mnNextNumber001 [N001] = TK Next Number Range 1 [N001]</span><br>                 <span class='iokey'>BF szDocumentType [DCT] = TK Document Type [DCT]</span><br>                 <span class='iokey'>BF szBrazilTaxType [55BRTX] = TK Tax Type - Brazil [55BRTX]</span></div></div><br>       End If</div><br>  End If<span class='comment'><br>  //</span><span class='comment'><br>  // ICMS Interestadual (Partilha do ICMS com UF de Destino)</span><br>  BF mnBrazilTaxBasis_Acm [55BRTXB] = 0<br>  BF mnBrazilTaxAmount_Acm [55BRTXA] = 0<br>  BF szBrazilTaxType [55BRTX] = "55"<br> <div id='2aef6aeb-50bb-400d-a605-e9341550b3ca:57' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5576B11.Select  [Index 1: Nota Fiscal Number, +]<div id='2aef6aeb-50bb-400d-a605-e9341550b3ca:57:hide' style='display: inline;'><br>       <span class='iokey'>BF mnNotaFiscalNumber [BNNF] = TK Nota Fiscal Number [BNNF]</span><br>       <span class='iokey'>BF szNotaFiscalSeries [BSER] = TK Nota Fiscal Series [BSER]</span><br>       <span class='iokey'>BF mnNextNumber001 [N001] = TK Next Number Range 1 [N001]</span><br>       <span class='iokey'>BF szDocumentType [DCT] = TK Document Type [DCT]</span><br>       <span class='iokey'>BF szBrazilTaxType [55BRTX] = TK Tax Type - Brazil [55BRTX]</span></div><br> <div id='2aef6aeb-50bb-400d-a605-e9341550b3ca:58' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5576B11.FetchNext  [Index 1: Nota Fiscal Number, +]<div id='2aef6aeb-50bb-400d-a605-e9341550b3ca:58:hide' style='display: inline;'><br>       VA evt_BrazilTaxBasis_55BRTXB [55BRTXB] &#60;- TK Tax Basis - Brazil [55BRTXB]<br>       VA evt_BrazilTaxAmount_55BRTXA [55BRTXA] &#60;- TK Tax Amount - Brazil [55BRTXA]<br>       VA evt_FutureUseMathNumeric1 [N1FU] &#60;- TK Future Use - Math Numeric 1 [N1FU]<br>       VA evt_FutureUseMathNumeric9 [55N9FU] &#60;- TK Future Use - Math Numeric 9 [55N9FU]<br>       VA evt_FutureUseMathNumeric10 [55N10FU] &#60;- TK Future Use - Math Numeric 10 [55N10FU]</div><br> <div id='2aef6aeb-50bb-400d-a605-e9341550b3ca:59' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>While SV File_IO_Status is equal to CO SUCCESS<div id='2aef6aeb-50bb-400d-a605-e9341550b3ca:59:hide' style='display: inline;'><br>       BF mnBrazilTaxBasis_Acm [55BRTXB] = [BF mnBrazilTaxBasis_Acm [55BRTXB]]+[VA evt_BrazilTaxBasis_55BRTXB [55BRTXB]]<br>       BF mnBrazilTaxAmount_Acm [55BRTXA] = [BF mnBrazilTaxAmount_Acm [55BRTXA]]+[VA evt_BrazilTaxAmount_55BRTXA [55BRTXA]]<br>       VA evt_FutureUseMathNumeric1_Acm [N1FU] = [VA evt_FutureUseMathNumeric1_Acm [N1FU]]+[VA evt_FutureUseMathNumeric1 [N1FU]]<br>       VA evt_FutureUseMathNumeric9_Acm [55N9FU] = [VA evt_FutureUseMathNumeric9_Acm [55N9FU]]+[VA evt_FutureUseMathNumeric9 [55N9FU]]<br>       VA evt_FutureUseMathNumeric10_Acm [55N10FU] = [VA evt_FutureUseMathNumeric10_Acm [55N10FU]]+[VA evt_FutureUseMathNumeric10 [55N10FU]]<br>      <div id='2aef6aeb-50bb-400d-a605-e9341550b3ca:65' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5576B11.FetchNext  [Index 1: Nota Fiscal Number, +]<div id='2aef6aeb-50bb-400d-a605-e9341550b3ca:65:hide' style='display: inline;'><br>            VA evt_BrazilTaxBasis_55BRTXB [55BRTXB] &#60;- TK Tax Basis - Brazil [55BRTXB]<br>            VA evt_BrazilTaxAmount_55BRTXA [55BRTXA] &#60;- TK Tax Amount - Brazil [55BRTXA]<br>            VA evt_FutureUseMathNumeric1 [N1FU] &#60;- TK Future Use - Math Numeric 1 [N1FU]<br>            VA evt_FutureUseMathNumeric9 [55N9FU] &#60;- TK Future Use - Math Numeric 9 [55N9FU]<br>            VA evt_FutureUseMathNumeric10 [55N10FU] &#60;- TK Future Use - Math Numeric 10 [55N10FU]</div></div><br>  End While<br> <div id='2aef6aeb-50bb-400d-a605-e9341550b3ca:67' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5576B01.FetchSingle  [Index 1: Nota Fiscal Number, +]<div id='2aef6aeb-50bb-400d-a605-e9341550b3ca:67:hide' style='display: inline;'><br>       <span class='iokey'>BF mnNotaFiscalNumber [BNNF] = TK Nota Fiscal Number [BNNF]</span><br>       <span class='iokey'>BF szNotaFiscalSeries [BSER] = TK Nota Fiscal Series [BSER]</span><br>       <span class='iokey'>BF mnNextNumber001 [N001] = TK Next Number Range 1 [N001]</span><br>       <span class='iokey'>BF szDocumentType [DCT] = TK Document Type [DCT]</span><br>       <span class='iokey'>BF szBrazilTaxType [55BRTX] = TK Tax Type - Brazil [55BRTX]</span></div><br> <div id='2aef6aeb-50bb-400d-a605-e9341550b3ca:68' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If BF mnBrazilTaxBasis_Acm [55BRTXB] is not equal to VA evt_mnZero [55BRTXA]<br>  Or BF mnBrazilTaxAmount_Acm [55BRTXA] is not equal to VA evt_mnZero [55BRTXA]<br>  Or VA evt_FutureUseMathNumeric1_Acm [N1FU] is not equal to VA evt_mnZero [55BRTXA]<br>  Or VA evt_FutureUseMathNumeric9_Acm [55N9FU] is not equal to VA evt_mnZero [55BRTXA]<br>  Or VA evt_FutureUseMathNumeric10_Acm [55N10FU] is not equal to VA evt_mnZero [55BRTXA]<div id='2aef6aeb-50bb-400d-a605-e9341550b3ca:68:hide' style='display: inline;'><br>      <div id='2aef6aeb-50bb-400d-a605-e9341550b3ca:69' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If SV File_IO_Status is equal to CO SUCCESS<div id='2aef6aeb-50bb-400d-a605-e9341550b3ca:69:hide' style='display: inline;'><br>           <div id='2aef6aeb-50bb-400d-a605-e9341550b3ca:70' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5576B01.Update  [Index 1: Nota Fiscal Number, +]<div id='2aef6aeb-50bb-400d-a605-e9341550b3ca:70:hide' style='display: inline;'><br>                 <span class='iokey'>BF mnNotaFiscalNumber [BNNF] = TK Nota Fiscal Number [BNNF]</span><br>                 <span class='iokey'>BF szNotaFiscalSeries [BSER] = TK Nota Fiscal Series [BSER]</span><br>                 <span class='iokey'>BF mnNextNumber001 [N001] = TK Next Number Range 1 [N001]</span><br>                 <span class='iokey'>BF szDocumentType [DCT] = TK Document Type [DCT]</span><br>                 <span class='iokey'>BF szBrazilTaxType [55BRTX] = TK Tax Type - Brazil [55BRTX]</span><br>                 BF mnBrazilTaxBasis_Acm [55BRTXB] -&#62; TK Tax Basis - Brazil [55BRTXB]<br>                 BF mnBrazilTaxAmount_Acm [55BRTXA] -&#62; TK Tax Amount - Brazil [55BRTXA]<br>                 VA evt_FutureUseMathNumeric1_Acm [N1FU] -&#62; TK Future Use - Math Numeric 1 [N1FU]<br>                 VA evt_FutureUseMathNumeric9_Acm [55N9FU] -&#62; TK Future Use - Math Numeric 9 [55N9FU]<br>                 VA evt_FutureUseMathNumeric10_Acm [55N10FU] -&#62; TK Future Use - Math Numeric 10 [55N10FU]<br>                 SL UserID -&#62; TK Transaction Originator [TORG]<br>                 SL UserID -&#62; TK User ID [USER]<br>                 VA evt_ProgramId [PID] -&#62; TK Program ID [PID]<br>                 VA evt_WorkStationId [JOBN] -&#62; TK Work Station ID [JOBN]<br>                 SL DateToday -&#62; TK Date - Updated [UPMJ]<br>                 VA evt_TimeLastUpdated [UPMT] -&#62; TK Time - Last Updated [UPMT]</div></div><br>      <div id='2aef6aeb-50bb-400d-a605-e9341550b3ca:71' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='2aef6aeb-50bb-400d-a605-e9341550b3ca:71:hide' style='display: inline;'><br>           <div id='2aef6aeb-50bb-400d-a605-e9341550b3ca:72' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5576B01.Insert  [Index 1: Nota Fiscal Number, +]<div id='2aef6aeb-50bb-400d-a605-e9341550b3ca:72:hide' style='display: inline;'><br>                 BF mnNotaFiscalNumber [BNNF] -&#62; TK Nota Fiscal Number [BNNF]<br>                 BF szNotaFiscalSeries [BSER] -&#62; TK Nota Fiscal Series [BSER]<br>                 BF mnNextNumber001 [N001] -&#62; TK Next Number Range 1 [N001]<br>                 BF szDocumentType [DCT] -&#62; TK Document Type [DCT]<br>                 BF szBrazilTaxType [55BRTX] -&#62; TK Tax Type - Brazil [55BRTX]<br>                 BF mnBrazilTaxBasis_Acm [55BRTXB] -&#62; TK Tax Basis - Brazil [55BRTXB]<br>                 BF mnBrazilTaxAmount_Acm [55BRTXA] -&#62; TK Tax Amount - Brazil [55BRTXA]<br>                 VA evt_FutureUseMathNumeric1_Acm [N1FU] -&#62; TK Future Use - Math Numeric 1 [N1FU]<br>                 VA evt_FutureUseMathNumeric9_Acm [55N9FU] -&#62; TK Future Use - Math Numeric 9 [55N9FU]<br>                 VA evt_FutureUseMathNumeric10_Acm [55N10FU] -&#62; TK Future Use - Math Numeric 10 [55N10FU]<br>                 SL UserID -&#62; TK Transaction Originator [TORG]<br>                 SL UserID -&#62; TK User ID [USER]<br>                 VA evt_ProgramId [PID] -&#62; TK Program ID [PID]<br>                 VA evt_WorkStationId [JOBN] -&#62; TK Work Station ID [JOBN]<br>                 SL DateToday -&#62; TK Date - Updated [UPMJ]<br>                 VA evt_TimeLastUpdated [UPMT] -&#62; TK Time - Last Updated [UPMT]</div></div><br>       End If</div><br> <div id='2aef6aeb-50bb-400d-a605-e9341550b3ca:74' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='2aef6aeb-50bb-400d-a605-e9341550b3ca:74:hide' style='display: inline;'><br>      <div id='2aef6aeb-50bb-400d-a605-e9341550b3ca:75' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If SV File_IO_Status is equal to CO SUCCESS<div id='2aef6aeb-50bb-400d-a605-e9341550b3ca:75:hide' style='display: inline;'><br>           <div id='2aef6aeb-50bb-400d-a605-e9341550b3ca:76' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5576B01.Delete  [Index 1: Nota Fiscal Number, +]<div id='2aef6aeb-50bb-400d-a605-e9341550b3ca:76:hide' style='display: inline;'><br>                 <span class='iokey'>BF mnNotaFiscalNumber [BNNF] = TK Nota Fiscal Number [BNNF]</span><br>                 <span class='iokey'>BF szNotaFiscalSeries [BSER] = TK Nota Fiscal Series [BSER]</span><br>                 <span class='iokey'>BF mnNextNumber001 [N001] = TK Next Number Range 1 [N001]</span><br>                 <span class='iokey'>BF szDocumentType [DCT] = TK Document Type [DCT]</span><br>                 <span class='iokey'>BF szBrazilTaxType [55BRTX] = TK Tax Type - Brazil [55BRTX]</span></div></div><br>       End If</div><br>  End If<span class='comment'><br>  //</span></div></div><div class='section'>EVENTS<div class='objectheader'>NER: CalculaGravaPISeCOFINSeRetencoes <BR>Event GUID: 03122184-e48e-4515-ba6e-16ca41a1f28c</div><div class='er'><div class='dstrmembers'><B>Data Structure: D5576B09 - Calcula e Grava o PIS, a COFINS e as Retenções              </B><BR>BF cTransactionCode [EV01]<BR>BF cErrorCode [ERRC]<BR>BF szCompany [CO]<BR>BF mnNotaFiscalNumber [BNNF]<BR>BF szNotaFiscalSeries [BSER]<BR>BF mnNextNumber001 [N001]<BR>BF szDocumentType [DCT]<BR>BF mnUniqueKeyIDInternal [UKID]<BR>BF jdIssueDate [ISSU]<BR>BF mnAddressNumber [AN8]<BR>BF szTaxId [TAX]<BR>BF cPersonCorporationCode [TAXC]<BR>BF szReportCodeAddBook006 [AC06]<BR>BF mnCodeTransactionNature [BNOP]<BR>BF szSuffixTransactionNature [BSOP]<BR>BF szBrazilTaxType [55BRTX]<BR>BF mnBrazilTaxBasis [55BRTXB]<BR>BF mnBrazilTaxAmount [55BRTXA]<BR>BF mnBrazilTaxRate [55BRTXR]<BR>BF szBrazilTaxInformation [55BRTX2]<BR>BF mnNotaFiscalNumber_Ant [BNNF]<BR>BF szNotaFiscalSeries_Ant [BSER]<BR>BF mnNextNumber001_Ant [N001]<BR>BF szDocumentType_Ant [DCT]<BR>BF mnBrazilTaxBasis_Acm [55BRTXB]<BR>BF mnBrazilTaxAmount_Acm [55BRTXA]<BR></div>----------------------------------------</BR>Event Level Variables</BR>----------------------------------------</BR>evt_TimeLastUpdated [UPMT]<br>evt_WorkStationId [JOBN]<br>evt_UserDefinedCode [KY]<br>evt_CST [AA02]<br>evt_TaxAreaForInterm1 [TG01]<br>evt_Midia [MIDIA]<br>evt_pCSLL [FW01]<br>evt_pPIS [FW02]<br>evt_pCOFINS [FW03]<br>evt_pIRPJ [FW06]<br>evt_Company_00999 [CO]<br>evt_ProductCode [SY]<br>evt_UserDefinedCodes [RT]<br>evt_ProgramId_PID [PID]<br>evt_CodeTransactionNature [BRNOP]<br>evt_LineNumberID [IDLN]<br>evt_BF_CFOP_N5 [PEL]<br>evt_BW_CFOP_N5 [PEL]<br>evt_ObjectAccount [OBJ]<br>evt_Subsidiary [SUB]<br>evt_CostCenter [MCU]<br>evt_RegimeTributacao [EV01]<br>----------------------------------------</BR><span class='comment'>  //</span><span class='comment'><br>  // Parametros:</span><span class='comment'><br>  // Sq DataIt  Member Name</span><span class='comment'><br>  //     ----------------------------------------------------</span><span class='comment'><br>  //  0  EV01     cTransactionCode</span><span class='comment'><br>  //     C - so Calcula</span><span class='comment'><br>  //     G - Calcula e Grava</span><span class='comment'><br>  //     F - Fechamento (so Grava o Acm no Header e nao Grava Detalhe)</span><span class='comment'><br>  //  1  ERRC     cErrorCode</span><span class='comment'><br>  //  2  CO      szCompany</span><span class='comment'><br>  //     ----------------------------------------------------</span><span class='comment'><br>  //     Chave da NF</span><span class='comment'><br>  //  3  BNNF    mnNotaFiscalNumber</span><span class='comment'><br>  //  4  BSER    szNotaFiscalSeries</span><span class='comment'><br>  //  5  N001    mnNextNumber001</span><span class='comment'><br>  //  6  DCT     szDocumentType</span><span class='comment'><br>  //  7  UKID    mnUniqueKeyIDInternal</span><span class='comment'><br>  //  8  ISSU    jdIssueDate</span><span class='comment'><br>  //     ----------------------------------------------------</span><span class='comment'><br>  //     Ou informa o AN8 e a NER le a F0101</span><span class='comment'><br>  //     Ou ja informa os dados lidos</span><span class='comment'><br>  //  9  AN8     mnAddressNumber</span><span class='comment'><br>  // 10  TAX     szTaxId</span><span class='comment'><br>  // 11  TAXC    cPersonCorporationCode</span><span class='comment'><br>  // 12  AC06    szReportCodeAddBook006</span><span class='comment'><br>  //     ----------------------------------------------------</span><span class='comment'><br>  //     CFOP para determinar o CST (Codigo da Situacao Tributaria)</span><span class='comment'><br>  // 13  BNOP    mnCodeTransactionNature</span><span class='comment'><br>  // 14  BSOP    szSuffixTransactionNature</span><span class='comment'><br>  //     ----------------------------------------------------</span><span class='comment'><br>  //     Tipo e Base de Calculo para o Tributo</span><span class='comment'><br>  // 15  55BRTX  szBrazilTaxType</span><span class='comment'><br>  //     00 - Retencoes ( a nivel de header da NF)</span><span class='comment'><br>  //         11 - IR</span><span class='comment'><br>  //         15 - PIS</span><span class='comment'><br>  //         16 - COFINS</span><span class='comment'><br>  //         17 - CSLL</span><span class='comment'><br>  //     05 - PIS ( a nivel de detail da NF)</span><span class='comment'><br>  //     06 - COFINS ( a nivel de detail da NF)</span><span class='comment'><br>  // 16  55BRTXB mnBrazilTaxBasis</span><span class='comment'><br>  //     ----------------------------------------------------</span><span class='comment'><br>  //     Retorno do Tributo calculado</span><span class='comment'><br>  // 17  55BRTXA mnBrazilTaxAmount</span><span class='comment'><br>  // 18  55BRTXR mnBrazilTaxRate</span><span class='comment'><br>  // 19  55BRTX2 szBrazilTaxInformation</span><span class='comment'><br>  //     ----------------------------------------------------</span><span class='comment'><br>  //     Controle da quebra de NF</span><span class='comment'><br>  // 20  BNNF    mnNotaFiscalNumber_Ant</span><span class='comment'><br>  // 21  BSER    szNotaFiscalSeries_Ant</span><span class='comment'><br>  // 22  N001    mnNextNumber001_Ant</span><span class='comment'><br>  // 23  DCT     szDocumentType_Ant</span><span class='comment'><br>  //     ----------------------------------------------------</span><span class='comment'><br>  //     Acumuladores do Tributo</span><span class='comment'><br>  // 24  55BRTXB mnBrazilTaxBasis_Tot</span><span class='comment'><br>  // 25  55BRTXA mnBrazilTaxAmount_Tot</span><span class='comment'><br>  //</span><br>  BF cErrorCode [ERRC] = "N"<span class='comment'><br>  //</span><br> <div id='03122184-e48e-4515-ba6e-16ca41a1f28c:59' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>GetAuditInfo(B9800100.GetAuditInfo)<div id='03122184-e48e-4515-ba6e-16ca41a1f28c:59:hide' style='display: inline;'><span class='parameters'><br>       UNDEFINED &#60;&#62; szUserName [USER]<br>       UNDEFINED &#60;&#62; jdDate [DTE]<br>       VA evt_TimeLastUpdated [UPMT] &#60;- mnTime [TME0]<br>       VA evt_WorkStationId [JOBN] &#60;- szWorkstation_UserId [JOBN]</span></div><span class='comment'><br>  //</span><br>  VA evt_ProgramId_PID [PID] = "N5576B09"<span class='comment'><br>  //</span><br> <div id='03122184-e48e-4515-ba6e-16ca41a1f28c:63' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If BF szBrazilTaxType [55BRTX] is not equal to "00"<div id='03122184-e48e-4515-ba6e-16ca41a1f28c:63:hide' style='display: inline;'><span class='comment'><br>       //     05 - PIS ( a nivel de detail da NF)</span><span class='comment'><br>       //     06 - COFINS ( a nivel de detail da NF)</span><span class='comment'><br>       //</span><span class='comment'><br>       // verifica Quebra da NF e grava Total do Tributo no header da NF (Ant)</span><span class='comment'><br>       //</span><br>      <div id='03122184-e48e-4515-ba6e-16ca41a1f28c:69' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If BF mnNotaFiscalNumber [BNNF] is not equal to BF mnNotaFiscalNumber_Ant [BNNF]<br>       Or BF szNotaFiscalSeries [BSER] is not equal to BF szNotaFiscalSeries_Ant [BSER]<br>       Or BF mnNextNumber001 [N001] is not equal to BF mnNextNumber001_Ant [N001]<br>       Or BF szDocumentType [DCT] is not equal to BF szDocumentType_Ant [DCT]<br>       Or BF cTransactionCode [EV01] is equal to "F"<div id='03122184-e48e-4515-ba6e-16ca41a1f28c:69:hide' style='display: inline;'><span class='comment'><br>            //</span><span class='comment'><br>            // Como o número da NFe pode conter mais de seis dígitos e, na virada do</span><span class='comment'><br>            // milhao, mantemos apenas os seis últimos, esse número pode ficar zerado.</span><span class='comment'><br>            // Portando, foi substituído o teste do nNFe_Ant&#62;0 por Ser_Ant&#60;&#62;Null/Blank</span><br>           <div id='03122184-e48e-4515-ba6e-16ca41a1f28c:74' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If BF szNotaFiscalSeries_Ant [BSER] is not equal to &#60;NULL&#62;<br>            And BF szNotaFiscalSeries_Ant [BSER] is not equal to &#60;Blank&#62;<br>            And BF mnBrazilTaxAmount_Acm [55BRTXA] is not equal to "0"<div id='03122184-e48e-4515-ba6e-16ca41a1f28c:74:hide' style='display: inline;'><br>                <div id='03122184-e48e-4515-ba6e-16ca41a1f28c:75' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5576B01.Insert  [Index 1: Nota Fiscal Number, +]<div id='03122184-e48e-4515-ba6e-16ca41a1f28c:75:hide' style='display: inline;'><br>                      BF mnNotaFiscalNumber_Ant [BNNF] -&#62; TK Nota Fiscal Number [BNNF]<br>                      BF szNotaFiscalSeries_Ant [BSER] -&#62; TK Nota Fiscal Series [BSER]<br>                      BF mnNextNumber001_Ant [N001] -&#62; TK Next Number Range 1 [N001]<br>                      BF szDocumentType_Ant [DCT] -&#62; TK Document Type [DCT]<br>                      BF szBrazilTaxType [55BRTX] -&#62; TK Tax Type - Brazil [55BRTX]<br>                      BF mnBrazilTaxBasis_Acm [55BRTXB] -&#62; TK Tax Basis - Brazil [55BRTXB]<br>                      BF mnBrazilTaxAmount_Acm [55BRTXA] -&#62; TK Tax Amount - Brazil [55BRTXA]<br>                      SL UserID -&#62; TK Transaction Originator [TORG]<br>                      SL UserID -&#62; TK User ID [USER]<br>                      VA evt_ProgramId_PID [PID] -&#62; TK Program ID [PID]<br>                      VA evt_WorkStationId [JOBN] -&#62; TK Work Station ID [JOBN]<br>                      SL DateToday -&#62; TK Date - Updated [UPMJ]<br>                      VA evt_TimeLastUpdated [UPMT] -&#62; TK Time - Last Updated [UPMT]</div><br>                <div id='03122184-e48e-4515-ba6e-16ca41a1f28c:76' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If SV File_IO_Status is not equal to CO SUCCESS<div id='03122184-e48e-4515-ba6e-16ca41a1f28c:76:hide' style='display: inline;'><br>                     <div id='03122184-e48e-4515-ba6e-16ca41a1f28c:77' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5576B01.Update  [Index 1: Nota Fiscal Number, +]<div id='03122184-e48e-4515-ba6e-16ca41a1f28c:77:hide' style='display: inline;'><br>                           <span class='iokey'>BF mnNotaFiscalNumber_Ant [BNNF] = TK Nota Fiscal Number [BNNF]</span><br>                           <span class='iokey'>BF szNotaFiscalSeries_Ant [BSER] = TK Nota Fiscal Series [BSER]</span><br>                           <span class='iokey'>BF mnNextNumber001_Ant [N001] = TK Next Number Range 1 [N001]</span><br>                           <span class='iokey'>BF szDocumentType_Ant [DCT] = TK Document Type [DCT]</span><br>                           <span class='iokey'>BF szBrazilTaxType [55BRTX] = TK Tax Type - Brazil [55BRTX]</span><br>                           BF mnBrazilTaxBasis_Acm [55BRTXB] -&#62; TK Tax Basis - Brazil [55BRTXB]<br>                           BF mnBrazilTaxAmount_Acm [55BRTXA] -&#62; TK Tax Amount - Brazil [55BRTXA]<br>                           SL UserID -&#62; TK Transaction Originator [TORG]<br>                           SL UserID -&#62; TK User ID [USER]<br>                           VA evt_ProgramId_PID [PID] -&#62; TK Program ID [PID]<br>                           VA evt_WorkStationId [JOBN] -&#62; TK Work Station ID [JOBN]<br>                           SL DateToday -&#62; TK Date - Updated [UPMJ]<br>                           VA evt_TimeLastUpdated [UPMT] -&#62; TK Time - Last Updated [UPMT]</div></div><br>                 End If</div><br>            End If<span class='comment'><br>            //</span><br>            BF mnBrazilTaxBasis_Acm [55BRTXB] = 0<br>            BF mnBrazilTaxAmount_Acm [55BRTXA] = 0<span class='comment'><br>            //</span></div><br>       End If<span class='comment'><br>       //</span><span class='comment'><br>       // Calcula o tributo, grava na linha da NF e acumula</span><span class='comment'><br>       //</span><br>      <div id='03122184-e48e-4515-ba6e-16ca41a1f28c:88' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If BF cTransactionCode [EV01] is equal to ("C","G")<div id='03122184-e48e-4515-ba6e-16ca41a1f28c:88:hide' style='display: inline;'><span class='comment'><br>            //</span><span class='comment'><br>            // Verifica se CFOP é de 3 digitos e converte para 4 dígitos</span><span class='comment'><br>            //</span><br>            VA evt_BF_CFOP_N5 [PEL] = BF mnCodeTransactionNature [BNOP]<br>            VA evt_BW_CFOP_N5 [PEL] = "999"<br>           <div id='03122184-e48e-4515-ba6e-16ca41a1f28c:94' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_BF_CFOP_N5 [PEL] is less than or equal to VA evt_BW_CFOP_N5 [PEL]<div id='03122184-e48e-4515-ba6e-16ca41a1f28c:94:hide' style='display: inline;'><span class='comment'><br>                 //</span><span class='comment'><br>                 // Com o CFOP de 3 dígitos, busca o CFOP de 4 dígitos na Cia</span><br>                <div id='03122184-e48e-4515-ba6e-16ca41a1f28c:97' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F76B200.FetchSingle  [Index 1: CFOP, sufixo, companhia]<div id='03122184-e48e-4515-ba6e-16ca41a1f28c:97:hide' style='display: inline;'><br>                      <span class='iokey'>BF mnCodeTransactionNature [BNOP] = TK Code - Transaction Nature [BNOP]</span><br>                      <span class='iokey'>BF szSuffixTransactionNature [BSOP] = TK Suffix - Transaction Nature [BSOP]</span><br>                      <span class='iokey'>BF szCompany [CO] = TK Company From [FCO]</span><br>                      VA evt_UserDefinedCode [KY] &#60;- TK Code - Transaction Nature [BRNOP]</div><br>                <div id='03122184-e48e-4515-ba6e-16ca41a1f28c:98' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If SV File_IO_Status is not equal to CO SUCCESS<div id='03122184-e48e-4515-ba6e-16ca41a1f28c:98:hide' style='display: inline;'><span class='comment'><br>                      //</span><span class='comment'><br>                      // Com o CFOP de 3 dígitos, busca o CFOP de 4 dígitos na Cia 00999</span><br>                      VA evt_Company_00999 [CO] = "00999"<br>                     <div id='03122184-e48e-4515-ba6e-16ca41a1f28c:102' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F76B200.FetchSingle  [Index 1: CFOP, sufixo, companhia]<div id='03122184-e48e-4515-ba6e-16ca41a1f28c:102:hide' style='display: inline;'><br>                           <span class='iokey'>BF mnCodeTransactionNature [BNOP] = TK Code - Transaction Nature [BNOP]</span><br>                           <span class='iokey'>BF szSuffixTransactionNature [BSOP] = TK Suffix - Transaction Nature [BSOP]</span><br>                           <span class='iokey'>VA evt_Company_00999 [CO] = TK Company From [FCO]</span><br>                           VA evt_UserDefinedCode [KY] &#60;- TK Code - Transaction Nature [BRNOP]</div><br>                     <div id='03122184-e48e-4515-ba6e-16ca41a1f28c:103' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If SV File_IO_Status is not equal to CO SUCCESS<div id='03122184-e48e-4515-ba6e-16ca41a1f28c:103:hide' style='display: inline;'><br>                           BF cErrorCode [ERRC] = "S"</div><br>                     <div id='03122184-e48e-4515-ba6e-16ca41a1f28c:105' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='03122184-e48e-4515-ba6e-16ca41a1f28c:105:hide' style='display: inline;'><br>                           VA evt_CodeTransactionNature [BRNOP] = VA evt_UserDefinedCode [KY]</div><br>                      End If</div><br>                <div id='03122184-e48e-4515-ba6e-16ca41a1f28c:108' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='03122184-e48e-4515-ba6e-16ca41a1f28c:108:hide' style='display: inline;'><br>                      VA evt_CodeTransactionNature [BRNOP] = VA evt_UserDefinedCode [KY]</div><br>                 End If</div><br>           <div id='03122184-e48e-4515-ba6e-16ca41a1f28c:111' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='03122184-e48e-4515-ba6e-16ca41a1f28c:111:hide' style='display: inline;'><span class='comment'><br>                 // Verifica se existe o CFOP de 4 posições</span><br>                 VA evt_CodeTransactionNature [BRNOP] = [BF mnCodeTransactionNature [BNOP]]<br>                <div id='03122184-e48e-4515-ba6e-16ca41a1f28c:114' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F76B200.FetchSingle  [Index 2: NovoCFOP, Sufixo]<div id='03122184-e48e-4515-ba6e-16ca41a1f28c:114:hide' style='display: inline;'><br>                      <span class='iokey'>BF szSuffixTransactionNature [BSOP] = TK Suffix - Transaction Nature [BSOP]</span><br>                      <span class='iokey'>VA evt_CodeTransactionNature [BRNOP] = TK Code - Transaction Nature [BRNOP]</span></div><br>                <div id='03122184-e48e-4515-ba6e-16ca41a1f28c:115' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If SV File_IO_Status is equal to CO SUCCESS<div id='03122184-e48e-4515-ba6e-16ca41a1f28c:115:hide' style='display: inline;'><br>                      VA evt_UserDefinedCode [KY] = [BF mnCodeTransactionNature [BNOP]]</div><br>                <div id='03122184-e48e-4515-ba6e-16ca41a1f28c:117' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='03122184-e48e-4515-ba6e-16ca41a1f28c:117:hide' style='display: inline;'><br>                      BF cErrorCode [ERRC] = "S"</div><br>                 End If</div><br>            End If<span class='comment'><br>            //</span><br>           <div id='03122184-e48e-4515-ba6e-16ca41a1f28c:122' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If BF cErrorCode [ERRC] is equal to "N"<div id='03122184-e48e-4515-ba6e-16ca41a1f28c:122:hide' style='display: inline;'><span class='comment'><br>                 //</span><span class='comment'><br>                 // com o CFOP, busca a CST na udc 55/IO</span><span class='comment'><br>                 //</span><br>                 VA evt_ProductCode [SY] = "55"<br>                 VA evt_UserDefinedCodes [RT] = "IO"<br>                 VA evt_UserDefinedCode [KY] = rtrim([VA evt_UserDefinedCode [KY]], &#60;Blank&#62;)<br>                 VA evt_UserDefinedCode [KY] = concat([VA evt_UserDefinedCode [KY]], ".")<br>                 VA evt_UserDefinedCode [KY] = concat([VA evt_UserDefinedCode [KY]], [BF szSuffixTransactionNature [BSOP]])<br>                <div id='03122184-e48e-4515-ba6e-16ca41a1f28c:131' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F0005.FetchSingle  [Index 1: System, Type, Code]<div id='03122184-e48e-4515-ba6e-16ca41a1f28c:131:hide' style='display: inline;'><br>                      <span class='iokey'>VA evt_ProductCode [SY] = TK Product Code [SY]</span><br>                      <span class='iokey'>VA evt_UserDefinedCodes [RT] = TK User Defined Codes [RT]</span><br>                      <span class='iokey'>VA evt_UserDefinedCode [KY] = TK User Defined Code [KY]</span><br>                      VA evt_CST [AA02] &#60;- TK Description 02 [DL02]</div><br>                <div id='03122184-e48e-4515-ba6e-16ca41a1f28c:132' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If SV File_IO_Status is not equal to CO SUCCESS<div id='03122184-e48e-4515-ba6e-16ca41a1f28c:132:hide' style='display: inline;'><span class='comment'><br>                      // CFOP nao cadastrado na udc 55/IO - CST PIS/COFINS</span><br>                      BF cErrorCode [ERRC] = "S"</div><br>                <div id='03122184-e48e-4515-ba6e-16ca41a1f28c:135' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='03122184-e48e-4515-ba6e-16ca41a1f28c:135:hide' style='display: inline;'><br>                      BF szBrazilTaxInformation [55BRTX2] = VA evt_CST [AA02]<br>                     <div id='03122184-e48e-4515-ba6e-16ca41a1f28c:137' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_CST [AA02] is equal to ("01","50")<div id='03122184-e48e-4515-ba6e-16ca41a1f28c:137:hide' style='display: inline;'><span class='comment'><br>                           //</span><span class='comment'><br>                           // Tributado</span><span class='comment'><br>                           //</span><span class='comment'><br>                           // Verifica se empresa abre o setup por Centro de Custo</span><span class='comment'><br>                           //</span><br>                           VA evt_LineNumberID [IDLN] = 1<br>                           VA evt_ObjectAccount [OBJ] = "999999"<br>                           VA evt_Subsidiary [SUB] = "99999999"<br>                           VA evt_Company_00999 [CO] = "00999"<span class='comment'><br>                           //</span><span class='comment'><br>                           // ###################################################</span><span class='comment'><br>                           // busca a conta contábil</span><br>                          <div id='03122184-e48e-4515-ba6e-16ca41a1f28c:150' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>DefineContadoLivroFiscal(N5576EPC.DefineContadoLivroFiscal)<div id='03122184-e48e-4515-ba6e-16ca41a1f28c:150:hide' style='display: inline;'><span class='parameters'><br>                                BF mnNotaFiscalNumber [BNNF] -&#62; mnNotaFiscalNumber [BNNF]<br>                                BF szNotaFiscalSeries [BSER] -&#62; szNotaFiscalSeries [BSER]<br>                                BF mnNextNumber001 [N001] -&#62; mnNextNumber001 [N001]<br>                                BF szDocumentType [DCT] -&#62; szDocumentType [DCT]<br>                                BF jdIssueDate [ISSU] -&#62; jdNotaFiscalDate [BRADEJ]<br>                                VA evt_CodeTransactionNature [BRNOP] -&#62; szCodeTransactionNature [BRNOP]<br>                                BF szSuffixTransactionNature [BSOP] -&#62; szSuffixTransactionNature [BSOP]<br>                                VA evt_CostCenter [MCU] &#60;- szCostCenter [MCU]<br>                                VA evt_ObjectAccount [OBJ] &#60;- szObjectAccount [OBJ]<br>                                VA evt_Subsidiary [SUB] &#60;- szSubsidiary [SUB]<br>                                UNDEFINED &#60;&#62; mnCodProduto [CODPRODU]<br>                                UNDEFINED &#60;&#62; szEdiDocumentType [EDCT]<br>                                UNDEFINED &#60;&#62; cFat_VA_EV01 [EV01]<br>                                BF szCompany [CO] &#60;&#62; szCompany [CO]<br>                                BF mnBrazilTaxBasis [55BRTXB] -&#62; mnAmountNotaFiscalTotals [BVTN]</span></div><span class='comment'><br>                           //</span><br>                          <div id='03122184-e48e-4515-ba6e-16ca41a1f28c:152' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If BF szBrazilTaxType [55BRTX] is equal to "05"<div id='03122184-e48e-4515-ba6e-16ca41a1f28c:152:hide' style='display: inline;'><br>                                VA evt_UserDefinedCode [KY] = "PIS CRD"</div><br>                          <div id='03122184-e48e-4515-ba6e-16ca41a1f28c:154' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='03122184-e48e-4515-ba6e-16ca41a1f28c:154:hide' style='display: inline;'><br>                                VA evt_UserDefinedCode [KY] = "COFINS CRD"</div><br>                           End If<span class='comment'><br>                           //</span><span class='comment'><br>                           // Verifica por Nivel de Centro de Custo se é "Não Cumulativo"</span><br>                          <div id='03122184-e48e-4515-ba6e-16ca41a1f28c:159' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5504RR5.FetchSingle  [Index 1: ChvPrincipal]<div id='03122184-e48e-4515-ba6e-16ca41a1f28c:159:hide' style='display: inline;'><br>                                <span class='iokey'>VA evt_UserDefinedCode [KY] = TK User Defined Code [KY]</span><br>                                <span class='iokey'>BF szCompany [CO] = TK Company [CO]</span><br>                                <span class='iokey'>VA evt_CostCenter [MCU] = TK Business Unit [MCU]</span><br>                                <span class='iokey'>VA evt_ObjectAccount [OBJ] = TK Object Account [OBJ]</span><br>                                <span class='iokey'>VA evt_Subsidiary [SUB] = TK Subsidiary [SUB]</span></div><br>                          <div id='03122184-e48e-4515-ba6e-16ca41a1f28c:160' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If SV File_IO_Status is equal to CO SUCCESS<div id='03122184-e48e-4515-ba6e-16ca41a1f28c:160:hide' style='display: inline;'><br>                                VA evt_RegimeTributacao [EV01] = "N"</div><br>                          <div id='03122184-e48e-4515-ba6e-16ca41a1f28c:162' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='03122184-e48e-4515-ba6e-16ca41a1f28c:162:hide' style='display: inline;'><span class='comment'><br>                                //</span><br>                               <div id='03122184-e48e-4515-ba6e-16ca41a1f28c:164' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If BF szBrazilTaxType [55BRTX] is equal to "05"<div id='03122184-e48e-4515-ba6e-16ca41a1f28c:164:hide' style='display: inline;'><br>                                     VA evt_UserDefinedCode [KY] = "PIS"</div><br>                               <div id='03122184-e48e-4515-ba6e-16ca41a1f28c:166' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='03122184-e48e-4515-ba6e-16ca41a1f28c:166:hide' style='display: inline;'><br>                                     VA evt_UserDefinedCode [KY] = "COFINS"</div><br>                                End If<span class='comment'><br>                                //</span><span class='comment'><br>                                // Verifica por Nivel de Centro de Custo se é "Cumulativo"</span><br>                               <div id='03122184-e48e-4515-ba6e-16ca41a1f28c:171' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5504RR5.FetchSingle  [Index 1: ChvPrincipal]<div id='03122184-e48e-4515-ba6e-16ca41a1f28c:171:hide' style='display: inline;'><br>                                     <span class='iokey'>VA evt_UserDefinedCode [KY] = TK User Defined Code [KY]</span><br>                                     <span class='iokey'>VA evt_Company_00999 [CO] = TK Company [CO]</span><br>                                     <span class='iokey'>VA evt_CostCenter [MCU] = TK Business Unit [MCU]</span><br>                                     <span class='iokey'>VA evt_ObjectAccount [OBJ] = TK Object Account [OBJ]</span><br>                                     <span class='iokey'>VA evt_Subsidiary [SUB] = TK Subsidiary [SUB]</span></div><br>                               <div id='03122184-e48e-4515-ba6e-16ca41a1f28c:172' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If SV File_IO_Status is equal to CO SUCCESS<div id='03122184-e48e-4515-ba6e-16ca41a1f28c:172:hide' style='display: inline;'><br>                                     VA evt_RegimeTributacao [EV01] = "C"</div><br>                               <div id='03122184-e48e-4515-ba6e-16ca41a1f28c:174' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='03122184-e48e-4515-ba6e-16ca41a1f28c:174:hide' style='display: inline;'><span class='comment'><br>                                     //</span><br>                                    <div id='03122184-e48e-4515-ba6e-16ca41a1f28c:176' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If BF szBrazilTaxType [55BRTX] is equal to "05"<div id='03122184-e48e-4515-ba6e-16ca41a1f28c:176:hide' style='display: inline;'><br>                                          VA evt_UserDefinedCode [KY] = "PIS CRD"</div><br>                                    <div id='03122184-e48e-4515-ba6e-16ca41a1f28c:178' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='03122184-e48e-4515-ba6e-16ca41a1f28c:178:hide' style='display: inline;'><br>                                          VA evt_UserDefinedCode [KY] = "COFINS CRD"</div><br>                                     End If<span class='comment'><br>                                     //</span><br>                                     VA evt_Company_00999 [CO] = lpad(substr(ltrim([VA evt_CostCenter [MCU]], &#60;Blank&#62;), "0", "3"), "0", "5")<span class='comment'><br>                                     //</span><span class='comment'><br>                                     // Verifica se a Empresa é "Não Cumulativo"</span><br>                                    <div id='03122184-e48e-4515-ba6e-16ca41a1f28c:185' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5504RR0.Select  [Index 1: ChvPrincipal]<div id='03122184-e48e-4515-ba6e-16ca41a1f28c:185:hide' style='display: inline;'><br>                                          <span class='iokey'>VA evt_UserDefinedCode [KY] = TK User Defined Code [KY]</span><br>                                          <span class='iokey'>VA evt_Company_00999 [CO] = TK Company [CO]</span><br>                                          <span class='iokey'>VA evt_LineNumberID [IDLN] = TK Who's Who Line Number - ID [IDLN]</span></div><br>                                    <div id='03122184-e48e-4515-ba6e-16ca41a1f28c:186' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5504RR0.FetchNext  [Index 1: ChvPrincipal]<div id='03122184-e48e-4515-ba6e-16ca41a1f28c:186:hide' style='display: inline;'><br>                                          VA evt_TaxAreaForInterm1 [TG01] &#60;- TK User Defined Code [KY]</div><span class='comment'><br>                                     //</span><br>                                    <div id='03122184-e48e-4515-ba6e-16ca41a1f28c:188' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If SV File_IO_Status is equal to CO SUCCESS<div id='03122184-e48e-4515-ba6e-16ca41a1f28c:188:hide' style='display: inline;'><br>                                          VA evt_RegimeTributacao [EV01] = "N"</div><br>                                    <div id='03122184-e48e-4515-ba6e-16ca41a1f28c:190' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='03122184-e48e-4515-ba6e-16ca41a1f28c:190:hide' style='display: inline;'><br>                                          VA evt_RegimeTributacao [EV01] = "C"</div><br>                                     End If<span class='comment'><br>                                     //</span></div><br>                                End If<span class='comment'><br>                                //</span></div><br>                           End If<span class='comment'><br>                           //</span><span class='comment'><br>                           // ################################################</span><span class='comment'><br>                           //</span><span class='comment'><br>                           // Busca a Aliquota</span><span class='comment'><br>                           //</span><br>                          <div id='03122184-e48e-4515-ba6e-16ca41a1f28c:202' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_RegimeTributacao [EV01] is equal to "N"<div id='03122184-e48e-4515-ba6e-16ca41a1f28c:202:hide' style='display: inline;'><span class='comment'><br>                                // Modalidade: Não Cumulativo - dá direito aos créditos</span><br>                               <div id='03122184-e48e-4515-ba6e-16ca41a1f28c:204' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If BF szBrazilTaxType [55BRTX] is equal to "05"<div id='03122184-e48e-4515-ba6e-16ca41a1f28c:204:hide' style='display: inline;'><br>                                     VA evt_TaxAreaForInterm1 [TG01] = "PIS E Ñ"</div><br>                               <div id='03122184-e48e-4515-ba6e-16ca41a1f28c:206' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='03122184-e48e-4515-ba6e-16ca41a1f28c:206:hide' style='display: inline;'><br>                                     VA evt_TaxAreaForInterm1 [TG01] = "COFINS E Ñ"</div><br>                                End If</div><br>                          <div id='03122184-e48e-4515-ba6e-16ca41a1f28c:209' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='03122184-e48e-4515-ba6e-16ca41a1f28c:209:hide' style='display: inline;'><span class='comment'><br>                                // Modalidade: Cumulativo - NÃO dá direito aos créditos</span><br>                               <div id='03122184-e48e-4515-ba6e-16ca41a1f28c:211' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_CST [AA02] is equal to "50"<div id='03122184-e48e-4515-ba6e-16ca41a1f28c:211:hide' style='display: inline;'><br>                                     VA evt_CST [AA02] = "08"</div><br>                               <div id='03122184-e48e-4515-ba6e-16ca41a1f28c:213' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='03122184-e48e-4515-ba6e-16ca41a1f28c:213:hide' style='display: inline;'><br>                                    <div id='03122184-e48e-4515-ba6e-16ca41a1f28c:214' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If BF szBrazilTaxType [55BRTX] is equal to "05"<div id='03122184-e48e-4515-ba6e-16ca41a1f28c:214:hide' style='display: inline;'><br>                                          VA evt_TaxAreaForInterm1 [TG01] = "PIS E C"</div><br>                                    <div id='03122184-e48e-4515-ba6e-16ca41a1f28c:216' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='03122184-e48e-4515-ba6e-16ca41a1f28c:216:hide' style='display: inline;'><br>                                          VA evt_TaxAreaForInterm1 [TG01] = "COFINS E C"</div><br>                                     End If</div><br>                                End If</div><br>                           End If<span class='comment'><br>                           //</span><br>                          <div id='03122184-e48e-4515-ba6e-16ca41a1f28c:222' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_CST [AA02] is not equal to "08"<div id='03122184-e48e-4515-ba6e-16ca41a1f28c:222:hide' style='display: inline;'><br>                               <div id='03122184-e48e-4515-ba6e-16ca41a1f28c:223' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5504PT0.FetchSingle  [Index 1: ChvImposto]<div id='03122184-e48e-4515-ba6e-16ca41a1f28c:223:hide' style='display: inline;'><br>                                     <span class='iokey'>VA evt_TaxAreaForInterm1 [TG01] = TK Tax Area for Interm1 [TG01]</span><br>                                     BF mnBrazilTaxRate [55BRTXR] &#60;- TK Percent - Beneficiary [BPCT]</div><br>                               <div id='03122184-e48e-4515-ba6e-16ca41a1f28c:224' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If SV File_IO_Status is not equal to CO SUCCESS<div id='03122184-e48e-4515-ba6e-16ca41a1f28c:224:hide' style='display: inline;'><span class='comment'><br>                                     // Aliquota indefinida (tributo nao cadastrado no setup de Impostos)</span><br>                                     BF cErrorCode [ERRC] = "S"<br>                                     BF mnBrazilTaxRate [55BRTXR] = 0<br>                                     BF mnBrazilTaxAmount [55BRTXA] = 0</div><br>                               <div id='03122184-e48e-4515-ba6e-16ca41a1f28c:229' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='03122184-e48e-4515-ba6e-16ca41a1f28c:229:hide' style='display: inline;'><br>                                     BF mnBrazilTaxAmount [55BRTXA] = round((([BF mnBrazilTaxBasis [55BRTXB]]*[BF mnBrazilTaxRate [55BRTXR]])/100), "2")</div><br>                                End If</div><br>                           End If</div><br>                     <div id='03122184-e48e-4515-ba6e-16ca41a1f28c:233' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='03122184-e48e-4515-ba6e-16ca41a1f28c:233:hide' style='display: inline;'><span class='comment'><br>                           //</span><span class='comment'><br>                           // Não Tributado</span><br>                          <div id='03122184-e48e-4515-ba6e-16ca41a1f28c:236' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5576B01.Delete  [Index 1: Nota Fiscal Number, +]<div id='03122184-e48e-4515-ba6e-16ca41a1f28c:236:hide' style='display: inline;'><br>                                <span class='iokey'>BF mnNotaFiscalNumber [BNNF] = TK Nota Fiscal Number [BNNF]</span><br>                                <span class='iokey'>BF szNotaFiscalSeries [BSER] = TK Nota Fiscal Series [BSER]</span><br>                                <span class='iokey'>BF mnNextNumber001 [N001] = TK Next Number Range 1 [N001]</span><br>                                <span class='iokey'>BF szDocumentType [DCT] = TK Document Type [DCT]</span><br>                                <span class='iokey'>BF szBrazilTaxType [55BRTX] = TK Tax Type - Brazil [55BRTX]</span></div><br>                          <div id='03122184-e48e-4515-ba6e-16ca41a1f28c:237' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5576B11.Delete  [Index 1: Nota Fiscal Number, +]<div id='03122184-e48e-4515-ba6e-16ca41a1f28c:237:hide' style='display: inline;'><br>                                <span class='iokey'>BF mnNotaFiscalNumber [BNNF] = TK Nota Fiscal Number [BNNF]</span><br>                                <span class='iokey'>BF szNotaFiscalSeries [BSER] = TK Nota Fiscal Series [BSER]</span><br>                                <span class='iokey'>BF mnNextNumber001 [N001] = TK Next Number Range 1 [N001]</span><br>                                <span class='iokey'>BF szDocumentType [DCT] = TK Document Type [DCT]</span><br>                                <span class='iokey'>BF mnUniqueKeyIDInternal [UKID] = TK Unique Key ID (Internal) [UKID]</span><br>                                <span class='iokey'>BF szBrazilTaxType [55BRTX] = TK Tax Type - Brazil [55BRTX]</span></div><span class='comment'><br>                           //</span><br>                          <div id='03122184-e48e-4515-ba6e-16ca41a1f28c:239' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If VA evt_CST [AA02] is not equal to("04","06","73")<div id='03122184-e48e-4515-ba6e-16ca41a1f28c:239:hide' style='display: inline;'><br>                                BF mnBrazilTaxBasis [55BRTXB] = 0</div><br>                           End If<br>                           BF mnBrazilTaxAmount [55BRTXA] = 0</div><br>                      End If</div><br>                 End If</div><br>            End If<span class='comment'><br>            //</span><br>           <div id='03122184-e48e-4515-ba6e-16ca41a1f28c:247' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If BF cErrorCode [ERRC] is equal to "N"<br>            And VA evt_CST [AA02] is not equal to "08"<br>            And BF cTransactionCode [EV01] is equal to "G"<div id='03122184-e48e-4515-ba6e-16ca41a1f28c:247:hide' style='display: inline;'><span class='comment'><br>                 //</span><br>                <div id='03122184-e48e-4515-ba6e-16ca41a1f28c:249' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5576B11.Insert  [Index 1: Nota Fiscal Number, +]<div id='03122184-e48e-4515-ba6e-16ca41a1f28c:249:hide' style='display: inline;'><br>                      BF mnNotaFiscalNumber [BNNF] -&#62; TK Nota Fiscal Number [BNNF]<br>                      BF szNotaFiscalSeries [BSER] -&#62; TK Nota Fiscal Series [BSER]<br>                      BF mnNextNumber001 [N001] -&#62; TK Next Number Range 1 [N001]<br>                      BF szDocumentType [DCT] -&#62; TK Document Type [DCT]<br>                      BF mnUniqueKeyIDInternal [UKID] -&#62; TK Unique Key ID (Internal) [UKID]<br>                      BF szBrazilTaxType [55BRTX] -&#62; TK Tax Type - Brazil [55BRTX]<br>                      BF szBrazilTaxInformation [55BRTX2] -&#62; TK Tax Information - Brazil [55BRTX2]<br>                      BF mnBrazilTaxBasis [55BRTXB] -&#62; TK Tax Basis - Brazil [55BRTXB]<br>                      BF mnBrazilTaxAmount [55BRTXA] -&#62; TK Tax Amount - Brazil [55BRTXA]<br>                      BF mnBrazilTaxRate [55BRTXR] -&#62; TK Tax Rate - Brazil [55BRTXR]<br>                      SL UserID -&#62; TK Transaction Originator [TORG]<br>                      SL UserID -&#62; TK User ID [USER]<br>                      VA evt_ProgramId_PID [PID] -&#62; TK Program ID [PID]<br>                      VA evt_WorkStationId [JOBN] -&#62; TK Work Station ID [JOBN]<br>                      SL DateToday -&#62; TK Date - Updated [UPMJ]<br>                      VA evt_TimeLastUpdated [UPMT] -&#62; TK Time - Last Updated [UPMT]</div><br>                <div id='03122184-e48e-4515-ba6e-16ca41a1f28c:250' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If SV File_IO_Status is not equal to CO SUCCESS<div id='03122184-e48e-4515-ba6e-16ca41a1f28c:250:hide' style='display: inline;'><br>                     <div id='03122184-e48e-4515-ba6e-16ca41a1f28c:251' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5576B11.Update  [Index 1: Nota Fiscal Number, +]<div id='03122184-e48e-4515-ba6e-16ca41a1f28c:251:hide' style='display: inline;'><br>                           <span class='iokey'>BF mnNotaFiscalNumber [BNNF] = TK Nota Fiscal Number [BNNF]</span><br>                           <span class='iokey'>BF szNotaFiscalSeries [BSER] = TK Nota Fiscal Series [BSER]</span><br>                           <span class='iokey'>BF mnNextNumber001 [N001] = TK Next Number Range 1 [N001]</span><br>                           <span class='iokey'>BF szDocumentType [DCT] = TK Document Type [DCT]</span><br>                           <span class='iokey'>BF mnUniqueKeyIDInternal [UKID] = TK Unique Key ID (Internal) [UKID]</span><br>                           <span class='iokey'>BF szBrazilTaxType [55BRTX] = TK Tax Type - Brazil [55BRTX]</span><br>                           BF szBrazilTaxInformation [55BRTX2] -&#62; TK Tax Information - Brazil [55BRTX2]<br>                           BF mnBrazilTaxBasis [55BRTXB] -&#62; TK Tax Basis - Brazil [55BRTXB]<br>                           BF mnBrazilTaxAmount [55BRTXA] -&#62; TK Tax Amount - Brazil [55BRTXA]<br>                           BF mnBrazilTaxRate [55BRTXR] -&#62; TK Tax Rate - Brazil [55BRTXR]<br>                           SL UserID -&#62; TK Transaction Originator [TORG]<br>                           SL UserID -&#62; TK User ID [USER]<br>                           VA evt_ProgramId_PID [PID] -&#62; TK Program ID [PID]<br>                           VA evt_WorkStationId [JOBN] -&#62; TK Work Station ID [JOBN]<br>                           SL DateToday -&#62; TK Date - Updated [UPMJ]<br>                           VA evt_TimeLastUpdated [UPMT] -&#62; TK Time - Last Updated [UPMT]</div></div><br>                 End If<span class='comment'><br>                 //</span><br>                 BF mnBrazilTaxBasis_Acm [55BRTXB] = [BF mnBrazilTaxBasis_Acm [55BRTXB]]+[BF mnBrazilTaxBasis [55BRTXB]]<br>                 BF mnBrazilTaxAmount_Acm [55BRTXA] = [BF mnBrazilTaxAmount_Acm [55BRTXA]]+[BF mnBrazilTaxAmount [55BRTXA]]<span class='comment'><br>                 //</span></div><br>            End If<span class='comment'><br>            //</span></div><br>       End If</div><br> <div id='03122184-e48e-4515-ba6e-16ca41a1f28c:260' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='03122184-e48e-4515-ba6e-16ca41a1f28c:260:hide' style='display: inline;'><span class='comment'><br>       //     00 - Retencoes ( a nivel de header da NF)</span><span class='comment'><br>       //         11 - IR</span><span class='comment'><br>       //         15 - PIS</span><span class='comment'><br>       //         16 - COFINS</span><span class='comment'><br>       //         17 - CSLL</span><span class='comment'><br>       //</span><br>      <div id='03122184-e48e-4515-ba6e-16ca41a1f28c:267' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If BF cTransactionCode [EV01] is equal to ("C","G")<div id='03122184-e48e-4515-ba6e-16ca41a1f28c:267:hide' style='display: inline;'><span class='comment'><br>            //</span><span class='comment'><br>            // Calcular e Gravar</span><span class='comment'><br>            //</span><br>           <div id='03122184-e48e-4515-ba6e-16ca41a1f28c:271' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If BF mnAddressNumber [AN8] is not equal to "0"<div id='03122184-e48e-4515-ba6e-16ca41a1f28c:271:hide' style='display: inline;'><br>                <div id='03122184-e48e-4515-ba6e-16ca41a1f28c:272' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F0101.FetchSingle  [Index 1: Address #]<div id='03122184-e48e-4515-ba6e-16ca41a1f28c:272:hide' style='display: inline;'><br>                      <span class='iokey'>BF mnAddressNumber [AN8] = TK Address Number [AN8]</span><br>                      BF szTaxId [TAX] &#60;- TK Tax ID [TAX]<br>                      BF cPersonCorporationCode [TAXC] &#60;- TK Person/Corporation Code [TAXC]<br>                      BF szReportCodeAddBook006 [AC06] &#60;- TK Category Code - Address Book 06 [AC06]</div><br>                <div id='03122184-e48e-4515-ba6e-16ca41a1f28c:273' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If SV File_IO_Status is equal to CO SUCCESS<div id='03122184-e48e-4515-ba6e-16ca41a1f28c:273:hide' style='display: inline;'><br>                      BF cErrorCode [ERRC] = "S"</div><br>                 End If</div><br>            End If<span class='comment'><br>            //</span><br>           <div id='03122184-e48e-4515-ba6e-16ca41a1f28c:278' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If BF cErrorCode [ERRC] is equal to "N"<div id='03122184-e48e-4515-ba6e-16ca41a1f28c:278:hide' style='display: inline;'><br>                <div id='03122184-e48e-4515-ba6e-16ca41a1f28c:279' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If BF cPersonCorporationCode [TAXC] is equal to "2"<div id='03122184-e48e-4515-ba6e-16ca41a1f28c:279:hide' style='display: inline;'><br>                     <div id='03122184-e48e-4515-ba6e-16ca41a1f28c:280' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If BF szReportCodeAddBook006 [AC06] is equal to "OP"<div id='03122184-e48e-4515-ba6e-16ca41a1f28c:280:hide' style='display: inline;'><span class='comment'><br>                           // Orgao Publico</span><br>                           VA evt_Midia [MIDIA] = "RBS"<br>                          <div id='03122184-e48e-4515-ba6e-16ca41a1f28c:283' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F570500.FetchSingle  [Index 1: Midia]<div id='03122184-e48e-4515-ba6e-16ca41a1f28c:283:hide' style='display: inline;'><br>                                <span class='iokey'>VA evt_Midia [MIDIA] = TK Mídia [MIDIA]</span><br>                                VA evt_pCSLL [FW01] &#60;- TK Factor Weight % 1 [FW01]<br>                                VA evt_pPIS [FW02] &#60;- TK Factor Weight % 2 [FW02]<br>                                VA evt_pCOFINS [FW03] &#60;- TK Factor Weight % 3 [FW03]<br>                                VA evt_pIRPJ [FW06] &#60;- TK Factor Weight % 6 [FW06]</div><br>                          <div id='03122184-e48e-4515-ba6e-16ca41a1f28c:284' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If SV File_IO_Status is not equal to CO SUCCESS<div id='03122184-e48e-4515-ba6e-16ca41a1f28c:284:hide' style='display: inline;'><br>                                BF cErrorCode [ERRC] = "S"</div><br>                          <div id='03122184-e48e-4515-ba6e-16ca41a1f28c:286' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='03122184-e48e-4515-ba6e-16ca41a1f28c:286:hide' style='display: inline;'><span class='comment'><br>                                // IRPJ</span><br>                                BF szBrazilTaxType [55BRTX] = "11"<br>                                BF mnBrazilTaxRate [55BRTXR] = VA evt_pIRPJ [FW06]<br>                                BF mnBrazilTaxAmount [55BRTXA] = round((([BF mnBrazilTaxBasis [55BRTXB]]*[BF mnBrazilTaxRate [55BRTXR]])/100), "2")<br>                               <div id='03122184-e48e-4515-ba6e-16ca41a1f28c:291' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If BF cTransactionCode [EV01] is equal to "G"<div id='03122184-e48e-4515-ba6e-16ca41a1f28c:291:hide' style='display: inline;'><br>                                    <div id='03122184-e48e-4515-ba6e-16ca41a1f28c:292' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5576B01.Insert  [Index 1: Nota Fiscal Number, +]<div id='03122184-e48e-4515-ba6e-16ca41a1f28c:292:hide' style='display: inline;'><br>                                          BF mnNotaFiscalNumber [BNNF] -&#62; TK Nota Fiscal Number [BNNF]<br>                                          BF szNotaFiscalSeries [BSER] -&#62; TK Nota Fiscal Series [BSER]<br>                                          BF mnNextNumber001 [N001] -&#62; TK Next Number Range 1 [N001]<br>                                          BF szDocumentType [DCT] -&#62; TK Document Type [DCT]<br>                                          BF szBrazilTaxType [55BRTX] -&#62; TK Tax Type - Brazil [55BRTX]<br>                                          BF mnBrazilTaxBasis [55BRTXB] -&#62; TK Tax Basis - Brazil [55BRTXB]<br>                                          BF mnBrazilTaxAmount [55BRTXA] -&#62; TK Tax Amount - Brazil [55BRTXA]<br>                                          BF mnBrazilTaxRate [55BRTXR] -&#62; TK Future Use - Math Numeric 1 [N1FU]<br>                                          SL UserID -&#62; TK Transaction Originator [TORG]<br>                                          SL UserID -&#62; TK User ID [USER]<br>                                          VA evt_ProgramId_PID [PID] -&#62; TK Program ID [PID]<br>                                          VA evt_WorkStationId [JOBN] -&#62; TK Work Station ID [JOBN]<br>                                          SL DateToday -&#62; TK Date - Updated [UPMJ]<br>                                          VA evt_TimeLastUpdated [UPMT] -&#62; TK Time - Last Updated [UPMT]</div><br>                                    <div id='03122184-e48e-4515-ba6e-16ca41a1f28c:293' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If SV File_IO_Status is not equal to CO SUCCESS<div id='03122184-e48e-4515-ba6e-16ca41a1f28c:293:hide' style='display: inline;'><br>                                         <div id='03122184-e48e-4515-ba6e-16ca41a1f28c:294' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5576B01.Update  [Index 1: Nota Fiscal Number, +]<div id='03122184-e48e-4515-ba6e-16ca41a1f28c:294:hide' style='display: inline;'><br>                                               <span class='iokey'>BF mnNotaFiscalNumber [BNNF] = TK Nota Fiscal Number [BNNF]</span><br>                                               <span class='iokey'>BF szNotaFiscalSeries [BSER] = TK Nota Fiscal Series [BSER]</span><br>                                               <span class='iokey'>BF mnNextNumber001 [N001] = TK Next Number Range 1 [N001]</span><br>                                               <span class='iokey'>BF szDocumentType [DCT] = TK Document Type [DCT]</span><br>                                               <span class='iokey'>BF szBrazilTaxType [55BRTX] = TK Tax Type - Brazil [55BRTX]</span><br>                                               BF mnBrazilTaxBasis [55BRTXB] -&#62; TK Tax Basis - Brazil [55BRTXB]<br>                                               BF mnBrazilTaxAmount [55BRTXA] -&#62; TK Tax Amount - Brazil [55BRTXA]<br>                                               BF mnBrazilTaxRate [55BRTXR] -&#62; TK Future Use - Math Numeric 1 [N1FU]<br>                                               SL UserID -&#62; TK Transaction Originator [TORG]<br>                                               SL UserID -&#62; TK User ID [USER]<br>                                               VA evt_ProgramId_PID [PID] -&#62; TK Program ID [PID]<br>                                               VA evt_WorkStationId [JOBN] -&#62; TK Work Station ID [JOBN]<br>                                               SL DateToday -&#62; TK Date - Updated [UPMJ]<br>                                               VA evt_TimeLastUpdated [UPMT] -&#62; TK Time - Last Updated [UPMT]</div></div><br>                                     End If</div><br>                                End If<span class='comment'><br>                                //</span><span class='comment'><br>                                // PIS</span><br>                                BF szBrazilTaxType [55BRTX] = "15"<br>                                BF mnBrazilTaxRate [55BRTXR] = VA evt_pPIS [FW02]<br>                                BF mnBrazilTaxAmount [55BRTXA] = round((([BF mnBrazilTaxBasis [55BRTXB]]*[BF mnBrazilTaxRate [55BRTXR]])/100), "2")<br>                               <div id='03122184-e48e-4515-ba6e-16ca41a1f28c:302' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If BF cTransactionCode [EV01] is equal to "G"<div id='03122184-e48e-4515-ba6e-16ca41a1f28c:302:hide' style='display: inline;'><br>                                    <div id='03122184-e48e-4515-ba6e-16ca41a1f28c:303' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5576B01.Insert  [Index 1: Nota Fiscal Number, +]<div id='03122184-e48e-4515-ba6e-16ca41a1f28c:303:hide' style='display: inline;'><br>                                          BF mnNotaFiscalNumber [BNNF] -&#62; TK Nota Fiscal Number [BNNF]<br>                                          BF szNotaFiscalSeries [BSER] -&#62; TK Nota Fiscal Series [BSER]<br>                                          BF mnNextNumber001 [N001] -&#62; TK Next Number Range 1 [N001]<br>                                          BF szDocumentType [DCT] -&#62; TK Document Type [DCT]<br>                                          BF szBrazilTaxType [55BRTX] -&#62; TK Tax Type - Brazil [55BRTX]<br>                                          BF mnBrazilTaxBasis [55BRTXB] -&#62; TK Tax Basis - Brazil [55BRTXB]<br>                                          BF mnBrazilTaxAmount [55BRTXA] -&#62; TK Tax Amount - Brazil [55BRTXA]<br>                                          BF mnBrazilTaxRate [55BRTXR] -&#62; TK Future Use - Math Numeric 1 [N1FU]<br>                                          SL UserID -&#62; TK Transaction Originator [TORG]<br>                                          SL UserID -&#62; TK User ID [USER]<br>                                          VA evt_ProgramId_PID [PID] -&#62; TK Program ID [PID]<br>                                          VA evt_WorkStationId [JOBN] -&#62; TK Work Station ID [JOBN]<br>                                          SL DateToday -&#62; TK Date - Updated [UPMJ]<br>                                          VA evt_TimeLastUpdated [UPMT] -&#62; TK Time - Last Updated [UPMT]</div><br>                                    <div id='03122184-e48e-4515-ba6e-16ca41a1f28c:304' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If SV File_IO_Status is not equal to CO SUCCESS<div id='03122184-e48e-4515-ba6e-16ca41a1f28c:304:hide' style='display: inline;'><br>                                         <div id='03122184-e48e-4515-ba6e-16ca41a1f28c:305' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5576B01.Update  [Index 1: Nota Fiscal Number, +]<div id='03122184-e48e-4515-ba6e-16ca41a1f28c:305:hide' style='display: inline;'><br>                                               <span class='iokey'>BF mnNotaFiscalNumber [BNNF] = TK Nota Fiscal Number [BNNF]</span><br>                                               <span class='iokey'>BF szNotaFiscalSeries [BSER] = TK Nota Fiscal Series [BSER]</span><br>                                               <span class='iokey'>BF mnNextNumber001 [N001] = TK Next Number Range 1 [N001]</span><br>                                               <span class='iokey'>BF szDocumentType [DCT] = TK Document Type [DCT]</span><br>                                               <span class='iokey'>BF szBrazilTaxType [55BRTX] = TK Tax Type - Brazil [55BRTX]</span><br>                                               BF mnBrazilTaxBasis [55BRTXB] -&#62; TK Tax Basis - Brazil [55BRTXB]<br>                                               BF mnBrazilTaxAmount [55BRTXA] -&#62; TK Tax Amount - Brazil [55BRTXA]<br>                                               BF mnBrazilTaxRate [55BRTXR] -&#62; TK Future Use - Math Numeric 1 [N1FU]<br>                                               SL UserID -&#62; TK Transaction Originator [TORG]<br>                                               SL UserID -&#62; TK User ID [USER]<br>                                               VA evt_ProgramId_PID [PID] -&#62; TK Program ID [PID]<br>                                               VA evt_WorkStationId [JOBN] -&#62; TK Work Station ID [JOBN]<br>                                               SL DateToday -&#62; TK Date - Updated [UPMJ]<br>                                               VA evt_TimeLastUpdated [UPMT] -&#62; TK Time - Last Updated [UPMT]</div></div><br>                                     End If</div><br>                                End If<span class='comment'><br>                                //</span><span class='comment'><br>                                // COFINS</span><br>                                BF szBrazilTaxType [55BRTX] = "16"<br>                                BF mnBrazilTaxRate [55BRTXR] = VA evt_pCOFINS [FW03]<br>                                BF mnBrazilTaxAmount [55BRTXA] = round((([BF mnBrazilTaxBasis [55BRTXB]]*[BF mnBrazilTaxRate [55BRTXR]])/100), "2")<br>                               <div id='03122184-e48e-4515-ba6e-16ca41a1f28c:313' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If BF cTransactionCode [EV01] is equal to "G"<div id='03122184-e48e-4515-ba6e-16ca41a1f28c:313:hide' style='display: inline;'><br>                                    <div id='03122184-e48e-4515-ba6e-16ca41a1f28c:314' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5576B01.Insert  [Index 1: Nota Fiscal Number, +]<div id='03122184-e48e-4515-ba6e-16ca41a1f28c:314:hide' style='display: inline;'><br>                                          BF mnNotaFiscalNumber [BNNF] -&#62; TK Nota Fiscal Number [BNNF]<br>                                          BF szNotaFiscalSeries [BSER] -&#62; TK Nota Fiscal Series [BSER]<br>                                          BF mnNextNumber001 [N001] -&#62; TK Next Number Range 1 [N001]<br>                                          BF szDocumentType [DCT] -&#62; TK Document Type [DCT]<br>                                          BF szBrazilTaxType [55BRTX] -&#62; TK Tax Type - Brazil [55BRTX]<br>                                          BF mnBrazilTaxBasis [55BRTXB] -&#62; TK Tax Basis - Brazil [55BRTXB]<br>                                          BF mnBrazilTaxAmount [55BRTXA] -&#62; TK Tax Amount - Brazil [55BRTXA]<br>                                          BF mnBrazilTaxRate [55BRTXR] -&#62; TK Future Use - Math Numeric 1 [N1FU]<br>                                          SL UserID -&#62; TK Transaction Originator [TORG]<br>                                          SL UserID -&#62; TK User ID [USER]<br>                                          VA evt_ProgramId_PID [PID] -&#62; TK Program ID [PID]<br>                                          VA evt_WorkStationId [JOBN] -&#62; TK Work Station ID [JOBN]<br>                                          SL DateToday -&#62; TK Date - Updated [UPMJ]<br>                                          VA evt_TimeLastUpdated [UPMT] -&#62; TK Time - Last Updated [UPMT]</div><br>                                    <div id='03122184-e48e-4515-ba6e-16ca41a1f28c:315' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If SV File_IO_Status is not equal to CO SUCCESS<div id='03122184-e48e-4515-ba6e-16ca41a1f28c:315:hide' style='display: inline;'><br>                                         <div id='03122184-e48e-4515-ba6e-16ca41a1f28c:316' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5576B01.Update  [Index 1: Nota Fiscal Number, +]<div id='03122184-e48e-4515-ba6e-16ca41a1f28c:316:hide' style='display: inline;'><br>                                               <span class='iokey'>BF mnNotaFiscalNumber [BNNF] = TK Nota Fiscal Number [BNNF]</span><br>                                               <span class='iokey'>BF szNotaFiscalSeries [BSER] = TK Nota Fiscal Series [BSER]</span><br>                                               <span class='iokey'>BF mnNextNumber001 [N001] = TK Next Number Range 1 [N001]</span><br>                                               <span class='iokey'>BF szDocumentType [DCT] = TK Document Type [DCT]</span><br>                                               <span class='iokey'>BF szBrazilTaxType [55BRTX] = TK Tax Type - Brazil [55BRTX]</span><br>                                               BF mnBrazilTaxBasis [55BRTXB] -&#62; TK Tax Basis - Brazil [55BRTXB]<br>                                               BF mnBrazilTaxAmount [55BRTXA] -&#62; TK Tax Amount - Brazil [55BRTXA]<br>                                               BF mnBrazilTaxRate [55BRTXR] -&#62; TK Future Use - Math Numeric 1 [N1FU]<br>                                               SL UserID -&#62; TK Transaction Originator [TORG]<br>                                               SL UserID -&#62; TK User ID [USER]<br>                                               VA evt_ProgramId_PID [PID] -&#62; TK Program ID [PID]<br>                                               VA evt_WorkStationId [JOBN] -&#62; TK Work Station ID [JOBN]<br>                                               SL DateToday -&#62; TK Date - Updated [UPMJ]<br>                                               VA evt_TimeLastUpdated [UPMT] -&#62; TK Time - Last Updated [UPMT]</div></div><br>                                     End If</div><br>                                End If<span class='comment'><br>                                //</span><span class='comment'><br>                                // CSLL</span><br>                                BF szBrazilTaxType [55BRTX] = "17"<br>                                BF mnBrazilTaxRate [55BRTXR] = VA evt_pCSLL [FW01]<br>                                BF mnBrazilTaxAmount [55BRTXA] = round((([BF mnBrazilTaxBasis [55BRTXB]]*[BF mnBrazilTaxRate [55BRTXR]])/100), "2")<br>                               <div id='03122184-e48e-4515-ba6e-16ca41a1f28c:324' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If BF cTransactionCode [EV01] is equal to "G"<div id='03122184-e48e-4515-ba6e-16ca41a1f28c:324:hide' style='display: inline;'><br>                                    <div id='03122184-e48e-4515-ba6e-16ca41a1f28c:325' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5576B01.Insert  [Index 1: Nota Fiscal Number, +]<div id='03122184-e48e-4515-ba6e-16ca41a1f28c:325:hide' style='display: inline;'><br>                                          BF mnNotaFiscalNumber [BNNF] -&#62; TK Nota Fiscal Number [BNNF]<br>                                          BF szNotaFiscalSeries [BSER] -&#62; TK Nota Fiscal Series [BSER]<br>                                          BF mnNextNumber001 [N001] -&#62; TK Next Number Range 1 [N001]<br>                                          BF szDocumentType [DCT] -&#62; TK Document Type [DCT]<br>                                          BF szBrazilTaxType [55BRTX] -&#62; TK Tax Type - Brazil [55BRTX]<br>                                          BF mnBrazilTaxBasis [55BRTXB] -&#62; TK Tax Basis - Brazil [55BRTXB]<br>                                          BF mnBrazilTaxAmount [55BRTXA] -&#62; TK Tax Amount - Brazil [55BRTXA]<br>                                          BF mnBrazilTaxRate [55BRTXR] -&#62; TK Future Use - Math Numeric 1 [N1FU]<br>                                          SL UserID -&#62; TK Transaction Originator [TORG]<br>                                          SL UserID -&#62; TK User ID [USER]<br>                                          VA evt_ProgramId_PID [PID] -&#62; TK Program ID [PID]<br>                                          VA evt_WorkStationId [JOBN] -&#62; TK Work Station ID [JOBN]<br>                                          SL DateToday -&#62; TK Date - Updated [UPMJ]<br>                                          VA evt_TimeLastUpdated [UPMT] -&#62; TK Time - Last Updated [UPMT]</div><br>                                    <div id='03122184-e48e-4515-ba6e-16ca41a1f28c:326' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>If SV File_IO_Status is not equal to CO SUCCESS<div id='03122184-e48e-4515-ba6e-16ca41a1f28c:326:hide' style='display: inline;'><br>                                         <div id='03122184-e48e-4515-ba6e-16ca41a1f28c:327' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>F5576B01.Update  [Index 1: Nota Fiscal Number, +]<div id='03122184-e48e-4515-ba6e-16ca41a1f28c:327:hide' style='display: inline;'><br>                                               <span class='iokey'>BF mnNotaFiscalNumber [BNNF] = TK Nota Fiscal Number [BNNF]</span><br>                                               <span class='iokey'>BF szNotaFiscalSeries [BSER] = TK Nota Fiscal Series [BSER]</span><br>                                               <span class='iokey'>BF mnNextNumber001 [N001] = TK Next Number Range 1 [N001]</span><br>                                               <span class='iokey'>BF szDocumentType [DCT] = TK Document Type [DCT]</span><br>                                               <span class='iokey'>BF szBrazilTaxType [55BRTX] = TK Tax Type - Brazil [55BRTX]</span><br>                                               BF mnBrazilTaxBasis [55BRTXB] -&#62; TK Tax Basis - Brazil [55BRTXB]<br>                                               BF mnBrazilTaxAmount [55BRTXA] -&#62; TK Tax Amount - Brazil [55BRTXA]<br>                                               BF mnBrazilTaxRate [55BRTXR] -&#62; TK Future Use - Math Numeric 1 [N1FU]<br>                                               SL UserID -&#62; TK Transaction Originator [TORG]<br>                                               SL UserID -&#62; TK User ID [USER]<br>                                               VA evt_ProgramId_PID [PID] -&#62; TK Program ID [PID]<br>                                               VA evt_WorkStationId [JOBN] -&#62; TK Work Station ID [JOBN]<br>                                               SL DateToday -&#62; TK Date - Updated [UPMJ]<br>                                               VA evt_TimeLastUpdated [UPMT] -&#62; TK Time - Last Updated [UPMT]</div></div><br>                                     End If</div><br>                                End If<span class='comment'><br>                                //</span></div><br>                           End If</div><br>                     <div id='03122184-e48e-4515-ba6e-16ca41a1f28c:332' class='expand2' onclick='ExpandCollapse(this.id);'>-</div>Else<div id='03122184-e48e-4515-ba6e-16ca41a1f28c:332:hide' style='display: inline;'><span class='comment'><br>                           // So deve reter se for servicos (ISSQN)</span><span class='comment'><br>                           // Se for o caso, desenvolver no futuro</span></div><br>                      End If</div><br>                 End If</div><br>            End If<span class='comment'><br>            //</span></div><br>       End If<span class='comment'><br>       //</span></div><br>  End If<span class='comment'><br>  //</span></div></div></body></html>